{"title": "PDF", "author": "PDF", "url": "https://openaccess.uoc.edu/bitstream/10609/144026/7/fgutierrezromTFM062020memoria.pdf", "hostname": "PDF", "description": "PDF", "sitename": "PDF", "date": "PDF", "cleaned_text": "Enfermedades mentales y su relaci\u00f3n con el microbioma intestinal Francisco Guti\u00e9rrez Romero M\u00e1ster Universitario en Bioinform\u00e1tica y Bioestad\u00edstica TFM - Bioinform\u00e1tica y Bioestad\u00edstica Paytuv\u00ed Gallart Ferran Padros Carrasco Junio 2020\"Pronto ser\u00e1 un pecado para los padres tener un hijo que lleve la pesada carga de la enfermedad gen\u00e9tica. \" BOB EDWARDS \"Las 'leyes del pensamiento' no solo dependen de las propiedades de las c\u00e9lulas cerebrales, sino del modo en que est\u00e1n conectadas. \" MARVIN MINSKY \"Si en otras ciencias hay que llegar a la certeza, sin duda, y a la verdad sin error, nos corresponde poner las bases de los conocimientos en las matem\u00e1ticas. \" ROGER BACONFICHA DEL TRABAJO FINAL T\u00edtulo del trabajo: Enfermedades mentales y su relaci\u00f3n con el microbioma intestinal Nombre del autor: Francisco Guti\u00e9rrez Romero Nombre del consultor: Andreu Paytuv\u00ed Gallart Nombre del PRA: Ferran Prados Carrascos Fecha de entrega (mm/aaaa): 06/2020 Titulaci\u00f3n: M\u00e1ster Universitario en Bioinform\u00e1tica y trabajo nal: TFM - Bioinform\u00e1tica y Bioestad\u00edstica \u00c1rea 3 Castellano Palabras clave Disbiosis, microbiota, intestino-cerebro, salud, mental, enfermedad, transtorno, comportamiento, predic- ci\u00f3n, aprendizaje autom\u00e1tico, Machine learning Resumen del trabajo La relaci\u00f3n entre el microbioma intestinal y algunas de las enfermedades mentales m\u00e1s co- munes, es una realidad. Es una certeza que no se puede constatar qu\u00e9 conjunto de unidades taxon\u00f3micas operativas son responsables de estas afectaciones mentales. Hoy en d\u00eda se re- curre a diferentes tratamientos, en funci\u00f3n del trastorno y de la gravedad del mismo. Lo m\u00e1s importante en estos casos es poder llegar a adelantarse a esta situaci\u00f3n degenerativa y poder predecir a tiempo cualquiera de estas enfermedades. Este trabajo se centra en esto mismo, en la predicci\u00f3n de enfermedades mentales que pueda llegar a desarrollar cualquier persona, bas\u00e1ndose principalmente en el microbioma intestinal y en ciertos h\u00e1bitos de comportamiento. Cada individuo tiene su propia microbiota, formada por un determinado tipo de bacterias, algunas con m\u00e1s presencia que otras, lo que se conoce como enterotipo intestinal . A partir del an\u00e1lisis de los datos proporcionados, se ha desarrollado una aplicaci\u00f3n de soft- ware de predicci\u00f3n para detectar enfermedades mentales. Dicha herramienta supone la parte pr\u00e1ctica de un estudio basado en el entrenamiento autom\u00e1tico para el ajuste de un modelo predictor. La aplicaci\u00f3n permite al usuario realizar ajustes antes del entrenamiento, como la elecci\u00f3n de los algoritmos de clasicaci\u00f3n, decidir el porcentaje de balanceo de los datos, o incluso, insertar la taxonom\u00eda de un grupo de pacientes para ser diagnosticados de un posible trastorno mental. Durante el trascurso de este documento se describir\u00e1n los m\u00e9todos y t\u00e9cnicas utilizadas, y las caracter\u00edsiticas de las herramientas necesarias. Finalmente, se presentan los resultados fruto del experimento, que demuestran la ecacia del an\u00e1lisis en su totalidad.Abstract The relationship between the gut microbiome and some of the most common mental illnesses, it is a reality. It is a certainty that it cannot be veried which set of operational taxonomic unit are responsible for these mental disorders. Today it is used different treatments, depending on the disorder and its severity. The most important in these cases is to be able to anticipate this degenerative situation and to be able to predict any of these diseases. This work focuses on this very thing, on predicting mental illnesses that can be developed by any person, individual has their own microbiota, formed by a certain type of bacteria, some with more presence than others, what is known as intestinal enterotype . From the analysis of the data provided, a software application has been developed of predic- tion to detect mental illnesses. This tool is the practical part of a study based on automatic training to t a predictive model. The application allows the user to make adjustments before training, such as choosing the classication algorithms, decide the percentage of data ba- lancing, or even insert the taxonomy of a group of patients to be diagnosed with a possible mental disorder. This document shows the methods and techniques used and the characteristics of the neces- sary tools. Finally, the results of the experiment are presented, that demonstrate the effective- ness of the analysis in its entirety. vvi\u00cdndice general 1 Introducci\u00f3n 1 1.1 Contexto 53 Glosario 57 Bibliograa 59 Anexos 62 A M\u00e9todos y funciones de la aplicaci\u00f3n 65 de la poblaci\u00f3n taxon\u00f3mica con enfermedades mentales. . . . . . . 20 la detecci\u00f3n de Anorexia nervosa, Bipolar Resultados en la detecci\u00f3n de Anorexia nervosa, Depression Depression y Schizophrenia. . . . . . 46 Figura 2.47 Resultados en la predicci\u00f3n de la Anorexia nervosa . 48 Figura 2.50 Variables m\u00e1s importantes en la predicci\u00f3n de la Bipolar disorder . . 48 Figura 2.51 Variables m\u00e1s importantes en la predicci\u00f3n de la Bulimia nervosa . . 49 Figura 2.52 Variables m\u00e1s importantes en la predicci\u00f3n de la Depression . . . . 49 Figura 2.53 Variables m\u00e1s importantes en la predicci\u00f3n de la Schizophrenia . . . 50 Figura 2.55 Variables m\u00e1s importantes en la predicci\u00f3n de Susbstance abuse . . 51 Figura B.1 Distribuci\u00f3n de los datos referente a la edad, el sexo, la altura y el gr\u00e1ca de frecuencia en la ingesta de vegetales, marisco, fruta y carne gr\u00e1ca de frecuencia en la toma de un litro de agua, bebidas azucaradas, alcohol los datos referente a la duraci\u00f3n del sue- \u00f1o, diagn\u00f3stico de tener migra\u00f1a, reflujo de de frecuencia del uso de cosm\u00e9ticos, ejerci- cio y vacuna para la gripe, adem\u00e1s del tipo de anticonceptivo usado . . . . 75 Figura B.6 Representaci\u00f3n gr\u00e1ca de los datos referente enfermedades de ri- \u00f1\u00f3n, h\u00edgado y pulm\u00f3n, y la frecuencia de consumo de huevo de carne. . . . 76 Figura B.7 Representaci\u00f3n gr\u00e1ca de frecuencia del consumo de queso, multi- vitaminas y probi\u00f3ticos, adem\u00e1s de la condici\u00f3n de estar embarazada . . . 76 Figura B.8 Representaci\u00f3n gr\u00e1ca de frecuencia del consumo de snaks, azu- car, vitamina de tablas Tabla 2.1 Distribuci\u00f3n de las enfermedades mentales dentro del juego de datos 15 xiiiTabla 2.2 Relaci\u00f3n de m\u00faltiples enfermedades mentales en pacientes . . . . . 16 Tabla 2.3 Valor Tree . . . . . . 25 Tabla 2.6 Fortalezas del algoritmo Support Vector Machine . . . . 29 Tabla 2.7 Fortalezas y 2.8 Valores de las variables m\u00e1s importantes en la predicci\u00f3n de la 2.9 Valores de las variables m\u00e1s importantes en la predicci\u00f3n de 2.10 Valores de las variables m\u00e1s importantes en la predicci\u00f3n de 2.11 Valores de las variables m\u00e1s importantes en la predicci\u00f3n de Valores de las variables m\u00e1s importantes en la predicci\u00f3n de la Valores de las variables m\u00e1s importantes en la predicci\u00f3n Valores de las variables m\u00e1s importantes en la predicci\u00f3n 1.1. Contexto y justicaci\u00f3n del Trabajo Con frecuencia, las bacterias, virus y par\u00e1sitos son considerados como una gran ame- naza que debe ser eliminada. Es cierto que bacterias como Yersinia pestis oVibrio cho- lerae han truncado un gran n\u00famero de vidas humanas. Sin embargo, tambi\u00e9n cabe decir que otras como Bacillus subtilis ,Escherichia coli oStreptomyces venezuelae han ayuda- do en la detecci\u00f3n de enfermedades metab\u00f3licas e incluso son utilizadas para elaborar antibi\u00f3ticos, salvando de este modo much\u00edsimas otras vidas. [3] La microbiota, que es el conjunto de microorganismos que mantiene una relaci\u00f3n de asociaci\u00f3n con otro organismo de diferente especie, se aloja en diferentes partes del cuerpo humano. Cabe destacar por su importancia el microbioma intestinal, formado por el conjunto de genes de estos microorganismos. Se sabe que existe una interacci\u00f3n entre el microbioma intestinal y el hu\u00e9sped, por lo tanto, de esta relaci\u00f3n se podr\u00eda obtener informaci\u00f3n relevante sobre el estado de la salud mental de \u00e9ste. As\u00ed pues, algunas enfermedades pueden ser relacionadas con los desequilibrios de la microbiota intestinal o disbiosis. Por el momento, s\u00f3lo se han dado los primeros pasos en establecer una correlaci\u00f3n directa entre la disbiosis y el crecien- te n\u00famero de enfermedades mentales, s\u00edndromes y/o alteraciones funcionales ligadas a estos desequilibrios. 12 CAP\u00cdTULO 1. INTRODUCCI\u00d3N As\u00ed pues, la detecci\u00f3n precoz de cualquier enfermedad mental es de vital importancia para poder tomar medidas mientras a\u00fan se est\u00e1 a tiempo, proporcionando un tratamiento o incluso indicando qu\u00e9 h\u00e1bitos deben ser corregidos para que la enfermedad no llegue a manifestarse y/o se retrase lo m\u00e1ximo posible. Se estima que, actualmente, hay m\u00e1s de 1.100 millones de personas en todo el mundo que padecen alg\u00fan tipo de transtorno mental. Entre las m\u00e1s comunes est\u00e1n los trastornos de ansiedad con 275 millones, depresi\u00f3n con 268 millones, trastorno bipolar con 40 mi- llones o esquizofrenia con 21 millones, entre otras enfermedades [11]. Estos transtornos no solo incluyen caracter\u00edsticas individuales como la capacidad de gesti\u00f3n de los pensa- mientos o la sociabilidad, sino que tambi\u00e9n hay factores culturales, condiciones laborales y/o econ\u00f3micas. Otros factores influyentes que pueden causar trastornos mentales pue- den ser la alimentaci\u00f3n, el estr\u00e9s o la propia herencia gen\u00e9tica. [12]. El objetivo principal de este proyecto es el de poder determinar, en funci\u00f3n de la taxonom\u00eda de una poblaci\u00f3n y ciertas caracter\u00edsticas de un grupo de individuos, si \u00e9stos podr\u00edan llegar a desarrollar o no una o varias enfermedades mentales y de ser as\u00ed, cu\u00e1l es la probabilidad de que esto ocurra y qu\u00e9 g\u00e9neros taxon\u00f3micos son los m\u00e1s relevantes. A t\u00edtulo personal, considero que lo m\u00e1s importante de la vida es ser consciente de la existencia de uno mismo. Si se pierde esa certeza, todo lo dem\u00e1s carecer\u00e1 de importan- cia. 1.2. Objetivos del Trabajo El objetivo principal de esta investigaci\u00f3n es el de generar un modelo, a trav\u00e9s del aprendizaje autom\u00e1tico Machine learning , capaz de determinar la probabilidad de desa- rrollar ciertos tipos de enfermedades mentales en funci\u00f3n del perl taxon\u00f3mico del micro- bioma intestinal de un sujeto. A su vez, este modelo ser\u00e1 parte de una herramienta inform\u00e1tica para el diagn\u00f3stico einvestigaci\u00f3n , que facilitar\u00e1 el an\u00e1lisis a aquellos profesionales del sector que nece- siten saber si un paciente puede llegar a desarrollar o no alguna enfermedad mental, permitiendo de esta forma el poder prevenir y analizar el posible desarrollo de la misma.1.2. OBJETIVOS DEL TRABAJO 3 1.2.1. Objetivos generales Los objetivos generales de este trabajo, constan de dos partes bien diferenciadas, tanto en su cometido como en la tecnolog\u00eda en la que se van a desarrollar. La primera parte se centra, principalmente, en la obtenci\u00f3n de un modelo predictor a trav\u00e9s del aprendizaje autom\u00e1tico. Se utilizar\u00e1 el lenguaje Ren su versi\u00f3n 3.6.1 , para realizar todos aquellos pasos necesarios en el entrenamiento del modelo, as\u00ed como en las comprobaciones de los resultados obtenidos en el mismo. La segunda parte consiste en el desarrollo de una aplicaci\u00f3n, a trav\u00e9s del lenguaje de programaci\u00f3n Python en su versi\u00f3n 3.6, que permitir\u00e1 al usuario introducir los datos a analizar y visualizar los resultados despu\u00e9s de aplicar el modelo de predicci\u00f3n. 1.2.2. Objetivos espec\u00edcos Los objetivos espec\u00edcos de este trabajo se dividen en tres bloques dependientes entre ellos, ya que requieren de una compenetraci\u00f3n total entre s\u00ed. El primer bloque se basa en la preparaci\u00f3n de los datos para el an\u00e1lisis. \u00c9ste se centra, principalmente en la lectura, ltrado y selecci\u00f3n de informaci\u00f3n proporcionada a trav\u00e9s de diferentes cheros, que ser\u00e1n utilizados posteriormente en el estudio. El segundo bloque trata del an\u00e1lisis de los datos sin procesar y en la aplicaci\u00f3n de t\u00e9cnicas de normalizaci\u00f3n y/o transformaci\u00f3n en funci\u00f3n de las necesidades del ajuste del modelo. Adem\u00e1s de esto, mediante diferentes algoritmos de clasicaci\u00f3n, se podr\u00e1 determinar cu\u00e1l o cu\u00e1les son m\u00e1s \u00f3ptimos para este n. Por \u00faltimo, el tercer bloque se centra en el desarrollo de una aplicaci\u00f3n de software, que mediante una interfaz de usuario permitir\u00e1 facilitar la tarea de an\u00e1lisis e interpretaci\u00f3n de los resultados obtenidos al usuario nal.4 CAP\u00cdTULO 1. INTRODUCCI\u00d3N 1.3. Enfoque y m\u00e9todo seguido El procedimiento a seguir se basa en dos pilares principales: la preparaci\u00f3n de los datos para ajustar el modelo y la predicci\u00f3n. Ajuste del modelo Inicialmente, se dispone de dos grupos de datos: Un primer grupo de Metadatos , formado por un conjunto de cheros en formato JSON que contienen las caracter\u00edsticas de \u001916.000 individuos. Estas caracter\u00edsticas son, entre otras, edad, peso, h\u00e1bito referente a la ingesta de bebidas alcoh\u00f3licas, alergias, etc... La fundamental es la informaci\u00f3n referente a si \u00e9ste ha llegado a desarrollar o no alguna en- fermedad mental, como anorexia nerviosa, desorden bipolar, bulimia nerviosa, depresi\u00f3n, estr\u00e9s post-traum\u00e1tico, esquizofrenia y/o abuso de sustancias . Un segundo grupo de datos almacena informaci\u00f3n taxon\u00f3mica , perteneciente al mis- mo conjunto de individuos del grupo anterior. Dicha informaci\u00f3n contiene el porcentaje y la cantidad de OTUs que est\u00e1n presentes en cada paciente. A partir de estos cheros, se realizar\u00e1 un ltrado y una agrupaci\u00f3n que formar\u00e1n el conjunto nal de datos a utilizar para realizar el ajuste del modelo. Una vez el conjunto de datos ha sido transformado y/o normalizado, se proceder\u00e1 a probar algunos de los algoritmos de aprendizaje autom\u00e1tico m\u00e1s conocidos, como por ejemplo: Boost Decision Tree,Support Vector Machine yRandom Forest que a partir de ahora, cuando se haga referencia a alguno de ellos, se utilizar\u00e1n las siglas BDT, SVM y RF respectivamente, cuando se quiera hacer menci\u00f3n a estos algoritmos. Seguidamente, se realizar\u00e1 una comparativa de rendimiento y se tomar\u00e1 aquel que mejor se adapte al conjunto de datos. En el caso de haber m\u00e1s de un clasicador \u00f3ptimo, se trabajar\u00e1 con todos ellos. [1] Predicci\u00f3n El proyecto est\u00e1 basado en un t\u00e1ndem de tecnolog\u00edas, donde el lenguaje Python se encargar\u00e1 de mostrar la interfaz de usuario y de entrada/salida de cheros, y la herra-1.4. PLANIFICACI\u00d3N DEL TRABAJO 5 mienta estad\u00edstica Ractuar\u00e1 como motor de c\u00f3mputo. Para obtener la predicci\u00f3n, se necesitar\u00e1 un chero de taxonom\u00eda de la poblaci\u00f3n a la que se le va a realizar dicha predicci\u00f3n, adem\u00e1s de los correspondientes metadatos de cada uno de los pacientes. Es importante se\u00f1alar que se deben tener en cuenta los mismos criterios de ltrado y selecci\u00f3n de los pacientes que cuando se ha ajustado el modelo. Por \u00faltimo, el juego de datos resultante ser\u00e1 utilizado con el modelo de entre- namiento para que \u00e9ste realice la predicci\u00f3n nal. En esta predicci\u00f3n se conocer\u00e1 si un individuo padecer\u00e1 o no una de estas enfermedades mentales, con una cierta proba- bilidad de que as\u00ed sea. Adem\u00e1s, se mostrar\u00e1n aquellas OTUs m\u00e1s signicativas en la obtenci\u00f3n de esta predicci\u00f3n. 1.4. Planicaci\u00f3n del Trabajo La tarea de planicaci\u00f3n del trabajo, se podr\u00eda decir que ha sido tan complicada como el desarrollo del trabajo en si. Han habido algunas subtareas, sobre todo en la conexi\u00f3n de las dos tecnolog\u00edas, donde se sab\u00eda de antemano que podr\u00edan surgir problemas, pero era realmente muy dif\u00edcil poder realizar una valoraci\u00f3n en horas del coste del desarrollo. Figura 1.1: Distribuci\u00f3n del tiempo para el desarrollo de las tareas Por ese motivo, la estimaci\u00f3n de alguna de las partes del proyecto han necesitado de una peque\u00f1a bolsa de horas adicional, por si llegaba a complicarse mucho m\u00e1s de lo previsto inicialmente.6 CAP\u00cdTULO 1. INTRODUCCI\u00d3N 1.4.1. Preparaci\u00f3n de los datos Inicio tarea 17/03/2020 - Final tarea 23/03/2020 Consiste en ltrar y preparar toda la informaci\u00f3n suministrada para poder realizar el an\u00e1lisis. El primer ltrado se basa en descartar aquellos individuos del conjunto de Metadatos que no cumplan unos ciertos requisitos. De esta forma se intenta eliminar el ruido lo m\u00e1ximo posible en los resultados. Estos requisitos de descarte son: estar fuera de un rango de \u00edndice de masa corporal, haber padecido alguna enfermedad inflamatoria intestinal, ser diab\u00e9tico y haber tomado antibi\u00f3ticos en los \u00faltimos seis meses . El segundo ltrado se realiza sobre la matriz de taxonom\u00eda, y consiste en descartar aquellos individuos con un porcentaje de Pseudomonas superior al 3 % y un porcentaje de(unkn.) Enterobacteriaceae(f) tambi\u00e9n superior al 3 %. Una vez realizados los dos ltrados, aquellos individuos que aparezcan en ambos grupos a la vez, ser\u00e1n parte del conjunto nal de datos que ser\u00e1 analizado. Por \u00faltimo, a la hora de preparar los datos, se observa que la informaci\u00f3n de cada uno de los pacientes es muy extensa y no toda es importante para este estudio. Por lo tanto, para no elevar los tiempos de c\u00e1lculo o incluso para que algunas caracter\u00edsticas no relevantes generen ruido, solo algunas ser\u00e1n incluidas en el conjunto nal. 1.4.2. Estad\u00edstica descriptiva y normalizaci\u00f3n Inicio tarea 24/03/2020 - Final tarea 02/04/2020 Se trata de saber c\u00f3mo est\u00e1n distribuidos los datos obtenidos para determinar si es necesario o no realizar alg\u00fan tipo de normalizaci\u00f3n y/o transformaci\u00f3n. Tambi\u00e9n permite tener una primera toma de contacto de c\u00f3mo puede ir el proceso de entrenamiento y pruebas. 1.4.3. Algoritmos Machine Learning Inicio tarea 03/04/2020 - Final tarea 17/04/2020 Se debe decidir qu\u00e9 algoritmo de aprendizaje autom\u00e1tico se va a utilizar, ya que sin conocer c\u00f3mo est\u00e1n distribuidos los datos o qu\u00e9 tipo de correlaci\u00f3n existe entre ellos,1.4. PLANIFICACI\u00d3N DEL TRABAJO 7 ser\u00eda aventurarse por un camino del que se desconoce si hay salida o no. Es cierto que algoritmos como Random Forest , que se utiliza habitualmente y del que se obtienen buenos resultados si el conjunto de datos es lo sucientemente grande, podr\u00eda ser a priori, la \u00fanica propuesta. Pero tambi\u00e9n hay otros como Support Vector Machine , que en el caso de llegar a conseguir una buena distribuci\u00f3n de los datos, se podr\u00edan obtener unos muy esperanzadores resultados. As\u00ed pues, se realizar\u00e1n pruebas con distintos clasicadores, y aquellos mejor adapta- dos al conjunto de datos ser\u00e1n los disponibles desde la interfaz de usuario. 1.4.4. Generaci\u00f3n del modelo Inicio tarea 18/04/2020 - Final tarea 22/04/2020 Para cada uno de los algoritmos de clasicaci\u00f3n se realizar\u00e1 los mismos pasos con el n de completar el entrenamiento y generar el modelo. Estos pasos est\u00e1n formados por la preparaci\u00f3n del grupo de entrenamiento y del grupo de pruebas, la predicci\u00f3n y evaluaci\u00f3n del rendimiento del modelo y por \u00faltimo, una mejora del mismo si fuera posible. 1.4.5. Interfaz de usuario Inicio tarea 23/04/2020 - Final tarea 04/05/2020 Una vez se ha tomado la decisi\u00f3n de qu\u00e9 algoritmo o algoritmos se van a utilizar para generar el modelo, el siguiente paso es desarrollar una aplicaci\u00f3n de software que sea capaz de facilitar todo este proceso al usuario nal. Esta aplicaci\u00f3n ha de permitir realizar un n\u00famero de simulaciones con distintos mo- delos entrenados, y que aquel con mejor resultado sea el que calcule la probabilidad de que un paciente pueda desarrollar o no una enfermedad mental.8 CAP\u00cdTULO 1. INTRODUCCI\u00d3N 1.4.6. Comunicaci\u00f3n Python/R Inicio tarea 05/05/2020 - Final tarea 12/05/2020 El proceso de comunicaci\u00f3n entre estas dos tecnolog\u00edas permitir\u00e1 repartir de una manera ordenada los pesos de cada una de las tareas. Desde Python se enviar\u00e1n los datos sin procesar, previamente ltrados, a Rpara que \u00e9ste se encargue de todo el proceso de la generaci\u00f3n del modelo. Una vez terminado, Rdeber\u00e1 enviar los resultados a Python con la nalidad de poder informar al usuario de c\u00f3mo ha ido todo el proceso de an\u00e1lisis. 1.4.7. Pruebas unitarias Inicio tarea 13/05/2020 - Final tarea 18/05/2020 Este tipo de pruebas permiten asegurar que cada uno de los pasos atomizados rea- lizan aquello que se espera de ellos, que no es m\u00e1s que el cometido para lo que fueron dise\u00f1ados. 1.4.8. Hitos HITO 1 : Una vez completado el primero de los objetivos, se realizar\u00e1 un informe para explicar los resultados provisionales obtenidos y cu\u00e1l o cu\u00e1les de los algoritmos de apren- dizaje autom\u00e1tico pueden ser candidatos a ser utilizados en la aplicaci\u00f3n de software. HITO 2 : Al nalizar el desarrollo de la aplicaci\u00f3n de software, se documentar\u00e1 el funcionamiento de \u00e9sta y se decidir\u00e1 si se a\u00f1ade alguna nueva funcionalidad o se elimina alguna de las ya existentes. HITO 3 : Entrega de la memoria nal y preparaci\u00f3n de la presentaci\u00f3n virtual.1.5. BREVE SUMARIO DE PRODUCTOS OBTENIDOS 9 Figura 1.2: Diagrama de Gantt de las tareas a realizar con los tiempos de dedicaci\u00f3n para cada una de las diferentes tareas previstas durante el desarrollo del proyecto 1.5. Breve sumario de productos obtenidos 1.5.1. Memoria Se trata del presente documento, donde se explica c\u00f3mo se ha desarrollado todo el trabajo nal del m\u00e1ster en cada una de las diferentes fases. 1.5.2. Productos Se entrega un producto nal que consiste en una aplicaci\u00f3n de software que sintetiza todo el estudio realizado. Adem\u00e1s, a trav\u00e9s de un repositorio se adjunta tanto el c\u00f3digo fuente de la aplicaci\u00f3n en lenguaje de programaci\u00f3n Python , como el c\u00f3digo fuente del an\u00e1lisis de los datos y la evaluaci\u00f3n de los algoritmos en el lenguaje estad\u00edstico R. 1.5.3. Presentaci\u00f3n Mediante un documento en formato power point , se realizar\u00e1 una presentaci\u00f3n y al mismo tiempo una explicaci\u00f3n oral del desarrollo del trabajo.10 CAP\u00cdTULO 1. INTRODUCCI\u00d3N 1.5.4. Autoevaluaci\u00f3n Consiste en la defensa personal del trabajo ante un tribunal, que formular\u00e1 preguntas o dudas sobre el mismo. 1.6. Breve descripci\u00f3n de los otros cap\u00edtulos de la me- moria En el segundo cap\u00edtulo se encuentra toda la metodolog\u00eda utilizada en el desarrollo del proyecto y los resultados de cada una de las fases. En el tercer cap\u00edtulo se exponen las conclusiones generadas a partir de los resulta- dos del cap\u00edtulo anterior. En el cuarto cap\u00edtulo se enumeran las palabras y expresiones del documento que pueden necesitar una denici\u00f3n m\u00e1s concreta. En el quinto cap\u00edtulo se hace referencia a las publicaciones de los autores mencio- nadas en alguna parte de la memoria. En el sexto cap\u00edtulo aparece informaci\u00f3n adicional como soporte para la mejor com- prensi\u00f3n de alguna de las fases del trabajo.Cap\u00edtulo 2 Metodolog\u00eda 2.1. Introducci\u00f3n Tiempo atr\u00e1s, hab\u00eda la creencia de que los trastornos y las enfermedades mentales eran consecuencia de posesiones demon\u00edacas o fruto de acontecimientos sobrenatura- les. M\u00e1s adelante, aparecieron centros de reclusi\u00f3n donde los enfermos, en lugar de ser curados, simplemente eran torturados con la excusa de la sanaci\u00f3n. Incluso, a me- diados del siglo pasado se utilizaron t\u00e9cnicas m\u00e1s avanzadas, compar\u00e1ndolas con la trepanaci\u00f3n craneal, donde nalmente los afectados terminaban con da\u00f1os cerebrales irreversibles [4]. Desde hace algo m\u00e1s de una d\u00e9cada, la ciencia intenta comprender el complejo fun- cionamiento de la comunicaci\u00f3n entre el intestino y el cerebro. Ya en 2011 se publicaron los primeros resultados que reflejaban la influencia de la microbiota en el comportamiento en ratones, simplemente alterando la composici\u00f3n de \u00e9sta. Ahora, un estudio ha podido demostrar por primera vez, que la microbiota intestinal en humanos tiene una relaci\u00f3n directa con la salud mental. [5] Actualmente, se pueden enumerar y clasicar un gran n\u00famero de trastornos y en- fermedades mentales, algunos muy antiguos y otros no tanto a consecuencia de la vida moderna. Por ejemplo: Alzheimer, demencia vascular, Parkinson, pensamientos suicidas, depresi\u00f3n, ansiedad, fobia social, trastorno por d\u00e9cit de atenci\u00f3n, trastorno obsesivo compulsivo, trastorno bipolar, trastorno de la conducta alimentaria, esquizofrenia, distor- 1112 CAP\u00cdTULO 2. METODOLOG\u00cdA siones cognitivas, y muchas m\u00e1s que seguramente a\u00fan no est\u00e1 catalogadas y otras que aparecer\u00e1n. Por lo tanto, el poder anticiparse a este hecho es de vital importancia para el buen funcionamiento de nuestras mentes. Disponer de herramientas capaces de predecir qu\u00e9 tipo de enfermedad o trastorno mental podr\u00edamos llegar a desarrollar, en funci\u00f3n de un cierto escenario microbi\u00f3mico, ser\u00edan la punta de lanza ante esta eventualidad. La disbiosis, hecho muy com\u00fan actualmente, est\u00e1 vinculada a un gran n\u00famero de enfermedades humanas, de las que cabe destacar por su importancia la salud mental y el comportamiento. Este hecho puede explicar, en gran medida, el papel de la conexi\u00f3n intestino-cerebro y su vital importancia. Con el n de relacionar los trastornos depresivos con una cierta bacteria, se ha ob- servado una fuerte asociaci\u00f3n entre las bacterias Faecalibacterium yCoprococcus y los indicadores de mayor calidad de vida. La merma de las bacterias Dialister yCoprococcus agudizan el trastorno depresivo, incluso despu\u00e9s de corregir los efectos con antidepresi- vos. [5] Otro tipo de relaci\u00f3n son los problemas gastrointestinales, que se ven asociados con la mayor\u00eda de los casos de autismo, sugiriendo que no se trata \u00fanicamente de un trastorno psiqui\u00e1trico, sino que tambi\u00e9n tiene una base siol\u00f3gica. Un trastorno intestinal similar a la enfermedad de Crohn es, a veces, reportado en ni\u00f1os autistas. Se lleg\u00f3 a la con- clusi\u00f3n de que los ni\u00f1os con autismo tienen niveles m\u00e1s bajos de bacterias intestinales Veillonellaceae ,Coprococcus yPrevotella que aquellos sin la condici\u00f3n. [6] La base del problema reside en que no se conoce la totalidad de la relaciones entre las enfermedades mentales y la carencia o merma de uno o varias bacterias que forman la microbiota intestinal. Una de las dicultades a\u00f1adidas a esta investigaci\u00f3n con seres humanos, es que \u00e9stos a diferencia de los animales por norma general, cambian de patrones de alimentaci\u00f3n, toman antibi\u00f3ticos, pueden estar sujetos a estr\u00e9s cont\u00ednuo, lo que puede alterar la composici\u00f3n y/o concentraci\u00f3n de la microbiota. Adem\u00e1s, cabe a\u00f1adir que \u00e9sta es, en cada individuo, \u00fanica. [7]2.2. AN\u00c1LISIS DE LOS DATOS 13 2.2. An\u00e1lisis de los datos 2.2.1. Recolecci\u00f3n de los datos Los datos recopilados provienen del proyecto American Gut Project o AGP. Este, junto a otros proyectos, est\u00e1n basados en el an\u00e1lisis del microbioma en todo el mundo, estableciendo los cimientos de la comprensi\u00f3n de los billones de microbios que moran en cada uno de nuestros cuerpos. Ahora, este proyecto, brinda la oportunidad de unirse a la investigaci\u00f3n y comparar microbios de nuestro intestino con los de los intestinos de miles de personas en los Estados Unidos y en todo el mundo. La informaci\u00f3n taxon\u00f3nica recopilada para la realizaci\u00f3n de este trabajo, consta de una poblaci\u00f3n de \u001916.000 participantes humanos y de \u00192.900 OTUs formando, de esta manera, una matriz taxon\u00f3mica. Adem\u00e1s, por cada paciente se dispone de informaci\u00f3n sobre ciertas caracter\u00edsticas, pero sobre todo si padece alg\u00fan tipo de transtorno de salud mental. Cuando se hizo la selecci\u00f3n de pacientes se tuvo en cuenta este hecho, que fue conrmado por cada uno de ellos. Todos los datos de secuencia y las respuestas de los participantes an\u00f3nimos se pueden encontrar en EBI bajo el proyecto PRJEB11419 y el ID de estudio Qiita 10317 . [14] Taxonom\u00eda La informaci\u00f3n taxon\u00f3mica est\u00e1 formada por dos cheros de texto, donde se incluye la relaci\u00f3n entre cada uno de los pacientes y un conjunto de OTUs. En el chero ge- nus.count.txt se tiene en cuenta la relaci\u00f3n entre el n\u00famero de apariciones de cada tax\u00f3n y cada paciente. Por otro lado, el chero genus.perc.txt muestra el porcentaje de apariciones de ca- da tax\u00f3n en cada paciente respecto al total de la poblaci\u00f3n. Este mismo chero se ha utilizado en este proyecto para el ltrado de pacientes en funci\u00f3n de un porcentaje, ya que precisamente contiene estos valores ya calculados y permite un mejor manejo de los datos.14 CAP\u00cdTULO 2. METODOLOG\u00cdA Metadatos Para cada paciente existe un conjunto de metadatos que se almacenan en cheros con formato JSON . En \u00e9stos se encuentra informaci\u00f3n sobre ciertas caracter\u00edsticas y h\u00e1bitos relevantes, como por ejemplo si el paciente ha sufrido alguna enfermedad men- tal del tipo anorexia nerviosa ,desorden bipolar ,bulimia nerviosa ,depresi\u00f3n , desorden debido a estr\u00e9s post traum\u00e1tico ,esquizofrenia oabuso de sustancias . Tambi\u00e9n se tiene en cuenta otro tipo de caracter\u00edsticas tales como: sexo,edad ,altura , peso ,frecuencia en la ingesta de vegetales ,marisco ,fruta,carne roja ,si toma al menos un litro de agua diario ,si consume bebidas azucaradas ,alcohol ,si fuma ,cu\u00e1nto tiempo duerme ysi padece migra\u00f1a . Se ha hecho una extensi\u00f3n de las caracter\u00edsticas y se ha ampliado la lista a: si pade- cereflujo estomacal , alguna enfermedad cardiovascular , si toma anticonceptivos , con qu\u00e9 frecuencia usa productos cosm\u00e9ticos , cu\u00e1nto tiempo hace que se vacun\u00f3 contra la gripe , si ha padecido alguna enfermedad de ri\u00f1\u00f3n , deh\u00edgado , depulm\u00f3n , frecuencia en la in- gesta huevos ,queso ,multivitaminas ,probi\u00f3ticos ,bocadillos salados ,az\u00facar ,vitamina b,vitamina d y si se est\u00e1 embarazada . 2.2.2. Extracci\u00f3n y ltrado de los datos El objetivo principal de este apartado es el de ltrar y preparar toda la informaci\u00f3n suministrada para poder realizar el estudio. \u00c9sta incluye datos sobre la taxonom\u00eda de una poblaci\u00f3n e informaci\u00f3n relevante sobre cada uno de los individuos, constituida por un conjunto de metadatos con caracter\u00edsticas sobre cada uno. El primer criterio de ltrado es taxon\u00f3mico y \u00e9ste se basa en la exclusi\u00f3n de aquellos pacientes que dispongan del g\u00e9nero Pseudomonas superior al 3 % y/o un porcentaje del g\u00e9nero (unkn.) Enterobacteiaceae(f) tambi\u00e9n superior al 3 %. Este ltrado reduce la lista de pacientes, aproximadamente, a la mitad. Cada paciente dispone de un identicador \u00fanico que se relaciona con un chero de metadatos. A partir del contenido de ciertos campos inclu\u00eddos en estos cheros, se rea- liza el segundo ltrado. Aquellos pacientes que cumplan los siguientes requisitos, ser\u00e1n aquellos que formar\u00e1n parte del juego de datos para el ajuste del modelo.2.2. AN\u00c1LISIS DE LOS DATOS 15 A continuaci\u00f3n se enumeran: Tener el \u00edndice de masa corporal BMI comprendido entre los valores [18, 30] . No haber padecido alguna enfermedad inflamatoria intestinal IBD. No tener diabetes . No tener antecedentes de haber tomado antibi\u00f3ticos en los \u00faltimos seis meses . Despu\u00e9s de realizar este ltrado, el n\u00famero de pacientes se reduce a unos 2.500, aproximadamente. Por \u00faltimo, se ha realizado otro ltrado pensando en la optimizaci\u00f3n de los c\u00e1lculos, basado en la eliminaci\u00f3n de aquellas unidades taxon\u00f3micas sin relevancia, debido a la falta de resultados o incluso por carecer de ellos. Por lo tanto, ya que no van a realizar ninguna aportaci\u00f3n al estudio y adem\u00e1s van a incrementar el consumo de los recursos del sistema, se proceder\u00e1 a eliminar todas aquellas sin resultados. 2.2.3. Estad\u00edstica descriptiva Multivariante vs Univariante En un primer momento, sin conocer las distribuci\u00f3n de las variables de salida o depen- dientes, que son todas las enfermedades mentales que est\u00e1n englobadas en el conjunto de los datos, parec\u00eda factible utilizar las herramientas y m\u00e9todos del an\u00e1lisis multivariante. El problema reside en que hay pacientes que maniestan m\u00e1s de un trastorno al mismo tiempo. Anorexia Bipolar Bulimia Depression Ptsd Schizophrenia 2657 17 27 28 305 41 10 15 Cuadro 2.1: Distribuci\u00f3n de las enfermedades mentales dentro del juego de datos En la tabla anterior, se muestra la relaci\u00f3n entre padecer una enfermedad y de qu\u00e9 tipo o no padecerla.16 CAP\u00cdTULO 2. METODOLOG\u00cdA Adem\u00e1s, despu\u00e9s de someter los datos a los distintos ltrados estad\u00edsticos, la canti- dad de pacientes con m\u00faltiples enfermedades mentales no ha sido sucientemente sig- nicativa en cada uno de estos casos, lo que dicultar\u00eda en gran medida el ajuste del modelo. [2] Healthy One Two Three Four Five Counter 2334 258 65 7 6 2 Cuadro 2.2: Relaci\u00f3n de m\u00faltiples enfermedades mentales en pacientes En la tabla anterior, se puede observar que hay 2334 pacientes sin ning\u00fan tipo de trastorno, 258que maniestan un \u00fanico trastorno, 65pacientes que maniestan dos tras- tornos al mismo tiempo, 7pacientes que maniestan tres trastornos a la vez, 6pacientes que maniestan cuatro trastornos, y por \u00faltimo, 2pacientes que maniestan cinco trastor- nos de los siete analizados. De realizar un an\u00e1lisis multivariante, adem\u00e1s de tener en cuenta los 7 tipos de en- fermedades mentales, el sistema tambi\u00e9n deber\u00eda valorar las distintas combinaciones posibles entre ellas. Esto sumado al bajo \u00edndice de pacientes que podr\u00edan presentar es- ta casu\u00edstica, har\u00eda muy dif\u00edcil encontrar patrones signicativos y el sistema tendr\u00eda una sensibilidad muy baja o casi nula. Por ese motivo, se ha optado por el an\u00e1lisis univariante con una \u00fanica variable co- mo respuesta, siendo cada una de las siete enfermedades mentales existentes en los metadatos. Distribuci\u00f3n de los datos Toda la informaci\u00f3n contenida en el juego de datos, despu\u00e9s de aplicar los diferen- tes ltrados, se puede dividir en tres grupos: datos taxon\u00f3micos, caracter\u00edsticas de los pacientes y enfermedades mentales. Los datos taxon\u00f3micos se encuentran en forma de matriz donde las las son los identicadores de los pacientes y las columnas cada una de los OTUs con sus corres- pondientes valores.2.2. AN\u00c1LISIS DE LOS DATOS 17 Figura 2.1: Representaci\u00f3n de la matriz taxon\u00f3mica En primer lugar, se calcula la variabilidad entre las variables que hacen referencia a la taxonom\u00eda y se concluye que existe una alta variabilidad entre la primera, que es Bac- teroides con 287;6967 y la \u00faltima variable, que es Ammoniibacillus con 3;628886 e\u000011. Por lo tanto, se requiere normalizar los datos para mitigar esta gran diferencia. Como apunte, indicar que en algunos an\u00e1lisis ha sido demostrado que el suministro de pectina o inuli- na de manzana da como resultado el enriquecimiento altamente espec\u00edco de unidades taxon\u00f3micas operativas del g\u00e9nero Bacteroides . [15] Se comprueba cu\u00e1les son las bacterias con mayor valor de media con los datos sin normalizar. Figura 2.2: Boxplot OTUs sin normalizar con normalizar con m\u00e1s apariciones18 CAP\u00cdTULO 2. METODOLOG\u00cdA Se comprueba cu\u00e1les son las bacterias con mayor valor de media con los datos des- pu\u00e9s de la normalizaci\u00f3n. Figura 2.3: Boxplot normalizados con m\u00e1s apariciones Ya que estos datos son cuantitativos pueden ser normalizados para poder unicar el rango de todos los valores. Antes de la normalizaci\u00f3n, por ejemplo, Bacteroides ten\u00eda una varianza de 25;379y despu\u00e9s de 0;3064 oFaecalibacterium con una varianza de 8;6089 antes de la normalizaci\u00f3n y con un valor de 0;1585 despu\u00e9s de \u00e9sta. Las medidas de dispersi\u00f3n se utilizan para medir la variabilidad de una variable res- puesta dentro de una muestra o poblaci\u00f3n. La dispersi\u00f3n promedio que presenta cada dato es evaluado respecto a su valor medio. [18] Mediante el test de Shapiro-Wilk se puso a prueba si los datos estaban basados en una distribuci\u00f3n normal. El valor de las probabilidades fue menor al 5 %, por lo que se concluye que los datos no siguen una distribuci\u00f3n normal. Posteriormente, se realiza un an\u00e1lisis de los componentes principales de los datos taxon\u00f3micos normalizados, concluyendo que las primeras 608variables explican el 80 % de los datos, lo que antes explicaban 2117 variables. Para estimar el n\u00famero K \u00f3ptimo de clusters se puede aplicar el algoritmo de K-means para un rango de valores de K e identicar aquel valor a partir del cual la reducci\u00f3n en la suma total de varianza intra- cluster deja de ser sustancial. Se utiliza la Distancia de Manhattan para denir la distancia entre objetos.2.2. AN\u00c1LISIS DE LOS DATOS 19 Figura 2.4: Representaci\u00f3n gr\u00e1ca del n\u00famero \u00f3ptimo de clusters Como se puede observar en la gura 2.4, parece que el codo se da con 3 componen- tes o, como m\u00e1ximo, con 4. De todas maneras, la representaci\u00f3n PCoA se realizar\u00e1 con 3 componentes, como se muestra a continuaci\u00f3n. Figura 2.5: Representaci\u00f3n gr\u00e1ca PCoA de la poblaci\u00f3n taxon\u00f3mica taxones Pseudomonas y(unkn.) Enterobacteiaceae(f) aplicados20 CAP\u00cdTULO 2. METODOLOG\u00cdA El procedimiento de agrupaci\u00f3n ha sido aleatorio y las etiquetas corresponden a los enterotipos Bacteroides (enterotipo tipo 1) ,Prevotella (enterotipo tipo 2) yRuminococcus (enterotipo tipo 3) [17]. Los datos que hacen referencia a las caracter\u00edsticas de los pacientes, se encuentran en forma de matriz d\u00f3nde las las son los identicadores de los pacientes y las columnas cada una de estas caracter\u00edsticas. Figura 2.6: Representaci\u00f3n de la matriz de caracter\u00edsticas Los datos que hacen referencia a las enfermedades mentales de los pacientes, se encuentran en forma de matriz d\u00f3nde las las son los identicadores de los pacientes y las columnas cada de los trastornos mentales analizados en este estudio. Figura 2.7: Representaci\u00f3n de la matriz de enfermedades mentales.2.2. AN\u00c1LISIS DE LOS DATOS 21 Como se puede observar en la siguiente gura, la distribuci\u00f3n de las enfermedades mentales no es equitativa entre todas ellas. Figura 2.8: Distribuci\u00f3n de las distintas enfermedades mentales22 CAP\u00cdTULO 2. METODOLOG\u00cdA 2.3. Evaluaci\u00f3n de los algoritmos de clasicaci\u00f3n 2.3.1. Planteamiento Una vez nalizada la fase de an\u00e1lisis de los datos, queda determinar qu\u00e9 algoritmo o algoritmos ser\u00e1n utilizados en el proceso de clasicaci\u00f3n dentro de la aplicaci\u00f3n. Los candidatos son Boost Decision Trees ,Support Vector Machine yRandom Forest . El cri- terio para decidir cu\u00e1les ser\u00e1n inclu\u00eddos en la aplicaci\u00f3n nal, depender\u00e1 en gran medida de c\u00f3mo estos algoritmos son capaces de adaptarse a las necesidades de los datos. Recordemos que no todas las enfermedades mentales est\u00e1n distribuidas por igual den- tro del juego de datos, lo que puede afectar muy signicativamente en la eciencia y el rendimiento de los clasicadores. 2.3.2. Re-sampling Antes de entrar en materia con el funcionamiento y los resultados obtenidos de cada uno de los algoritmos, es importante explicar en qu\u00e9 consiste este apartado. Para realizar un correcto entrenamiento, es necesario que los datos dispongan de un buen balanceo o equilibrio entre la clase positiva, que es la que hace referencia a la existencia de la enfermedad mental, y la clase negativa que indicar\u00e1 que no se tiene tal enfermedad mental. Se sabe que existe una gran descompensaci\u00f3n entre estas dos clases. Para poner en pr\u00e1ctica el Re-sampling , existen algunas t\u00e9cnicas que han sido puestas en marcha, como son Under sampling yOver sampling [10]. Con el n de mitigar este hecho, se han aplicado ambas t\u00e9cnicas. Under sampling En este caso, se selecciona solo algunos de los datos de la clase mayoritaria, man- teniendo la distribuci\u00f3n de probabilidad de la clase. Por lo tanto, se realiza un sesgado para igualar, en funci\u00f3n de un porcentaje, los resultados positivos con los negativos. Cabe indicar que este tipo de balanceo tiene ventajas, como la ayuda al algoritmo de clasicaci\u00f3n a distinguir mejor la clase minoritaria de la clase mayoritaria eliminando las2.3. EVALUACI\u00d3N DE LOS ALGORITMOS DE CLASIFICACI\u00d3N 23 observaciones ruidosas. Pero tambi\u00e9n tiene desventajas en la eciencia, ya que aquellos datos eliminados podr\u00edan tener informaci\u00f3n relevante sobre la clase mayoritaria. Over sampling Se trata de crear copias de la clase minoritaria para tener la misma cantidad de ejem- plos que la clase mayoritaria, manteniendo la distribuci\u00f3n de la clase minoritaria. Por lo tanto, se duplican, en funci\u00f3n de un porcentaje, los resultados negativos con los positivos. Del mismo modo que en el caso anterior, este tipo de balanceo tambien tiene ventajas, como la reducci\u00f3n del sesgo introducido por el desequilibrio de clase. Pero tambi\u00e9n tiene la desventaja de haber un riesgo de tener \u00fanicamente un solo ejemplo minoritario para la observaci\u00f3n perteneciente a la clase minoritaria con una baja distribuci\u00f3n. Figura 2.9: Representaci\u00f3n gr\u00e1ca son modelos de predicci\u00f3n que sirven para representar y categorizar una serie de condiciones que ocurren de forma sucesiva para la resoluci\u00f3n de un problema. Estos algoritmos aportan una visi\u00f3n gr\u00e1ca de la toma de decisi\u00f3n, especican las variables que son evaluadas, qu\u00e9 acciones deben ser tomadas y el orden en la que la toma de decisiones ser\u00e1 efectiva.24 CAP\u00cdTULO 2. METODOLOG\u00cdA Cada vez que se ejecuta un \u00e1rbol de decisi\u00f3n, solo un camino ser\u00e1 seguido depen- diendo del valor actual de la variable evaluada. Figura 2.10: El \u00e1rbol de clasicaci\u00f3n lo compone una serie de nodos internos y externos, as\u00ed como arcos que los unen A los nodos externos se les conoce como hojas del \u00e1rbol y se marcan con una clase o una distribuci\u00f3n de probabilidad sobre las clases. Aunque los resultados que se obtienen dependen de la calidad de los ejemplos introducidos, sin lugar a dudas, este mecanismo de descubrimiento de patrones se ha convertido, en los \u00faltimos a\u00f1os, en una de las fuentes m\u00e1s ables de predicci\u00f3n y su uso se ha extendido velozmente. [1] Para evitar el overtting, debido a que este tipo de \u00e1rboles tienden a reducir r\u00e1pida- mente el error de entrenamiento ajust\u00e1ndose bien a las observaciones utilizadas para la fase de entrenamiento, es importante controlar bien el tama\u00f1o del \u00e1rbol. Para el proceso de entrenamiento del modelo se ha limitado a 50iteraciones.2.3. EVALUACI\u00d3N DE LOS ALGORITMOS DE CLASIFICACI\u00d3N 25 En la siguiente tabla se enumeran las fortalezas y debilidades generales de los mo- delos basados en este algoritmo. Fortalezas Debilidades Clasicador de uso m\u00faltiple con buenos re- sultados en la mayor\u00eda de los problemas.Frecuentemente son sesgados hacia las di- visiones, si tienen una gran cantidad de ni- veles. Proceso de aprendizaje altamente autom\u00e1- tico que puede permitir valores num\u00e9ricos o nominales, como valores faltantes.Es f\u00e1cil que se produzca overtting oun- dertting . Excluye caracter\u00edsticas sin importancia.Puede tener problemas al modelar algunas relaciones debido a la conanza en las di- visiones del eje-paralelo. Se puede utilizar tanto en peque\u00f1os como en grandes conjuntos de datos.Peque\u00f1os cambios en los datos del en- trenamiento, pueden resultar ser grandes cambios en la toma de decisiones. La interpretaci\u00f3n de los datos no requie- rede experiencia matem\u00e1tica por parte del usuario.Grandes \u00e1rboles pueden dicultar la inter- pretaci\u00f3n y la toma de decisi\u00f3n. M\u00e1s eciente que otros modelos comple- jos. Cuadro 2.5: Fortalezas y del algoritmo Boost Decision Tree 2.3.4. Boost Decision Trees Resultados A continuaci\u00f3n, se muestran los diferentes resultados obtenidos durante el proceso de validaci\u00f3n de este algoritmo, con los distintos tipos de t\u00e9cnicas de balanceo de los datos. Las enfermedades mentales mostradas en estos resultados son la Depression y laSchizophrenia , ya que la primera es, de las siete, la que m\u00e1s resultados positivos tiene y la segunda es la que menos casos positivos tiene. De esta manera se muestra la importancia de tener los datos balancelados.26 CAP\u00cdTULO 2. METODOLOG\u00cdA No sampling Figura 2.11: No sampling Depression Figura 2.12: No sampling Schizophrenia Tanto en la gura 2.11 como en la gura 2.12 se observan las dicultades que ha tenido el clasicador para ajustar el modelo. En el caso de la Depression ha detectado muchos falsos positivos o \u00abError de tipo I \u00bby el valor del coeciente kappa tiende a cero, lo que implica un sesgo muy grande y por lo tanto, se puede decir que estos resultados son fruto del \"azar\" m\u00e1s que de una buena clasicaci\u00f3n. En el caso de la Schizophrenia los resultados fueron peores, ya que fue incapaz de detectar un resultado positivo y el valor de kappa es cero. Under sampling Figura 2.13: Under sampling Depression Figura 2.14: Under sampling Schizophrenia Al aplicar Under sampling, los resultados han sido mucho mejores que en el caso anterior, pero sin llegar a ser satisfactorios. En el caso de la Depression , adem\u00e1s de los2.3. EVALUACI\u00d3N DE LOS ALGORITMOS DE CLASIFICACI\u00d3N 27 falsos positivos de antes, tambi\u00e9n han aparecido falsos negativos o \u00abError de tipo II \u00bby el valor del coeciente kappa apenas ha mejorado signicativamente. Sin embargo, donde si ha habido una mejora sustancial, ha sido en el caso de la Schizophrenia donde el \u00abError de tipo I \u00bbse mantiene, pero ha sido capaz de detectar un solo caso positivo. Aqu\u00ed el valor de kappa ha mejorado, pero todav\u00eda con resultados que aportan poca seguridad de que \u00e9stos no sean fruto del \"azar\". Over sampling Figura 2.15: Over sampling Depression Figura 2.16: Over sampling Schizophrenia Al aplicar Over sampling , los resultados han mejorado lo suciente como para tener- los en cuenta. Los valores de kappa en ambos casos toman m\u00e1s relevancia y a pesar de que cuando se tienen pocos resultados positivos en los datos, como ocurre con la Schizophrenia , los resultados son m\u00e1s equilibrados aunque sin ser del todo satisfactorio. En el caso de la Depression , son algo mejores, tambi\u00e9n a consecuencia de que existen m\u00e1s positivos en el juego de datos, aunque el \u00abError de tipo I \u00bbsigue siendo bastante elevado. La valoraci\u00f3n sobre este algoritmo de clasicaci\u00f3n no es muy positiva, porque incluso despu\u00e9s de balancear los datos de diferentes maneras, el modelo no ha sido ajustado co- rrectamente y deja muchas lagunas en la veracidad de los resultados. De todas maneras, no ha quedado descartado y se incluye en la aplicaci\u00f3n de software.28 CAP\u00cdTULO 2. METODOLOG\u00cdA 2.3.5. Support Vector Machine Support Vector Machines son un conjunto de algoritmos de aprendizaje supervisado relacionados con problemas de clasicaci\u00f3n y regresi\u00f3n. Se pueden adaptar a casi cual- quier tipo de tarea de aprendizaje, incluido la predicci\u00f3n num\u00e9rica. La clave del \u00e9xito del algoritmo tiene que ver con el reconocimiento de patrones. Figura 2.17: Representaci\u00f3n gr\u00e1ca de las funciones kernel lineal y polinomial Sobresale en aplicaciones como: Clasicaci\u00f3n de datos de expresi\u00f3n g\u00e9nica de microarrays, en el campo de Bioin- form\u00e1tica, para identicar c\u00e1ncer u otras enfermedades gen\u00e9ticas. Categorizaci\u00f3n de textos, para identicar idiomas utilizados en un documento o la clasicaci\u00f3n de documentos por materias. Detecci\u00f3n de eventos raros, pero importantes, como los fallos de motor de combus- ti\u00f3n, violaciones de seguridad o terremotos.2.3. EVALUACI\u00d3N DE LOS ALGORITMOS DE CLASIFICACI\u00d3N 29 En la siguiente tabla se enumeran las fortalezas y debilidades generales de los mo- delos basados en este algoritmo. Fortalezas Debilidades Puede ser utilizado para la clasicaci\u00f3n o para problemas de predicci\u00f3n num\u00e9rica.Encontrar un buen modelo requiere probar varias combinaciones de kernel y par\u00e1me- tros del modelo. No est\u00e1 demasiado influenciado por datos con ruido yno es propenso a la sobreali- mentaci\u00f3n.Puede ser lento para la fase deentrena- miento, particularmente si elconjunto de datos de entrada tiene un gran n\u00famero de caracter\u00edsticas. Puede ser m\u00e1s f\u00e1cil de usar que la Red Neuronal debido al respaldo de los algo- ritmos SVM .Los resultados se obtienen de una comple- ja caja negra casi imposible de interpretar. Gana popularidad debido a su alta preci- si\u00f3n y a lasvictorias obtenidas en competi- ciones de Data Mining . Cuadro 2.6: Fortalezas y debilidades del algoritmo Support Vector Machine Este algoritmo permite utilizar diferente funciones kernel para el an\u00e1lisis de patrones. La tarea general del an\u00e1lisis de patrones es encontrar y estudiar tipos generales de rela- ciones entre grupos y/o clasicaciones en el conjuntos de datos. Las funciones utilizadas han sido: * Funci\u00f3n kernel lineal es la m\u00e1s simple de las funciones ya que se basa, principal- mente, en la separaci\u00f3n de una linea recta o un hiperplano de dimensi\u00f3n N. * Funci\u00f3n kernel polinomial es equivalente a una regresi\u00f3n polin\u00f3mica. Es mucho m\u00e1s preciso que el kernel lineal y sobre todo es resistente al overtting, a pesar de que penaliza con el elevado coste computacional. [16]30 CAP\u00cdTULO 2. METODOLOG\u00cdA 2.3.6. Support Vector Machine Resultados A continuaci\u00f3n se muestras los resultados obtenidos, para las enfermedades menta- lesDepression ySchizophrenia , por cada uno de los clasicadores, utilizando t\u00e9cnicas deRe-sampling y sin utilizarlas. No sampling Figura 2.18: No sampling Depression kernel lineal Figura 2.19: No sampling Schizophrenia kernel lineal Figura 2.20: No sampling Depression kernel polinomial Figura 2.21: No sampling Schizophrenia kernel polinomial En comparaci\u00f3n con el algoritmo BDT, SVM con la funci\u00f3n lineal mejora sustancial- mente los resultados a pesar de no haber aplicado Re-sampling . Como se observa en la gura 2.18, teniendo en cuenta un valor kappa bastante bajo, 0;1458 se observa una2.3. EVALUACI\u00d3N DE LOS ALGORITMOS DE CLASIFICACI\u00d3N 31 buena predisposici\u00f3n a detectar positivos, aunque si que hay que decir que la tasa de \u00abError de tipo I y II \u00bbtambi\u00e9n es elevada. Pero por el contrario, en la gura 2.19, la mejora es signicativa llegando a obtener un valor kappa de0;4989 y una tasa de \u00abError de tipo I y II \u00bbmuy baja. Under sampling Figura 2.22: Under sampling Depression kernel lineal. Figura 2.23: Under sampling Schizophrenia kernel lineal Figura 2.24: Under sampling Depression kernel polinomial Figura 2.25: Under sampling Schizophrenia kernel polinomial La aplicaci\u00f3n del Under sampling ha empeorado los resultados en ambos casos, sim- plemente, porque el problema est\u00e1 en el escaso n\u00famero de positivos. A pesar de ello, Aplicando Under sampling tampoco se puede decir que los resultados obtenidos ha- yan mejorado. Los valores para kappa siguen siendo no signicativos y para la Depres-32 CAP\u00cdTULO 2. METODOLOG\u00cdA sion ha aumentado los \u00abErrores de tipo I y II\u00bbcomo los aciertos. Asi pues, este ajuste tampoco se puede tomar en cuenta. Over sampling Figura 2.26: Over sampling Depression ker- nel lineal. Figura 2.27: Over sampling Schizophrenia kernel lineal. Figura 2.28: Over sampling Depression ker- nel polinomial Figura 2.29: Over sampling Schizophrenia kernel polinomial De nuevo, se observa una mejora signicativa en los resultados, sobre todo para la Schizophrenia , obteniedo un valor de kappa de0;832con una precisi\u00f3n del %y de 0;7257 y una precisi\u00f3n del 99;6 %para las funciones lineal y polinomial respectivamente. M\u00e1s dicultades ha tenido con la Depression con un valor de kappa de0;447y una preci- si\u00f3n del 83;8 %para las funciones lineal y polinomial respectivamente. Se concluye que ambas funciones son v\u00e1lidas para el ajuste del modelo y ser\u00e1n inclu\u00eddas en la aplicaci\u00f3n de software.2.3.7. Random Forest El m\u00e9todo Random Forest est\u00e1 basado, principalmente, en los \u00c1rboles de Decisi\u00f3n . Se crea un gran n\u00famero de \u00e1rboles mediante el muestreo de individuos y variables en el conjunto de datos. Una diferencia clave con los \u00c1rboles de Decisi\u00f3n es que cada nodo est\u00e1 dividido por el mejor de un subconjunto aleatorio de variables, en lugar de la mejor de todas las variables. Cada individuo est\u00e1 clasicado por cada \u00e1rbol y el resultado m\u00e1s com\u00fan se utiliza como la clasicaci\u00f3n nal. Adem\u00e1s se puede utilizar para realizar tareas de clasicaci\u00f3n y de regresi\u00f3n. En muchos problemas el rendimiento del algoritmo Ran- dom Forest es muy similar a la del boosting , anteriormente probado, y es m\u00e1s simple de entrenar y ajustar. Esta caracter\u00edstica lo convierte en popular y ampliamente utilizado. Figura 2.30: Representaci\u00f3n gr\u00e1ca del algoritmo Random Forest La idea esencial es promediar muchos modelos ruidosos pero aproximadamente im- parciales, y por tanto reducir la variaci\u00f3n. Los \u00e1rboles son los candidatos ideales, dado que ellos pueden registrar estructuras de interacci\u00f3n compleja en los datos, y si crecen con la suciente profundidad, tienen relativamente baja parcialidad. [9]34 CAP\u00cdTULO 2. METODOLOG\u00cdA En la siguiente tabla se enumeran las fortalezas y debilidades generales de los mo- delos basados en este algoritmo. Fortalezas Debilidades Un modelo multiprop\u00f3sito que realiza bien la mayor\u00eda de los problemas.A diferencia del \u00c1rbol de Decisi\u00f3n , el mo- delo no es f\u00e1cil de interpretar. Puede manejar datos ruidosos o faltan- tes as\u00ed como variables categ\u00f3ricas o con- t\u00ednuas.Es posible que se necesite alg\u00fan trabajo extra para sintonizar el modelo con los da- tos. Selecciona s\u00f3lo las caracter\u00edsticas m\u00e1s im- portantes. Se puede utilizar en datos con un gran n\u00fa- mero de caracter\u00edsticas o ejemplos. Cuadro 2.7: Fortalezas y debilidades del algoritmo Random Forest 2.3.8. Random Forest Resultados A continuaci\u00f3n se muestras los resultados obtenidos, para las enfermedades menta- lesDepression ySchizophrenia , por cada uno de los clasicadores, utilizando t\u00e9cnicas deRe-sampling y sin utilizarlas. No sampling Figura 2.31: No sampling Depression. Figura 2.32: No sampling Schizophrenia.2.3. EVALUACI\u00d3N DE LOS ALGORITMOS DE CLASIFICACI\u00d3N 35 Como era de esperar y tal como ha ocurrido con BDT, los resultados sin realizar Re- sampling han sido muy malos. Los valores para kappa para ambas enfermedades son pr\u00e1cticamente 0y el \u00abError de tipo I \u00bbse ha disparado. Por lo tanto, este ajuste carece de importancia. Under sampling Figura 2.33: Under sampling Depression. Figura 2.34: Under sampling Schizophre- nia. Aplicando Under sampling tampoco se puede decir que los resultados obtenidos ha- yan mejorado. Los valores para kappa siguen siendo no signicativos y para la Depres- sion ha aumentado los \u00abErrores de tipo I y II\u00bbcomo los aciertos. Asi pues, este ajuste tampoco se puede tomar en cuenta.36 CAP\u00cdTULO 2. METODOLOG\u00cdA Over sampling Figura 2.35: Over sampling Depression. Figura 2.36: Over sampling Schizophrenia. Al aplicar el balanceo de los datos basado en Over sampling se nota una considerable mejor\u00eda en los resultados. Los valores de kappa son signitcativos, siendo de 0;7699 para laDepression y de 0;613para la Schizophrenia . A pesar de que el \u00abError de tipo I \u00bbse sigue manteniendo, los resultados positivos doblan a \u00e9stos en el primer caso y los iguala en el segundo. Por este motivo, se tendr\u00e1 en cuenta esta conguraci\u00f3n para el ajuste del modelo.2.4. SOFTWARE 37 2.4. Software Adem\u00e1s del estudio sobre la relaci\u00f3n entre el microbioma intestinal y ciertas enfer- medades mentales, documentado en apartados anteriores, se ha querido ir m\u00e1s all\u00e1 desarrollando una herramienta que permita al especialista obtener predicciones sobre pacientes, y adem\u00e1s realizar la investigaci\u00f3n sobre qu\u00e9 microorganismos tienen m\u00e1s re- levancia cuando se detecta una enfermedad mental. Esta herramienta permite a usuarios con poco conocimiento de an\u00e1lisis estad\u00edstico y programaci\u00f3n, el poder realizar predic- ciones e investigaciones sobre este tema. 2.4.1. Tecnolog\u00edas Para desarrollar la aplicaci\u00f3n de predicci\u00f3n de enfermedades mentales, llamada MI- Predictor , se ha necesitado la combinaci\u00f3n de dos tecnolog\u00edas. En primer lugar R, con un enfoque m\u00e1s matem\u00e1tico, responsable de todos los c\u00e1lcu- los num\u00e9ricos y capaz de manejar grandes cantidades de datos, orientado al an\u00e1lisis estad\u00edstico, que es utilizado ampliamente en el \u00e1mbito de la ciencia de datos . [19] Y en segundo lugar y no por ellos menos importante, Python que en este caso por su versatilidad, ha servido como contenedor de todas las funciones de R y para que el usuario nal pueda interact\u00faar con la aplicaci\u00f3n [20]. Se requiere la librer\u00eda RPY2 para poder comunicar una tecnolog\u00eda con otra. [21] Pensando en el futuro y en la mejora de la aplicaci\u00f3n, ambas tecnolog\u00edas son de c\u00f3di- go abierto[8] y disponen de amplias comunidades de desarrolladores que las mantienen en constante evoluci\u00f3n.38 CAP\u00cdTULO 2. METODOLOG\u00cdA 2.4.2. Interfaz gr\u00e1ca de usuario Para facilitar al usuario el manejo de la aplicaci\u00f3n, cada una de las funcionalidades han sido separadas por pesta\u00f1as o tabs y cada una de \u00e9stas tiene una nalidad espec\u00ed- ca que se explica a continuaci\u00f3n. Figura 2.37: Tabs de cada una de las partes de la aplicaci\u00f3n Taxonomy La pantalla Taxonomy se divide en dos apartados. Figura 2.38: Tab par la carga y ltrado de la taxonom\u00eda En el apartado Add taxonomy lter list se permite introducir una lista de duplas que deber\u00e1n estar formadas por un nombre de tax\u00f3n y un porcentaje, que ser\u00e1 el que se tendr\u00e1 en cuenta para el ltraje. Esta entrada permite introducir tantos elementos como sea necesario para el ltrado. Por defecto, est\u00e1n inclu\u00eddos aquellos requeridos para este proyecto, pero como se ha comentado anteriormente, permite introducir muchos m\u00e1s.2.4. SOFTWARE 39 En el apartado Select a taxonomy le to t a model se debe seleccionar un chero que contenga la taxonom\u00eda de una poblaci\u00f3n, que servir\u00e1 para el entrenamiento de los datos Una vez seleccionado el ltro y el chero de taxonom\u00eda se deber\u00e1 pulsar el bot\u00f3n Apply para comenzar el proceso de ltrado. Metadata La pantalla Metadata se divide en dos apartados. Figura 2.39: Tab para la carga y ltrado de los metadatos En el apartado Filtering by taxonomy se permite congurar un segundo ltro basado en ciertas caracter\u00edsticas del paciente. Se puede seleccionar el rango de Body mass in- dexBMI, donde se debe indicar el valor m\u00ednimo y el m\u00e1ximo. El resto de conguraciones40 CAP\u00cdTULO 2. METODOLOG\u00cdA est\u00e1n deshabilitadas y por defecto est\u00e1n aquellos valores requeridos para el proyecto. En el apartado Filtering by patients characteristics aparecen otras caracter\u00edsticas de los pacientes que se tendr\u00e1n en cuenta para ajustar y entrenar el modelo. En es- te caso aparece deshabilitada la opci\u00f3n de marcarlas o no, y por defecto est\u00e1n todas seleccionadas. Una vez elegidos los ltros, se deber\u00e1 pulsar el bot\u00f3n Apply para comenzar el proceso de ltrado. Classiers La pantalla Classiers se divide en tres apartados. Figura 2.40: Tab para congurar los clasicadores En el apartado Machine learning algorithms se puede seleccionar qu\u00e9 algoritmos se van a utilizar en el entrenamiento de los datos. Como m\u00ednimo se ha de seleccionar uno2.4. SOFTWARE 41 de ellos. Todos los algoritmos seleccionados realizar\u00e1n un entrenamiento de los datos y posteriormente se determinar\u00e1 cu\u00e1l de ellos es el que tiene mejor rendimiento. En el apartado Select Mental illness to evaluate results se permite seleccionar qu\u00e9 enfermedades mentales van a ser analizadas. Por defecto est\u00e1n todas seleccionadas. En el apartado Sampling option selection se permite realizar ciertas transforma- ciones en los datos, antes de pasar por los algoritmos de clasicaci\u00f3n. La opci\u00f3n No sampling no realiza ninguna transformaci\u00f3n. La opci\u00f3n Under sampling permite eliminar un n\u00famero de resultados negativos, en funci\u00f3n de un porcentaje que tambi\u00e9n es ajus- table. Por \u00faltimo, La opci\u00f3n Over sampling permite duplicar un n\u00famero de resultados positivos, en funci\u00f3n de un porcentaje que tambi\u00e9n es ajustable. Es importante indicar que solo puede haber una de estas tres opciones seleccionada. Training La pantalla Training se divide en dos apartados, y permite observar visualmente el resultado de los entrenamientos de cada uno de los algoritmos seleccionados para cada una de las enfermedades mentales, que est\u00e1n separadas por tabs. En el primer apartado se muestran los resultados de cada uno de los algoritmos ele- gidos en el paso anterior. Se puede ver la tabla de contingencia y otros resultados como: F-F el sistema determin\u00f3 falso cuando era falso. F-T el sistema determin\u00f3 falso cuando era cierto. T-F el sistema determin\u00f3 cierto cuando era falso. T-T el sistema determin\u00f3 cierto cuando era cierto. Accuracy es el porcentaje de clasicaciones correctas de todas las instancias. CI (intervalos de conanza) es un posible rango de valores o intervalo (a; b), en el que, con una determinada probabilidad, sus l\u00edmites contendr\u00e1n el valor del par\u00e1me- tro poblacional que se est\u00e1 buscando.42 CAP\u00cdTULO 2. METODOLOG\u00cdA Figura 2.41: Tab para el entrenamiento del modelo p_value corresponde al nivel de signicaci\u00f3n m\u00e1s peque\u00f1o posible que puede es- cogerse, para el cual todav\u00eda se aceptar\u00eda la hip\u00f3tesis alternativa con las observa- ciones actuales. Cualquier nivel de signicaci\u00f3n escogido inferior a alpha = 0.05 comporta aceptar H0. kappa es similiar a la precisi\u00f3n de la clasicaci\u00f3n, excepto porque se normaliza al inicio del azar en su conjunto de datos. Sensitivity tambi\u00e9n se conoce como Tasa de Verdaderos Positivos. Es la proporci\u00f3n de casos positivos que fueron correctamente identicados por el algoritmo. Specicity es la Tasa de Verdaderos Negativos. Se trata de los casos negativos que el algoritmo ha clasicado correctamente.2.4. SOFTWARE 43 En el apartado Chart results se pueden visualizar los resultados de manera gr\u00e1ca. Este apartado est\u00e1 divido a su vez en seis partes, una para cada tipo de resultado. Indicar que, cuando un algoritmo no ha sido seleccionado para realizar el entrena- miento, la la aparece con un color m\u00e1s oscuro que la la de los algoritmos seleccionados para tal cometido. Patients La pantalla Patients se divide en tres apartados y permite realizar todo el proceso de la predicci\u00f3n. Figura 2.42: Tab para congurar los pacientes a predecir En el apartado Select a taxonomy le to prediction se debe seleccionar un chero que contenga la taxonom\u00eda de una poblaci\u00f3n que servir\u00e1 para realizar la predicci\u00f3n. En el apartado Taxonomy list lters added se pueden observar la selecci\u00f3n del ltro taxon\u00f3mico tomada en la fase de entrenamiento con los taxones y sus respectivos porcentajes, pero \u00e9sta en este punto ya no es modicable. En el apartado State of processes se puede observar los tres pasos que componen la predicci\u00f3n. \u00c9stos son, el ltrado por taxonom\u00eda, el ltrado por metadatos y por \u00faltimo, la predicci\u00f3n en funci\u00f3n del modelo ajustado anteriormente.44 CAP\u00cdTULO 2. METODOLOG\u00cdA Cuando uno de estos pasos se inicia, se muestra un mensaje indicando loading . Una vez ha nalizado, el mensaje cambiar\u00e1 a done . De esta manera el usuario puede ir viendo el proceso de predicci\u00f3n. Tambi\u00e9n hay que hacer referencia a que en la parte inferior de la pantalla ir\u00e1n apareciendo mensajes indicando cu\u00e1l es el proceso actual que se est\u00e1 ejecutando. Predictions La pantalla Predictions se divide en tres apartados y permite visualizar los resultados de la predicci\u00f3n. Figura 2.43: Tab con los resultados de las predicciones2.4. SOFTWARE 45 En el apartado Results of predictions se muestran todos los resultados obtenidos sobre aquellos pacientes que han superado todos los ltros. Para cada paciente se mues- tra su identicador y si padece o no, con un cierto intervalo de conanza, cualquiera de las siete enfermedades mentales de las que se disponen datos. En el apartado Distribution of predictions se muestra el n\u00famero de pacientes que padecen una cierta enfermedad mental y con qu\u00e9 algoritmo se realiz\u00f3 dicha predicci\u00f3n. El algoritmo que realiza la predicci\u00f3n es el que mejores resultados obtuvo en la fase de entrenamiento y esta elecci\u00f3n se hace autom\u00e1ticamente. En el apartado Most signicant OTUs and characteristics in prediction by Mental illness se muestran aquellas unidades taxon\u00f3micas y/o caracter\u00edsticas m\u00e1s signicativas para determinar si un paciente padece cierta enfermedad mental. 2.4.3. Resultados En la gran mayor\u00eda de las pruebas que han sido realizadas, los resultados han sido \u00f3ptimos con intervalos de conanza en el acierto de la predicci\u00f3n muy elevados. Resultados en la predicci\u00f3n Figura 2.44: Resultados en la detecci\u00f3n de Anorexia nervosa, Bipolar disorder, Depres- sion y Post traumatic stress disorder se observa en la gura 2.44, el paciente ERR2032863 padece Anorexia ner- vosa con una certeza del 98\u0000100 % , adem\u00e1s Depression entre un 91\u000094 % yPost traumatic stress disorder entre un 98\u000099 del paciente ERR2032867 , pa- dece Bipolar disorder entre un 97\u000099 %.46 CAP\u00cdTULO 2. METODOLOG\u00cdA Figura 2.45: Resultados en la detecci\u00f3n de Anorexia nervosa, Depression y Post trauma- tic stress disorder. Otros resultados obtenidos se observan en la gura 2.45, donde el paciente ERR2306183 padece Anorexia nervosa con una certeza del 98\u000099 % yPost traumatic stress disorder con un pacientes ERR2306202 yERR2306211 padecen De- pression con una veracidad del 90\u000094 %. Figura 2.46: Resultados en la detecci\u00f3n de Depression y Schizophrenia En la gura 2.46, se observa como el paciente ERR2092109 padece Depression con un acierto entre el 91\u000094 % de las veces y Substance abuse con un intervalo de conanza en que ser\u00e1 cierto de entre el 99\u0000100 % de las veces. Figura 2.47: Resultados en la detecci\u00f3n de Bulimia nervosa, Depression y Schizophrenia2.4. SOFTWARE 47 En la gura 2.47, se observa como el paciente ERR2302863 padece Bulimia nervo- sacon un acierto entre el 99\u0000100 % de las veces, el paciente ERR2308945 padece Schizoprenia con una veracidad del 100 % y por \u00faltimo, el paciente ERR2308946 pade- ceDepression entre el 90\u000094 % y tambi\u00e9n padece Schizoprenia con una veracidad del 100 % . Distribuci\u00f3n de las predicciones Como se ha comentado en el apartado que trata sobre los algoritmos, aquellos que presenten mejores resultados a la hora de ajustar el modelo, ser\u00e1n los utilizados en la predicci\u00f3n de las enfermedades mentales. Figura 2.48: Distribuci\u00f3n de los resultados obtenidos Random Forest fue el que tuvo mejor ajuste para la detecci\u00f3n de las enfermedades mentales de Anorexia nervosa ,Bulimia nervosa ySubstance abuse , detectando a 8,12y 3pacientes con estos trastornos, respectivamente. Support Vector Machine Lineal fue el que tuvo mejor ajuste para la detecci\u00f3n de las enfermedades mentales de Bipolar disorder yPost traumatic stress disorder , respectivamente. Support Vector Machine Polynomial fue el que tuvo mejor ajuste para la detecci\u00f3n de la enfermedad mental Schizophrenia , detectando a 2pacientes con este trastorno. Boost Decision Tree fue el que tuvo mejor ajuste para la detecci\u00f3n de la enfermedad mental Depression , detectando a 208pacientes con este trastorno.48 CAP\u00cdTULO 2. METODOLOG\u00cdA Variables m\u00e1s signicativas en la predicci\u00f3n Este es el apartado m\u00e1s interesante, ya que muestra aquellas unidades traxon\u00f3micas operativas y aquellos h\u00e1bitos de los pacientes m\u00e1s signicativos a la hora de realizar la predicci\u00f3n. MeanDecreaseGini proporciona una medida de importancia que tiene en cuenta la contribuci\u00f3n que la variable hace a la precisi\u00f3n como el grado de clasicaci\u00f3n err\u00f3nea. EnAnorexia nervosa la variable m\u00e1s importante e influyente es OTU Bilophila . Figura 2.49: Variables m\u00e1s importantes en la de las variables m\u00e1s importantes en la predicci\u00f3n de la Anorexia nervosa EnBipolar disorder la variable m\u00e1s importante e influyente es OTU unkn..Chitinophagaceae.f. . Figura 2.50: Variables m\u00e1s importantes en la m\u00e1s im- portantes en la predicci\u00f3n de Bipolar disorder2.4. SOFTWARE 49 EnBulimia nervosa la variable m\u00e1s importante e influyente es OTU Lacihabitans . Figura 2.51: Variables m\u00e1s importantes en la de las variables m\u00e1s importantes en la predicci\u00f3n de Bulimia nervosa EnDepression la variable m\u00e1s importante e influyente es OTU Lachnoclostridium . Figura 2.52: Variables m\u00e1s importantes en m\u00e1s im- portantes en la predicci\u00f3n de la Depression50 CAP\u00cdTULO 2. METODOLOG\u00cdA EnPost traumatic stress disorder la variable importante e influyente es OTU Gabonibacter . Figura 2.53: Variables m\u00e1s importantes en la de las variables m\u00e1s importantes en la predicci\u00f3n de la Post trau- matic stress disorder EnSchizophrenia la variable m\u00e1s importante e influyente es OTU Myxococcus . Figura 2.54: Variables m\u00e1s importantes en de las variables m\u00e1s importantes en la predicci\u00f3n de la Schizophrenia2.4. SOFTWARE 51 EnSusbstance abuse la variable m\u00e1s importante e influyente es OTU Dokdonia . Figura 2.55: Variables m\u00e1s importantes impor- tantes en la predicci\u00f3n de Susbstance abuse52 CAP\u00cdTULO 2. METODOLOG\u00cdACap\u00edtulo 3 Conclusiones A medida que se ha ido profundizando m\u00e1s en el tema, han ido surgiendo nuevos retos y se han ido aplicando t\u00e9cnicas de an\u00e1lisis ya existentes, pero sobre todo, se han ido adaptando otras a las propias necesidades del estudio. Est\u00e1 claro, que no existe un patr\u00f3n universal donde se presente un problema y \u00e9ste quede resuelto sin necesidad de adaptarlo. El gran volumen de datos que se ha manejado en este proyecto y el bajo poder de c\u00f3mputo de las herramientas utilizadas, ha obligado a agudizar aun m\u00e1s el ingenio. Lo primero que hay que destacar es que todos los objetivos han sido cumplidos e incluso se ha querido ir m\u00e1s all\u00e1 y se han conseguido otros que no estaban previstos inicialmente, pero que a medida que ha ido evolucionando en el proyecto ha sido oportuno a\u00f1adir. Este trabajo se compone de dos partes bien diferenciadas. La primera, basada en el estudio y an\u00e1lisis de los datos suministrados y una segunda, centrada en el desarrollo de una aplicaci\u00f3n de software donde se pone en pr\u00e1ctica el an\u00e1lisis anterior. El objetivo principal en la primera parte y el n en si mismo, era que a partir de una poblaci\u00f3n de unidades taxon\u00f3micas, poder llegar a detectar cu\u00e1les son las m\u00e1s influyen- tes en cada una de las enfermedades mentales a analizar. El primer reto ha sido manejar toda esta informaci\u00f3n y prepararla para su posterior an\u00e1lisis y ajuste de un modelo capaz de realizar predicciones. 5354 CAP\u00cdTULO 3. CONCLUSIONES La dicultad ha estado en este punto en concreto, porque a pesar de disponer de m\u00e1s de 16000 pacientes con sus respectivos microbiomas, una gran parte de ellos no dispon\u00edan de toda la informaci\u00f3n necesaria, o quedaron descartados una vez pasada la fase de ltrado, reduci\u00e9ndose as\u00ed la poblaci\u00f3n a unos 2500 pacientes en total para el an\u00e1lisis. Adem\u00e1s, salvo en el caso de la Depression, el resto de enfermedades mentales te- n\u00edan muy pocos casos positivos. Esto mismo ha dicultado la tarea a los algoritmos de clasicaci\u00f3n y ha obligado a utilizar t\u00e9cnicas de Re-sampling . A pesar de que el poner en pr\u00e1ctica estas t\u00e9cnicas podr\u00eda dar la sensaci\u00f3n de que se est\u00e1n manipulando los datos de entrada, lo que nos est\u00e1 diciendo esto realmente, es que con m\u00e1s datos positivos el modelo estar\u00e1 mejor ajustado y por lo tanto, la predicci\u00f3n ser\u00e1 mejor. Este desbalanceo en los datos se ha solucionado de esta manera y a partir de ese momento, se empezaron a tener resultados signicativos y realmente buenos. Una vez realizada la preparaci\u00f3n de los datos y la evaluaci\u00f3n de los algoritmos, se ha desarrollado una aplicaci\u00f3n de software que engloba todo este an\u00e1lisis, convierti\u00e9ndose en una herramienta de predicci\u00f3n de enfermedades mentales, ajustable a las necesida- des del usuario. Adem\u00e1s de realizar dicha predicci\u00f3n, esta herramienta nos informa de aquellas va- riables o factores m\u00e1s importantes que son las que han influenciado en la decisi\u00f3n nal. Por lo tanto, esta aplicaci\u00f3n facilita la tarea del usuario, permitiendo realizar predicciones sobre enfermedades mentales de pacientes a partir del microbioma intestinal. Esto es extrapolable a cualquier otro tipo de microbioma, realizando los cambios pertinentes en el software. Cabe destacar que esta herramienta permite estudiar aquellos OTUs signi- cativos en el resultado, adem\u00e1s de permitir ajustar el balanceo de los datos en funci\u00f3n de las necesidades del momento. La planicaci\u00f3n se ha seguido estrictamente, a pesar de la situaci\u00f3n actual de pan- demia que estamos viviendo actualmente. Se ha tenido que realizar un esfuerzo sobre- humano para poder cumplir los plazos, teniendo en cuenta que se debia compaginar el teletrabajo con el cuidado de mis dos hijos peque\u00f1os y la realizaci\u00f3n de este trabajo nal de m\u00e1ster.55 En este sentido, he de agradecer la extensi\u00f3n de tiempo de dos semanas que me ha permitido no solo cumplir con lo planicado, sino realizar aquellas mejoras no previstas, pero bajo mi punto de vista, importantes para el proyecto. El trabajar en este proyecto me ha permitido pensar sobre temas todav\u00eda descono- cidos para la investigaci\u00f3n. Temas que me han rondado durante mucho tiempo en la cabeza y que, de una forma u otra, he podido dar a luz, como por ejemplo, un analizador en tiempo real del estado de nuestro microbioma, capaz de detectar alteraciones en la variabilidad de \u00e9ste. Adem\u00e1s, esta herramienta deber\u00eda ser port\u00e1til y de f\u00e1cil uso y adqui- sici\u00f3n, ya que el usuario nal es el propio analizado. Y yendo mucho m\u00e1s all\u00e1, ser\u00eda aun m\u00e1s efectivo que este analizador sea un dispositivo electr\u00f3nico insertado en el propio intestino, suministrando informaci\u00f3n relevante de todo lo que est\u00e1 pasando en \u00e9l. La mente humana es el gran desconocido para la propia humanidad, donde diferentes ciencias intentan descrifrar y desvelar sus interioridades. \u00bfSomos conscientes, porque pensamos? \u00bfQui\u00e9n o qu\u00e9 alimenta ese pensamiento? \u00bfSe mapear\u00e1 la mente y se corre- lacionar\u00e1 cada parte de ella con nuestro microbioma? Solo hay que ponerse manos a la obra, porque: \"El hombre que mueve monta\u00f1as empieza apartando piedrecitas. \"CONFUCIO56 CAP\u00cdTULO 3. CONCLUSIONESGlosario AGP Plataforma abierta para la investigaci\u00f3n de microbiomas de ciencia ciudadana. 13 BDT Boost decision tree son modelos de predicci\u00f3n que sirven para representar y cate- gorizar una serie de condiciones que ocurren de forma sucesiva para la resoluci\u00f3n de un problema. 4 Crohn Alteraci\u00f3n de la microbiota intestinal. 12 disbiosis Alteraci\u00f3n de la microbiota. 1, 12 Distancia de Manhattan M\u00e9trica en la que la distancia entre dos puntos es la suma de las diferencias (absolutas) de sus coordenadas. 18 JSON Formato de texto sencillo para el intercambio de datos. 4, 14 K-means M\u00e9todo de agrupamiento. 18 kappa Medida estad\u00edstica que ajusta el efecto del azar. 26, 27, 30-32, 35, 36 Machine learning Conjunto de algoritmos que transforman los datos en conocimiento procesable. 2 Metadatos Datos que describen otros datos. 4 microbi\u00f3mico Microbioma es el conjunto total de genes de la microbiota. 12 microbiota Conjunto de microorganismos que conviven simbi\u00f3ticamente con el nuestro. 11 5758 Glosario OTU Operational Taxonomic Unit, es una unidad muy utilizada en la investigaci\u00f3n de la diversidad microbiana. 4, 5, 13, 16, 54 Over sampling Sobremuestreo de los resultados positivos. 22, 27, 36, 41 Python Lenguaje de programaci\u00f3n orientado a objetos interpretado. 3 REntorno y lenguaje de programaci\u00f3n con un enfoque al an\u00e1lisis estad\u00edstico. 3 Re-sampling Conjunto de m\u00e9todos para garantizar que el modelo es lo sucientemente bueno para manejar variaciones en los datos. 22, 30, 34, 35, 54 RFRandom Forest est\u00e1 basado, principalmente, en los \u00c1rboles de Decisi\u00f3n con la dife- rencia de que cada nodo est\u00e1 dividido por el mejor de un subconjunto aleatorio de variables, en lugar de la mejor de todas las variables. 4 RPY2 Proporciona acceso desde Python para utilizar funciones R. 37 SVM Support Vector Machine son un conjunto de algoritmos de aprendizaje supervisado relacionados con problemas de clasicaci\u00f3n y regresi\u00f3n. 4 taxonom\u00eda Ciencia que trata de los principios, m\u00e9todos y nes de la clasicaci\u00f3n, gene- ralmente cient\u00edca; se aplica, en especial, dentro de la biolog\u00eda para la ordenaci\u00f3n jerarquizada y sistem\u00e1tica de los grupos de animales y de vegetales. 2 Under sampling Submuestreo de los resultados negativos. 22, 31Bibliograf\u00eda [1] Lantz, B. (2015).00Machine Learning build machine learning algorithms, prepare data, York: [3] Michel Aceves, R., Izeta Guti\u00e9rrez, AC., Torres Alarc\u00f3n, G., Margarita Michel Izeta, AC. (2017).00La microbiota y el microbioma intestinal humano. (Entre las llaves del reino y una nueva caja de Pandora)00. [4] Salaverry, O. (2012).00The stone of madness: Starting points of the history of mental health00. [5] Alles-Colomer, M., tial of the and depression00. [6] disorder and microbiota00. [8] Levine, Proceedings of the 3rd Inter- national Conference on Document Analysis and Recognition00, Montreal, QC, 5960 BIBLIOGRAF\u00cdA 14-16 August 1995. pp. 278-282. Archivado desde el original el 4 de julio de 2008. [10] Handling Imbalanced Datasets in Deep Learning. https://towardsdatascience.com/handling-imbalanced-datasets-in-deep. [11] Hannah Ritchie and recursos psicosociales y de salud mental00. N\u00famero de p\u00e1ginas: 84, Fecha de publicaci\u00f3n: 2015, Idiomas: \u00c1rabe, espa\u00f1ol, franc\u00e9s, ingl\u00e9s, ruso; ISBN: 978 92 4 354853 1 [13] Daniel McDonald, Embriette Hyde, Justine W. Debelius, James T. Morton, Antonio Gonzalez, Ackermann, Alexander Robert R. Dunn, Ashkaan K. Fahimipour, James Gaffney, Jack A. Gilbert, Grant Gogul, Jessica L. Green, Philip Hugenholtz, Greg Humphrey, Curtis Huttenhower, Matthew A. Jackson, Stefan Janssen, Dilip V. Jeste, Ling- jing Jiang, Scott T. Kelley, Naseer Sangwan, Joshua Shorenstein, Larry Se Song, Timothy Spector, Austin D. Swafford, Varykina Thackray, Paul Wischmeyer, Elaine Qiyun Zhu, The American Gut Consortium, Rob Knight, Casey S. Greene (2018).00American Gut: an Open Faith Chung, Alan Petra Louis, Julian Parkhill, Joan Vermeiren, Douwina Bosscher, Sylvia H. Duncan, and Harry J. Flint (2016). 00Modulation of the human gut microbiota by dietary bres occurs learning software: Kyoto. Manimozhiyan Arumugam, Eric Pelletier, Denis Le Paslier, Ta- kuji Yamada, Daniel R Mende, Gabriel R Fernandes, Julien Tap, Thomas Bruls, Jean-Michel Batto, Marcelo Bertalan, Natalia Borruel, Francesc Ca- sellas, Nielsen, Nielsen, Poulain, Junjie Qin, Thomas Sicheritz-Ponten, Sebastian Tims, David Torrents, Edgardo Ugarte, Erwin G Zoetendal, Jun Wang, Fran- cisco Guarner, Oluf Pedersen, Torrejon, Keith Turner, Gaetana Vandemeulebrouck, Encarna Varela, Yoha- nan Winogradsky, Georg Zeller, Jean Weissenbach, S Dusko Ehrlich, Peer Bork (2011).00Enterotypes of the 10.1038/nature09944. Epub 2011 Apr 20. [18] N\u00fa\u00f1ez, & Alejandro F. Barrientos Priego (2006).00Estimaci\u00f3n de la variabilidad interna de muestras poblacionales, mediante an\u00e1lisis de62 BIBLIOGRAF\u00cdA componentes principales00. Interciencia: Revista de ciencia y tecnolog\u00eda de Am\u00e9rica, 31(11), 802-806. [19] \u00abrstudio/rstudio\u00bb. GitHub.00RStudio00. Consultado el 18 de diciembre de 2016. [20] Guttag, John V. (12 August 2016).00Introduction to Computation gramming Using Python: 978-0-262-52962-4. [21] Laurent Gautier (2020).00Python interface to the R language00. https://pypi.org/project/rpy2/Anexos 63Anexo A M\u00e9todos y funciones de la aplicaci\u00f3n El c\u00f3digo fuente de la aplicaci\u00f3n y del an\u00e1lisis de datos se encuentran disponibles en https://bitbucket.org/derdritteraum/workspace/projects/BIOIN A.1. Front-end Para poder permitir al usuario acceder a todas las funcionalidades de la aplicaci\u00f3n, ha sido necesario implementar una GUI. Para ello, se ha creado una clase llamada MIP- Window desde la que el usuario realizar\u00e1, de forma directa o indirecta, todas las acciones necesarias para completar su predicci\u00f3n. En el constructor se declaran principalmente aquellas variables que se van a ir actualizando durante todo el proceso, el estilo de la GUI y la fuente de los textos, y sobre todo las dimensiones de la ventana, t\u00edtulo, icono y colores. M\u00e9todo layout() permite habilitar todos los tabs de la aplicaci\u00f3n y llamar a aquellos m\u00e9todos responsables de su implementaci\u00f3n. M\u00e9todo patients_tab() permite mostrar al usuario todo lo relacionado con la predic- ci\u00f3n. M\u00e9todo taxonomy_tab() permite mostrar al usuario todo lo relacionado con la taxo- nom\u00eda. 6566 ANEXO A. M\u00c9TODOS Y FUNCIONES DE LA APLICACI\u00d3N M\u00e9todo metadata_tab() permite mostrar al usuario todo lo relacionado con los me- tadatos. M\u00e9todo classiers_tab() permite mostrar al usuario todo lo relacionado con los algoritmos de clasicaci\u00f3n. M\u00e9todo results_tab() permite mostrar al usuario todo lo relacionado con los resul- tados obtenidos despu\u00e9s del entrenamiento. M\u00e9todo prediction_tab() permite mostrar al usuario todos los resultados obtenidos despu\u00e9s de la predicci\u00f3n. M\u00e9todo about_tab() permite mostrar al usuario informaci\u00f3n sobre el proyecto y par- tes implicadas en \u00e9l. M\u00e9todo generic_result() permite mostrar los resultados obtenidos despu\u00e9s del en- trenamiento tanto a nivel num\u00e9rico como a nivel gr\u00e1co. Esta pantalla al ser gen\u00e9ri- ca se reutilizar\u00e1 para todas las diferentes enfermedades mentales. M\u00e9todo simple_chart() permite realizar una representaci\u00f3n gr\u00e1ca de un resultado por algoritmo. M\u00e9todo multi_chart() ermite realizar una representaci\u00f3n gr\u00e1ca de varios resulta- dos por algoritmo. M\u00e9todo start_taxonomy_ltered() permite cargar los cheros de taxonom\u00eda y apli- car los ltros, tanto para la fase de entrenamiento como para la fase de predicci\u00f3n. M\u00e9todo start_metadata_ltered() permite cargar los cheros de metadatos y apli- car los ltros, tanto para la fase de entrenamiento como para la fase de predicci\u00f3n. M\u00e9todo start_generate_model() permite generar el modelo para cada una de las enfermedades mentales. M\u00e9todo execute_prediction() permite realizar la predicci\u00f3n bas\u00e1ndose en el mo- delo ajustado para cada una de las enfermedades mentales.A.2. BACK-END 67 M\u00e9todo xxx_RFunction_calculations() permiten calcular todos los resultados para cada algoritmo para cada enfermedad mental. M\u00e9todo decide_best_algorithm() permite decidir cu\u00e1l de los algoritmos seleccio- nados en la fase de entrenamiento ha obtenido mejor resultado para cada enferme- dad mental, y por lo tanto, ser\u00e1 el utilizado en la fase de predicci\u00f3n. Este criterio est\u00e1 basado en obtener el mejor resultado despu\u00e9s de sumar la precisi\u00f3n accuracy y el estad\u00edstico kappa. A.2. Back-end Para realizar la extracci\u00f3n de los datos taxon\u00f3micos y su posterior ltrado, se ha creado una clase llamada Taxonomy preparada para gestionar toda la informaci\u00f3n sobre este tipo de datos. load_le() se encarga de realizar la lectura de los datos desde el chero de taxo- nom\u00eda para poder crear una matriz con ellos. create_matrix() es responsable directo de la creaci\u00f3n de la matriz de datos. Recoge l\u00ednea a l\u00ednea el contenido del chero y las convierte en listas. insert_list_in_matrix() toma cada una de estas l\u00edneas le\u00eddas desde el chero y separa cada uno de los elementos que completar\u00e1 nalmente la lista. Con estos tres m\u00e9todos se pasa toda la informaci\u00f3n del chero a una matriz o lista de listas. El siguiente paso es el ltrado o supresi\u00f3n de aquella informaci\u00f3n no necesaria. En este caso lo que se pretende es suprimir a aquellos individuos de la lista con un por- centaje de Pseudomonas superior al 3 % y un porcentaje de (unkn.) Enterobacteiaceae(f) tambi\u00e9n superior al 3 %. microorganism_lter() guarda una lista de \u00edndices de pacientes que no cumplen los requisitos del ltro, para ser eliminados de la matriz de taxonom\u00eda. Este m\u00e9todo recibe como par\u00e1metro un diccionario con el microorganismo y el porcentaje. De esta manera, sin en un futuro se quisieran a\u00f1adir m\u00e1s microorganismos u otros valores en los porcentajes, no habr\u00eda que modicarlo.68 ANEXO A. M\u00c9TODOS Y FUNCIONES DE LA APLICACI\u00d3N lter_taxonomy_matrix() es el responsable directo de eliminar aquellos pacientes que no cumplen con las condiciones deseadas. Recibe una lista de \u00edndices a supri- mir, generada por el m\u00e9todo microorganism_lter() , y de mayor a menor procede a la supresi\u00f3n. get_taxonomy_matrix() retorna la matriz de taxonom\u00eda una vez realizados todos los ltrados. get_patientsId_list() retorna la lista con todos los identicadores de los pacientes que han pasado el ltrado. get_microorganism_list() retorna la lista de los nombres de todos los microorga- nismos. change_bacteria_name() reduce el nombre de la bacteria de una manera dr\u00e1stica para un mejor manejo de los datos y evitar nombre muy largos. get_bacteria_name() retorna el nombre original de la bacteria, es decir, su versi\u00f3n larga del nombre. write_le() permite generar un chero, con los datos obtenidos despu\u00e9s del ltrado, de la matriz de taxonom\u00eda. Para realizar la extracci\u00f3n de los metadatos de cada uno de los pacientes, se ha utili- zado la tecnolog\u00eda Python. Para este caso en concreto, se ha creado una clase llamada Metadata preparada para gestionar toda la informaci\u00f3n sobre este tipo de datos. lter_by_taxonomy() se encarga de la obtenci\u00f3n de la matriz de taxonom\u00eda gene- rada a trav\u00e9s de la clase Taxonomy. lter_by_metadata() es el m\u00e1s importante de la clase, ya que es responsable del ltrado total de todos los datos. Toma la lista de pacientes v\u00e1lidos en el ltrado taxon\u00f3mico y uno a uno comprobar\u00e1 si cumplen con los requisitos de ltrado. \u00cdndice de masa corporal (BMI) si este valor no est\u00e1 entre los valores 18y30o no se tuviera informaci\u00f3n al respecto, este paciente quedar\u00e1 descartado del juego de datos a analizar.A.2. BACK-END 69 Padecer enfermedad intestinal (IBD) si el resultado es un diagn\u00f3stico positivo, ya sea por un profesional m\u00e9dico o un practicante de medicina alternativa, por el mismo paciente o no se tuviera informaci\u00f3n al respecto, este paciente quedar\u00e1 descartado del juego de datos a analizar. Padecer Diabetes si el resultado es un diagn\u00f3stico positivo, ya sea por un profe- sional m\u00e9dico o un practicante de medicina alternativa, por el mismo paciente o no se tuviera informaci\u00f3n al respecto, este paciente quedar\u00e1 descartado del juego de datos a analizar. Haber tomado alg\u00fan tipo de antibi\u00f3tico en los \u00faltimos seis meses tambi\u00e9n descar- tar\u00e1 a este paciente del juego nal de datos. Es importante tener informaci\u00f3n sobre si los pacientes tienen o no alguna enferme- dad mental. En el caso en que el valor obtenido en todas las enfermedades menta- les no este especicado, Unspecied , tambi\u00e9n quedar\u00e1 descartado el paciente. Cuando un paciente supera todos estos ltros ser\u00e1 insertada toda esta informaci\u00f3n m\u00e1s otras caracter\u00edsticas al conjunto de datos. Se han creado otros m\u00e9todos que ayudan a la obtenci\u00f3n de los resultados, prepar\u00e1ndolos para el an\u00e1lisis. check_characteristic_if_has_condition() recibe un resultado obtenido de una ca- racter\u00edstica del paciente y se retorna un resultado m\u00e1s signicativo o con una lon- gitud del literal mucho m\u00e1s corto. Como por ejemplo, si se recibe 'Diagnosed by a medical professional (doctor, dependiendo si se padece o no cierta enfermedad mental y en cualquier otro caso se retornar\u00e1 sin especicar 'Unspecied' . getCharacteristics() dependiendo de la caracter\u00edstica a buscar retorna su valor. Una vez obtenido todos los datos, el siguiente paso es unicarlos con la matriz de taxonom\u00eda.70 ANEXO A. M\u00c9TODOS Y FUNCIONES DE LA APLICACI\u00d3N merge_taxonomy_and_metadata_matrix() a\u00f1ade la nal de la matriz de taxono- m\u00eda todos los resultados obtenidos a partir de los metadatos de cada paciente. Puede suceder que una bacteria sea irrelevante debido a la falta de resultados o incluso por carecer de ellos. Por lo tanto, ya que no va a realizar ninguna aportaci\u00f3n al estudio y adem\u00e1s va a incrementar el consumo de los recursos del sistema en los c\u00e1lculos, se proceder\u00e1 a eliminar aquellas poco relevantes. clean_merge_matrix() permite eliminar bacterias irrelevantes. Para determinar cu\u00e1- les son, se comprobar\u00e1 el n\u00famero de valores diferente a '0' encontrados. write_le_dataset() tomar\u00e1 lista a lista de la matriz resultante y las insertar\u00e1 en un chero a modo de juego de datos. \u00c9ste est\u00e1 preparado para su uso con la tecnolog\u00eda R. A.3. Llamadas a las funciones R Para realizar llamadas a las funciones de R se ha necesitado crear una nueva clase llamada RFunctions que se encarga de todas estas tareas. En el constructor se cargan todas las librer\u00edas necesarias, como por ejemplo las librer\u00edas que procesan los algoritmos de entrenamiento. M\u00e9todo load_data() yload_data_prediction() tienen el mismo cometido, que es la de cargar los cheros .csv generados en los pasos previos al entrenamiento. La diferencia es que el primer m\u00e9todo carga el chero .csv para el entrenamiento, y el segundo m\u00e9todo carga el chero .csv para la predicci\u00f3n. M\u00e9todo distribute_data() ydistribute_data_prediction() se encargan de distribuir los datos le\u00eddos del juego de datos en funci\u00f3n de si son taxon\u00f3micos, o metadatos para el entrenamiento y la predicci\u00f3n, y si son enfermedades mentales que en este caso solo afecta al entrenamiento. M\u00e9todo normalize_data() ynormalize_data_prediction() realizan la normaliza- ci\u00f3n de los datos para el entrenamiento y para la predicci\u00f3n.A.3. LLAMADAS A LAS FUNCIONES R 71 M\u00e9todo add_mental_illness_data() permite a\u00f1adir cada una de las enfermedades mentales al dataframe nal. M\u00e9todo f_under_sampling() permite recortar resultados negativos del juego de da- tos. M\u00e9todo f_over_sampling() permite a\u00f1adir resultados positivos al juego de datos. M\u00e9todo f_confusion_matrix_xxx() permite crear la matriz de confusi\u00f3n para cada una de las enfermedades mentales tomadas como variables de salida. M\u00e9todo calculate_result() permite obtener el resultado despu\u00e9s del entrenamiento y despu\u00e9s de la predicci\u00f3n. M\u00e9todo get_patientsId_prediction_list() retorna una lista con los identicadores de cada uno de los pacientes a los que se les ha hecho la predicci\u00f3n.72 ANEXO A. M\u00c9TODOS Y FUNCIONES DE LA APLICACI\u00d3NAnexo B Distribuciones B.1. Estad\u00edstica descriptiva Figura B.1: Distribuci\u00f3n de los datos referente a la edad, el sexo, la altura y el peso 7374 ANEXO B. DISTRIBUCIONES Figura B.2: Representaci\u00f3n gr\u00e1ca de frecuencia en la ingesta de vegetales, marisco, fruta y carne roja Figura B.3: Representaci\u00f3n gr\u00e1ca de frecuencia en la toma de un litro de agua, bebidas azucaradas, alcohol y tabacoB.1. ESTAD\u00cdSTICA DESCRIPTIVA 75 Figura B.4: Representaci\u00f3n gr\u00e1ca de los datos referente a la duraci\u00f3n del sue\u00f1o, diag- n\u00f3stico de tener migra\u00f1a, reflujo de \u00e1cidos y enfermedades cardiovasculares Figura B.5: Representaci\u00f3n gr\u00e1ca de frecuencia del uso de cosm\u00e9ticos, ejercicio y va- cuna para la gripe, adem\u00e1s del tipo de anticonceptivo usado76 ANEXO B. DISTRIBUCIONES Figura B.6: Representaci\u00f3n gr\u00e1ca de los datos referente enfermedades de ri\u00f1\u00f3n, h\u00edgado y pulm\u00f3n, y la frecuencia de consumo de huevo de carne. Figura B.7: Representaci\u00f3n gr\u00e1ca de frecuencia del consumo de queso, multivitaminas y probi\u00f3ticos, adem\u00e1s de la condici\u00f3n de estar embarazadaB.1. ESTAD\u00cdSTICA DESCRIPTIVA 77 Figura B.8: Representaci\u00f3n gr\u00e1ca de frecuencia del consumo de snaks, azucar, vitamina b y vitamina d78 ANEXO B. DISTRIBUCIONESAnexo C Clasicadores A continuaci\u00f3n, se muestran las tablas de confusi\u00f3n para cada uno de los clasicado- res en cada una de la enfermedades mentales, despu\u00e9s de ajustar el modelo. Figura C.1: No sampling Anorexia - RF Figura C.2: No sampling Anorexia - BDT 7980 ANEXO C. CLASIFICADORES Figura C.3: No sampling Anorexia - SVM li- neal Figura C.4: No sampling Anorexia - SVM polynomial Figura C.5: Under sampling Anorexia - RF Figura C.6: Under sampling Anorexia - BDT Figura C.7: Under sampling Anorexia - SVM lineal Figura C.8: Under sampling Anorexia - SVM polynomial81 Figura C.9: Over sampling Anorexia - RF Figura C.10: Over sampling Anorexia - BDT Figura C.11: Over sampling Anorexia - SVM lineal Figura C.12: Over sampling Anorexia - SVM polynomial Figura C.13: No sampling Bipolar - RF Figura C.14: No sampling Bipolar - BDT82 ANEXO C. CLASIFICADORES Figura C.15: No sampling Bipolar - SVM li- neal Figura C.16: No sampling Bipolar - SVM polynomial Figura C.17: Under sampling Bipolar - RF Figura C.18: Under sampling Bipolar - BDT Figura C.19: Under sampling Bipolar - SVM lineal Figura C.20: Under sampling Bipolar - SVM polynomial83 Figura C.21: Over sampling Bipolar - RF Figura C.22: Over sampling Bipolar - BDT Figura C.23: Over sampling Bipolar - SVM lineal Figura C.24: Over sampling Bipolar - SVM polynomial Figura C.25: No sampling Bulimia - RF Figura C.26: No sampling Bulimia - BDT84 ANEXO C. CLASIFICADORES Figura C.27: No sampling Bulimia - SVM li- neal Figura C.28: No sampling Bulimia - SVM polynomial Figura C.29: Under sampling Bulimia - RF Figura C.30: Under sampling Bulimia - BDT Figura C.31: Under sampling Bulimia - SVM lineal Figura C.32: Under sampling Bulimia - SVM polynomial85 Figura C.33: Over sampling Bulimia - RF Figura C.34: Over sampling Bulimia - BDT Figura C.35: Over sampling Bulimia - SVM lineal Figura C.36: Over sampling Bulimia - SVM polynomial C.37: Post Figura No sampling - C.41: sampling - BDT C.43: Under sampling PTSD - Under PTSD C.45: sampling sampling - C.49: No Substance Abuse RF Figura C.50: No sampling Substance Abuse - BDT88 ANEXO C. CLASIFICADORES Figura C.51: No sampling Substance Abuse - SVM lineal Figura C.52: No sampling Substance Abuse - SVM polynomial Figura C.53: Under sampling Substance Abuse - RF C.54: Under sampling Substance Abuse - BDT Figura C.55: Under sampling Substance Abuse - SVM lineal Figura C.56: Under sampling Substance Abuse - SVM polynomial89 Figura C.57: Over sampling Substance Abuse - RF C.58: Over sampling Substance Abuse - BDT Figura C.59: Over sampling Substance Abuse - SVM lineal "}