{"title": "Cap\u00edtulo 8 C\u00f3mo visualizar distribuciones de datos | Introducci\u00f3n a la ciencia de datos", "author": "Rafael A Irizarry", "url": null, "hostname": null, "description": "Este libro presenta conceptos y destrezas que les ayudar\u00e1n abordar los retos de situaciones actuales del an\u00e1lisis de datos. Cubre conceptos de probabilidad, inferencia estad\u00edstica, regresi\u00f3n lineal y machine learning. Adem\u00e1s, les permitir\u00e1 desarrollar destrezas como la programaci\u00f3n R, el wrangling de datos con dplyr, la visualizaci\u00f3n de datos con ggplot2, la organizaci\u00f3n de archivos con Shell de UNIX / Linux, el control de versiones con GitHub y la preparaci\u00f3n de documentos reproducibles con R markdown.", "sitename": null, "date": "2010-01-01", "cleaned_text": "Cap\u00edtulo 8 C\u00f3mo visualizar distribuciones de datos Los datos num\u00e9ricos a menudo se resumen con el valor promedio. Por ejemplo, la calidad de una escuela secundaria a veces se resume con un solo n\u00famero: la puntuaci\u00f3n promedio en una prueba estandarizada. Ocasionalmente, se incluye un segundo n\u00famero: la desviaci\u00f3n est\u00e1ndar. Por ejemplo, pueden leer un informe que indique que las puntuaciones fueron 680 m\u00e1s o menos 50 (la desviaci\u00f3n est\u00e1ndar). El informe ha resumido un vector completo de puntuaciones con solo dos n\u00fameros. \u00bfEs esto apropiado? \u00bfHay alguna informaci\u00f3n importante que no estamos considerando al ver este resumen en lugar de la lista completa? Nuestro primer componente b\u00e1sico de visualizaci\u00f3n de datos es aprender a resumir listas de factores o vectores num\u00e9ricos. Generalmente, la mejor manera de compartir o explorar este resumen es a trav\u00e9s de la visualizaci\u00f3n de datos. El resumen estad\u00edstico m\u00e1s b\u00e1sico de una lista de objetos o n\u00fameros es su distribuci\u00f3n. Una vez que un vector se haya resumido como una distribuci\u00f3n, existen varias t\u00e9cnicas de visualizaci\u00f3n de datos para transmitir esta informaci\u00f3n de manera efectiva. En este cap\u00edtulo, primero discutiremos las propiedades de una variedad de distribuciones y c\u00f3mo visualizar las distribuciones usando un ejemplo motivante de alturas de estudiantes. Luego, en la Secci\u00f3n [8.16](distributions.html#other-geometries), discutiremos las geometr\u00edas de ggplot2 para estas visualizaciones. 8.1 Tipos de variables Trabajaremos con dos tipos de variables: categ\u00f3ricas y num\u00e9ricas. Cada uno puede dividirse en otros dos grupos: las variables categ\u00f3ricas pueden ser ordinales o no, mientras que las num\u00e9ricas pueden ser discretas o continuas. Cuando cada entrada en un vector proviene de uno de un peque\u00f1o n\u00famero de grupos, nos referimos a los datos como datos categ\u00f3ricos. Dos ejemplos sencillos son el sexo (masculino o femenino) y las regiones (noreste, sur, norte central, oeste). Algunos datos categ\u00f3ricos se pueden ordenar aunque no sean n\u00fameros, por ejemplo cu\u00e1n picante es una comida (poco, medio, muy). En los libros de texto de estad\u00edsticas, los datos categ\u00f3ricos ordenados se denominan datos ordinales. Ejemplos de datos num\u00e9ricos son el tama\u00f1o de la poblaci\u00f3n, las tasas de asesinatos y las alturas. Algunos datos num\u00e9ricos se pueden tratar como ordenados categ\u00f3ricos. Podemos dividir a\u00fan m\u00e1s los datos num\u00e9ricos en continuos y discretos. Las variables continuas son aquellas que pueden tomar cualquier valor, como las alturas, si se miden con suficiente precisi\u00f3n. Por ejemplo, un par de gemelos pueden medir 68.12 y 68.11 pulgadas, respectivamente. Los conteos, como el tama\u00f1o de la poblaci\u00f3n, son discretos porque tienen que ser n\u00fameros redondos. Tengan en cuenta que los datos num\u00e9ricos discretos pueden considerarse ordinales. Aunque esto es t\u00e9cnicamente cierto, generalmente reservamos el t\u00e9rmino datos ordinales para variables que pertenecen a un peque\u00f1o n\u00famero de grupos diferentes, y cada grupo tiene muchos miembros. En cambio, cuando tenemos muchos grupos con pocos casos en cada grupo, generalmente nos referimos a ellos como variables num\u00e9ricas discretas. Entonces, por ejemplo, el n\u00famero de paquetes de cigarrillos que una persona fuma al d\u00eda, redondeado al paquete m\u00e1s cercano, se considerar\u00eda ordinal, mientras que el n\u00famero real de cigarrillos se considerar\u00eda una variable num\u00e9rica. Sin embargo, hay ejemplos que pueden considerarse tanto num\u00e9ricos como ordinales cuando se trata de visualizar datos. 8.2 Estudio de caso: describiendo alturas de estudiantes Aqu\u00ed presentamos un nuevo problema motivante. Es artificial, pero nos ayudar\u00e1 ilustrar los conceptos necesarios para comprender las distribuciones. Imaginen que tenemos que describir las alturas de nuestros compa\u00f1eros de clase a ET, un extraterrestre que nunca ha visto humanos. Como primer paso, necesitamos recopilar datos. Para hacer esto, les pedimos a los estudiantes que indiquen sus alturas en pulgadas. Les pedimos que nos provean informaci\u00f3n sobre su sexo biol\u00f3gico porque sabemos que hay dos distribuciones diferentes por sexo. Recopilamos los datos y los guardamos en el set de datos heights: Una forma de transmitir las alturas a ET es simplemente enviarle esta lista de 1,050 alturas. Sin embargo, hay formas mucho m\u00e1s efectivas de transmitir la informaci\u00f3n y, para lograr esto, nos ayudar\u00e1 a entender el concepto de distribuciones. Para simplificar la explicaci\u00f3n, primero nos enfocamos en las alturas masculinas. Examinamos los datos de altura femenina en la Secci\u00f3n [8.14](distributions.html#student-height-cont). 8.3 La funci\u00f3n de distribuci\u00f3n Resulta que, en algunos casos, el promedio y la desviaci\u00f3n est\u00e1ndar son pr\u00e1cticamente todo lo que necesitamos para comprender los datos. Aprenderemos t\u00e9cnicas de visualizaci\u00f3n de datos que nos ayudar\u00e1n a determinar cu\u00e1ndo este resumen de dos n\u00fameros es apropiado. Estas mismas t\u00e9cnicas servir\u00e1n como una alternativa para cuando dos n\u00fameros no son suficientes. El resumen estad\u00edstico m\u00e1s b\u00e1sico de una lista de objetos o n\u00fameros es su distribuci\u00f3n. La forma m\u00e1s sencilla de pensar en una distribuci\u00f3n es como una descripci\u00f3n compacta de una lista con muchas entradas. Este concepto no deber\u00eda ser nuevo para los lectores de este libro. Por ejemplo, con datos categ\u00f3ricos, la distribuci\u00f3n simplemente describe la proporci\u00f3n de cada categor\u00eda \u00fanica. El sexo representado en el set de datos de alturas es: #> #> Female Male #> 0.227 0.773 Esta tabla de frecuencia de dos categor\u00edas es la forma m\u00e1s sencilla de una distribuci\u00f3n. Realmente no necesitamos visualizarla ya que un n\u00famero describe todo lo que necesitamos saber: 23% son mujeres y el resto son hombres. Cuando hay m\u00e1s categor\u00edas, un diagrama de barras sencillo describe la distribuci\u00f3n. Aqu\u00ed hay un ejemplo con las regiones estatales de EE. UU.: Este gr\u00e1fico simplemente nos muestra cuatro n\u00fameros, uno para cada categor\u00eda. Usualmente usamos diagramas de barras cuando tenemos pocos n\u00fameros. Aunque este gr\u00e1fico en particular no ofrece mucha m\u00e1s informaci\u00f3n que una tabla de frecuencias en s\u00ed, es un primer ejemplo de c\u00f3mo convertimos un vector en un gr\u00e1fico que resume de manera sucinta toda la informaci\u00f3n en el vector. Cuando los datos son num\u00e9ricos, la tarea de mostrar distribuciones es m\u00e1s retante. 8.4 Funciones de distribuci\u00f3n acumulada Los datos num\u00e9ricos que no son categ\u00f3ricos tambi\u00e9n tienen distribuciones. En general, cuando los datos no son categ\u00f3ricos, indicar la frecuencia de cada entrada no es un resumen efectivo, ya que la mayor\u00eda de las entradas son \u00fanicas. En nuestro estudio de caso, por ejemplo, mientras varios estudiantes reportaron una altura de 68 pulgadas, un estudiante indic\u00f3 una altura de 68.503937007874 pulgadas y otro una altura 68.8976377952756 pulgadas. Suponemos que convirtieron sus alturas de 174 y 175 cent\u00edmetros, respectivamente. Los libros de texto de estad\u00edsticas nos ense\u00f1an que una forma m\u00e1s \u00fatil de definir una distribuci\u00f3n de datos num\u00e9ricos es definir una funci\u00f3n que indique la proporci\u00f3n de los datos a continuaci\u00f3n \\(a\\) para todos los valores posibles de \\(a\\). Esta funci\u00f3n se llama la funci\u00f3n de distribuci\u00f3n acumulada (cumulative distribution function o CDF por sus siglas en ingl\u00e9s). En estad\u00edstica, se usa la siguiente notaci\u00f3n: \\[ F(a) = \\mbox{Pr}(x \\leq a) \\] Aqu\u00ed vemos un gr\u00e1fico de \\(F\\) para los datos de altura masculina: Similar a lo que hace la tabla de frecuencias para datos categ\u00f3ricos, la CDF define la distribuci\u00f3n de datos num\u00e9ricos. En el gr\u00e1fico, podemos ver que 16% de los valores son menos de 65, ya que \\(F(66)=\\) 0.164, o que 84% de los valores son menos de 72, ya que \\(F(72)=\\) 0.841, y as\u00ed. De hecho, podemos informar la proporci\u00f3n de valores entre dos alturas, digamos \\(a\\) y \\(b\\), al calcular \\(F(b) - F(a)\\). Esto significa que si enviamos este diagrama a ET, tendr\u00e1 toda la informaci\u00f3n necesaria para reconstruir la lista completa. Parafraseando la expresi\u00f3n \"una imagen vale m\u00e1s que mil palabras\", en este caso una imagen es tan informativa como 812 n\u00fameros. Una nota final: debido a que las CDF pueden definirse matem\u00e1ticamente, la palabra emp\u00edrica se a\u00f1ade para distinguir cuando se usan los datos. Por lo tanto, utilizamos el t\u00e9rmino CDF emp\u00edrico (o eCDF por sus siglas en ingl\u00e9s). 8.5 Histogramas Aunque el concepto de CDF se discute ampliamente en los libros de texto de estad\u00edstica, el gr\u00e1fico no es muy popular en la pr\u00e1ctica. La raz\u00f3n principal es que no transmite f\u00e1cilmente caracter\u00edsticas de inter\u00e9s como: \u00bfen qu\u00e9 valor se centra la distribuci\u00f3n? \u00bfLa distribuci\u00f3n es sim\u00e9trica? \u00bfQu\u00e9 rangos contienen el 95% de los valores? Los histogramas son preferidos porque facilitan enormemente la respuesta a tales preguntas. Los histogramas sacrifican solo un poco de informaci\u00f3n para producir gr\u00e1ficos que son mucho m\u00e1s f\u00e1ciles de interpretar. La forma m\u00e1s sencilla de hacer un histograma es dividir el span de nuestros datos en compartimientos (bins en ingl\u00e9s) no superpuestos del mismo tama\u00f1o. Entonces para cada compartimiento, contamos el n\u00famero de valores que se encuentran en ese intervalo. El histograma grafica estos conteos como barras con la base de la barra definida por los intervalos. A continuaci\u00f3n tenemos el histograma para los datos de altura que dividen el rango de valores en intervalos de una pulgada: \\([49.5, 50.5], [51.5,52.5],(53.5,54.5],...,(82.5,83.5]\\). Como pueden ver en la figura de arriba, un histograma es similar a un diagrama de barras, pero difiere en que el eje-x es num\u00e9rico, no categ\u00f3rico. Si le enviamos este diagrama a ET, inmediatamente aprender\u00e1 algunos detalles importantes sobre nuestros datos. Primero, el rango de datos es de 50 a 84 con la mayor\u00eda (m\u00e1s del 95%) entre 63 y 75 pulgadas. Adem\u00e1s, las alturas son casi sim\u00e9tricas alrededor de 69 pulgadas. Por \u00faltimo, al sumar conteos, ET puede obtener una muy buena aproximaci\u00f3n de la proporci\u00f3n de los datos en cualquier intervalo. Por lo tanto, el histograma anterior no solo es f\u00e1cil de interpretar, sino que tambi\u00e9n ofrece casi toda la informaci\u00f3n contenida en la lista cruda de 812 alturas con aproximadamente 30 conteos, uno por cada compartimiento. \u00bfQu\u00e9 informaci\u00f3n perdemos? Recuerden que todos los valores en cada intervalo se tratan de la misma manera cuando se calculan las alturas del compartimiento. Entonces, por ejemplo, el histograma no distingue entre 64, 64.1 y 64.2 pulgadas. Dado que estas diferencias son casi imperceptibles a la vista, las implicaciones pr\u00e1cticas son insignificantes y pudimos resumir los datos en solo 23 n\u00fameros. Discutimos c\u00f3mo codificar histogramas en la Secci\u00f3n [8.16](distributions.html#other-geometries). 8.6 Densidad suave Los gr\u00e1ficos de densidad suave son est\u00e9ticamente m\u00e1s atractivos que los histogramas. A continuaci\u00f3n vemos un gr\u00e1fico de densidad suave para nuestros datos de altura: En este gr\u00e1fico, ya no tenemos bordes afilados en los l\u00edmites de intervalo y se han eliminado muchos de los picos locales. Adem\u00e1s, la escala del eje-y cambi\u00f3 de conteos a densidad. Para entender las densidades suaves, tenemos que entender estimadores, un tema que no abordamos hasta m\u00e1s tarde. Sin embargo, ofrecemos una explicaci\u00f3n heur\u00edstica para ayudarles a entender los conceptos b\u00e1sicos y as\u00ed poder utilizar esta herramienta \u00fatil de visualizaci\u00f3n de datos. El nuevo concepto principal que deben entender es que suponemos que nuestra lista de valores observados es un subconjunto de una lista mucho m\u00e1s grande de valores no observados. En el caso de las alturas, pueden imaginar que nuestra lista de 812 estudiantes varones proviene de una lista hipot\u00e9tica que contiene todas las alturas de todos los estudiantes varones en todo el mundo, medidos todos con mucha precisi\u00f3n. Digamos que hay 1,000,000 de estas medidas. Esta lista de valores tiene una distribuci\u00f3n, como cualquier lista de valores, y esta distribuci\u00f3n considerable es realmente lo que queremos transmitir a ET, ya que es mucho m\u00e1s general. Desafortunadamente, no podemos ver esa lista grand\u00edsima. Sin embargo, podemos hacer una suposici\u00f3n que quiz\u00e1s nos ayude a aproximarla. Si tuvi\u00e9ramos 1,000,000 valores, medidos con mucha precisi\u00f3n, podr\u00edamos hacer un histograma con compartimientos muy, muy peque\u00f1os. La suposici\u00f3n es que si mostramos esto, la altura de los compartimientos consecutivos ser\u00e1 similar. Esto es lo que queremos decir con suave: no tenemos grandes saltos en las alturas de los compartimientos consecutivos. A continuaci\u00f3n tenemos un histograma hipot\u00e9tico con compartimientos de tama\u00f1o 1: Entre m\u00e1s peque\u00f1os hacemos los compartimientos, m\u00e1s suave se vuelve el histograma. Aqu\u00ed est\u00e1n los histogramas con ancho de compartimiento de 1, 0.5 y 0.1: La densidad suave es b\u00e1sicamente la curva que atraviesa la parte superior de las barras del histograma cuando los compartimientos son muy, muy peque\u00f1os. Para que la curva no dependa del tama\u00f1o hipot\u00e9tico de la lista hipot\u00e9tica, calculamos la curva usando frecuencias en lugar de conteos: Ahora, de vuelta a la realidad. No tenemos millones de medidas. En cambio, tenemos 812 y no podemos hacer un histograma con compartimientos muy peque\u00f1os. Por lo tanto, hacemos un histograma utilizando tama\u00f1os de compartimiento apropiados para nuestros datos y frecuencias de c\u00f3mputo en lugar de conteos. Adem\u00e1s, dibujamos una curva suave que pasa por la parte superior de las barras del histograma. Los siguientes gr\u00e1ficos muestran los pasos que conducen a una densidad suave: Sin embargo, recuerden que suave (smooth en ingl\u00e9s) es un t\u00e9rmino relativo. De hecho, podemos controlar la suavidad de la curva cambiando el n\u00famero de puntos en los compartimientos. Esta opci\u00f3n se conoce como bandwidth, span, window size o, en espa\u00f1ol, ventana de suavizado o par\u00e1metro de suavizado, y se puede ajustar en la funci\u00f3n que calcula la curva de densidad suave. Aqu\u00ed hay dos ejemplos que usan diferentes niveles de suavidad en el mismo histograma: Necesitamos tomar esta decisi\u00f3n con cuidado ya que las visualizaciones que resultan pueden cambiar nuestra interpretaci\u00f3n de los datos. Debemos seleccionar un grado de suavidad que podamos defender como representativo de los datos subyacentes. En el caso de la altura, realmente tenemos razones para creer que la proporci\u00f3n de personas con alturas similares deber\u00eda ser la misma. Por ejemplo, la proporci\u00f3n que es 72 pulgadas deber\u00eda ser m\u00e1s similar a la proporci\u00f3n que es 71 que a la proporci\u00f3n que es 78 o 65. Esto implica que la curva debe ser bastante suave; es decir, la curva deber\u00eda parecerse m\u00e1s al ejemplo de la derecha que al de la izquierda. Si bien el histograma es un resumen sin supuestos, la densidad suavizada se basa en algunos supuestos. 8.6.1 C\u00f3mo interpretar el eje-y Tengan en cuenta que interpretar el eje-y de un gr\u00e1fico de densidad suave no es obvio. Se escala para que el \u00e1rea bajo la curva de densidad se sume a 1. Si imaginan que formamos un compartimiento con una base de 1 unidad de longitud, el valor del eje-y nos indica la proporci\u00f3n de valores en ese compartimiento. Sin embargo, esto solo es cierto para compartimientos de tama\u00f1o 1. Para intervalos de otro tama\u00f1o, la mejor manera de determinar la proporci\u00f3n de datos en ese intervalo es calculando la proporci\u00f3n del \u00e1rea total contenida en ese intervalo. Por ejemplo, aqu\u00ed vemos la proporci\u00f3n de valores entre 65 y 68: La proporci\u00f3n de esta \u00e1rea es aproximadamente 0.3, lo que significa que aproximadamente 30% de las alturas masculinas est\u00e1n entre 65 y 68 pulgadas. Al comprender esto, estamos listos para usar la densidad suave como resumen. Para este set de datos, nos sentimos bastante c\u00f3modos suponiendo suavidad y, por ende, compartiendo esta figura est\u00e9ticamente agradable con ET, que puede usarla para comprender nuestros datos de alturas masculinas: 8.6.2 Densidades permiten estratificaci\u00f3n Como nota final, se\u00f1alamos que una ventaja de las densidades suaves sobre los histogramas para fines de visualizaci\u00f3n es que las densidades facilitan la comparaci\u00f3n de dos distribuciones. Esto se debe en gran parte a que los bordes irregulares del histograma a\u00f1aden desorden. Aqu\u00ed hay un ejemplo que compara las alturas masculinas y las femeninas: Con el argumento correcto, ggplot autom\u00e1ticamente sombrea la regi\u00f3n de intersecci\u00f3n con un color diferente. Mostraremos ejemplos de c\u00f3digo de ggplot2 para densidades en la Secci\u00f3n [9](gapminder.html#gapminder) as\u00ed como en la Secci\u00f3n [8.16](distributions.html#other-geometries). 8.7 Ejercicios 1. En el set de datos murders, la regi\u00f3n es una variable categ\u00f3rica y la siguiente es su distribuci\u00f3n: Redondeando al 5% m\u00e1s cercano, \u00bfqu\u00e9 proporci\u00f3n de los estados se encuentran en la regi\u00f3n \"North Central\"? 2. \u00bfCu\u00e1l de los siguientes es cierto? - El gr\u00e1fico anterior es un histograma. - El gr\u00e1fico anterior muestra solo cuatro n\u00fameros con un diagrama de barras. - Las categor\u00edas no son n\u00fameros, por lo que no tiene sentido graficar la distribuci\u00f3n. - Los colores, no la altura de las barras, describen la distribuci\u00f3n. 3. El siguiente gr\u00e1fico muestra el eCDF para las alturas masculinas: Seg\u00fan el gr\u00e1fico, \u00bfqu\u00e9 porcentaje de hombres son m\u00e1s bajos que 75 pulgadas? - 100% - 95% - 80% - 72 pulgadas 4. A la pulgada m\u00e1s cercana, \u00bfqu\u00e9 altura m tiene la propiedad de que la mitad de los estudiantes varones son m\u00e1s altos que m y la mitad son m\u00e1s bajos? - 61 pulgadas - 64 pulgadas - 69 pulgadas - 74 pulgadas 5. Aqu\u00ed hay un eCDF de las tasas de asesinatos en todos los estados: Sabiendo que hay 51 estados (contando DC) y basado en este gr\u00e1fico, \u00bfcu\u00e1ntos estados tienen tasas de homicidio superiores a 10 por cada 100,000 personas? - 1 - 5 - 10 - 50 6. Seg\u00fan el eCDF anterior, \u00bfcu\u00e1l de las siguientes afirmaciones es cierta? - Alrededor de la mitad de los estados tienen tasas de homicidios superiores a 7 por 100,000 y la otra mitad por debajo. - La mayor\u00eda de los estados tienen tasas de homicidio de menos de 2 por 100,000. - Todos los estados tienen tasas de asesinatos superiores a 2 por 100,000. - Con la excepci\u00f3n de 4 estados, las tasas de asesinatos son inferiores a 5 por cada 100,000. 7. A continuaci\u00f3n mostramos el histograma de alturas masculinas de nuestro set de datos heights: Seg\u00fan este gr\u00e1fico, \u00bfcu\u00e1ntos hombres hay entre 63.5 y 65.5? - 10 - 24 - 34 - 100 8. \u00bfAproximadamente qu\u00e9 porcentaje son m\u00e1s bajos que 60 pulgadas? - 1% - 10% - 25% - 50% 9. Seg\u00fan el siguiente gr\u00e1fico de densidad, \u00bfaproximadamente qu\u00e9 proporci\u00f3n de estados de EE. UU. tiene poblaciones con m\u00e1s de 10 millones de personas? - 0.02 - 0.15 - 0.50 - 0.55 10. A continuaci\u00f3n hay tres gr\u00e1ficos de densidad. \u00bfEs posible que sean del mismo set de datos? \u00bfCu\u00e1l de las siguientes afirmaciones es cierta? - Es imposible que sean del mismo set de datos. - Son del mismo set de datos, pero los gr\u00e1ficos son diferentes debido a errores de c\u00f3digo. - Son del mismo set de datos, pero el primer y el segundo gr\u00e1fico suavizan de menos y el tercero sobresuaviza. - Son del mismo set de datos, pero el primero no est\u00e1 en la escala logar\u00edtmica, el segundo suaviza de menos y el tercero sobresuaviza. 8.8 La distribuci\u00f3n normal Los histogramas y los gr\u00e1ficos de densidad proveen excelentes res\u00famenes de una distribuci\u00f3n. \u00bfPero podemos resumir a\u00fan m\u00e1s? A menudo vemos el promedio y la desviaci\u00f3n est\u00e1ndar utilizada como resumen estad\u00edstico: \u00a1un resumen de dos n\u00fameros! Para comprender cu\u00e1les son estos res\u00famenes y por qu\u00e9 se usan tanto, necesitamos comprender la distribuci\u00f3n normal. La distribuci\u00f3n normal, tambi\u00e9n conocida como curva de campana y distribuci\u00f3n Gausiana, es uno de los conceptos matem\u00e1ticos m\u00e1s famosos de la historia. Una raz\u00f3n para esto es que se producen distribuciones aproximadamente normales en muchas situaciones, incluyendo las ganancias de juego, las alturas, los pesos, la presi\u00f3n arterial, las puntuaciones en las pruebas estandarizadas y los errores de medici\u00f3n experimentales. Hay explicaciones para esto y las describiremos m\u00e1s adelante. Aqu\u00ed nos enfocamos en c\u00f3mo la distribuci\u00f3n normal nos ayuda a resumir los datos. En vez de usar datos, la distribuci\u00f3n normal se define con una f\u00f3rmula matem\u00e1tica. Para cualquier intervalo \\((a,b)\\), la proporci\u00f3n de valores en ese intervalo se puede calcular utilizando esta f\u00f3rmula: \\[\\mbox{Pr}(a < x < b) = \\int_a^b \\frac{1}{\\sqrt{2\\pi}s} e^{-\\frac{1}{2}\\left( \\frac{x-m}{s} \\right)^2} \\, dx\\] No necesitan memorizar o comprender los detalles de la f\u00f3rmula. Sin embargo, recuerden que est\u00e1 completamente definida por solo dos par\u00e1metros: \\(m\\) y \\(s\\). El resto de los s\u00edmbolos en la f\u00f3rmula representan los extremos del intervalo que determinamos \\(a\\) y \\(b\\) y las conocidas constantes matem\u00e1ticas \\(\\pi\\) y \\(e\\). Estos dos par\u00e1metros, \\(m\\) y \\(s\\), se conocen respectivamente como el promedio (o la media) y la desviaci\u00f3n est\u00e1ndar (SD por sus siglas en ingl\u00e9s) de la distribuci\u00f3n. La distribuci\u00f3n es sim\u00e9trica, centrada en el promedio, y la mayor\u00eda de los valores (alrededor del 95%) est\u00e1n dentro de 2 SD del promedio. As\u00ed es como se ve la distribuci\u00f3n normal cuando el promedio es 0 y la SD es 1: El hecho de que la distribuci\u00f3n est\u00e1 definida por solo dos par\u00e1metros implica que si la distribuci\u00f3n de un set de datos se puede aproximar con una distribuci\u00f3n normal, toda la informaci\u00f3n necesaria para describir la distribuci\u00f3n se puede codificar en solo dos n\u00fameros: el promedio y la desviaci\u00f3n est\u00e1ndar. Ahora vamos a definir estos valores para una lista arbitraria de n\u00fameros. Para una lista de n\u00fameros contenidos en un vector x, el promedio se define como: y la SD se define como: que puede interpretarse como la distancia promedio entre los valores y su promedio. Calculemos los valores para la altura de los varones que almacenaremos en el objeto \\(x\\): Se pueden usar las funciones predefinidas mean y sd (tengan en cuenta que por razones que se explican en la Secci\u00f3n [16.2](models.html#data-driven-model), sd divide por length(x)-1 en vez de length(x)) : A continuaci\u00f3n tenemos un gr\u00e1fico de la densidad suave de nuestras alturas de estudiantes en azul y la distribuci\u00f3n normal con media = 69.3 y SD = 3.6 trazado como una l\u00ednea negra: La distribuci\u00f3n normal parece ser una buena aproximaci\u00f3n aqu\u00ed. Ahora veremos cu\u00e1n bien funciona esta aproximaci\u00f3n para predecir la proporci\u00f3n de valores dentro de los intervalos. 8.9 Unidades est\u00e1ndar Para los datos que se distribuyen aproximadamente normalmente, es conveniente pensar en t\u00e9rminos de unidades est\u00e1ndar. La unidad est\u00e1ndar de un valor nos dice cu\u00e1ntas desviaciones est\u00e1ndar se alejan del promedio. Espec\u00edficamente, para un valor x de un vector X, definimos el valor de x en unidades est\u00e1ndar como z = (x - m)/s con m y s el promedio y la desviaci\u00f3n est\u00e1ndar de X, respectivamente. \u00bfPor qu\u00e9 es conveniente hacer esto? Primero, repasen la f\u00f3rmula para la distribuci\u00f3n normal y observen que lo que se est\u00e1 exponiendo es \\(-z^2/2\\) con \\(z\\) equivalente a \\(x\\) en unidades est\u00e1ndar. El hecho de que el m\u00e1ximo de \\(e^{-z^2/2}\\) es cuando \\(z=0\\) explica por qu\u00e9 la distribuci\u00f3n ocurre en el promedio. Tambi\u00e9n explica la simetr\u00eda ya que \\(- z^2/2\\) es sim\u00e9trico alrededor de 0. Adem\u00e1s, noten que si convertimos los datos distribuidos normalmente a unidades est\u00e1ndar, podemos saber r\u00e1pidamente si, por ejemplo, una persona es aproximadamente promedio (\\(z=0\\)), entre los m\u00e1s altos (\\(z \\approx 2\\)), entre los m\u00e1s bajos (\\(z \\approx -2\\)), una ocurrencia extremadamente rara (\\(z > 3\\) o \\(z < -3\\)). Recuerden que no importa cu\u00e1les sean las unidades originales, estas reglas aplican a cualquier dato que es aproximadamente normal. En R, podemos obtener unidades est\u00e1ndar usando la funci\u00f3n scale: Ahora para ver cu\u00e1ntos hombres hay dentro de 2 SD del promedio, simplemente escribimos: \u00a1La proporci\u00f3n es aproximadamente 95%, que es lo que predice la distribuci\u00f3n normal! Para tener hasta m\u00e1s confirmaci\u00f3n de que la aproximaci\u00f3n es precisa, podemos usar gr\u00e1ficos Q-Q (quantile-quantile plots en ingl\u00e9s). 8.10 Gr\u00e1ficos Q-Q Una manera sistem\u00e1tica de evaluar cu\u00e1n bien se ajusta la distribuci\u00f3n normal a los datos es verificar si las proporciones observadas y predecidas coinciden. En general, este es el acercamiento del gr\u00e1fico Q-Q. Primero, definimos los cuantiles te\u00f3ricos para la distribuci\u00f3n normal. En los libros de estad\u00edsticas usamos el s\u00edmbolo \\(\\Phi(x)\\) para definir la funci\u00f3n que nos da la probabilidad de que una distribuci\u00f3n normal est\u00e1ndar sea menos que \\(x\\). Entonces, por ejemplo, \\(\\Phi(-1.96) = 0.025\\) y \\(\\Phi(1.96) = 0.975\\). En R, podemos evaluar \\(\\Phi\\) utilizando la funci\u00f3n pnorm: La funci\u00f3n inversa \\(\\Phi^{-1}(x)\\) nos da los cuantiles te\u00f3ricos para la distribuci\u00f3n normal. As\u00ed, por ejemplo, \\(\\Phi^{-1}(0.975) = 1.96\\). En R, podemos evaluar el inverso de \\(\\Phi\\) utilizando la funci\u00f3n qnorm. Tengan en cuenta que estos c\u00e1lculos son para la distribuci\u00f3n normal est\u00e1ndar por defecto (media = 0, desviaci\u00f3n est\u00e1ndar = 1), pero tambi\u00e9n podemos definirlos para cualquier distribuci\u00f3n normal. Podemos hacer esto usando los argumentos mean y sd en las funciones pnorm y qnorm. Por ejemplo, podemos usar qnorm para determinar cuantiles de una distribuci\u00f3n con promedio y desviaci\u00f3n est\u00e1ndar espec\u00edficos: Para la distribuci\u00f3n normal, todos los c\u00e1lculos relacionados con los cuantiles se realizan sin datos, de ah\u00ed el nombre de cuantiles te\u00f3ricos. Pero los cuantiles se pueden definir para cualquier distribuci\u00f3n, incluso una emp\u00edrica. Entonces si tenemos datos en un vector \\(x\\), podemos definir el cuantil asociado con cualquier proporci\u00f3n \\(p\\) como el \\(q\\) para el cual la proporci\u00f3n de valores por debajo de \\(q\\) es \\(p\\). Usando el c\u00f3digo R, podemos definir q como el valor para el cual mean(x <= q) = p. Observen que no todo \\(p\\) tiene un \\(q\\) para el cual la proporci\u00f3n es exactamente \\(p\\). Hay varias maneras de definir el mejor \\(q\\) como se discute en la p\u00e1gina de ayuda para la funci\u00f3n quantile. Como ejemplo r\u00e1pido, para los datos de alturas masculinas, vemos que: Alrededor del 50% son m\u00e1s bajos o iguales a 69 pulgadas. Esto implica que si \\(p=0.50\\), entonces \\(q=69.5\\). La idea de un gr\u00e1fico Q-Q es que si sus datos est\u00e1n bien aproximados por la distribuci\u00f3n normal, los cuantiles de sus datos deber\u00edan ser similares a los cuantiles de una distribuci\u00f3n normal. Para construir un gr\u00e1fico Q-Q, hacemos lo siguiente: - Definimos un vector de \\(m\\) dimensiones \\(p_1, p_2, para las proporciones \\(p_1, \\dots, p_m\\) usando sus datos. Nos referimos a estos como los cuantiles muestrales (sample quantiles en ingl\u00e9s). - Definimos un vector de cuantiles te\u00f3ricos para las proporciones \\(p_1, \\dots, p_m\\) para una distribuci\u00f3n normal con el mismo promedio y desviaci\u00f3n est\u00e1ndar que los datos. - Graficamos los cuantiles muestrales versus los cuantiles te\u00f3ricos. Construyamos un gr\u00e1fico Q-Q usando el c\u00f3digo R. Comiencen definiendo el vector de proporciones. Para obtener los cuantiles de los datos, podemos usar la funci\u00f3n quantile as\u00ed: Para obtener los cuantiles te\u00f3ricos de distribuci\u00f3n normal con promedio y desviaci\u00f3n est\u00e1ndar (SD) correspondiente, utilizamos la funci\u00f3n qnorm: Para ver si coinciden o no, los graficamos uno contra el otro y dibujamos la l\u00ednea de identidad: Noten que este c\u00f3digo es mucho m\u00e1s sencillo c\u00f3digo anterior se incluye para ayudar a describir los gr\u00e1ficos Q-Q. Sin embargo, en la pr\u00e1ctica es m\u00e1s f\u00e1cil usar el c\u00f3digo ggplot2 descrito en la Secci\u00f3n [8.16](distributions.html#other-geometries): Mientras que para la ilustraci\u00f3n anterior usamos 20 cuantiles, el valor por defecto de la funci\u00f3n geom_qq es utilizar la misma cantidad de cuantiles como datos. 8.11 Percentiles Antes de continuar, definamos algunos t\u00e9rminos que se usan com\u00fanmente en el an\u00e1lisis exploratorio de datos. Percentiles son casos especiales de cuantiles que se usan com\u00fanmente. Los percentiles son los cuantiles que se obtienen al configurar el \\(p\\) a \\(0.01, 0.02, ..., 0.99\\). Denominamos, por ejemplo, el caso de \\(p=0.25\\) el cuartilo inferior, ya que nos da un n\u00famero para el cual el 25% de los datos est\u00e1n por debajo. El percentil m\u00e1s famoso es el 50, tambi\u00e9n conocido como la mediana. Para la distribuci\u00f3n normal, la mediana y el promedio son los mismos, pero generalmente este no es el caso. Otro caso especial que recibe un nombre son los cuartiles, que se obtienen al configurar \\(p=0.25,0.50\\) y \\(0.75\\). 8.12 Diagramas de caja Para presentar los diagramas de caja (boxplots en ingl\u00e9s), volveremos a los datos de asesinatos de EE. UU. Supongan que queremos resumir la distribuci\u00f3n de la tasa de asesinatos. Usando la t\u00e9cnica de visualizaci\u00f3n de datos que hemos aprendido, podemos ver que la aproximaci\u00f3n normal no aplica aqu\u00ed: En este caso, el histograma anterior o un gr\u00e1fico de densidad suave servir\u00eda como un resumen relativamente sucinto. Ahora supongan que los que est\u00e1n acostumbrados a recibir solo dos n\u00fameros como res\u00famenes nos piden un resumen num\u00e9rico m\u00e1s compacto. Aqu\u00ed Tukey ofreci\u00f3 algunos consejos. Primero, recomend\u00f3 proveer un resumen de cinco n\u00fameros compuestos por el rango junto con los cuartiles (los percentiles 25, 50 y 75). Adem\u00e1s, Tukey sugiri\u00f3 ignorar los valores at\u00edpicos (outliers en ingl\u00e9s) al calcular el rango y, en su lugar, graficarlos como puntos independientes. Ofreceremos una explicaci\u00f3n detallada de los valores at\u00edpicos m\u00e1s adelante. Finalmente, recomend\u00f3 que grafic\u00e1ramos estos n\u00fameros como una \"caja\" con \"bigotes\" as\u00ed: con el cuadro definido por los percentiles 25% y 75% y los bigotes mostrando el rango. La distancia entre estos dos se llama el rango intercuartil. Los dos puntos son valores at\u00edpicos seg\u00fan la definici\u00f3n de Tukey. La mediana se muestra con una l\u00ednea horizontal. A partir de este gr\u00e1fico sencillo, hoy conocido como un diagrama de caja, sabemos que la mediana es de aproximadamente 2.5, que la distribuci\u00f3n no es sim\u00e9trica y que el rango es de 0 a 5 para la gran mayor\u00eda de los estados con dos excepciones. Discutimos c\u00f3mo crear diagramas de caja en la Secci\u00f3n [8.16](distributions.html#other-geometries). 8.13 Estratificaci\u00f3n En el an\u00e1lisis de datos, a menudo dividimos las observaciones en grupos seg\u00fan los valores de una o m\u00e1s variables asociadas con esas observaciones. Por ejemplo, en la siguiente secci\u00f3n dividimos los valores de altura en grupos seg\u00fan una variable de sexo: hembras y varones. Llamamos a este procedimiento estratificaci\u00f3n y nos referimos a los grupos resultantes como estratos. La estratificaci\u00f3n es com\u00fan en la visualizaci\u00f3n de datos porque a menudo estamos interesados en c\u00f3mo la distribuci\u00f3n de variables difiere entre los diferentes subgrupos. Veremos varios ejemplos a lo largo de esta parte del libro. Revisaremos el concepto de estratificaci\u00f3n cuando aprendamos regresi\u00f3n en el Cap\u00edtulo [17](regression.html#regression) y en la parte de machine learning del libro. 8.14 Estudio de caso: describiendo alturas de estudiantes (continuaci\u00f3n) Usando el histograma, los gr\u00e1ficos de densidad y los gr\u00e1ficos Q-Q, nos hemos convencido de que los datos de altura masculina se aproximan bien con una distribuci\u00f3n normal. En este caso, le damos a ET un resumen muy sucinto: las alturas masculinas siguen una distribuci\u00f3n normal con un promedio de 69.3 pulgadas y una SD de 3.6 pulgadas. Con esta informaci\u00f3n, ET tendr\u00e1 una buena idea de qu\u00e9 esperar cuando conozca a nuestros estudiantes varones. Sin embargo, para proporcionar una imagen completa, tambi\u00e9n debemos proveer un resumen de las alturas femeninas. Aprendimos que los diagramas de caja son \u00fatiles cuando queremos comparar r\u00e1pidamente dos o m\u00e1s distribuciones. Aqu\u00ed vemos las alturas para varones y hembras: El diagrama inmediatamente demuestra que los varones son, en promedio, m\u00e1s altos que las hembras. Las desviaciones est\u00e1ndar parecen ser similares. Pero, \u00bfla aproximaci\u00f3n normal tambi\u00e9n funciona para los datos de altura femenina recopilados por la encuesta? Esperamos que sigan una distribuci\u00f3n normal, al igual que los varones. Sin embargo, los gr\u00e1ficos exploratorios revelan que la aproximaci\u00f3n no es tan \u00fatil: Vemos algo que no observamos para los varones: el gr\u00e1fico de densidad tiene una segunda protuberancia. Adem\u00e1s, el gr\u00e1fico Q-Q muestra que los puntos m\u00e1s altos tienden a ser m\u00e1s altos de lo esperado por la distribuci\u00f3n normal. Finalmente, tambi\u00e9n vemos cinco puntos en el gr\u00e1fico Q-Q que sugieren alturas m\u00e1s bajas de lo esperado para una distribuci\u00f3n normal. Al nuevamente informar a ET, es posible que necesitemos proveer un histograma en lugar de solo el promedio y la desviaci\u00f3n est\u00e1ndar para las alturas femeninas. Sin embargo, releemos la cita de Tukey y nos damos cuenta de que hemos notado lo que no esper\u00e1bamos ver. Si observamos otras distribuciones de altura femenina, encontramos que est\u00e1n bien aproximadas con una distribuci\u00f3n normal. Entonces, \u00bfpor qu\u00e9 son diferentes nuestras alumnas? \u00bfEs nuestra clase un requisito para el equipo femenino de baloncesto? \u00bfHay una proporci\u00f3n peque\u00f1a de mujeres que dicen ser m\u00e1s altas de lo que son? Otra explicaci\u00f3n, quiz\u00e1s m\u00e1s probable, es que en el formulario en que los estudiantes ingresaron sus alturas, FEMALE era el sexo predeterminado y algunos varones ingresaron sus alturas, pero olvidaron cambiar la variable de sexo. En cualquier caso, la visualizaci\u00f3n de datos ha ayudado a descubrir una posible falla en nuestros datos. Con respecto a los cinco valores m\u00e1s peque\u00f1os, noten que estos valores son: Debido a que estas son alturas autoreportadas, una posibilidad es que las estudiantes quisieron ingresar 5'1\", 5'2\", 5'3\" o 5'5\". 8.15 Ejercicios 1. Defina variables que contengan las alturas de varones y hembras de esta tenemos para cada una? 2. Supongan que no podemos hacer un gr\u00e1fico y queremos comparar las distribuciones una al lado de otra. No podemos simplemente enumerar todos los n\u00fameros. En cambio, veremos los percentiles. Cree una tabla de cinco filas que muestre female_percentiles y male_percentiles con los percentiles 10, 30, 50, ..., 90 para cada sexo. Luego, cree un data frame con estas dos como columnas. 3. Estudie los siguientes diagramas de caja que muestran los tama\u00f1os de poblaci\u00f3n por pa\u00eds: \u00bfQu\u00e9 continente tiene el pa\u00eds con el mayor tama\u00f1o de poblaci\u00f3n? 4. \u00bfQu\u00e9 continente tiene la mediana de tama\u00f1o poblacional m\u00e1s grande? 5. \u00bfCu\u00e1l es la mediana del tama\u00f1o poblacional de \u00c1frica al mill\u00f3n m\u00e1s cercano? 6. \u00bfQu\u00e9 proporci\u00f3n de pa\u00edses en Europa tiene poblaciones menos de 14 millones? - 0.99 - 0.75 - 0.50 - 0.25 7. Si utilizamos una transformaci\u00f3n logar\u00edtmica, \u00bfqu\u00e9 continente de los anteriores tiene el mayor rango intercuartil? 8. Cargue el set de datos de altura y cree un vector x con solo las alturas masculinas: \u00bfQu\u00e9 proporci\u00f3n de los datos est\u00e1 entre 69 y 72 pulgadas (m\u00e1s alto que 69, pero m\u00e1s bajo o igual a 72)? Sugerencia: use un operador l\u00f3gico y mean. 9. Supongan que lo \u00fanico que sabe sobre los datos es el promedio y la desviaci\u00f3n est\u00e1ndar. Use la aproximaci\u00f3n normal para estimar la proporci\u00f3n que acaba de calcular. Sugerencia: comience calculando el promedio y la desviaci\u00f3n est\u00e1ndar. Luego use la funci\u00f3n pnorm para predecir las proporciones. 10. Note que la aproximaci\u00f3n calculada en la pregunta nueve est\u00e1 muy cerca del c\u00e1lculo exacto en la primera pregunta. Ahora realice la misma tarea para valores m\u00e1s at\u00edpicos. Compare el c\u00e1lculo exacto y la aproximaci\u00f3n normal para el intervalo (79,81]. \u00bfCu\u00e1ntas veces mayor es la proporci\u00f3n real que la aproximaci\u00f3n? 11. Aproxime la distribuci\u00f3n de hombres adultos en el mundo como distribuci\u00f3n normal con un promedio de 69 pulgadas y una desviaci\u00f3n est\u00e1ndar de 3 pulgadas. Usando esta aproximaci\u00f3n, calcule la proporci\u00f3n de hombres adultos que miden 7 pies de alto o m\u00e1s, conocidos como seven footers. Sugerencia: use la funci\u00f3n pnorm. 12. Hay alrededor de mil millones de hombres entre las edades de 18 y 40 en el mundo. Use su respuesta a la pregunta anterior para estimar cu\u00e1ntos de estos hombres (de 18 a 40 a\u00f1os) miden siete pies de altura o m\u00e1s en el mundo. 13. Hay alrededor de 10 jugadores de la Asociaci\u00f3n Nacional de Baloncesto (NBA) que miden 7 pies de altura o m\u00e1s. Usando la respuesta a las dos preguntas anteriores, \u00bfqu\u00e9 proporci\u00f3n de los seven footers del mundo, entre 18 a 40 a\u00f1os, est\u00e1n en la NBA? 14. Repita los c\u00e1lculos realizados en la pregunta anterior para la altura del baloncelista Lebron James: 6 pies y 8 pulgadas. Hay alrededor de 150 jugadores que son al menos tan altos. 15. Al responder a las preguntas anteriores, descubrimos que no es raro que un jugador de siete pies se convierta en jugador de la NBA. Entonces, \u00bfque ser\u00eda una cr\u00edtica justa de nuestros c\u00e1lculos? - La pr\u00e1ctica y el talento son lo que hacen a un gran jugador de baloncesto, no la altura. - La aproximaci\u00f3n normal no es apropiada para alturas. - Como se observa en la pregunta 10, la aproximaci\u00f3n normal tiende a subestimar los valores at\u00edpicos. Es posible que haya m\u00e1s seven footers de lo que predijimos. - Como se observa en la pregunta 10, la aproximaci\u00f3n normal tiende a sobreestimar los valores at\u00edpicos. Es posible que haya menos seven footers de lo que predijimos. 8.16 Geometr\u00edas ggplot2 En [7](ggplot2.html#ggplot2), presentamos ggplot2 para la visualizaci\u00f3n de datos. Aqu\u00ed demostramos c\u00f3mo generar gr\u00e1ficos relacionados con distribuciones, espec\u00edficamente los gr\u00e1ficos que se muestran anteriormente en este cap\u00edtulo. 8.16.1 Diagramas de barras Para generar un diagrama de barras (barplots en ingl\u00e9s), podemos usar la geometr\u00eda geom_bar. Por defecto, R cuenta los casos en cada categor\u00eda y dibuja una barra. Aqu\u00ed vemos el diagrama de barras para las regiones de Estados Unidos. A menudo ya tenemos una tabla con una distribuci\u00f3n que queremos presentar como diagrama de barras. Aqu\u00ed tenemos un ejemplo de [#> 3 North Central 12 0.235] [#> 4 West 13 0.255] Ya no queremos que geom_bar cuente, sino que simplemente grafique una barra a la altura proporcionada por la variable proportion. Para esto necesitamos proveer x (las categor\u00edas) e y (los valores) y usar la opci\u00f3n stat=\"identity\". 8.16.2 Histogramas Para generar histogramas, utilizamos geom_histogram. Al revisar la p\u00e1gina de ayuda para esta funci\u00f3n, vemos que el \u00fanico argumento requerido es x, la variable para la cual construiremos un histograma. No usamos la x porque sabemos que es el primer argumento. El c\u00f3digo se ve as\u00ed: Si ejecutamos el c\u00f3digo anterior, nos da un mensaje: stat_bin()utilizando bins = 30. Elija un mejor valor con binwidth. Anteriormente utilizamos un tama\u00f1o de compartimiento de 1 pulgada, por lo que el c\u00f3digo se ve as\u00ed: Finalmente, si por razones est\u00e9ticas queremos a\u00f1adir color, usamos los argumentos descritos en la p\u00e1gina de ayuda. Tambi\u00e9n a\u00f1adimos etiquetas y un +] [ggtitle(\"Histogram\")] 8.16.3 Gr\u00e1ficos de densidad Para crear una densidad suave, usamos geom_density. Para hacer un gr\u00e1fico de densidad suave con los datos que anteriormente visualizamos como un histograma, podemos usar este c\u00f3digo: Para rellenar con color, podemos usar el argumento fill. Para cambiar la suavidad de la densidad, utilizamos el argumento adjust para multiplicar el valor por defecto por ese adjust. Por ejemplo, si queremos que el par\u00e1metro de suavizado sea el doble de grande, usamos: 8.16.4 Diagramas de caja La geometr\u00eda para crear diagramas de caja es geom_boxplot. Como ya hemos discutido, los diagramas de caja son \u00fatiles para comparar distribuciones. Por ejemplo, a continuaci\u00f3n vemos las alturas mostradas anteriormente para las mujeres, pero aqu\u00ed en comparaci\u00f3n con los hombres. Para esta geometr\u00eda, necesitamos los argumentos x como las categor\u00edas y los argumentos y como los valores: 8.16.5 Gr\u00e1ficos Q-Q Para gr\u00e1ficos Q-Q, usamos la geometr\u00eda geom_qq. De la p\u00e1gina de ayuda, aprendemos que necesitamos especificar el sample (aprenderemos sobre samples en un cap\u00edtulo posterior). Aqu\u00ed tenemos el gr\u00e1fico Q-Q para alturas de varones: Por defecto, la variable muestral se compara con una distribuci\u00f3n normal con un promedio de 0 y una desviaci\u00f3n est\u00e1ndar de 1. Para cambiar esto, utilizamos el argumento dparams seg\u00fan la p\u00e1gina de ayuda. Para a\u00f1adir una l\u00ednea de identidad, simplemente asignen otra capa. Para l\u00edneas rectas, usamos la funci\u00f3n geom_abline. La l\u00ednea por defecto es la l\u00ednea de identidad (pendiente = 1, intercepto = 0). Otra opci\u00f3n aqu\u00ed es escalar los datos primero y luego hacer un gr\u00e1fico Q-Q contra la distribuci\u00f3n normal est\u00e1ndar. 8.16.6 Im\u00e1genes No hemos tenido que usar im\u00e1genes para los conceptos descritos en este cap\u00edtulo, pero los usaremos en la Secci\u00f3n [10.14](principios-de-visualizaci\u00f3n-de-datos.html#vaccines), as\u00ed que presentamos las dos geometr\u00edas utilizadas para crear im\u00e1genes: geom_tile y geom_raster. Se comportan de manera similar; para ver c\u00f3mo difieren, consulten la p\u00e1gina de ayuda. Para crear una imagen en ggplot2, necesitamos un data frame con las coordenadas x e y, as\u00ed como los valores asociados con cada uno de estos. Aqu\u00ed tenemos un data frame: Tengan en cuenta que esta es la versi\u00f3n tidy de una matriz, matrix(1:120, 12, 10). Para graficar la imagen, usamos el siguiente c\u00f3digo: Con estas im\u00e1genes, a menudo querr\u00e1n cambiar la escala de color. Esto se puede hacer a trav\u00e9s de la capa scale_fill_gradientn. [x Secci\u00f3n [7.13](ggplot2.html#qplot), presentamos qplot como una funci\u00f3n \u00fatil cuando necesitamos hacer un diagrama de dispersi\u00f3n r\u00e1pido. Tambi\u00e9n podemos usar qplot para hacer histogramas, diagramas de densidad, diagramas de caja, gr\u00e1ficos Q-Q y m\u00e1s. Aunque no provee el nivel de control de ggplot, qplot es definitivamente \u00fatil, ya que nos permite hacer un gr\u00e1fico con un peque\u00f1o fragmento de c\u00f3digo. Supongan que tenemos las alturas femeninas en un objeto x: Para hacer un histograma r\u00e1pido podemos usar: La funci\u00f3n adivina que queremos hacer un histograma porque solo proveemos una variable. En la Secci\u00f3n [7.13](ggplot2.html#qplot), vimos que si le damos dos variables a qplot, autom\u00e1ticamente crea un diagrama de dispersi\u00f3n. Para hacer un gr\u00e1fico Q-Q r\u00e1pido, tienen que usar el argumento sample. Recuerden que podemos a\u00f1adir capas tal como lo hacemos con ggplot. Si proveemos un factor y un vector num\u00e9rico, obtenemos un gr\u00e1fico como el que vemos abajo. Tengan en cuenta que en el c\u00f3digo estamos utilizando el argumento data. Como el data frame no es el primer argumento en qplot, tenemos que usar el operador de punto. Tambi\u00e9n podemos seleccionar una geometr\u00eda espec\u00edfica mediante el uso del argumento geom. Entonces, para convertir el diagrama anterior en un diagrama de caja, usamos el siguiente c\u00f3digo: Tambi\u00e9n podemos usar el argumento geom para generar un gr\u00e1fico de densidad en lugar de un histograma: Aunque no tanto como con ggplot, tenemos cierta flexibilidad para mejorar los resultados de qplot. Mirando la p\u00e1gina de ayuda, vemos varias formas en que podemos mejorar el aspecto del histograma anterior. Por ejemplo: Nota t\u00e9cnica: La raz\u00f3n por la que usamos I(\"black\") es porque queremos que qplot trate \"black\" como un car\u00e1cter en lugar de convertirlo en un factor. Este es el comportamiento por defecto dentro de aes, que se llama internamente aqu\u00ed. En general, la funci\u00f3n I se usa en R para decir \"mant\u00e9ngalo como est\u00e1\". 8.17 Ejercicios 1. Ahora vamos a usar la funci\u00f3n geom_histogram para hacer un histograma de las alturas en el set de datos height. Al leer la documentaci\u00f3n para esta funci\u00f3n, vemos que requiere solo una asignaci\u00f3n, los valores que se utilizar\u00e1n para el histograma. Haga un histograma de todos los gr\u00e1ficos. \u00bfCu\u00e1l es la variable que contiene las alturas? sex heights height heights$height 2. Ahora cree un objeto ggplot usando el pipe para asignar los datos de altura a un objeto ggplot. Asigne height a los valores de x a trav\u00e9s de la funci\u00f3n aes. 3. Ahora estamos listos para a\u00f1adir una capa para hacer el histograma. Utilice el objeto creado en el ejercicio anterior y la funci\u00f3n geom_histogram para hacer el histograma. 4. Cuando ejecutamos el c\u00f3digo en el ejercicio anterior, recibimos la advertencia: stat_bin() utilizando bins = 30. Elija un mejor valor con binwidth. Utilice el argumento binwidth para cambiar el histograma creado en el ejercicio anterior para usar compartimientos de tama\u00f1o de 1 pulgada. 5. En lugar de un histograma, vamos a hacer un gr\u00e1fico de densidad suave. En este caso, no crearemos un objeto, sino haremos y mostraremos el gr\u00e1fico con una l\u00ednea de c\u00f3digo. Cambie la geometr\u00eda en el c\u00f3digo utilizado anteriormente para hacer una densidad suave en lugar de un histograma. 6. Ahora vamos a hacer un gr\u00e1fico de densidad para varones y hembras por separado. Podemos hacer esto usando el argumento group. Asignamos grupos a trav\u00e9s del mapeo est\u00e9tico, ya que cada punto necesita un grupo antes de hacer los c\u00e1lculos necesarios para estimar una densidad. 7. Tambi\u00e9n podemos asignar grupos a trav\u00e9s del argumento color. Esto tiene el beneficio adicional de que utiliza el color para distinguir los grupos. Cambie el c\u00f3digo anterior para usar color. 8. Adem\u00e1s, podemos asignar grupos a trav\u00e9s del argumento fill. Esto tiene el beneficio adicional de que usa colores para distinguir los grupos as\u00ed: Sin embargo, aqu\u00ed la segunda densidad se traza sobre la primera. Podemos hacer que las curvas sean m\u00e1s visibles mediante el uso de alpha blending para a\u00f1adir transparencia. Establezca el par\u00e1metro alfa a 0.2 en la funci\u00f3n geom_density para hacer este cambio. "}