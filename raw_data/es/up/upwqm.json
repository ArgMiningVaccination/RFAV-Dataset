{"title": "PDF", "author": "PDF", "url": "http://deeea.urv.cat/public/PROPOSTES/pub/pdf/1515pub.pdf", "hostname": "PDF", "description": "PDF", "sitename": "PDF", "date": "PDF", "cleaned_text": "DE UN BEB\u00c9 TITULACI\u00d3N: INGENIER\u00cdA AUTOM\u00c1 TICA Y ELECTR\u00d3NICA INDUSTRIAL AUTOR: Miguel Mar\u00eda Garc\u00eda Jim\u00e9nez DIRECTOR: Enrique Cant\u00f3 Navarro FECHA: Mayo / 2011. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 2 INDICE: 1 Introducci\u00f3n y Objetivos ....................................................................................... 4 1.1 Introducci\u00f3n................................................................................................... 4 1.2 Antecedentes.................................................................................................. 5 1.3 Objetivo del Proyecto .................................................................................... 8 2 Memoria descriptiva.............................................................................................. 9 2.1 Nociones sobre la Temperatura Corporal...................................................... 9 2.1.1 Definici\u00f3n .............................................................................................. 9 2.1.2 Zonas de Lectura ................................................................................. 10 2.1.3 Valores, Alteraciones y Terminolog\u00eda................................................. 10 2.2 M\u00f3dulo 1: Equipo Inal\u00e1mbrico c on Sensor de Temperatura....................... 12 2.2.1 Diagrama de Bloques........................................................................... 12 2.3 Medici\u00f3n de la Temperatur a Corporal. Sensores. ....................................... 14 Se\u00f1al. .......................................................... 26 2.3.5 Sensores de Temperatur a con Semiconductores. ................................ 27 2.3.6 Elecci\u00f3n Final...................................................................................... 30 2.4 Comunicaci\u00f3n Wireless entre M\u00f3dulos....................................................... 33 2.4.1 ZigBee ................................................................................................. 33 2.4.2 IEEE 802.15.4 ..................................................................................... 35 2.4.2.1 Arquitectura de los Protocolos........................................................ 36 2.4.2.2 Nivel F\u00edsico..................................................................................... 36 2.4.2.3 Nivel Enlace de Datos..................................................................... 37 2.4.3 Especificaci\u00f3n Zigbee.......................................................................... 38 2.4.4 Dispositivos que Constituyen una Red Zigbee.................................... 39 2.4.5 Comunicaciones y Descubrimie ntos de Dispositivos.......................... 40 2.4.6 Modos de Funcionamiento .................................................................. 40 2.4.7 Modelo de Redes Zigbee ..................................................................... 43 2.4.8 Otros Medios de Transmisi\u00f3n de Datos y Elecci\u00f3n Final ................... 46 2.5 M\u00f3dulos Zigbee en el Mercado................................................................... 51 2.5.1 Elecci\u00f3n Final...................................................................................... 52 2.6 El Microcontrolador .................................................................................... 54 Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 32.6.1 Funci\u00f3n ................................................................................................ 54 2.6.2 Requisitos ............................................................................................ 54 2.6.3 Alternativas.......................................................................................... 56 2.6.4 Elecci\u00f3n Final...................................................................................... 56 2.7 M\u00f3dulo 2: Equipo de Sobremesa ................................................................ 58 2.7.1 Funciones:............................................................................................ 58 2.7.2 Diagrama de m\u00f3dulo de comunicaci\u00f3n inal\u00e1mbrica. ............................................................................................ ....................................................................................... 64 2.8 Manual de Funcionamiento ......................................................................... 67 3 MEMORIA DE C\u00c1LCULO................................................................................ 68 3.1 Diagrama de Flujo M\u00f3dulo 1: Equi po Inal\u00e1mbrico con Sensor de T\u00aa......... 68 3.2 Diagrama de Flujo M\u00f3dulo 2: M\u00f3dulo de Sobremesa ................................ 74 3.3 Bater\u00eda M\u00f3dulo 1: M\u00f3dulo inal\u00e1mbrico ...................................................... 83 3.4 Datos experimentales................................................................................... 85 4 PLANOS.............................................................................................................. 86 5 PRESUPUESTO.................................................................................................. 93 5.1 Mediciones .................................................................................................. 93 5.2 Cuadro de Precios Unitarios........................................................................ 93 5.3 Cuadro de Precios Descompuestos.............................................................. 95 5.4 Presupuesto.................................................................................................. 99 5.5 Resumen del Presupuesto .......................................................................... 100 6 CONCLUSIONES............................................................................................. 101 7 ANEXOS........................................................................................................... 103 7.1 Programa en CCS M\u00f3dulo 1...................................................................... 103 7.2 Programa en CCS M\u00f3dulo 2...................................................................... 109 7.3 Ficheros ..................................................................................................... 127 Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 41 Introducci\u00f3n y Objetivos 1.1 Introducci\u00f3n Han pasado alrededor de 2.500 a\u00f1os desd e que se fund\u00f3 la primera Escuela de Medicina Occidental. Muchos han sido los m\u00e9di cos e investigadores que han ido desde la anestesia a la vacuna, pasando por el endosco pio y los antibi\u00f3ticos. Numerosos han sido los inventos y descubrimientos que se han producido en el \u00faltimo siglo y medio que han permitido sentar las bases de la actual ciencia m\u00e9dica. Para muchos, estos avances han pasado inadvertidos a lo largo de los a\u00f1os debido al trepidante ritmo tecnol\u00f3gico que le ha dado la tecnolog\u00eda. Hace s\u00f3lo unos ciento cincuenta a\u00f1os parec\u00eda casi un sue\u00f1o realizar una operaci \u00f3n quir\u00fargica sin que el paciente sufriera. Hoy en d\u00eda, las intervenciones resultan menos traum\u00e1ticas y lo s per\u00edodos postoperatorios se han reducido notablemente gracias a la presenci a de la tecnolog\u00eda en el ejercicio de la medicina. Se han aplicado cada vez m\u00e1s y m\u00e1s tec nolog\u00edas para logr ar las condiciones \u00f3ptimas en cualquier intervenci\u00f3n quir\u00fargica. Se est\u00e1n utilizando los avances no s\u00f3lo para curar sino tambi\u00e9n para prevenir enfermedades as\u00ed como para todo tipo de investigaciones m\u00e9dicas, las cuales, gracias a la tecnolog\u00eda ha n realizado importantes descubrimientos. Los expertos se han ocupado de la incorporaci\u00f3n de los avances t ecnol\u00f3gicos en la pr\u00e1ctica de la medicina, por lo que se prev\u00e9 un cambio radical en la ciencia m\u00e9dica del futuro. En la actualidad, la tecnolog\u00eda m\u00e9dica ha traspasado la frontera de hospitales y centros de salud y d\u00eda a d\u00eda se incorporan nue vos equipos que mejoran la calidad de vida de los ciudadanos. Estos equipos basan su \u00e9xito en su senci llez de uso, la calidad y precisi\u00f3n de sus medidas y su bajo coste. Como ejemplos, pode mos citar los medidores de tensi\u00f3n arterial de mu\u00f1eca, term\u00f3metros digitales, medidor es de glucosa en sangre, puls\u00edmetros, aud\u00edfonos... En el presente proyecto, se implementar\u00e1 un dispositivo de medici\u00f3n de temperatura de bajo coste y wireless, que perm itir\u00e1 conocer la temperatura de una persona, adulta o beb\u00e9, a distancia. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 51.2 Antecedentes La temperatura corporal es una de las cons tantes vitales que nos indica el estado de salud de una persona, ya sea en su estado adulto o durante la ni\u00f1ez. La fiebre (temperatura corporal elevada) es uno de los s\u00edntomas que nos indican enfermedad. Existen en el mercado muchos tipos de term\u00f3metros para medir la temperatura, adem\u00e1s de diferentes m\u00e9todos , cada uno ofrece ventajas y desventajas de acuerdo a la edad, colaboraci\u00f3n y personalidad de la persona o ni\u00f1o a la que se va a medir la temperatura. Los term\u00f3metros que podemos en contrar son los siguientes: Temperatura t\u00e1ctil. Es la medici\u00f3n de la temperatura utili zando el tacto tocando a la persona, este m\u00e9todo no ofrece ninguna garant\u00eda acerca del nive l exacto de la temperatura, simplemente es una forma de saber si tiene fiebre para luego usar un term\u00f3metro para la medici\u00f3n. Term\u00f3metro de vidrio. Estos term\u00f3metros ya no se encuentran en el mercado, aunque su utilizaci\u00f3n estuvo muy extendida hasta su prohibici\u00f3n. Pueden medi r la temperara de forma precisa y de f\u00e1cil medici\u00f3n, pero requieren mayor tiempo para ha cer las mediciones (oral y rectal 3 minutos, axilar 8 a 10 minutos). Al ser de vidrio pueden romperse con facilidad, por lo que no son aconsejados debido a que el vidrio roto y su contenido de mercurio (t\u00f3xico) son da\u00f1inos para la salud, tienen la punta s\u00f3lida y son de dif\u00edcil lectura porque se debe buscar el \u00e1ngulo en el cual se puede visualizar la banda de mercurio. Figura 1. Term\u00f3metro de vidrio Term\u00f3metros digitales Sirven para medir la fiebre de forma precis a, r\u00e1pida, segura y f\u00e1 cil de leer y f\u00e1cil medici\u00f3n. Precisa porque utilizan sensores de temperatura; r\u00e1pida porque basta un minuto para obtener la medida; segura porque cuentan con una punta flexible, donde se ubica el sensor, lo que les da menor probabilidad a romperse y no contienen mercurio; y f\u00e1ciles de leer porque cuentan con una pant alla digital que muestra la temperatura obtenida de la medici\u00f3n. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 6 Figura 2. Term\u00f3metro digital Term\u00f3metros de o\u00eddo Son los m\u00e1s costosos, estos term\u00f3metros miden el calor emitido en el t\u00edmpano y el tejido circundante en el interior del conduc to auditivo por medio de un infrarrojo, se obtiene una medici\u00f3n precisa siempre y cuando se haya colocado correctamente dentro del canal auditivo, de lo contra rio, el infrarrojo no podr\u00e1 medi r la temperatura o arrojar\u00e1 un dato err\u00f3neo. El tiempo de la medici\u00f3n es el m\u00e1s r\u00e1pido, y son f\u00e1cile s de leer al contar con una pantalla digital. Figura 3. Term\u00f3metro de o\u00eddo Term\u00f3metros de tira pl\u00e1stica Es un dispositivo que se coloca en la frente de los ni\u00f1os y dan valores de temperatura poco confiables, son de f\u00e1cil lectura pero al igua l que el m\u00e9todo de medici\u00f3n de la temperatura t\u00e1ctil, le i ndican si el ni\u00f1o tiene fiebre, y es un anticipo al uso de otro tipo de term\u00f3metro. Figura 4. Term\u00f3metros de tira pl\u00e1stica Term\u00f3metros de chupete Dispositivo que se coloca en los chupone s de los beb\u00e9s, sus valores tambi\u00e9n son poco confiables, al igual que la temperatura t\u00e1ctil y los term\u00f3metros de tira pl\u00e1stica s\u00f3lo indican si el ni\u00f1o tiene fiebre Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 7 Figura 5. Term\u00f3metro de chupete Term\u00f3metro infrarrojo Este tipo de term\u00f3metros no necesitan del contacto f\u00edsico para medir la temperatura. En pocos segundos, a partir de sensores infrarrojos permiten obtener un valor de la temperatura de la piel sobre la cu al est\u00e1n dirigidos. La distancia a la que se debe encontrar el term\u00f3metro var\u00ed a entre los 0'5 cm. a los 10 cm. Figura 6. Term\u00f3metro infrarrojo A pesar de existen multitud de tipos de term\u00f3metros, todos tienen un elemento com\u00fan de funcionamiento: - En personas enfermas o ni\u00f1os, es necesaria la presencia de un adulto para realizar la medici\u00f3n. - La lectura de la medici\u00f3n se realiza al lado de la persona de la cual se quiere saber su temperatura. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 81.3 Objetivo del Proyecto Todos los padres han vivido alguna vez la siguiente situaci\u00f3n: despertarse a media noche para encontrar a su hijo parado al lado de su cama, rojo, acalorado y sudando. La frente de su peque\u00f1o est\u00e1 caliente. De inme diato, sospechan que su hijo tiene fiebre. A partir de ese momento, la m\u00e1xima preo cupaci\u00f3n de los padres es vigilar la temperatura corporal de su hijo. Esto implica de spertar al ni\u00f1o varias veces para tomarle la temperatura. Actualmente, todos los term\u00f3metros existentes en el mercado necesitan de un adulto para medir la temperatura en ni\u00f1os y en bebes. Durante el d\u00eda, la necesidad de estar con el ni\u00f1o para medir su temperatura puede parecer no muy importante, sin embargo, por la noche, implica que tanto el ni \u00f1o como el adulto, deben despertarse varias veces a lo largo de la noche para controla r la temperatura. Este hecho, hace que tanto los padres como los ni\u00f1os no consigan descansar, co menzando el nuevo d\u00eda m\u00e1s agotados. En el presente proyecto, se desea impl ementar un dispositivo que monitorice la temperatura corporal de un beb\u00e9 o un ni\u00f1o , y que env\u00ede esta medici\u00f3n mediante un sistema inal\u00e1mbrico a otro di spositivo el cual avisar\u00e1 a los padres cuando el ni\u00f1o presente fiebre. Para conseguir este cometido, se desarrollar\u00e1n dos dispositivos, un equipo de sobremesa y un equipo a bater\u00eda, ambos se comunicar\u00e1n de manera inal\u00e1mbrica. El dispositivo de sobremesa actuar\u00e1 de interfaz con los usuarios. Su misi\u00f3n es recibir la informaci\u00f3n que le env\u00ede el equipo de bater\u00eda, mostrarla por pantalla y avisar en caso de fiebre. El dispositivo de bate r\u00eda se encontrar\u00e1 en permanente contacto con el ni\u00f1o, realizar\u00e1 la medici\u00f3n de temperatura y la e nviar\u00e1 al dispositivo de sobremesa. En ambos equipos, se buscar\u00e1 su bajo c onsumo, bajo coste, peque\u00f1as dimensiones y alta precisi\u00f3n y resoluci\u00f3n, si endo estas caracter\u00eds ticas m\u00e1s cr\u00edticas en el caso del dispositivo a bater\u00edas. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 92 Memoria descriptiva 2.1 Nociones sobre la Temperatura Corporal 2.1.1 Definici\u00f3n La temperatura es una magnitud que refleja el nivel t\u00e9rmico de un cuerpo, es decir, su capacidad para ceder energ\u00eda calor\u00edfica. La temperatura de pende del movimiento de las mol\u00e9culas que componen a la sustancia, si \u00e9s tas est\u00e1n en mayor o menor movimiento, ser\u00e1 mayor o menor su temperatura respectivamente, es decir, estar\u00e1 m\u00e1s o menos caliente. El calor es la energ\u00eda que se pierde o gana en ciertos procesos. Por tanto, los t\u00e9rminos de temperatura y calor, aunque relaci onados entre s\u00ed, se refieren a conceptos diferentes: la temperatura es una propiedad de un cuerpo y el calor es un flujo de energ\u00eda entre dos cuerpos a diferentes temperaturas. La temperatura corporal es la medida del grado de calor de un organismo, y desempe\u00f1a un papel importante para determinar las condiciones de supervivencia de los seres vivos. As\u00ed, los seres humanos necesitan un rango muy limitado de temperatura corporal para poder sobrevivir, y tienen que estar protegidos de temperaturas extremas. La temperatura corporal es el equilibrio entre la producci\u00f3n de calor por el cuerpo y su p\u00e9rdida. El centro termorregulador est\u00e1 s ituado en el hipot\u00e1lamo. Cuando la temperatura sobrepasa el nivel normal se activan mecanis mos como vaso dilata ci\u00f3n, hiperventilaci\u00f3n y sudoraci\u00f3n que promueven la p\u00e9rd ida de calor. Si por el cont rario, la temperatura cae por debajo del nivel normal se activan mecan ismos como aumento del metabolismo y contracciones espasm\u00f3dicas que producen los escalofr\u00edos. Para poder hablar de temperatura normal del cuerpo, debemos establecer una diferencia entre la temperat ura de los tejidos profundos del cuerpo y la temperatura cut\u00e1nea. Esto justifica establecer una divisi \u00f3n: temperatura interna, con una temperatura constante y fuertemente regulada; y temperatur a cut\u00e1nea de los tejidos perif\u00e9ricos, cuya temperatura puede oscilar dentro de unos l\u00edmites amplios, dependiendo tanto de la temperatura del ambiente como del grado de defensa ante la p\u00e9rdida de calor y de las actividades particulares. De este modo, el t\u00e9 rmino temperatura corporal no debe emplearse sin tener en cuenta en qu\u00e9 parte del cuerpo tiene lugar la medici\u00f3n. - Temperatura perif\u00e9rica o s uperficial: es la de los constituyentes del revestimiento perif\u00e9rico, como la piel, el tejido subcut\u00e1neo y las porcione s superficiales de las masas musculares cuya funci\u00f3n principal es la de ma ntener una temperatura central constante. La temperatura perif\u00e9rica muestra considerable s variaciones, subie ndo y bajando seg\u00fan el medio ambiente. La temperatura media de la pi el para una persona promedio en un cuarto con temperatura ambiente de 25\u00baC es de 33\u00baC. La temperatura de la piel se puede medir mediante termocuplas o termistores mont ados en contacto con la epidermis. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 10- Temperatura central: la temperatura centr al representa la te mperatura media en \u00e1reas corporales profundas centrales (ejemp los: cerebro, coraz\u00f3n, pulmones, \u00f3rganos abdominales). Se encuentra constituida por la s regiones del cr\u00e1neo, tor\u00e1cica, abdominal, p\u00e9lvica y las porciones m\u00e1s pr ofundas de las masas muscular es de las extremidades. Los seres humanos somos homeot\u00e9rmicos lo que sign ifica que la temperatura corporal interna se mantiene casi constante. En condiciones normales, la temperatura interna del cuerpo fluct\u00faa entre 36'5\u00baC y 37'5\u00baC. 2.1.2 Zonas de Lectura Oral: sublingual utilizando el cl\u00e1sico term\u00f3metro de mercurio durante un tiempo aproximado de cuatro minutos. Se debe tener en cuenta la \u00faltima ingesta; se puede tomar la temperatura m\u00ednimo 15 minutos despu\u00e9s de la ingesta. La temperatur a oral se puede medir en todos los pacientes, excepto, en los que es t\u00e1n inconscientes, sufren confusi\u00f3n mental, convulsiones, afecciones de nariz, boca o ga rganta y los ni\u00f1os menores de 6 a\u00f1os. Rectal: lubricar el term\u00f3metro y proteger la intimidad del paciente. El resultado tiende a ser 0'5\u00baC a 0'7\u00baC mayor que la temp eratura oral. La temperatura rectal es recomendable para el paciente menor de 6 a\u00f1os, a menos, que se le haya practicado cirug\u00eda rectal o presente alg\u00fan tipo de anormalidad en el recto. El canal auditivo: por su proximidad del canal auditivo del hipot\u00e1lamo, la temperatura timp\u00e1nica puede utilizarse como cr iterio para la estimaci\u00f3n de la temperatura interna. De menor precisi \u00f3n que la toma rectal. Axilar: es recomendable en adultos y ni\u00f1os mayores de 6 a\u00f1os, se deja el term\u00f3metro durante 5 minutos. El resultado es 0'5\u00baC menor que la temperatura oral. 2.1.3 Valores, Alteraciones y Terminolog\u00eda En la tabla 1 , se muestra los valores normales de temperatura seg\u00fan la edad. Tabla 1. Valores de la temp eratura seg\u00fan la edad Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 11Los factores que var\u00edan la temperatur a var\u00edan seg\u00fan diversos par\u00e1metros: - Edad: los ni\u00f1os son m\u00e1s susceptibles a las variaciones clim\u00e1ticas. En los ancianos la hipotermia se da por la p\u00e9rdida de gr asa subcut\u00e1nea, dieta inadecuada, cese de actividad y disminuci\u00f3n de los controles termorreguladores. - Ejercicio: por aumento en la producci\u00f3n de calor - Hormonas: en las mujeres la progesterona secretada durante la ovulaci\u00f3n aumenta la temperatura. - Estr\u00e9s: la estimulaci\u00f3n del sistema nervioso simp\u00e1tico aumenta el metabolismo y la producci\u00f3n de calor. - Medio ambiente: las variaciones extremadas de la temperatura ambiental alteran los sistemas termorreguladores de las personas. Cuando la temperatura corporal alcanza valo res anormales se presentan una serie de reacciones: - Pirexia o hipertermia: temp eratura por encima del l\u00edmite superior normal. Se presenta aumento de la frecuencia cardiaca, escalofr\u00edos, piel p\u00e1lida y fr\u00eda y lechos ungueales cian\u00f3ticos, por vasoconstricci\u00f3n. - Hipotermia: temperatura corporal por debajo del limite inferior normal. Se puede presentar somnolencia e incluso coma, lo cual, favorece la inadecuada producci\u00f3n de calor y la aparici\u00f3n de hipotensi\u00f3n, dism inuci\u00f3n de la diures is, desorientaci\u00f3n, sensaci\u00f3n de fr\u00edo y piel p\u00e1lida y fr\u00eda. A la hipertermia se le denomina fiebre. Seg\u00fan la intensidad de la temperatura se puede distinguir entre: - Febr\u00edcula: temper atura hasta los 38\u00baC - Fiebre moderada: temperatura entre 38 y 39\u00baC - Fiebre alta: temperatura superior a 39\u00baC. Seg\u00fan la forma de la curva t\u00e9rmica: - Fiebre continua: oscilaci\u00f3n diaria inferior a un grado - Fiebre remitente: oscilacione s diarias mayores de un grado - Fiebre intermitente: la temperatura descie nde hasta lo normal, para luego ascender nuevamente. - Fiebre recurrente: episodios febriles (fiebr e por encima de 38'3\u00baC) alternados con periodos de temperatura normal por d\u00edas o semanas. Mediante el presente proyecto, se pretende monitorizar la temperatura corporal, detectar los episodios febriles o de hipote rmia y avisar a la persona encargada de cuidar a la persona enferma. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 122.2 M\u00f3dulo 1: Equipo Inal\u00e1mbrico con Sensor de Temperatura El m\u00f3dulo aut\u00f3nomo sensor ser\u00e1 el enca rgado de realizar la medici\u00f3n de la temperatura y transmitirla, es el m\u00f3dulo que se encontrar\u00e1 siempre en el bebe al cual se quiere monitorizar la temperatura. En su dise\u00f1o se han tenido en cuenta las siguientes necesidades: - Se alimentar\u00e1 mediante un sistema de bater\u00edas y su consumo ser\u00e1 m\u00ednimo. Durante m\u00e1s del 90% de su tiempo se encontrar\u00e1 funcionando en modo de bajo consumo y \u00fanicamente se activar\u00e1n todas sus funciones para realizar la medici\u00f3n de temperatura y enviar los da tos a otro dispositivo. - Su tama\u00f1o ser\u00e1 el menor posible, ya que se situar\u00e1 en el usuario y su dise\u00f1o debe ser tal que no provoque mole stias al llevarlo encima. - En su dise\u00f1o deben considerarse los m\u00edni mos componentes posibles para minimizar el consumo y el espacio. - Controlar\u00e1 el estado de la bater\u00eda y deber\u00e1 enviar un aviso de bater\u00eda baja al usuario. - El sensor de temperatura ser\u00e1 lo m\u00e1s exact o y preciso posible en su medida y debe poder funcionar en modo de bajo consumo. - El sistema inal\u00e1mbrico a utilizar debe se r de bajo consumo. La distancia m\u00e1xima a transmitir ser\u00e1 de unos 30 metros y la tasa de datos de transferencia ser\u00e1 baja. 2.2.1 Diagrama de Bloques En la figura 7 se puede observar el diagrama funcional de bloques del M\u00f3dulo Aut\u00f3nomo Sensor. bater\u00eda uCsensor T\u00aa Sist. Wireless Figura 7. Diagrama funcional de bloques Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 13Sus principales componentes ser\u00e1n: - El sensor de temperatura. Debe ser un sensor de peque\u00f1o tama\u00f1o, que permita dos modos de funcionamiento, modo norma l y modo de bajo consumo. Lo m\u00e1s integrado posible para que su consumo sea m\u00ednimo. - El sistema de comunicaci\u00f3n wireless. La elecci\u00f3n del sistema de comunicaci\u00f3n ser\u00e1 importante ya que ser\u00e1 el recurso que c onsuma m\u00e1s potencia. Se buscar\u00e1 un sistema de bajo consumo, capaz de entablar com unicaci\u00f3n con otro dispositivo a 30 metros y su tasa de transferencia no tiene porque ser muy elevada. - El microprocesador. Se encargar\u00e1 de gest ionar los modos de funcionamiento del m\u00f3dulo. Se encargar\u00e1 de tomar el dato de temperatura proveniente del sensor y enviarlo al sistema de comunicaci\u00f3n wireless para su env\u00edo al otro dispositivo. Tambi\u00e9n debe gestionar el estado de la ba ter\u00eda y enviar la informaci\u00f3n de bater\u00eda baja al modulo de sobremesa. - La bater\u00eda: proporcionara la alimentaci \u00f3n a todo el sistema. Debe ser lo m\u00e1s peque\u00f1a posible y que propor cione una autonom\u00eda sufici ente. En funci\u00f3n de las necesidades de consumo y tensi\u00f3n de funcionamiento del resto de dispositivos se decidir\u00e1 sus caracter\u00edsticas. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 142.3 Medici\u00f3n de la Temperatura Corporal. Sensores. Se puede realizar la medici\u00f3n de la temper atura corporal de diferentes maneras que var\u00edan de acuerdo al costo del equipo, precisi\u00f3n, linealidad y rango. A continuaci\u00f3n expondr\u00e9 los princi pales tipos de sensores. 2.3.1 Termopares Los termopares son los sensores de temperatura utilizados con mayor frecuencia porque son sensores precisos, relativamente econ\u00f3micos, que pueden operar en un amplio rango de temperaturas. El termopar fue descubierto por Thomas Seebeck en 1831. \u00c9l descubri\u00f3 que una corriente el\u00e9ctrica flu\u00eda en un circuito cerrado de dos metale s distintos cuando una de las uniones era calentada. La magnitud y direcci\u00f3n de la corriente son funci\u00f3n de la diferencia de temperatura de las uniones y de las propie dades t\u00e9rmicas de los metales usados en el circuito. A este fen\u00f3meno se le conoce como efecto Seebeck. Figura 8. Corriente provocada por el Efecto Seebeck Si abrimos este circuito, obtenemos una diferencia de potencial peque\u00f1a (milivoltios), la cual es directamente proporci onal a la temperatura de la uni\u00f3n y a la composici\u00f3n de los dos metales. Figura 9. Metales distintos creando un temopar Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 15 Figura 10. Los termopares son econ\u00f3micos y pueden operan en un amplio rango de temperaturas. Existen diferentes tipos de termopares as ignados con letras may\u00fasculas que indican su composici\u00f3n de acuerdo al American naci onal Standards Institute (ANSI). Los tipos de termopares m\u00e1s comunes incluyen B, E, K, N, R, S y T. Tabla 2. Diferentes tipos de termopares Las curvas de calibraci\u00f3n para los diferent es tipos de termopares son las descritas en la siguiente tabla: Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 16 Figura 11. Curvas de calibraci\u00f3n Medici\u00f3n. La diferencia de potencial, en un term opar, no puede ser medida directamente debido a que la uni\u00f3n termopar con el instru mento de medida crea un nuevo circuito termoel\u00e9ctrico. Por ejemplo, si conectamos un volt\u00edmetro a un termopar tipo T (cobre-constantan) para conocer su diferencia de potencial. Figura 12. Conexi\u00f3n volt\u00edmetro El circuito equivalente que obt endr\u00edamos ser\u00eda el siguiente: Figura 13. Circuito equivalente Se quiere conocer el valor de V1, pero al conectar el volt\u00edm etro estamos creando dos uniones m\u00e1s U2 y U3. Debido a que U3 es del mismo metal (cobre-cobre), la Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 17diferencia de potencial de V3 es cero vo ltios (V3=0=. Sin embargo, U2 que es una uni\u00f3n de cobre-constantan crea una V2 en oposici\u00f3n a V1, por lo que la lectura resultante del volt\u00edmetro V ser\u00e1 proporcional a la diferencia de temperaturas U1 y U2. Es necesario conocer U2 para determinar V1, Una manera de determinar U2 es colocar f\u00edsicamente esta uni \u00f3n dentro de un ba\u00f1o de hielo, forzando entonces a que su temperatura sea 0\u00baC y estableciendo U2 como la Uni\u00f3n de referencia (Uni\u00f3n fr\u00eda). Figura 14. Uni\u00f3n de referencia U2 por junta fr\u00eda De esta manera la tensi\u00f3n le\u00edda en el volt\u00edmetro ser\u00e1 directamente proporcional a la temperatura de U1, ya que la te mperatura de U2 es igual a cero. En el primer ejemplo se ha utilizado un termopar tipo T, pero si usamos un termopar tipo J (hierro-constantan), en este caso tendr\u00edamos una uni\u00f3n m\u00e1s que afectar\u00eda la medici\u00f3n. Por supuesto que una so luci\u00f3n ser\u00eda colocar U2 y U3 dentro del ba\u00f1o de hielo y el problema est\u00e1 resuelto. Pero existe otra soluci\u00f3n, \u00e9sta consiste en tener U2 y U3 a una misma temperatura conocida y aisladas el\u00e9ctricamente. Esto se logra con un bloque isot\u00e9rmico cuya temperatura tiene que ser medida mediante otro sensor, normalmente un termistor o PT100. Figura 15. Bloque de temperatura con PT100 Si el termistor o PT100 determinan la te mperatura de referencia de U2 y U3, se puede determinar entonces la tensi\u00f3n el\u00e9ctrica de referencia de esas uniones (Vref), por lo tanto V1 ser\u00e1 la diferencia de V menos la Vref. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 18Para este procedimiento de compensaci\u00f3n por uni\u00f3n fr\u00eda, exis ten dos t\u00e9cnicas: - compensaci\u00f3n por hardware - compensaci\u00f3n por software. En la compensaci\u00f3n por hardware , se inserta una fuente vari able de voltaje dentro del circuito para cancelar los voltajes termoel\u00e9ctrico s par\u00e1sitos. La fuente variable de voltaje genera un voltaje de compen saci\u00f3n de acuerdo con la temper atura ambiente, para as\u00ed poder adicionar el voltaje correcto para cancelar las se\u00f1ales termoel\u00e9ctricas indeseadas. Cuando se cancelan estas se\u00f1ales par\u00e1s itas, la \u00fanica se\u00f1al que mide el dispositivo de adquisici\u00f3n de datos es el voltaje desde la uni\u00f3n del term opar. Con la compensaci\u00f3n por hardware, la temperatura en los terminales del sistema de adquisici\u00f3n de datos es irrelevante ya que los voltajes par\u00e1sitos del termopar se han cancelado. La mayor desventaja de la compensaci\u00f3n por hardware es que cada tipo de termopar de be poseer un tipo sepa rado de circuito que pueda adicionar el voltaje correcto de compen saci\u00f3n; este hecho hace que el circuito sea bastante costoso. La compens aci\u00f3n por hardware es genera lmente menos exacta que la compensaci\u00f3n por software. En la compensaci\u00f3n por software el c\u00e1lculo de la tensi\u00f3n de referencia y a su vez el c\u00e1lculo de la diferencia de tensiones es re alizado por un microproces ador. Este \u00faltimo es sin duda el procedimiento de medici\u00f3n de termopares m\u00e1s com\u00fan. 2.3.2 RTD's. Las termorresistencias son sensores de temperatura basados en el cambio de resistividad que sufren las estructuras de los metales con la temperatura, la cual es aproximadamente lineal para ciertos metales. Una termo resistencia, o RTD, se fabri ca para tener un valor Ro nominal a una temperatura dad (p.e. 100 ohms a 0\u00baC). Al medir su resi stencia a una temperatura desconocida y al compararla con Ro, se puede conocer la difere ncia de resistencia. Como la caracter\u00edstica de la resist encia en funci\u00f3n de la temperatura es tambi\u00e9n conocida, el cambio de temperatura desde el punto inicial ser\u00e1 conocida. Los materiales usados como RTDs's son: - cobre - balco (aleaci\u00f3n de hierro-n\u00edquel) - tungsteno - iridio - Platino. Debido a su baja resistividad, el oro y la plata no son usados como RTD's. El tungsteno posee alta resistividad, pero se le reserva para muy alta temperatura, al ser muy quebradizo y dif\u00edcil de maquinar. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 19 El cobre se usa a veces como RTD. Su baja resistividad hace que el elemento sea m\u00e1s largo que uno de platino, pero su linealid ad y bajo costo lo hacen una alternativa econ\u00f3mica. Su l\u00edmite de operaci\u00f3n es de 120\u00baC. Los elementos de n\u00edquel o aleaciones de n\u00edquel son m\u00e1s no lineales y tienden a modificar su valor de re sistencia con el tiempo. Figura 16. Curva R-T de varios metales. El platino es el m\u00e1s popular de las RTD' s, debido a su caracter\u00edstica muy cercana a la linealidad en un rango amplio de temperatur as, estable a largo plazo. El costo de los PRTD's (RTD de platino) se vieron reducidos al implemen tarse en pel\u00edcula delgada. Las princ\u00edpiales caracter\u00edsticas encontradas en el platino son: - Estabilidad qu\u00edmica: resistencia a la oxidaci\u00f3n y corrosi\u00f3n - Facilidad de manufactura - Disponibilidad de alambre de alta pureza - Buena reproducibilidad de caracter\u00edsticas el\u00e9ctricas. Esta \u00faltima permite el poder reemplazar el elemento sensor sin tener que recalibrar un instrumento. Los valores t\u00edpicos son de 100, 500 y 1000 ohms. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 20 Las RTD's se identifican por el metal del que se componen (seg\u00fan la tabla peri\u00f3dica) y la resistencia que presen tan a 0\u00baC. Ejemplo: Pt100, Pt1000, Ni120, Cu200, etc. la tipos: - Clase A: \u00b1 0'15 \u00baC B: \u00b1 0'30 \u00baC 0\u00baC Luego presentan una degradaci\u00f3n de la pr ecisi\u00f3n hacia los extremos del rango. Por ejemplo, seg\u00fan el est\u00e1ndar IEC751, para clase B, se tiene: Tabla 3. Precisi\u00f3n para clase B Constructivamente las RTD se pue den encontrar de dos formas: - Construcci\u00f3n tipo Meyer. Consisten en enro llar sobre una cruz de mica una bobina helicoidal de platino, y montar el conjunto dentro de un tubo de vidrio. Al ser el coeficiente de dilataci\u00f3n de la mica muy bajo, el esfuerzo sobre el alambre ser\u00e1 bajo, evitando la variaci\u00f3n de resist encia por estiramiento, obteniendo as\u00ed un dispositivo estable. A su vez, al estar bobinado a la vez de enrollado, se maximiza su resistencia para un tama\u00f1o dado. - RTD de pel\u00edcula delgada de platino. La longitud de alambre y di\u00e1metro para controlar el valor de Ro se reemplaza por una estructura meandro muy delgada sobre un substrato (hasta de 3 micrones), de all\u00ed las bajas corrientes de medici\u00f3n permitidas. El RTD de pel\u00edcula delgada ofr ece un dispositivo peque\u00f1o, que responde r\u00e1pidamente a los cambios bruscos de temp eratura y reduce la cap taci\u00f3n de ruido por campos magn\u00e9ticos variables, problema s que poseen los del tipo bobinado. El inconveniente frente a los bobina dos es que son menos estables. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 21 Figura 17. RTD de pel\u00edcula delgada En el caso de la RTD de platino, su funci \u00f3n como sensor se basa en la dependencia con la temperatura de la resistividad del metal. La relaci\u00f3n existente puede ser descrita por el siguiente polinomio caracter\u00edstico: (1) donde: R(T) = Resistencia medida. Ro = Resistencia nominal a 0\u00baC Las constantes est\u00e1n definidas por el es t\u00e1ndar internacional (DIN EN 60751) para sensores de platino: (2) El coeficiente b es tan peque\u00f1o que para la mayor\u00eda de las aplicaciones puede considerarse una relaci\u00f3n lineal entre R(T) y T. Medici\u00f3n. La medida de una RTD se puede realizar de diferentes m\u00e9todos. En todos ellos, es necesaria un circuito de acondicionamiento de la se\u00f1al. Medici\u00f3n por m\u00e9todo de cero: puente de tres hilos. (3) Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 22El valor del RTD a la temperatura de calibr aci\u00f3n del puente ser\u00e1 el valor de R3. Se busca que R1, R2 y R3 tengan coeficientes de variaci\u00f3n de resistencia con la temperatura nulo a la temperatura de trabajo. Medici\u00f3n de temperatura con RTD por comparaci\u00f3n. En este m\u00e9todo se compara la magnitud de sconocida con otra de la misma especie conocida. El patr\u00f3n y la inc\u00f3gnita coexisten en la medici\u00f3n. Puede se r de deflexi\u00f3n o cero. El m\u00e9todo por fuentes de corriente es de deflexi\u00f3n, al obtener una tensi\u00f3n de salida proporcional a la diferencia de resistencia en tre RTD y Ro, que bien podr\u00eda actuar sobre un instrumento calibrado en \u00baC. El esquema b\u00e1sico se r\u00eda el siguiente: Figura 18. Esquema b\u00e1sico comparaci\u00f3n Al circular corriente por el sensor, se produce un e rror por autocalentamiento. 2.3.3 Termistores Los termistores aprovechan la dependencia que presenta la resistencia el\u00e9ctrica de cualquier material conductor con la temperatura. En el caso de los termistores, se utilizan materiales semiconductores de alta sensibilid ad, espec\u00edficamente dise\u00f1ados para que su resistencia dependa agudamente de la temper atura del elemento. Existen termistores de coeficiente positivo PTC (su resistencia aument a con la temperatura) o negativo NTC (su resistencia disminuye con la temperatura), siendo este \u00faltimo m\u00e1s t\u00edpico y de bajo costo. Figura 19. Distintas formas de los termistores NTC y PTC Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 23 En los termistores se observan relaciones de la resistencia con la temperatura que no son lineales, sino m\u00e1s bien de car\u00e1cter exponencial. Para termistores comerciales comunes, la relaci\u00f3n es del la resistencia (en ohms) observada a la temperatura \"T\", la que depende de un primer par\u00e1metro dado por la resistencia a una temperatura conocida \"R(T=To)\", t\u00edpicamente 25\u00baC, y de un segundo par\u00e1metro de ajuste \"x\". Figura 20. Curva caracter\u00edstica de los termistores En el caso de los termistore s, dado que se mide resist encia, se debe cuidar, en primer lugar, que la resisten cia de los cables de conexi\u00f3n (que tambi\u00e9n cambia con la temperatura) no incida sobre la medici\u00f3n y, en segundo luga r, que la corriente que circule por el elemento para medir su resistencia sea lo suficientemente peque\u00f1a como para calentar s\u00f3lo m\u00ednimamente el propio sens or. A ese fin se utilizan sistemas de compensaci\u00f3n que incorporan cables id\u00e9nticos pero sin el sensor, en el brazo adyacente de un puente de Wheastone, am\u00e9n de circular una corriente nula por el sensor. Los termistores al igual que cualquier dispositivo construido en base a semiconductores tienen algunos par\u00e1metros que deben ser considerados para su elecci\u00f3n. Los t\u00e9rminos que con mayor frecuencia se emplean son: - Resistencia a potencia cero: Resistencia del termistor cuando no existe efecto de autocalentamiento. - Variaci\u00f3n de la resistencia con la temper atura: Sensitividad, t\u00edpicamente de 4W/\u00baC. - Estabilidad: Capacidad de un termistor para mantener sus caracter\u00edsticas dentro del rango 0'03\u00baC/a en un periodo de 12 a\u00f1os. - Autocalentamiento: Potencia disipada en el termistor Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 24- Temperatura de operaci\u00f3n m\u00e1xima: Temperat ura m\u00e1xima en la cual el termistor conservar\u00e1 su operaci\u00f3n con caracter\u00ed sticas de estabilidad aceptables. Las principales caracter\u00edsticas que poseen son: - Alta sensibilidad - Alto coeficiente t\u00e9rmico - Envejecen - Tienen un tiempo de respuesta variable - Sufren de autocalentamiento - No son lineales - Son de tama\u00f1o reducido - Son susceptibles a contaminaci\u00f3n - Figure 21. Resistencia contra Temperatura para un Termistor T\u00edpico y RTD Medici\u00f3n. Los termistores son dispositivos sensibles, se les debe administrar una corriente de excitaci\u00f3n y luego leer el voltaje a trav\u00e9s de los terminales. Si el calor adicional no se puede disipar, el calentamient o causado por la corriente de excitaci\u00f3n puede incrementar la temperatura del elemento de detecci\u00f3n. El auto calentamiento generalmente cambia la resistencia del termistor, provocando errore s en las medidas. Los efectos del auto calentamiento se pueden disminuir al admi nistrar una baja corriente de excitaci\u00f3n. La manera m\u00e1s f\u00e1cil de conectar un RTD o termistor a un dispositivo de medida es con una conexi\u00f3n de 2 cables. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 25 Figura 22. Medida RTD/Termistor de 2 Cables Con este m\u00e9todo, los dos cables que alimenta n al RTD o termistor con su corriente de excitaci\u00f3n tambi\u00e9n se usan para medir el voltaje en el sens or. Debido a la baja resistencia nominal de los RTDs, la precis i\u00f3n de las medidas se puede ver afectada significativamente por la resistencia del cable. Por ejemplo, los cables con una resistencia de 1 W conectados a un RTD de platino de 100 W causan un error de medida del 1%. Un m\u00e9todo de conexi\u00f3n de 3 cables o 4 cables puede eliminar los efectos de resistencia del cable. La conexi\u00f3n coloca las terminales en una trayectoria de alta impedancia a trav\u00e9s del dispositivo de medi da, eliminando de manera efectiva los errores causados por la resistencia del cable. No es necesario usar un m\u00e9todo de conexi\u00f3n de 3 o 4 cables para termistores ya que \u00e9stos generalmente tienen valores de resistencia nominal m\u00e1s altos que los RTDs. A continuaci\u00f3n se muestra un diagrama de conexi\u00f3n de 4 cables. Figura 23. Medida RTD de 4 Cables Las se\u00f1ales de salida del RTD y del termisto r por lo general est\u00e1 n en el rango de los milivoltios, lo cual los hace sensibles al ruido. Los filtros paso bajo son usados com\u00fanmente en sistemas de adquisici\u00f3n de datos de RTD y termistor para eliminar de forma efectiva el ruido de alta frecuencia en las medidas. Por ejemplo, los filtros paso bajo son \u00fatiles para eliminar el ruido de l\u00ednea de potencia de 50 Hz que se presenta com\u00fanmente en la mayor\u00eda de los laboratorios y plantas. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 262.3.4 Acondicionamiento de la Se\u00f1al. Se requiere acondicionamiento de se\u00f1ales para realizar medidas de temperatura precisas y confiables. Al dise \u00f1ar el sistema de medidas adecuado para un sensor de temperatura, se debe considerar amplificac i\u00f3n, aislamiento, filtros, excitaci\u00f3n, precisi\u00f3n, resoluci\u00f3n y compensaci\u00f3n de junta fr\u00eda (CJC). Amplificaci\u00f3n Las se\u00f1ales de salida des los sensores de temperatura son gene ralmente en rangos de milivoltios, as\u00ed que se debe amplificar la se\u00f1al y prevenir el ruido en su sistema de medidas. Se debe escoger una ganancia que optimice los l\u00edmites de entrada del convertidor anal\u00f3gico a digital (ADC) del hardware. Para mejorar significativamente el rendimiento del ruido de su sistema, se puede amplificar lo s voltajes de bajo nivel cerca de la fuente de se\u00f1al o punto de medida. Aislamiento Los termopares que son montados o so ldados directamente a un material conductivo, como el acero o el agua, introducen otra fuente de ruido. Esta configuraci\u00f3n hace a los termopares particularmente sensib les al voltaje en modo com\u00fan y a lazos a tierra. El aislamiento ayuda a prevenir lazos a tierra y pu ede mejorar dr\u00e1sticamente el rechazo de voltaje en modo com\u00fan. Filtrado Los filtros paso bajo se utilizan com\u00fanmen te para eliminar de manera efectiva el ruido de alta frecuencia en medidas de temperaturas. Por ejemplo, los filtros paso bajo son \u00fatiles para eliminar el ruido de l\u00ednea de poten cia de 60 Hz que se presenta com\u00fanmente en varios laboratorios y plantas. Excitaci\u00f3n Ya que los RTDs y termistores son disposi tivos sensibles, se les debe administrar una corriente de excitaci\u00f3n y luego leer el volta je a trav\u00e9s de los te rminales. Si el calor adicional no se puede disipar, el calentam iento causado por la corriente de excitaci\u00f3n puede incrementar la temperatura del elemento de detecci\u00f3n. El auto calentamiento cambia la resistencia del RTD o termistor, provocando errores en las medidas.. Precisi\u00f3n y Resoluci\u00f3n Al seleccionar el sensor y el hardware de adquisici\u00f3n de datos adecuados, se deben conocer los requerimientos de precisi\u00f3n y reso luci\u00f3n para su aplicac i\u00f3n. Sin embargo los filtros y la amplificaci\u00f3n pueden mejorar signifi cativamente la precisi\u00f3n de las medidas de termopares, de RTDs y de termistores. Adem\u00e1s de las consideraciones de los sensores, el hardware de adquisici\u00f3n de da tos y acondicionamiento de se\u00f1al debe igualar la precisi\u00f3n y la resoluci\u00f3n requerida. Compensaci\u00f3n de Junta Fr\u00eda (CJC) CJC es una tecnolog\u00eda requerida para medida s precisas de termopa res. Un voltaje es generado en la conexi\u00f3n entre el termopar y el terminal de su dispositivo de adquisici\u00f3n de datos. CJC mejora la precisi\u00f3n de sus medidas al proporcionar la temperatura en esta uni\u00f3n Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 27y al aplicar la correcci\u00f3n apr opiada. Es importante conocer c\u00f3mo funciona la CJC porque el error introducido por el sensor CJC se co mpone de cualquier error existente en su medida. Al calcular la precisi\u00f3n del sistema , este error puede ser si gnificante y debe ser considerado Eliminaci\u00f3n de Ruido Las se\u00f1ales de los sensores generalmente est\u00e1n en el rango de los milivoltios, lo cual los hace sensibles al ruido. Los filtros paso bajo se utilizan com\u00fanmente en los sistemas de adquisici\u00f3n de datos de termopares para eliminar de manera efectiva el ruido de alta frecuencia. Tambi\u00e9n se puede reducir el ruido amplif icando los voltajes de bajo nivel cerca de la fuente de se\u00f1al. Otras fuentes de ruidos son debidas a que por ejemplo los termopares, se suelen montar o soldar en materiales conductivos, ha ci\u00e9ndolos particularment e sensibles al ruido en modo com\u00fan y a los lazos de tierra. Un bue n aislamiento ayuda a prevenir que ocurran lazos a tierra y puede mejora r dr\u00e1sticamente el rechazo de ruido en modo com\u00fan. 2.3.5 Sensores de Temperatur a con Semiconductores. La corriente de conducci\u00f3n de una uni\u00f3n p-n polarizada directamente, responde exponencialmente con la tensi\u00f3n de forma dir ecta, e inversa con la temperatura. Si se recuerda la ecuaci\u00f3n caracter\u00edsti ca de funcionamiento de un diodo. (5) donde: q=carga del electr\u00f3n k=constante de boltman T=temperatura Isat=corriente de saturaci\u00f3n De esta ecuaci\u00f3n, se desprende que a corrient e constante, la tensi\u00f3n var\u00eda a raz\u00f3n de -2'2m por cada grado cent\u00edgrado (\u00baC), consid erando el diodo forma do por la uni\u00f3n base- emisor de un transistor bipolar. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 28 (6) Pero adem\u00e1s de la variaci\u00f3n con T, mantie ne una fuerte dependencia de Isat con la temperatura, lo que hace que no sea directamen te utilizable debido a la compleja forma de dependencia con la temperatura. Si se toman N transistores id\u00e9nticos al primero sobre lo que se reparte igualitariamen te la misma corriente Ic. (7) Si se toma la tensi\u00f3n diferencia entr e ambos conjuntos, se tendr\u00e1 una tensi\u00f3n proporcional a la temperatura absoluta pe ro sin tener dependencia alguna con Isat. (8) Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 29De esta manera, puede cons truirse un circuito contenie ndo N+1 transistores NPN, un espejo de corriente PNP y una resistencia es table con la temperatura, como se muestra en la figura siguiente, cuya corriente ser\u00e1 proporcional a la temperatura absoluta, como lo ser\u00e1 igualmente la ca\u00edda de tensi\u00f3n sobre la re sistencia R (que representa la diferencia entre V y Vn de las ecuaciones anteriores). Los sensores basados en este sistema puede n dar su salida seg\u00fan la siguiente tabla: Tabla 4. Tipo de salidas para los sensores Los sensores de temperatura con salida en co rriente se basan en el circuito descrito en la figura anterior, a estos sensores se les denomina sensor de temperatura band-gap. Este tipo de sensores no necesitan calib raci\u00f3n alguna o ajuste externo. La incorporaci\u00f3n de dispositivos digitales in tegrados junto con el sensor reduce el n\u00famero de componentes externos en las apli caciones. As\u00ed, existen circuitos como el MCP9804 de Microchip que pr oporcionan un salida digital I2C como salida de temperatura. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 30 Figura 24. Diagrama de bloques sensor integrado 2.3.6 Elecci\u00f3n Final En base a las necesidades del proyecto y a las caracter\u00edsticas de los diferentes sensores descritos se ha escogido para desarrol lar el proyecto el sensor de temperatura de Microchip MCP9804. El MCP9804 es un sensor de temperatura basado en semiconductores del tipo band- gap. La ventaja del uso de semiconductores en el sensado de temperatura es su capacidad de integraci\u00f3n. En el caso del MCP 9804, viene integrado con un convertidor anal\u00f3gico/digital y con una comunicaci\u00f3n I2C. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 31El uso de un termopar, RTD o termistor imp lica la existencia de un circuito para acondicionar la se\u00f1al. Tipo de sensorAcondicionamiento de se\u00f1al necesariaExactitud Sensibilidad Buena RTD La mejor Muy buena Termistor Muy buena La mejor Integrado lineal MCP9804Muy buena Buena No necesita acondicionamiento de se\u00f1al Tabla 5. Comparativa sensores T\u00aa En el presente proyecto el us o de un circuito acondicionador de se\u00f1al presenta varios inconvenientes. - Se a\u00f1ade un circuito acondicionador a la placa del dispositivo inal\u00e1mbrico. - Se debe controlar el circuito acondiciona dor para que mientras n o e s t \u00e9 e n u s o consuma la m\u00ednima energ\u00eda. - El hecho de utilizar m\u00e1s componentes di scretos incrementa la complejidad del circuito, lo hace m\u00e1s susceptible a fa llos y hace m\u00e1s dif\u00edcil su reparaci\u00f3n. - Un circuito acondicionador aumenta el precio del sistema sensor. En la siguiente tabla se muestra el preci o aproximado de los diferentes sensores. Tipo Sensor Precio (euros) Intercambiabilidad Estabilidad Circuito Acond. TOTAL MCP9804 1.59 excelente buena 0 1.59 Termopar tipo T 4.27 buena media 1 5.27 Termistor 0.7 mala media 1 1.7 RTD - PT100 3.65 excelente buena 1 4.65 Tabla 6. Comparativa precios diferentes sensores Como se puede observar, el sensor m\u00e1s ec on\u00f3mico es el termistor, sin embargo, la necesidad de acondicionar su se\u00f1al lo rele ga al segundo puesto, sie ndo el MCP9804 el m\u00e1s econ\u00f3mico. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 32Existen sensores de temperatura basados en semiconductores m\u00e1s econ\u00f3micos, sin embargo su se\u00f1al de temperatur a es anal\u00f3gica, lo que hace necesaria un acondicionamiento de la se\u00f1al, siendo el precio final similar al MCP9804. En definitiva, el uso del MCP9804 presenta muchas ventajas frente al resto de sensores, entre las que podemos destacar: - facilidad de \u00ednter cambiabilidad, en caso de fallo del sensor - Alta precisi\u00f3n y resoluci\u00f3n - No necesita acondicionar la se\u00f1al de sa lida. Salida digital de temperatura. - Disminuye la complejidad del sistema y aumenta su fiabilidad. - Presenta modo de funcionamiento en ba jo consumo, necesario en sistemas a bater\u00eda. - El conjunto sensor se encuen tra entre los m\u00e1s econ\u00f3micos Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 332.4 Comunicaci\u00f3n Wireless entre M\u00f3dulos ZigBee constituye una de las partes importantes de este proyecto puesto que ser\u00e1 el medio de transmisi\u00f3n elegido para el env\u00edo de los datos, una vez medidos con el sensor de temperatura. Como se ver\u00e1 m\u00e1s adelante, ZigBee puede ser usado para una gran variedad de aplicaciones, como podemos observar en la Figura 25, pero en este caso su utilizaci\u00f3n es para fines de monitorizaci\u00f3n corporal. Figura 25. Aplicaciones tecnolog\u00eda Zigbee En este apartado se tratar\u00e1 de forma amplia y espec\u00edfica el funcionamiento de este tipo de conexi\u00f3n, partiendo de una defini ci\u00f3n de ZigBee y posteriormente estudiando tanto sus principales caracter\u00edsticas como su funcionamiento en una red ZigBee. Otro punto a tener en cuenta es el porqu\u00e9 de su elecci\u00f3n teniendo otros tipos de posibilidades. Para ello se realizar\u00e1 una comparaci\u00f3n con otros medios de transmisi\u00f3n muy parejos a ZigBee. A partir de dicha comparativa podremos entender y asimilar que un medio ZigBee para este tipo de proyecto es lo m\u00e1s adecuado. 2.4.1 ZigBee ZigBee es el nombre de la especificaci\u00f3n de un conjunto de protocolos de alto nivel de comunicaci\u00f3n inal\u00e1mbrica. Esta esp ecificaci\u00f3n define una soluci\u00f3n para comunicaciones inal\u00e1mbricas de bajo coste y consumo. El principal objetivo que pretende satisf acer una red de comunicaci\u00f3n ZigBee es la de comunicar aplicaciones que requieren comunicaciones seguras, con baja tasa de env\u00edo y maximizaci\u00f3n de la vida \u00fatil de sus bater\u00edas. La red, en su conjunto, utilizar\u00e1 una cantidad Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 34muy peque\u00f1a de energ\u00eda de forma que cada dispositivo individual pueda tener una autonom\u00eda de hasta 5 a\u00f1os antes de necesitar un recambio en su sistema de alimentaci\u00f3n. La ZigBee Alliance es el grupo encargado de su desarrollo. La primera versi\u00f3n 1.0 fue aprobada el 14 de diciembre de 2004. En diciembre de 2006 se aprob\u00f3 el protocolo ZigBee 2006, y actualmente se est\u00e1 trabajando en nuevas versiones. El medio de transmisi\u00f3n ZigBee trabaja sobr e la banda ISM para usos industriales, cient\u00edficos y m\u00e9dicos; en concreto, 868MHz en Europa, 915MHz en Estados Unidos y 2.4GHz en todo el mundo. Al ser \u00e9ste \u00faltimo libre en todo el mundo, las empresas optan por esta opci\u00f3n a la hora de dise\u00f1ar. En el ra ngo de frecuencias de 2.4GHz se definen hasta 16 canales, cada uno de ellos con un ancho de banda de 5MHz. La pila de protocolos ZigBee, tambi\u00e9n c onocida como ZigBee Stac k, se basa en el nivel f\u00edsico (PHY) y el cont rol de acceso al medio (MAC) definidos en el est\u00e1ndar IEEE 802.15.4, que desarrolla estos niveles para redes in al\u00e1mbricas de \u00e1rea personal de baja tasa de transferencia (LR-WPAN, Low Rate - Wireless Personal Area Network ). La especificaci\u00f3n ZigBee completa este est\u00e1ndar a\u00f1adiendo cuatro componentes principales: - Nivel de red. - Nivel de aplicaci\u00f3n - Objetos de dispositivo ZigBee (ZDO, ZigBee Device Objects). - Objetos de aplicaci\u00f3n defi nidos por el fabricante. Adem\u00e1s de a\u00f1adir dos capas de alto nivel (n ivel de red y de aplicaci\u00f3n) a la pila de protocolos, el principal cambio es la adici \u00f3n de los ZDO ya que son los responsables de llevar a cabo una serie de cometidos, entre los que se encuentran el mantenimiento de los roles de los dispositivos, la gesti\u00f3n de petic iones de uni\u00f3n a una red, el descubrimiento de otros dispositivos y la seguridad. Tambi\u00e9n hacer referencia a lo s objetos de aplicaci\u00f3n defini dos por el fabricante puesto que permiten la personalizaci\u00f3n y adapt aci\u00f3n, y favorecen la integraci\u00f3n total. Dicha ZigBee Stack ser\u00e1 un elemento a tener en cuenta m\u00e1s adelante puesto que los dispositivos que se usen para implementa r nuestro proyecto deber\u00e1n ser totalmente compatibles con ZigBee y de este modo poder programar la pila de protocolos. En la Figura 26 vemos de forma esquematizada los distintos niveles del est\u00e1ndar 802.15.4 y de la especificaci\u00f3n ZigBee. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 35 Figura 26. Niveles est\u00e1ndar 802.15.4 2.4.2 IEEE 802.15.4 Antes de estudiar la especificaci\u00f3n ZigBee, trataremos los niveles definidos por el est\u00e1ndar IEEE 802.15.4 espec\u00edfico para conexiones inal\u00e1mbricas tales como la nuestra. El est\u00e1ndar no define niveles superiores ni subcap as de interoperabilidad. Existen extensiones, como la especificaci\u00f3n ZigBee, que comple mentan al est\u00e1ndar en la propuesta de soluciones completas. IEEE 802.15.41 es la base sobre la que se de fine la especificaci\u00f3n de ZigBee, cuyo prop\u00f3sito es ofrecer una soluci\u00f3n completa para este tipo de redes construyendo los niveles superiores de la pila de protoc olos que el est\u00e1ndar no cubre. El prop\u00f3sito del est\u00e1ndar es definir los niveles de red b\u00e1sicos para dar servicio a un tipo espec\u00edfico de red inal\u00e1mbrica de \u00e1rea personal (WPAN) centrada en la habilitaci\u00f3n de comunicaci\u00f3n entre dispositivos con bajo coste y velocidad. Se enfatiza el bajo coste de comunicaci\u00f3n con nodos cercanos y sin infraestr uctura, o con muy poca, para favorecer a\u00fan m\u00e1s el bajo consumo. En su forma b\u00e1sica se concibe un \u00e1rea de comunicaci\u00f3n de 10 metros con una tasa de transferencia de 250kbps. Como se ha indicado, la caracter\u00edstica fundamental de 802.15.4 entre las WPAN's es la obtenci\u00f3n de costes de fabricaci\u00f3n excepcionalmente bajos por medio de la sencillez tecnol\u00f3gic a, sin perjuicio de la generalidad o la adaptabilidad. Entre los aspectos m\u00e1s importantes se encuentra la adecuaci\u00f3n de su uso para tiempo real por medio de slots2 de tiempo garantizados, ev itaci\u00f3n de colisiones por CSMA/CA y soporte integrado a las com unicaciones seguras. Tambi\u00e9n se incluyen Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 36funciones de control de consumo de energ\u00ed a como calidad del enlace y detecci\u00f3n de energ\u00eda. 2.4.2.1 Arquitectura de los Protocolos La definici\u00f3n de los distintos niveles se basa en el modelo OSI. Aunque los niveles inferiores (f\u00edsico y enlace de datos) se definen en el est\u00e1ndar 802.15.4, se prev\u00e9 la interacci\u00f3n con el resto de niveles por medio de un subnivel de Control de Enlace L\u00f3gico basado en IEEE 802.2 (LLC, Logical Link Control ), que acceda al Control de Acceso al Medio (MAC) a trav\u00e9s de un subnivel de conv ergencia. La implementaci\u00f3n puede basarse en dispositivos externos o integrar lo todo en dispositivos aut\u00f3nomos. Figura27. Pila de protocolos modelo OSI 2.4.2.2 Nivel F\u00edsico El nivel f\u00edsico (PHY) propor ciona el servicio de tran smisi\u00f3n de datos sobre el medio f\u00edsico propiamente dicho, as\u00ed como la interfaz con la entidad de gesti\u00f3n del nivel f\u00edsico, por medio de la cual se puede acceder a todos los servicios de gesti\u00f3n del nivel y que mantiene una base de datos con inform aci\u00f3n de redes de \u00e1rea personal relacionadas. De esta forma, PHY controla el transcepto r de radiofrecuencia y realiza la selecci\u00f3n de canales junto con el control de consumo y de la se\u00f1al. Como ya se ha comentado con anterioridad, se opera en una de las tres posibles bandas de frecuencia siguientes: - 868-868.8MHz: Europa. Permite de uno a tres canales. - 902-928MHz: Norte Am\u00e9rica. Permite de diez a treinta canales. - 2400-2483.5MHz: Uso en todo el mundo. Permite hasta diecis\u00e9is canales. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 37 Figura 28. Banda de frecuencias La versi\u00f3n original del est\u00e1ndar (2003) es pecifica dos niveles f\u00edsicos basados en Espectro Ensanchado por Secuencia Directa (DSSS, Direct Sequence Spread Spectrum ). Uno de los dos niveles f\u00edsicos trabaja en las bandas de 868/ 915MHz con tasas de transferencia de entre 20 y 40kbps ; el otro nivel trabaja en la banda de 2450MHz con hasta 250kbps. Posteriormente se realiz\u00f3 una revisi \u00f3n en el 2006 incrementando las tasas de datos m\u00e1ximas de las bandas de 868/915MHz, pasando a transmitir hasta 100 y 250kbps. En el nivel f\u00edsico podemos localizar cuatro ni veles f\u00edsicos distintos en base al m\u00e9todo de modulaci\u00f3n usado. Tres de estos cuatro niveles conservan el mecanismo DSSS: las bandas de 868-915MHz que usan modulaci\u00f3n en fa se binaria o por en offset (OQPSK, Offset Quadrature Phase Shift Keying ). de 2450MHz se usa la t\u00e9cnica OQPSK. Adicionalmente, se define una combinaci \u00f3n opcional de modulaci\u00f3n binaria y en amplitud para las bandas de menores frecuencias , basadas por lo tanto en una difusi\u00f3n de espectro paralela, no secuencial (PSSS). Si se usan \u00e9stas bandas de menor frecuencia, se puede cambiar din\u00e1micamente el nivel f\u00edsico usado entre los soportados. 2.4.2.3 Nivel Enlace de Datos En este nivel encontramos el Control de Acceso al Medio (MAC). \u00c9ste transmite tramas MAC usando para ello el canal f\u00edsico. Adem\u00e1s del servicio de datos, ofrece un interfaz de control y regula el acceso al canal f\u00edsico y al balizado de la red. Tambi\u00e9n controla la validaci\u00f3n de las tramas y las asociaciones entre nodos, y garantiza slots de tiempo. Por \u00faltimo, ofrece puntos de enganche para servicios seguros. En el nivel de enlace de datos podemos localizar el Control de Enlace L\u00f3gico (LLC) que hace la funci\u00f3n de interfaz con los nive les superiores de la pila de protocolos. En la figura 29 podemos observar los ni veles definidos por el est\u00e1ndar 802.15.4 y las capas intermedias que posibilitan la com unicaci\u00f3n con los niveles superiores definidos por un tipo de especificaci\u00f3n WPAN, como ZigBee. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 38 Figura 29. Pila de protocolos del est\u00e1ndar IEEE 802.15.4 2.4.3 Especificaci\u00f3n Zigbee Nivel de RED Los cometidos principales del nivel de red son permitir el correcto uso del subnivel MAC, definido por el est\u00e1ndar 802.15.4, y ofr ecer un interfaz adecuado para su uso por parte del nivel inmediatamente superior, el nivel de aplicaci\u00f3n. Sus capacidades son las t\u00edpicas de un nivel de red cl\u00e1sico. Por una parte, la entidad de datos crea y gestiona las unidades de datos del nivel de red a partir del payload del nivel de aplicaci\u00f3n y realiza el ruteo en base a la topolog\u00eda de la red en la que el dispositivo se encuentra. Por otra parte, las funciones de control del nivel de red controlan la c onfiguraci\u00f3n de nuevos dispositi vos y el establecimiento de nuevas redes; puede decidir si un dispositivo colindante pert enece a la red e identifica nuevos routers y vecinos. El control puede detectar as\u00ed mismo la presencia de receptores, lo que posibilita la comunicaci\u00f3n directa y la sincronizaci\u00f3n a nivel MAC. Nivel de APLICACI\u00d3N El nivel de aplicaci\u00f3n es el m\u00e1s alto de finido por la especificaci\u00f3n y, por tanto, la interfaz efectiva en tre el nodo ZigBee y sus usuarios. En \u00e9l se ubican la mayor parte de los componentes definidos por la especificaci\u00f3n: tanto ZDO's, como sus procedimientos de control y los objetos de aplicaci\u00f3n. Componentes principales El ZDO se encarga de la definici\u00f3n del rol de un di spositivo como Coordinador ZigBee o Dispositivo Final. Adem\u00e1s, el ZDO id entifica los dispositivos que se encuentran a un salto en la red (dispositivos vecinos) y los servicios que ofrece n. Tras ello, puede proceder a establecer enlaces seguros con dispositivos externos y responder peticiones. El subnivel de soporte a la aplicaci\u00f3n (APS, Application Support Sublayer ) es el segundo componente b\u00e1sico del nive l. Como tal, ofrece una interfaz bien definida y Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 39servicios de control asociados. Trabaja como ne xo de uni\u00f3n entre el nivel de red y el resto de componentes del nivel de aplicaci\u00f3n. Mantie ne actualizadas las tablas de asociaciones en forma de base de datos, que puede utilizar se para encontrar dispositivos adecuados en base a los servicios demandados y ofrecidos. Co mo puente entre dos niveles, encamina los mensajes a lo largo de la pila de protocolos. 2.4.4 Dispositivos que Constituyen una Red Zigbee En una red ZigBee podemos encontrar y detect ar tres tipos de dispositivos ZigBee diferentes, seg\u00fan el papel que desarrollen en nuestra red. Estos dispositivos son los siguientes: - Coordinador ZigBee ( ZigBee Coordinator , ZC): Consiste en el dispositivo m\u00e1s completo de los tres, puesto que sus func iones son las de cont rolar y coordinar la red y los caminos que deben seguir los dis positivos para conect arse entre ellos. Debemos encontrar obligatoriamente un ZC en cada red ZigBee. - Router ZigBee ( ZigBee Router , ZR): Su funci\u00f3n es la de interconectar los dispositivos separados en la topolog\u00eda de la red, adem\u00e1s de ofrecer un nivel de aplicaci\u00f3n para la ejecuci\u00f3n de c\u00f3digo de usuario. - Dispositivo Final ( ZigBee End Device , ZED): En este dispositivo queda representado las principales caracter\u00edsticas de ZigBee, como son el bajo consumo y el bajo coste. Los ZED poseen la funciona lidad necesaria para comunicarse con su nodo padre, que ya puede ser el Router Zi gBee o el Coordinador ZigBee, pero no puede transmitir informaci\u00f3n destinada a otros dispositivos. Es por ello, que este tipo de dispositivo puede estar \"dormido\" la mayor parte del tiempo aumentando as\u00ed la vida media de sus bater\u00edas. Un ZED tiene requerimientos m\u00ednimos de memoria y es por ello significativamente m\u00e1s barato. Vistas las funciones realizadas por los dis tintos tipos de dispositivos que forman una red ZigBee podemos clasificarlos, seg\u00fan su f uncionalidad, en dos tipos de nodo definidos por el est\u00e1ndar 802.15.4: - Dispositivo de Funcionalidad Completa (FFD, Full-Function Device ): Conocido tambi\u00e9n como nodo activo. Gracias a la memoria adicional y a la capacidad de computar puede funcionar como Coordinador o Router ZigBee de una red de \u00e1rea personal (PAN) o como un nodo normal. Implementa un modelo general de comunicaci\u00f3n que le permite establecer un intercambio con cualquier otro dispositivo pudiendo encaminar mensaj es, en cuyo caso se le denomina coordinador (coordinador de la PAN si es el responsable de toda la red y no s\u00f3lo de su entorno). Puede ser usado en dispositivos de red que act\u00faen de interface con los usuarios. - Dispositivo de Funcionalidad Reducida (RFD, Reduced-Function Device ): Conocido tambi\u00e9n como nodo pasivo. Po see una capacidad y funcionalidad limitada para garantizar un ba jo coste y una gran simplic idad, por ello s\u00f3lo pueden Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 40comunicarse con FFD's y nunca puede n ser coordinadores. B\u00e1sicamente constituyen los sensores de la red. 2.4.5 Comunicaciones y Descubrimientos de Dispositivos Para que los dispositivos que forman una aplicaci\u00f3n puedan comunicarse, deben utilizar un protocolo de aplicac i\u00f3n compartido. Estos acuerdos se agrupan en perfiles. En el momento de establecer una comunicaci\u00f3n entr e los distintos dispositivos se realiza mediante pares de identificadores fuente y destino (identificadores de cluster ), agrupando las parejas en tablas de asociaciones. Dichas tablas estar\u00e1n correctamente almacenadas en los Coordinadores ZigBee. En base a la informaci\u00f3n disponible, el descubrimiento de dispositivos puede efectuarse utilizando varios m\u00e9t odos. En caso de conocer la di recci\u00f3n de red, se pide la direcci\u00f3n IEEE utilizando unicast3 . Si no es as\u00ed, se pide por broadcast 4. Los Dispositivos Finales ZigBee responden a esta s peticiones con sus direccione s propias, mientras que los Routers y Coordinadores ZigBee env\u00edan tambi\u00e9n las direcciones de todos los dispositivos asociados a ellos. Los identificadores de cluster favorecen la asociaci\u00f3n entre entidades complementarias por medio de tablas de as ociaci\u00f3n, mantenidas en los Coordinadores ZigBee, ya que estas tablas siempre han de estar disponibles en una red. Los Coordinadores son los encargados de guardar las tablas ya que, de entre todos los nodos, son los que con mayor seguridad dispondr\u00e1n de una alimentaci\u00f3n continua. Para establecer asociaciones entre diferentes dispositivos se necesita que se haya formado un enlace de comunicaci\u00f3n, tras ello se decide si es neces ario adjuntar un nuevo nodo a la red en base a la aplicaci\u00f3n y las pol\u00edticas de seguridad. Nada m\u00e1s establecerse la asociaci\u00f3n, pueden iniciarse las comunicaciones. Existen dos modos de direccionamientos. Po r una parte, el direccionamiento directo utiliza la direcci\u00f3n de radio y el n\u00famero de endpoint 5; por otra parte, el direccionamiento indirecto necesita toda la informaci\u00f3n relevante (direcci\u00f3n, endpoint , cluster y atributo), y la env\u00eda al Coordinador de la red. El Coordina dor es el encargado de traducir su petici\u00f3n y proporcionarle los datos deseados. Este \u00faltimo direccionamiento es especialmente \u00fatil para favorecer el uso de dispositivos muy sencillo s y minimizar el almacenamiento interno. 2.4.6 Modos de Funcionamiento El funcionamiento de ZigBee debe cumplir la premisa del bajo consumo de sus nodos. Para ello un nodo ZigBee, tanto activo como pasivo, reduce su consumo gracias a que puede permanecer \"dormido\" la mayor parte del tiempo, incluso muchos d\u00edas seguidos. Cuando decimos que el nodo permanece \" dormido\" nos referimos a que est\u00e1 a la espera de ser activado por parte del Router o del Coordinador ZigBee. Cuando se requiere su uso, el nodo ZigB ee es capaz de despertar en un tiempo \u00ednfimo, para volverse a \"dormir\" cuando deje de ser requerido. El tiempo que tarda un nodo cualquiera en despertarse es de aproxi madamente 15ms. Las redes ZigBee han sido dise\u00f1adas para conservar la potencia en lo s nodos esclavos (ZED), de esta forma se consigue el bajo consumo de potencia. La id ea del funcionamiento ZigBee consiste en que Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 41los dispositivos esclavos en todo moment o permanecen en modo \"dormido\" a no ser que sean activados, de tal forma que solo se \"despiertan\" por una fracci\u00f3n de segundo para confirmar que siguen en nuestra red de dispositi vos de la que forman parte, es decir, que siguen \"vivos\". En las redes ZigBee, se pueden usar dos modos de funcionamiento diferentes: con balizas o sin balizas. Con balizas En este modelo de funcionamiento, el camino de transmisi\u00f3n y recepci\u00f3n est\u00e1 permanentemente controlado por un distribuidor que se encarga de controlar el canal y dirigir las transmisiones. El distribuidor permite a todos los dispositivos saber cu\u00e1ndo pueden transmitir. Para el control del canal se utilizan las balizas, elementos que se usan para poder sincronizar todos los dispositivos que conforma n la red. Los intervalos de las balizas son asignados por el coordinador de la red (C oordinador ZigBee) y pueden variar desde los 15ms hasta los 4 minutos. Este modo es m\u00e1s recomendable cuando el coordinador de red trabaja con una bater\u00eda. Los dispositivos que conforman la red escuchan a dicho coordinador durante el balizamiento (env\u00edo de mensajes a todos los dispositivos - broadcast -, entre 0.015 y 252 segundos). Un dispositivo que qu iere intervenir, lo primero que tendr\u00e1 que hacer es registrarse para el coordinador, y es entonces cuando mira si hay mensajes para \u00e9l. En el caso de que no haya mensajes, este disposit ivo vuelve a \"dormir\", y se despierta de acuerdo a un horario que ha establecido previa mente el coordinador. En cuanto el coordinador termina el balizamiento, todos los di spositivos de la red vuelven a \"dormirse\". Como vemos, se trata de un mecanismo de control del consumo de potencia en la red. Sin balizas En este tipo cada dispositivo es aut\u00f3no mo, pudiendo iniciar una conversaci\u00f3n en la cual los otros dispositivos pueden interfer ir. A veces puede ocurrir que el nodo destino puede no o\u00edr la petici\u00f3n o que el dispositivo emis or pretenda transmitir cuando el canal est\u00e9 ocupado, ocasionando posibles colisiones. Es po r ello que se debe utilizar un mecanismo de control de acceso al medio. Las redes si n balizas acceden al canal por medio del CSMA/CA. El CSMA/CA ( Carrier Sense Multiple Access with Collision Avoidance ) se basa en la escucha del canal por parte del nodo que pretende transmitir, y de esta forma detecta si alg\u00fan otro nodo que compone la red est\u00e1 transmitiendo o tiene intenci\u00f3n de ello. Al tratarse de un medio inal\u00e1mbrico, la de tecci\u00f3n de colisiones no es posible, por lo tanto para evitar dichas colisiones la estaci\u00f3n que quiera transmitir, si no hay tr\u00e1fico en el canal, podr\u00e1 hacerlo pasado un cierto instante de tiempo; en caso de ex istir tr\u00e1fico, deber\u00e1 esperar un cierto tiempo de espera m\u00e1s otro cierto intervalo de tiempo aleatorio. Este sistema se usa t\u00edpicamente en los si stemas de seguridad, en los cuales sus dispositivos duermen pr\u00e1cticamen te todo el tiempo. Pa ra que se les teng a en cuenta, estos elementos se \"despiertan\" de forma regul ar para anunciar que siguen en la red. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 42 Cuando se produce un evento, como por ejemplo que un sensor detecte alg\u00fan movimiento, el sensor \"despierta\" inst ant\u00e1neamente y transmite a la alarma correspondiente. Es en ese momento cuando el coordinador de re d recibe el mensaje enviado por el sensor y activa la alarma pertinente. En este caso, el coordinador de red se alimenta de la red principal durante todo el tiempo. Los routers suelen estar activos todo el tiempo, por lo que requieren una alimentaci\u00f3n estable en general. Esto pe rmite redes heterog\u00e9neas en las que algunos dispositivos pueden estar transmitiendo todo el tiempo, mientras que otros s\u00f3lo transmiten ante la presencia de est\u00edmulos externos. En general, los protocolos ZigBee que no hacen uso de las baliza, minimizan el tiempo de actividad para evitar el uso de ener g\u00eda. En las redes con balizas, los nodos s\u00f3lo necesitan estar despiertos mi entras se transmiten las baliz as (adem\u00e1s de cuando se les asigna tiempo para transmitir); si no hay ba lizas, el consumo de cada dispositivo ser\u00e1 distinto ya que encontraremos nodos activos permanentemente y otros que s\u00f3lo lo est\u00e1n espor\u00e1dicamente. Acceso al medio El medio f\u00edsico es un recurso al que se accede utilizando CSMA/CA. Las redes que no utilizan las balizas hacen uso de una variaci\u00f3n del mismo basada en la escucha del medio, temporizada por un algoritmo de backoff6 , salvo en el caso de las confirmaciones (ACK, Acknowledgement ). Estos mensajes de confirmaci\u00f3n puede n ser opcionales en algunos casos. La recepci\u00f3n de una confirmaci\u00f3n certifica el \u00e9xito de nuestro env\u00edo. En cualquier caso, si un dispositivo es incapaz de procesar una trama en un momento dado, no confirma su recepci\u00f3n. Pueden realizarse reintentos basados en timeout un cierto n\u00famero de veces, tras lo cual se decide si seguir intent \u00e1ndolo a dar error de transmisi\u00f3n. El entorno de funcionamiento previsto para este tipo de redes exige que se maximice la vida de la fuente de energ\u00eda, por lo que se favorece n los protocolos que conducen a estos fines. Para ello, se program an comprobaciones peri\u00f3dicas de mensajes pendientes, m\u00e1s o menos frecuente s seg\u00fan la aplicaci\u00f3n concreta. En lo que respecta a la seguridad en la s comunicaciones, el subnivel MAC ofrece funcionalidades que los niveles s uperiores pueden utilizar para lograr alcanzar el nivel de seguridad deseado. Estos niveles superiores pueden especificar claves sim\u00e9tricas para proteger los datos y restringir \u00e9stos a un grupo de dispositivos o a un enlace punto a punto. Estos grupos se especifican en listas de control de acceso. Adem\u00e1s, MAC realiza comprobaciones de frescura ( freshness check ) entre recepciones sucesivas para asegurar que las tramas viejas cuyo contenido no se cons idera \u00fatil o v\u00e1lido ya, no transcienden a los niveles superiores. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 432.4.7 Modelo de Redes Zigbee Las redes est\u00e1n compuestas por grupos de dispositivos separados por distancias suficientemente reducidas. Cada dispositivo posee un identificador \u00fanico de 64 bits, aunque si se dan ciertas condiciones de entorn o en \u00e9ste pueden utilizarse identificadores cortos de 16 bits. Probablemente \u00e9stos se utilizar\u00e1n dentro del dominio de cada PAN separadas. Un aspecto a tener muy en cuenta son los tipos de topolog\u00edas de red que permite el est\u00e1ndar que soporta ZigBee. Su nivel de red permite tres topolog\u00edas distintas: - Topolog\u00eda en estrella. - Topolog\u00eda en \u00e1rbol. - Topolog\u00eda de malla. Toda red necesita al menos un dispositi vo coordinador (FFD), encargado de su creaci\u00f3n, mantenimiento b\u00e1sico y control de sus par\u00e1metros. Seguidamente estudiaremos de forma detallada los distintos tipos de t opolog\u00edas de ZigBee, d\u00f3nde se sit\u00faa en cada uno de ellos el coordinador de la red y cu\u00e1l es la topolog\u00eda m\u00e1s adecuada. Topolog\u00eda estrella En redes en estrella el c oordinador se sit\u00faa en el ce ntro, y toda conexi\u00f3n que se quiera realizar entre los distintos nodos de la red debe pasar por \u00e9ste. Una red en estrella activa tiene un nodo cen tral activo que normalmente tiene los medios para prevenir problemas. Se utiliza sobr e todo para redes locale s. La mayor\u00eda de las redes de \u00e1rea local que tienen un router , un switch o un hub7 siguen esta topolog\u00eda. El nodo central, en el caso de utilizar uno de estos dispos itivos, ser\u00eda el router, el switch o el hub por el que pasan todos los paquetes. Las ventajas que nos puede aportar una red en estrella ser\u00eda la facilidad a la hora de implementarla, adecuada para redes temporales , el fallo de un nodo perif\u00e9rico no influir\u00eda en el comportamiento del resto de la red y no hay problemas con colisiones de datos ya que cada estaci\u00f3n tiene su propia conexi\u00f3n al c oordinador central. En contrapartida, la utilizaci\u00f3n de una red en estrella nos lim ita tanto el n\u00famero de nodos que pueden estar conectados a la red, como la longitud del cab leado (en caso de ser una conexi\u00f3n cableada). Tambi\u00e9n se debe tener muy en cuenta que los costes de mantenimientos pueden aumentar a largo plazo, y que el fallo del nodo centra l puede echar abajo la red entera. A causa de todo ello, podemos confirmar que una red en estrella puede ser poco fiable en el momento de reali zar transferencias de informaci\u00f3n Topolog\u00eda en \u00e1rbol Topolog\u00eda de red en la que lo s nodos est\u00e1n colocados en fo rma de \u00e1rbol. Para este tipo de topolog\u00eda el coordinador ser\u00e1 la ra \u00edz del \u00e1rbol. Desde una vista topol\u00f3gica, la conexi\u00f3n en \u00e1rbol es parecida a una serie de redes en estrella interconectadas, salvo en que Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 44no tiene un nodo central. En cambio, tiene un nodo de enlace troncal, generalmente ocupado por un hub o switch , desde el que se ramifican los dem\u00e1s nodos. En redes de \u00e1rbol se permite el uso de Router ZigBee para interconectar los distintos nodos de la red. As\u00ed mismo, la comuni caci\u00f3n en \u00e1rbol es estrictamente jer\u00e1rquica con lo que puede utilizar opcionalmente tramas balizas. Una falla de un nodo no implica la interrupci\u00f3n en las comunicaciones. Se compar te el mismo canal de comunicaciones. Los problemas asociados a este tipo de topolog\u00eda radican en que los datos son recibidos por todas las estaciones sin importar para quien vayan dirigidos. Por lo tanto es necesario dotar a la red de un mecanismo que permita identificar al destinatario de los mensajes. Adem\u00e1s, debido a la presencia de un medio de transmisi\u00f3n compartido entre muchas estaciones, pueden producirse interfer encias entre las se\u00f1ales cuando dos o m\u00e1s estaciones transmiten al mismo tiempo. La soluci\u00f3n al primero de estos problemas aparece con la introducci\u00f3n de un identificador de es taci\u00f3n destino. Para da rle soluci\u00f3n al segundo problema, hay que mantener una coordinaci\u00f3n entre todas las estaciones, y para eso se utiliza cierta informaci\u00f3n de control en las tramas que controlan quien transmite en cada momento (utilizaci\u00f3n de tramas ba lizas mencionadas anteriormente). Topolog\u00eda en malla La topolog\u00eda m\u00e1s interesante es la topolog\u00ed a de malla. Consiste en que al menos uno de los nodos tendr\u00e1 m\u00e1s de dos conexion es. Con ello conseguimos que si, en un momento dado, un nodo del camino falla y se cae, pueda seguir la comunicaci\u00f3n entre todos los dem\u00e1s nodos debido a que se rehacen todos los caminos. El establecimiento de una red de malla es una manera de encaminar datos, voz e instrucciones entre los nodos. Las redes de malla se diferencian de otras redes en que las piezas de la red (los nodos) est\u00e1n conectadas unas con otras por uno u otro camino. Esta configuraci\u00f3n ofrece caminos redundantes por t oda la red, de modo que si falla un cable, otro se har\u00e1 cargo del tr\u00e1fico. Esta topolog\u00eda, a diferencia de las vistas en apartados anteriores, no requiere de un servidor o nodo central, con lo que se reduce el mantenimiento. Un error en un nodo, sea importante o no, no implica la ca\u00edda de toda la red. Como ya se ha comentado anteriormente, las redes de malla son autogenerables. La red puede funcionar incluso cuando un nodo desapa rece o la conexi\u00f3n falla, ya que el resto de nodos evitan el paso por ese punto. Consecuen temente, se forma una red muy confiable. Gracias a las estructuras arbi trarias que permite la topol og\u00eda en malla , es posible llevar los mensajes de un nodo a otro por diferentes caminos. A consecuencia de este tipo de estructura no se pueden usar tramas balizas. Al igual que en la topolog\u00eda en \u00e1rbol, las redes en malla permiten el uso de Routers ZigBee para habilitar la comunicaci\u00f3n en el nivel de red. \u00c9stos no son Coordinadores ZigBee, pero pueden serlo de sus respectivos espacios de operaci\u00f3n personal definidos por 802.15.4. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 45Aunque la facilidad de soluci\u00f3n de problem as y el aumento de la fiabilidad son ventajas muy interesantes, estas redes resultan caras de instalar, ya que utilizan mucho cableado. En la siguiente figura, se puede apreciar las diferentes topolog\u00edas que puede tener una red ZigBee. Figura 30. Topolog\u00edas de una red ZigBee \u00c1rbol de clusters Vistos los tipos de topolog\u00edas que pode mos manipular, encontramos que nuestro est\u00e1ndar menciona un tipo de red definido como \"\u00e1rbol de clusters \". Para ello se usan redes punto a punto. Las redes punto a punto pueden formar pa trones arbitrarios de conexionado, donde su extensi\u00f3n se ve limitada \u00fanicamente por la distancia existente entr e cada par de nodos. Forman la base de redes ad hoc8 autoorganizativas. El est\u00e1ndar no define un nivel de red, por lo que no se sopor tan funciones de ruteo de form a directa, aunque si ha dicho nivel se le a\u00f1ade se pueden realizar comunicaciones en varios saltos. Las estructuras \u00e1rbol de clusters est\u00e1n formadas por el conexionado entre nodos FFD y RFD. Puesto que se necesita de al menos un nodo FFD para poder conectar diferentes RFD's, se aprovecha de ello para generar estructuras donde los nodos RFD's simbolizan las hojas de un \u00e1rbol, y donde la mayor\u00eda de los nodos son FFD's. A partir de los \u00e1rboles de clusters podemos generar grandes redes de malla, cuyos nodos sean \u00e1rboles de clusters con un coordinador local para cada cluster , junto con un coordinador global. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 46 Figura 31. \u00c1rbol de clusters 2.4.8 Otros Medios de Transmisi\u00f3n de Datos y Elecci\u00f3n Final Como ya hemos podido comprobar, el desa rrollo de la tecnol og\u00eda de ZigBee se centra en la sencillez y bajo coste de sus nodos y en el bajo nivel de transmisi\u00f3n de informaci\u00f3n. Es por ello que su utilizaci\u00f3n en este proy ecto es la m\u00e1s adecuada en comparaci\u00f3n con otras redes inal\u00e1mbricas semejantes de la familia WPAN, como por ejemplo Bluetooth. ZigBee vs. Bluetooth ZigBee es muy similar a Bluetooth, pero con algunas diferencias: - Una red ZigBee puede constar de m\u00e1s de 65000 nodos distribuidos en subredes de 255 nodos, frente a los 8 m\u00e1ximos de una subred (piconet9) Bluetooth. - Menor consumo el\u00e9ctrico que el de Bluet ooth. Este menor consumo se debe a que el sistema ZigBee, como ya se ha menci onado anteriormente, se queda la mayor parte del tiempo dormido, mientras que en una comunicaci\u00f3n Blue tooth esto no se puede dar ya que suelen estar siempre transmitiendo y/o recibiendo. En la siguiente tabla podemos ver en t\u00e9rm inos exactos el consumo de ZigBee y de Bluetooth. Tabla 6. Consumo ZigBee Vs Bluetooth La velocidad ZigBee es menor a la de Bluetooth. ZigBee tiene una velocidad de hasta 250kbps, mientras que en Bluetooth es de hasta 1Mbps. Esta diferencia de valores es l\u00f3gica si tenemos en cuenta que ZigBee se basa en una transmisi\u00f3n de datos baja, y por lo tanto no nos afecta en gran medida en el mo mento de transmisi\u00f3n y recepci\u00f3n de datos. Vistas las principales diferencias entr e ZigBee y Bluetooth, podemos llegar a la conclusi\u00f3n de que uno es m\u00e1s apropiado que el otro para ciertas aplicaciones. Haciendo referencia a la diferencia de velocidades, Bluetooth se usa para aplicaciones con mayor carga de informaci\u00f3n para transmitir, como por ejemplo para tel\u00e9fonos m\u00f3viles e Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 47inform\u00e1tica casera; la velocidad de ZigBee se hace insuficiente para estas tareas, desvi\u00e1ndolo a usos tales como la dom\u00f3tica, los productos dependientes de la bater\u00eda, art\u00edculos de jugueter\u00eda y sensores m\u00e9dicos, en lo s cuales la transferencia de datos es menor. \u00c9ste \u00faltimo caso de utilizaci\u00f3n de ZigBee, los sensores m\u00e9dicos, nos garantiza que ZigBee ser\u00e1 un medio id\u00f3neo para este proyecto que se basa en la transmisi\u00f3n de datos a partir de medidas capturadas por un sensor de temperatura. Wireless USB Wireless USB es un protocolo de comuni caci\u00f3n inal\u00e1mbrica por radio con gran ancho de banda, que combina la sencillez de us o de USB con la versatilidad de las redes inal\u00e1mbricas. Utiliza como banda frecuencial la plataforma UWB ( Ultra-Wide Band ), operando en los rangos de frecuencia de 3.1 a 10.6GHz. Pu ede lograr tasas de transmisi\u00f3n de hasta 480Mbps en rangos de tres metros y 110Mbps en rangos de diez metros. Gracias a su alta tasa de transferencia, Wireless puede usarse para aplicaciones que requieren un flujo de transferencia elev ado. Wireless USB se utiliza en mandos de videoconsola, impresoras, esc\u00e1neres, transm isi\u00f3n y visualizaci\u00f3n de v\u00eddeos, etc. Haciendo una comparativa de los principale s aspectos de Wireless USB, Bluetooth, Wi-Fi y ZigBee, como podemos comprobar en la siguiente tabla, el rango de frecuencia en el que trabaja Wireless es superior al de lo s otros medios de transmisi\u00f3n, al mismo tiempo que su tasa de transferencia es m\u00e1s elevada. Centr\u00e1ndonos en los valores de transferencia y utilizando la l\u00f3gica, a mayor tasa de transfer encia mayor ser\u00e1 el consumo, con lo cual no nos beneficia para el tipo de proyecto que queremos llevar a cabo. ZigBee sigue siendo la mejor opci\u00f3n. Tabla 7. Comparativa ZigBee - Bluetooth - Wireless USB - Wi-Fi Wi-Fi Wi-Fi, al igual que el resto de medios que estamos analizando, consiste en un sistema de env\u00edo de datos sobre redes que utiliza ondas en lugar de cables ( wireless ). Se basa en el est\u00e1ndar IEEE 802.11, y es por ello que podemos encontrar diversos tipos de Wi-Fi: - Los est\u00e1ndares IEEE 802.11 son f\u00e1cilmente aceptados debido a que usan la banda frecuencial de 2.4GHz. - La velocidad de transferencia del medi o depende del est\u00e1ndar que se haga uso. Puede proporcionarnos una velocida d de 11Mbps (IEEE 802.11b) hasta 108Mbps (IEEE 802.11n), pasando por los 54Mbps del est\u00e1ndar IEEE 802.11g. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 48- En la actualidad ya se utiliza el est\u00e1ndar IEEE 802.11a, conocido como Wi-Fi5 ya que opera en la banda de 5GHz. Dich a banda frecuencial (5GHz) ha sido recientemente habilitada. Al no existir ot ras tecnolog\u00edas como ZigBee o Bluetooth que hagan uso de ella, nos garantiza un m\u00ednimo de interferencias vecinas. Su alcance es algo menor que el de los est\u00e1ndares que trabajan a 2.4GHz. La principal ventaja que nos proporciona Wi -Fi, aparte de las altas velocidades de transferencia, es la capacidad de suministrar cobertura en un gran rango de distancia (capaz de alcanzar los 100 metros). Por otra parte, la desventaja fundamental de estas redes existe en el campo de la seguridad. Existen algunos programas capaces de capturar paquetes enviados y calcular la contrase\u00f1a de la red, y de esta forma acceder a ella. Al igual que el resto de medios de transmisi\u00f3n wireless , la velocidad de transferencia se ve disminuida al no utilizar cables. Vistos los principales puntos que nos puede aportar la utilizaci \u00f3n de Wi-Fi (altas velocidades de transmisi\u00f3n y gran cobertura) , se puede concluir que este tipo de medio quedar\u00eda fuera del tipo de transmisi\u00f3n que se pr etende llevar a cabo al necesitar una mayor fuente de energ\u00eda para poder proporci onar dichas tasas de velocidades. Wibree Wibree resultar\u00eda ser una opci\u00f3n a tener en cu enta para su empleo en este proyecto puesto que sus principales caracter\u00edsticas y su s principios b\u00e1sicos son parejos a los ya vistos en ZigBee. Wibree es una nueva tecnolog\u00eda digital de radio interoperable para peque\u00f1os dispositivos. Consiste en una tecnolog\u00eda de comunicaci\u00f3n inal\u00e1mbrica que nos ofrece conexi\u00f3n y comunicaci\u00f3n entre dispositivos m\u00f3v iles o computadores y otros dispositivos m\u00e1s peque\u00f1os. Su dise\u00f1o est\u00e1 pensado para que funcione con un consumo de energ\u00eda m\u00ednimo. Al igual que en ZigBee, Wibree opera a los 2.4GHz (banda ISM) haciendo posible la comunicaci\u00f3n entre dispositivos de pila de bot\u00f3n y dispositivos Bluetooth. Su tasa de transferencia es superior resp ecto a ZigBee: 250kbps de ZigB ee frente a 1Mbps de Wibree. Puesto que en este proyecto la cantidad de informaci\u00f3n a transmitir ser\u00e1 m\u00ednima (datos medidos por el sensor de temperatura), la tasa de transferencia tampoco interesa, en primera instancia, que sea muy elevada. Wibree se dise\u00f1\u00f3 para dos modos distintos de implementaci\u00f3n: - Wibree de implementaci\u00f3n \u00fanica: Esta implementaci\u00f3n est\u00e1 pensada para el funcionamiento de dispositivos que requieren un consumo bajo de energ\u00eda, peque\u00f1os y de bajo costo, como por ejemplo relojes, sensores deportivos, teclados inal\u00e1mbricos, etc. - Wibree de implementaci\u00f3n modo dual (Bluetooth - Wibree): Se dise\u00f1a para su uso en dispositivos Bluetooth donde Wibree se integra con Bluetooth y BluetoothRF, Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 49utilizando los dispositivos existentes y diri gidos especialmente a dispositivos como tel\u00e9fonos m\u00f3viles y computadoras personales. TinyOS TinyOS es un sistema operativo open source basado en componentes para redes de sensores inal\u00e1mbricas. Est\u00e1 dise\u00f1ado para incorporar nuevas innovaciones r\u00e1pidamente y para funcionar bajo las importantes restricci ones de memoria que se dan en las redes de sensores. Las aplicaciones para TinyOS se escriben en nesC, un dialecto del lenguaje de programaci\u00f3n C optimizado para las limitaciones de memoria de las redes de sensores; donde el lenguaje de programaci\u00f3n nesC consiste en un conjunto de tareas y procesos que colaboran entre s\u00ed. Existen, adem\u00e1s, varias herramientas que completan y facilitan su uso, escritas en su mayor\u00eda en Java y en Bash. TinyOS proporciona interfaces, m\u00f3dulos y configuraciones espec\u00edficas, que permiten a los programadores construir progra mas como una serie de m\u00f3dulos que hacen tareas espec\u00edficas. Los m\u00f3dulos de TinyOS pr oporcionan interfaces para los tipos est\u00e1ndar de entradas y salidas de hardware y sensores. A pesar de que TinyOS no sea una tecnolog\u00ed a para comunicaciones inal\u00e1mbricas, se puede tener en cuenta su u tilizaci\u00f3n para posib les configuraciones y programaciones de redes inal\u00e1mbricas. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 50Comparativa general Tabla 8. Comparativa entre los distintos medios de transmisi\u00f3n de datos Una vez analizados los distintos medios de transmisi\u00f3n inal\u00e1mbricos podemos concluir diciendo que cada uno de los medios se adapta mejor a un tipo de necesidades, pero en este caso son primordial es el bajo consumo y la baja transmisi\u00f3n de datos, por lo tanto el medio que mejor se adapta es ZigBee. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 512.5 M\u00f3dulos Zigbee en el Mercado. Actualmente existen cerca de una veintena de compa\u00f1\u00edas dedicadas entre otras cosas a la manufacturac\u00f3n de chips ZigBee, entre ellas, las m\u00e1s importantes son las siguientes: Atmel Corporation, Chipcon, Crossbow, Ember Co rporation, Freescale, etc. al igual que otros fabricantes de sarrollan M\u00f3dulos ZigBee utilizando estos chips, MaxStream ha optado por la plataforma ZigBee de Freescale. En este apartado se analizan distinto s m\u00f3dulos ZigBee a fin de comparar sus especificaciones m\u00e1s relevantes. Entre las especificaciones se pueden mencionar a modo de ejemplo la corriente de transmisi\u00f3n, la corriente de recepci\u00f3n, la dimensi\u00f3n, los tipos de antenas, etc. Tabla 9. Comparativa m\u00f3dulos Zigbee Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 52 Tabla 10. Comparativa m\u00f3dulos Zigbee Analizando las tablas comparativas se pue de observar que lo s productos ZigBee de MaxStream son la mejor opci\u00f3n frente a otros m\u00f3dulos de la competencia. Cuentan con unas dimensiones reducidas, una f\u00e1cil integrac i\u00f3n, diferentes tipos de antenas seg\u00fan las necesidades del usuario final, un consum o aceptable, una buena disponibilidad, y la caracter\u00edstica m\u00e1s relevante es la concesi\u00f3n del cer tificado ZigBee. Adem\u00e1s, cabe destacar que existe bastante informaci\u00f3n, resultando ser un factor importante al momento de elegir un \u00f3dulo ZigBee, ya que una buena documentaci\u00f3n permitir\u00e1 que el desarrollo del proyecto avance de forma continuada y fluida en el transcurso del tiempo. La familia de productos Xbee de MaxStream ha recibido la homologaci\u00f3n ZigBee que concede ZigBee Alliance, superando rigurosas pruebas hasta convertirse en uno de los pocos productos en recibir la exclusiva homologaci\u00f3n ZigBee. 2.5.1 Elecci\u00f3n Final La familia Xbee presenta 2 m\u00f3dulos, el Xbee y el Xbee-PRO. Las caracter\u00edsticas de ambos son las siguientes: Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 53 Tabla 11. Comparativa m\u00f3dulos Xbee y Xbee Pro Para el desarrollo de este proyecto, se ha optado por escoger el modulo Xbee, con antena chip integrada. De los dos es el que m\u00e1s se ajusta por su bajo consumo y dimensiones. Con antena chip integrada, los alcances de las especificaciones se reducen un 70%, aun as\u00ed, siguen siendo m\u00e1s que suficiente s para el objetivo de este proyecto. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 542.6 El Microcontrolador 2.6.1 Funci\u00f3n El microcontrolador se encargar\u00e1 de gest ionar los recursos y los componentes. Se encargar\u00e1 de temporizar los es tados de bajo consumo cuando no se necesite la temperatura y de despertar a los diferentes m\u00f3dulos cuando se requiera su uso. 2.6.2 Requisitos El microcontrolador escogido tendr\u00e1 que comunicarse con el m\u00f3dulo Xbee de MaxStream y el sensor MCP9804 de Microchip. Partiendo de las caracter\u00edsticas de cada uno de los equipos se debe elegir el microcontrolador m\u00e1s adecuado. Sensor MCP9804. Tensi\u00f3n de alimentaci\u00f3n: desde 2'7 V a 5'5 V Entradas / salidas digitales necesarias: Figura 32. MCP9804 Para su comunicaci\u00f3n, el sensor MCP9804 utiliza el protocolo I 2C. SDA - PIN 1 SCL - PIN 2 La se\u00f1al de Alert (PIN 3) no se utilizar\u00e1 en esta aplicaci\u00f3n. Las se\u00f1ales A0, A1 y A2 (PIN 7, 6 y 5) se configurar\u00e1n por hardware. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 55M\u00f3dulo Xbee. Figura 33. M\u00f3dulo Xbee Tensi\u00f3n de alimentaci\u00f3n: desde 2'8 V a 3'4 V Entradas / salidas digitales necesarias: Para su comunicaci\u00f3n, el m\u00f3dulo XBee utiliza la UART DOUT - PIN 2 DIN - PIN 3 Para entrar en modo de bajo consumo y sali r del modo en bajo consumo se utiliza el PIN 9. SLEEP_RQ - PIN 9 El resto de entradas / salidas no se aplican en este proyecto. Por lo tanto el microcontrolador deber\u00e1 disponer: - Capacidad para una comunicaci\u00f3n I 2C - Capacidad para una comunicaci\u00f3n UART - Un pin digital para controlar el modo de funcionamiento del m\u00f3dulo XBee. - Debe funcionar con una tensi\u00f3n de alim entaci\u00f3n comprendida entre 2'8V y 3'4V. - Debe poder trabajar en modo de bajo consumo y despertarse por si solo transcurrido un determinado periodo de tiempo. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 56PIN 1S D A2S C L2D O SLEEP_RQI2C UARTRequisitos Microcontrolador M\u00f3dulo XbeeSensor MCP9804Dispositivo Tabla 12. Requisitos del microcontrolador. 2.6.3 Alternativas Aunque existen m\u00faltiples fabricantes, los posibles microcontroladores se han buscado dentro de la gama que el fabricante MICROCHIP posee. El principal motivo de la decisi\u00f3n de us ar un microcontrolador de MICROCHIP es que suelen ser de bajo coste y ya disponemos de las herramientas y equipos necesarios para su programaci\u00f3n. El programa usado para su programaci\u00f3n ha si do el CCS y el hardware para cargar los progamas el USB PIC BURNER. 2.6.4 Elecci\u00f3n Final Dentro de la amplia gama de microcont roladores que posee Mi crochip, tiene las versiones LF que trabajan a baja tensi\u00f3n. Para esta aplicaci\u00f3n, estas versiones son las m\u00e1s id\u00f3neas ya que trabajan a partir de los 2V de tensi\u00f3n de alimentaci\u00f3n. El rest o de familias necesitan 4'2V como m\u00ednimo. Al ser un prototipo no se ha buscado ajusta r el microcontrolador a las necesidades iniciales de dise\u00f1o, ya que limitar\u00eda al equipo en sus posibles mejoras, por lo que se ha buscado un microcontrolador que facilitase la incorporaci\u00f3n de nuevas opciones al prototipo. Finalmente, el microcontrolador es cogido es el PIC 18LF2525. Es un microcontrolador de 24 pines, no excesivamen te grande, pero lo suficiente para poder disponer de puertos libres pa ra posibles ampliaciones. Las caracter\u00edsticas de este microcont rolador son iguales a las del PIC 18F2525, \u00fanicamente cambia la tensi\u00f3n m\u00ednima de alimentaci\u00f3n. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 57 Tabla 13. Caracter\u00edsticas PIC18F2525. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 582.7 M\u00f3dulo 2: Equipo de Sobremesa 2.7.1 Funciones: El m\u00f3dulo 2 es el equipo encargado de r ealizar las funciones de interface con el usuario. Su principal misi\u00f3n ser\u00e1 la de most rar en todo momento la temperatura corporal que el m\u00f3dulo 1 est\u00e1 midiendo. A su vez, permitir\u00e1 que el usuario disponga de una serie de opciones para ajustarse a las necesidades de este. Entre otras cosas deber\u00e1 permitir: - Conocer si el m\u00f3dulo 1 se encuen tra con bater\u00eda o sin bater\u00eda. - Programar la temperatura a la que quie re que el dispositivo de la alarma. 2.7.2 Diagrama de Bloques: El diagrama de bloques del m odulo 2 ser\u00e1 el siguiente: Regulador 3'2V uCLCD Sist. WirelessRegulador 5V AC / DC Figura 34. Diagrama funcional de bloques M\u00f3dulo 2 Estar\u00e1 formado por: - Un circuito de alimentaci\u00f3n. Se encargar\u00e1 de alimentar los diferentes elementos con las tensiones adecuadas. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 59 - El microcontrolador Se encargar\u00e1 de gestionar la informaci\u00f3n re cibida por los pulsa dores y el m\u00f3dulo de comunicaci\u00f3n Xbee. Enviar\u00e1 la informaci \u00f3n al m\u00f3dulo LCD para mostrarlo por pantalla y se podr\u00e1 configurar la aplicaci\u00f3n. - El m\u00f3dulo LCD Se encargar\u00e1 de mostrar la informaci\u00f3n que le envia el microc ontrolador, tanto los men\u00fas de configuraci\u00f3n, como la temperatura del m\u00f3dulo 1. - Pulsadores Mediante unos pulsadores, el usua rio podr\u00e1 configurar el m\u00f3dulo 2. - Zumbador, Es el encargado de avisar al usuario cuando alguna alarma se activa. Como por ejemplo: - Temperatura alta / baja del usuario. - Falta bater\u00eda en el m\u00f3dulo 1. - El m\u00f3dulo de comunicaci\u00f3n inal\u00e1mbrica Es el encargado de recibir la informaci \u00f3n proporcionada por el m\u00f3dulo 1 y enviarla al microcontrolador. 2.7.3 El m\u00f3dulo de comunicaci\u00f3n inal\u00e1mbrica. Tal y como se ha evaluado en el m \u00f3dulo 1, el dispositivo inal\u00e1mbrico adecuada para la comunicaci\u00f3n en este tipo de aplicaci ones es un dispositivo que utilice la tecnolog\u00eda ZigBee. El m\u00f3dulo escogido es el Xbee de Maxstream, la justificaci\u00f3n es la misma que para el m\u00f3dulo 1. 2.7.4 El m\u00f3dulo LCD. Las pantallas de cristal l\u00edquido LCD o disp lay LCD para mensajes (Liquid Cristal Display) tienen la capacidad de mostrar cu alquier car\u00e1cter alfanum\u00e9rico, permitiendo representar la informaci\u00f3n que genera cualqu ier equipo electr\u00f3nico de una forma f\u00e1cil y econ\u00f3mica. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 60La pantalla consta de una matriz de caracteres (normalmente de 5x7 o 5x8 puntos) distribuidos en una, dos, tres o cuatro l\u00edneas de 16 hasta 40 car\u00e1cteres cada l\u00ednea. El proceso de visualizaci\u00f3n es gobernado por un microcontrolador incorporado a la pantalla, siendo el HITACHI 44780 el modelo de controlador m\u00e1s utilizado. En la siguiente figura se puede observa un LCD. Figura 1 : LCD de 2x16: est\u00e1 compuest o por 2 l\u00edneas de 16 car\u00e1cteres En el presente proyecto se ha optado un un LCD de 2x16, ya que la cantidad de informaci\u00f3n a mostrar es m\u00ednima. Las caracter\u00edsticas generales de un m\u00f3dulo LCD 16x2 son las siguientes: - Consumo muy reducido, del orden de 7'5 mW. - Pantalla de car\u00e1cteres ASCII, adem\u00e1s de los car\u00e1cteres japoneses kanji, car\u00e1cteres griegos y s\u00edmbolos matem\u00e1ticos. - Desplazamiento de los car\u00e1cteres hacia la izquierda o a la derecha. - Memoria de 40 car\u00e1cteres por l\u00ednea de pa ntalla, visualiz\u00e1ndose 16 car\u00e1cteres por l\u00ednea. - Movimiento del cursor y c\u00e1mbio de su aspecto. - Permite que el usuario pueda programar 8 car\u00e1cteres. - Pueden ser gobernados de 2 formas principales: - Conexi\u00f3n con bus de 4 bits. - Conexi\u00f3n con bus de 8 bits. En este caso, se ha optado por una conexi\u00f3n con bus de 4 bits. La ventaja frente al bus de 8 bits es su velocidad de transmisi\u00f3n de datos, sin em bargo, al ser la necesidad de velocidad en la muestra de los datos en nue stra aplicaci\u00f3n baja, no es necesario una conexi\u00f3n de 8 bits. Adem\u00e1s, nos permite disponer de 4 pines m\u00e1s del microprocesador libres. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 61En la siguiente tabla, se presenta la de scripci\u00f3n de se\u00f1ales empleadas por el m\u00f3dulo LCD as\u00ed como el n\u00famero de patilla a la que corresponden. Tabla 14. Se\u00f1ales del m\u00f3dulo LCD El m\u00f3dulo LCF posee una zona de memo ria RAM llamada DDRAM (Data Display Ram) donde se almacenan los caracteres que se van a mostrar en la pantalla. Tiene una capacidad de 80 byt es, 40 por cada l\u00ednea, de los cuales s\u00f3lo 32 se pueden visualizar a la vez (16 bytes por l\u00ednea). De las 80 posibles, las dos direccione s m\u00e1s importantes de la DDRAM son: - Direcci\u00f3n 00h, que es el comienzo de la primera l\u00ednea - Direcci\u00f3n 40h, que es el comienzo de la segunda l\u00ednea. Adem\u00e1s de la DDRAM, el m\u00f3dulo LCD dis pone de una memoria interna no vol\u00e1til llamada CGROM donde se almacena una tabla con los 192 caracteres que pueden ser visualizados. Cada uno de los caracteres tiene su representaci \u00f3n binaria de 8 bits. Para visualizar un car\u00e1cter debe recibir por el bus de datos el c\u00f3digo correspondiente. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 62 Tabla 15. Caracteres ASCII Como ya he comentado anteriormente, la conexi\u00f3n del LCD al microcontrolador se realizar\u00e1 mediante 4 bits, utilizaremos el puerto B del PIC para realizar esta conexi\u00f3n. Las conexiones son las siguientes: - Las 4 l\u00edneas superiores del m\u00f3dulo LCD, pines <DB7:DB4> se conectan a las 4 l\u00edneas del puerto B de la siguiente manera: - DB4 - PIN B4 - DB5 - PIN B3 - DB6 - PIN B2 - DB7 - PIN B1 - PIN RS del LCD a la l\u00ednea PIN B7 del PIC - PIN R/W del LCD a la l\u00ednea PIN B6 del PIC - PIN Enable del LCD a la l\u00ednea PIN B5 del PIC Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 63La siguiente figura muestra un ejemplo de esquema de conexi\u00f3n del m\u00f3dulo LCD, aunque no es la utilizada en el presente proyect o ya que en la figura se utiliza el puerto D. Figura 35. Conexi\u00f3n a 4 bits Para su funcionamiento he utilizado la librer\u00eda que el compilador CCS ya incorpora con subrutinas de control. 2.7.5 Pulsadores Se han implementado 3 pulsadores mediante los cuales el usuario puede acceder al men\u00fa de la aplicaci\u00f3n y configurarla. La denominaci\u00f3n de los pulsadores ser\u00e1: - Pulsador 1 \u00c6 Menu / OK - 2 \u00c6 Sig. + - Pulsador 3 \u00c6 Prev. - El circuito para implementar los pulsadores es el siguiente: Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 64R1 10kPulsadorVCC PIN uC Figura 36. Esquema conexi\u00f3n pulsador Para evitar rebotes en la se\u00f1al durant e la pulsaci\u00f3n se implementa mediante software un retardo en la siguiente lectur a del pulsador, evitando as\u00ed que en una misma pulsaci\u00f3n se detecten varias. 2.7.6 Zumbador El zumbador utilizado es un zumbador (buzzer) electromec\u00e1nico. Se activar\u00e1 mediante un PIN del microcontrolador. Debido a que la intensidad m\u00e1xima que puede proporcionar un pin a su salida es de 25 mA, utili zaremos un transistor NPN en la VCC Q1 NPN 1kPIN uCBUZZER1 2 Figura 37. Esquema conexi\u00f3n zumbador 2.7.7 Alimentaci\u00f3n Los diferentes sistemas que forma el m\u00f3dulo se alimentan principalmente a 2 tensiones diferentes. El microcontrolador y el m\u00f3dulo Xbee y el zumbador se alimentan a 3,2 V mientras que el LCD se alimenta a 5 V. La tensi\u00f3n de alimentaci\u00f3n general la obt enemos de la red el\u00e9ctrica a 230V - 50 Hz y mediante un transformador la pa samos 9 V de tensi\u00f3n continua. Mediante 2 reguladores de tensi \u00f3n obtenemos las tensiones deseadas. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 65 El regulador LM317 es un regulador ajus table, con una tens i\u00f3n a su salida que puede ajustar entre los 1'2V y los 37V. Mediante el LM317 conseguimos la tensi\u00f3n de 3'2V deseada. Su conexi\u00f3n t\u00edpica es la que ap arece en su hoja de caracter\u00edsticas y es la siguientes: Figura 38. Montaje t\u00edpico LM317 Donde la tensi\u00f3n de salida Vou viene dada por la siguiente expresi\u00f3n: (9) Para la tensi\u00f3n de 5V, hemos elegi do el regulador L7805 que proporciona una tensi\u00f3n fija a su salida de 5V. Su conexi\u00f3n t\u00edpica seg\u00fan su hoja de caracter\u00edsticas es la siguiente: Figura 39. Montaje t\u00edpico 7805. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 66 Para evitar posibles conexiones incorrect as de la alimentaci\u00f3n, hemos colocado un diodo en serie justo a la salida del transfor mador, as\u00ed evitamos la alimentaci\u00f3n inversa. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 672.8 Manual de Funcionamiento Para operar con los equipos se deben segui r una serie de pasos que se enumeran a continuaci\u00f3n. 1- Conectar el m\u00f3dulo de sobremesa a la re d y poner el interrupt or en posici\u00f3n ON. 2- La pantalla del LCD se encender\u00e1 y aparecer\u00e1n los comandos AT de configuraci\u00f3n del m\u00f3dulo Xbee. 3- Una vez configurado aparecer\u00e1 sobre la pantalla el mensaje \"esperando dato\". 4- Una vez ha aparecido el mensaje \"esperando dato\" se procede a conectar el dispositivo inal\u00e1mbrico poniendo el interruptor en posici\u00f3n ON. 5- Tras unos segundo aparecer\u00e1 la temp eratura en la pantalla LCD. En cualquier momento, y siempre despu\u00e9 s de configurarse el m\u00f3dulo Xbee del dispositivo de sobremesa, se puede entr ar al men\u00fa de confi guraci\u00f3n mediante el pulsador \"Men\u00fa\". El iente \u00e1rbol de submenus: Men\u00fa: 1- Alarma. Configura los par\u00e1metros de alarma de la temperatura. 1.1- T. Max. Dentro de este apartado se puede modificar el valor de alarma para la temperatura m\u00e1xima. 1.2- T. Min. Dentro de este apartado se puede modificar el valor de alarma para la temperatura m\u00ednima. 1.3- Act. Alarma. Dentro de este aparta do se puede activar o desactivar la alarma sonora de temperatur a. Por defecto, cua ndo arranca el equipo est\u00e1 desactivada. 1.4- Salir. Sale del submenu alarma. 2- Term\u00f3metro. Dentro de este submenu se puede configurar el tiempo de muestreo de la temperatura, un interval o de 5s m\u00ednimo a un intervalo de 60s. 3- Save conf. Dentro de este submenu se guarda la configuraci\u00f3n del usuario en la Eeprom del dispositivo. La si guiente vez que se enciende se carga la \u00faltima configuraci\u00f3n salvada. 4- Salir. Sale del men\u00fa. En caso de que una vez conectado el di spositivo de sobremesa pasen m\u00e1s de 2 minutos sin que se reciba se\u00f1al de dispositivo inal\u00e1mbrico, apar ece por pantalla la se\u00f1al de \"Dispositivo no conectado o Baja Bateria\". Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 683 MEMORIA DE C\u00c1LCULO A partir de los elementos reflejados en la memoria descriptiva, se han desarrollado dos programas para los microcont roladores de los m\u00f3dulos 1 y 2. El lenguaje utilizado es el CCS, ya que dispone de herramientas y librerias muy \u00fatiles y se trata de un le nguaje muy parecido al C. El compilador utilizado es el PCWHD versi\u00f3n 4.104 de CCS. 3.1 Diagrama de Flujo M\u00f3dulo 1: Equipo Inal\u00e1mbrico con Sensor de T\u00aa A continuaci\u00f3n se refleja el diagrama de flujo del programa que gobierna el microcontrolador. En la primera y segunda figura se muestra el diagrama de flujo de las interrupciones del TIMER1 y de la UART. Figura 40. Diagrama de flujo Interrupci\u00f3n TIMER1 Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 69 El c\u00f3digo es el siguiente: #int_TIMER1 //Vector de interrupci\u00f3n el timer1 } Funcionamiento: Cada 500 ms se produce una interrupci\u00f3n por el Timer 1 del microcontrolador. Cuando entra en la interrupci\u00f3n, se increm enta un contador y se compara con el tiempo de muestreo preestablecido. Si es mayor, entonces la variable muestrea_envia toma valor 1 y se pone a 0 el contador. Esta variable, indi car\u00e1 al programa principal qu e puede muestrear la T\u00aa del sensor y enviarla al m\u00f3dulo de sobremesa. Finalmente, se carga el Timer1 con el valor 0x0BDC para que vuelva a generar una interrupci\u00f3n a los 500 ms. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Si kbhit dato=getc() dato_recibido=1 Figura 41. Diagrama de flujo Interrupci\u00f3n UART El c\u00f3digo es el siguiente: #int_rda //Vector de interrupcion la recepcion //por el usart { if { dato[indi]=getc(); aux[indi]=dato[indi]; indi++; dato_recibido=1; ; } } Funcionamiento: Si se genera una interrupc i\u00f3n de la UART en primer l ugar miro si es debido a la entrada de un dato (if (kbhit)). Si se genera por la entrada de un dato, le o ese dato, hago una c opia en una variable auxiliar he indico al programa principal que he r ecibido un dato (dato_recibido=1). Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 71 El siguiente diagrama de flujo muestra el programa principal. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 72Inicio Inicio variables globales Configuro Xbee Si \"recibo_dato=1\" Defino el tiempo de muestreo Obtengo del sensor Envio el dato Configuro Timer1 Si \"muestrea_envia=1\" uC modo bajo consumo Xbee modo normal Obtengo T\u00aa del sensor Envio el dato Xbee bajo consumo muestrea_envia=0 Mientras TrueSi SiNoNo Figura 42. Diagrama de flujo programa principal Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 73 El c\u00f3digo del programa principal es el siguiente: void main() despierta delay_ms(20); // El Xbee tarda muestrea(); envia(); output_high(PIN_C5); // Si C5=1->SLEEP_RQ=1, Xbee entra en modo else { SCS1=1; SCS2=0; IDLE=1; sleep(); // Duermo el microcontrolador pero dejo el TIMER1, cuando provoque interrupci\u00f3n despierta. } }while (TRUE); } Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 74 Funcionamiento: En primer lugar iniciali zo las variables globales. Configuro el m\u00f3dulo Xbee mediante la acci\u00f3n inicio_Xb ee(). Durante su configuraci\u00f3n, y para entrar en modo coma ndo, el m\u00f3dulo Xbee envia el comando +++ al m\u00f3dulo de sobremesa indicando que est\u00e1 conf igurando el m\u00f3dulo Xbee, cuando termina la configuraci\u00f3n envia el car\u00e1cter \"z\", cuando \u00e9ste lo recibe, le env\u00eda un valor entero con el tiempo de muestreo deseado. En el bucle del while, se espera a recibi r este dato. Una vez recibido, se env\u00eda el car\u00e1cter \"z\" al m\u00f3dulo de sobremesa para que sepa que se ha recibido correctamente el valor del tiempo de muestreo, y de spu\u00e9s se actualiza ese valor. A continuaci\u00f3n, se activa el sensor, se toma el valor de la T\u00aa, se pone al sensor en bajo consumo y se env\u00eda ese valor por el m\u00f3dulo Xbee. Se configura el Timer1 para que genere una interrupci\u00f3n cada 500 ms y se entra en un bucle cerrado infinito. En este bucle, se mira si la variable mues trea_envia toma el valor 1, si es as\u00ed, se saca al m\u00f3dulo Xbee de su modo de bajo consumo, se saca al sensor de su modo de bajo consumo, se muestrea la T\u00aa, se pone al sensor en modo de bajo consumo, se env\u00eda el dato y se vuelve a poner al m\u00f3dulo Xbee en modo de bajo consumo. Una vez enviado, muestrea_envia vuelve a valer 0. La variable muestrea_envia toma el va lor 1 cuando el n\u00famero de interrupciones realizadas por el timer 1 toma un valor supe rior a valor de tiempo de muestreo. En ese momento, la interrupci\u00f3n pone muestrea_envia a 1 y vuelve a inicializar el contador de interrupciones. Si muestrea_envia est\u00e1 a 0, el microcont rolador entra en modo de bajo consumo. \u00danicamente despertar\u00e1 en la interrupci\u00f3n de l Timer1. Volver\u00e1 a an alizar el valor de muestrea_envia, y si es 0 vol ver\u00e1 a modo de bajo consumo, sino, enviar\u00e1 la temperatura. Este ciclo lo realizar\u00e1 infinitamente. El c\u00f3digo completo del programa se encuentra en el cap\u00edtulo de Anexos. 3.2 Diagrama de Flujo M\u00f3dulo 2: M\u00f3dulo de Sobremesa Para representar el programa del m\u00f3dulo de sobremesa se ha utilizado 3 diagramas de flujo. Los dos primeros representan los diagramas de flujo de las interrupciones provocadas por el microcontrolador, mientras que el \u00faltimo representa el desarrollo principal del programa. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 75Interrupci\u00f3n Timer1 Contador_timer1++ 43. Diagrama de flujo interrupci\u00f3n TIMER 1 El c\u00f3digo es el siguiente: #int_TIMER1 //Vector de por TIMER1 ((alarma==1)&&(activar_alarma==1)) { } { if (contador_alarma==0) { output_low(PIN_C2); Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 76 contador_alarma=1; } } } if (contador_TIMER1>180) // 60 segundos //Carga el timer1 } Funcionamiento: En el programa principal se carga el valor del Timer1 con el valor 0xBDC, con lo que conseguimos que se reali ce una interrupci\u00f3n cada 500 ms. Una vez dentro de la interrupci\u00f3n, se in crementa un contador. Cuando este contador es mayor al valor de 180, significa que no se ha recibido ning\u00fan mensaje del m\u00f3dulo inal\u00e1mbrico durante m\u00e1s de 60 segundos, por lo que se da la se\u00f1al de alarma de dispositivo no conectado. A su vez, si tenemos la alarma de te mperatura activada, cada 500 ms cambia el estado del zumbador, de activo a inactivo y viceversa, consiguiendo as\u00ed una se\u00f1al de alarma intermitente. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial Interrupci\u00f3n UART Si (comando=1) dato=getc() aux=datodato=getc() recibido=1 Fin Interrupci\u00f3nNoSi Figura 44. Diagrama de interrupci\u00f3n UART El c\u00f3digo es el siguiente: #int_rda //Vector de interrupcion la recepcion //por el { if dato[indice]= getc(); //Se lee el dato recibido indice++; } if (comando==0) { if (kbhit()) { dato[indice]=getc(); Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 78 aux[indice]=dato[indice]; indice++; recibido=1; } } } Funcionamiento: Cuando se provoca la interrupci\u00f3n de la UAR T, en primer lugar miro se el m\u00f3dulo se encuentra en modo comando, esto significa qu e est\u00e1 configurando el m\u00f3dulo Xbee. Si es as\u00ed, y tambien se da la condici\u00f3n de que la interrupci\u00f3n es provocad a por una entrada de datos, entonces guardo el dato en trante en la variable datos. Si el m\u00f3dulo no se encuentra en modo co mando, y tambi\u00e9n se da la condici\u00f3n de que la interrupci\u00f3n es provocada por una entrada de datos, guardo ese dato en la variable dato, hago una copia de dato a una variable au xiliar, aux, e indico que se ha recibido un dato. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 79Inicio Inicio LCD Inicio variables Inicio Xbee Inicio Timer1 Si (presiono Menu) Entro en menu() dispositivo_no_conectado=1 Mientras (True)escribe en LCD\"No conectado\" dispositivo_no_conectado=0Si No Si Si No Si No Si NoNo NoSi Figura 44. Diagrama de flujo programa Principal Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 80El c\u00f3digo es el siguiente: void main() { set_tris_c(00111000); //0 = salida, 1 = // Si presiona el boton Menu (PIN C3) entra en Menu. if (input(PIN_C3)) { if (C3==-1) C3++; else{ opciones_menu(); } } // recibo dato del sensor... if ((recibido==1)) { contador_TIMER1=0; // El contador de sensor no conectado vuelve a cero. index=0; // Si recibido la '+', indica que el Xbee del m\u00f3dulo sensor se est\u00e1 configurando if (dato[0]=='+') ini_xbee=0; // Si recibido la 'x', envio t_muestreo e indico que el Xbee del m\u00f3dulo sensor est\u00e1 configurado if (dato[0]=='x') { if (xbee_ok==1) { sensor_ok=0; printf(\"%d\",t_muestreo); Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 81 ini_xbee=1; } else { xbee_ok=1; printf(\"%d\",t_muestreo); ini_xbee=1; } for (index=0;index<8;index++) {dato[index]='f';} } // Si recibido la 'z', el m\u00f3dulo sensor ha recibido el tiempo de muestreo if (dato[0]=='z') { sensor_ok=1; for (index=0;index<8;index++) {dato[index]='f';} } //Si del m\u00f3dulo sensor el Xbee y el sensor est\u00e1n configurados, recibo la temperatura y la muestro por pantalla. if disp_no_conectado=0; Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 82 } }while (TRUE); } Funcionamiento: En primer lugar, inicio va riables, el m\u00f3dulo LCD, el m\u00f3dulo Xbee y el timer 1. Este \u00faltimo lo configuro para que realice una interrupci\u00f3n cada 500 ms. Una vez configurado el timer 1 el programa en tra en un bucle infinito. Dentro de este bucle realiza secuencialmente varias acciones: Si se presiona el bot\u00f3n de men\u00fa, entonces entra en la opci\u00f3n men\u00fa. Si se ha recibido un dato, lo compara con varios caracteres: 1- Si es un \"+\", significa que el m\u00f3dul o inal\u00e1mbrico est\u00e1 configurando su m\u00f3dulo Xbee. 2- Si es una \"x\" indica que el m\u00f3dulo in al\u00e1mbrico ha terminado de configurar su m\u00f3dulo Xbee, en ese momento se envia el valor del tiempo de muestreo que se desea realizar de la T\u00aa. 3- Si recibe una \"z\" indi ca que el m\u00f3dulo inal\u00e1mbric o ha recibido ese dato correctamente. 4- Si el m\u00f3dulo inalambrico ha configur ado su m\u00f3dulo Xbee y tiene el tiempo de muestreo, se escribe el dato del sensor por pa ntalla y se ejecuta la funci\u00f3n alerta. Esta compara la temperatura con un m\u00e1ximo y un m\u00ednimo y da una se\u00f1al de alarma. Si la variable dispositivo no conectado to ma valor 1, significa que hace m\u00e1s de 60 segundos que no se ha recibido un dato del di spositivo inal\u00e1mbrico, por lo que se muestra por pantalla del LCD la se\u00f1a de DI SPOSITIVO NO CONECTADO O BAJA BATER\u00cdA. El c\u00f3digo completo se encuentra en el cap\u00edtulo de Anexos. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 833.3 Bater\u00eda M\u00f3dulo 1: M\u00f3dulo inal\u00e1mbrico Para la alimentaci\u00f3n del m\u00f3dulo 1 se ha escogido un bater\u00eda de 3'6V, 2600mA, AA. Aunque existen en el mercado las pilas ti po bot\u00f3n, de menor ta ma\u00f1o, he considerado que al ser un prototipo susceptible de mejo ras y al que se le podr\u00edan a\u00f1adir nuevos componentes, la bater\u00eda a escoge r deb\u00eda estar sobredimensionada. La duraci\u00f3n aproximada de la bater\u00eda, en funcionamiento continuo, y realizando un muestreo de temperatura cada minuto ser\u00eda el siguiente: Caracter\u00edsticas de la pila: Tensi\u00f3n: 3'6 V Capacidad: 2600 mA/h Elementos conectados y consumos: Modo Normal Modo bajo consumo 11 2,50 200 0,10 45000 10 45211 12,6(uA) Dispositivos Totales (uA) = PIC 18LF2525 MCP9804 Xbee Tabla 16. Consumos en modo normal y bajo consumo Suponiendo que el usuario desea una mues tra de temperatura cada minuto, y que adquirir esa muestra en el peor de los casos conllevar\u00e1 que los componentes funcionen en modo normal durante menos de un segundo. Siendo: Tmn = tiempo (s) funcionamiento en modo normal Imn = consumo en modo normal Tbc = tiempo (s) funcionamiento en modo bajo consumo Ibc = consumo en modo bajo consumo Suponemos Tmn = 1 s y Tbc=59s. El consumo del equipo ser\u00e1: Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 84Tbc TmnIbc Tbcn TmnConsumo++=Im (10) Sustituyendo obtenemos un consumo de 0'77mA. Dividiendo la capacidad de la bater\u00eda (mA/h) entre el consumo (mA), obtenemos las horas de funcionamiento. El resultado son 3395 horas, aproxi madamente 4 meses y medio. Esta es la duraci\u00f3n del equipo si su func ionamiento fuese continuo. Si el uso dom\u00e9stico fuese igual que el de los term\u00f3metro s, su uso ser\u00eda espor\u00e1dico, por lo que el dispositivo podr\u00eda durar a\u00f1os con la misma bater\u00eda. Suponiendo su uso 10 d\u00edas al mes, durante 8 horas seguidas hacen un total de 80 horas. Diviendo entre las 3395 horas, nos salen 42 meses, aproximadamente tres a\u00f1os y medio. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 853.4 Datos experimentales Se ha comprobado el correcto funcionamien to del sensor y el envio de datos al m\u00f3dulo de sobremesa comparando la temperatura dada con la obtenida mediante un term\u00f3metro digital de farmacia. En la siguiente tabla se muestran los resultados obtenidos: Sensor Term\u00f3metro farmacia error 36,18 36,2 -0,0536,34 36,2 -0,14\u00ba C Tabla 17. Comparativa valores obtenidos. Las muestras se han obtenido en diferentes d\u00edas. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 864 PLANOS La relaci\u00f3n de planos es la siguiente: N\u00ba PLANO Plano n\u00ba 6Disposici\u00f3n de elementos M\u00f3dulo 2: M\u00f3dulo de sobremesa Fotograf\u00eda M\u00f3dulo 1 Fotograf\u00eda M\u00f3dulo 2Descripci\u00f3n Esquema M\u00f3dulo 1: M\u00f3dulo inal\u00e1mbrico Esquema M\u00f3dulo 2: M\u00f3dulo de sobremesa Disposici\u00f3n elementos M\u00f3dulo 1: M\u00f3dulo Inal\u00e1mbrico Tabla 18. Relaci\u00f3n de planos. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 8 7 N\u00ba Plano: Plano 1 T\u00edtulo: Escala M\u00f3dulo 1: M\u00f3dulo inal\u00e1mbrico Monitorizaci\u00f3n wireless de las constantes vitales de un beb\u00e9 y Electr\u00f3nica Industrial 88 N\u00ba Plano: Plano 2 T\u00edtulo: Escala Proyecto: Versi\u00f3n 1/1Esquema M\u00f3dulo 2: M\u00f3dulo de sobremesa Monitorizaci\u00f3n wireless de las constantes vitales 10kJ2 LCD_PIN OUT 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 R710kV3 beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 89 N\u00ba Plano: Plano 3 T\u00edtulo: Escala Proyecto: elementos M\u00f3dulo 1: M\u00f3dulo Inal\u00e1mbrico Monitorizaci\u00f3n wireless de las Wireless Constantes beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 90 N\u00ba Plano: Plano 4 T\u00edtulo: Escala Proyecto: Versi\u00f3n Fecha: 01/06/2011 1/1Disposici\u00f3n de elementos M\u00f3dulo 2: M\u00f3dulo de sobremesa Monitorizaci\u00f3n wireless de las constantes vitales de un beb\u00e9 --:-- 0D1C2 D2 y Electr\u00f3nica Industrial 91 N\u00ba Plano: Plano 5 T\u00edtulo: Escala Proyecto: Versi\u00f3n Fecha: 01/06/2011 Hoja 1/1Fotograf\u00eda M\u00f3dulo 1 Monitorizaci\u00f3n wireless de las constantes vitales de un beb\u00e9 --:-- 0 Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 92 N\u00ba Plano: Plano 6 T\u00edtulo: Escala Proyecto: Versi\u00f3n Fecha: 01/06/2011 Hoja 1/1Fotograf\u00eda M\u00f3dulo 2 Monitorizaci\u00f3n wireless de las constantes vitales de un beb\u00e9 --:-- 0 Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 5 PRESUPUESTO 5.1 Mediciones Las mediciones son el conjunto de todos los conceptos necesarios pa ra la ejecuci\u00f3n del proyecto, agrupando por separado todas a quellas unidades que s ean objeto del mismo precio. Las mediciones del proyect o son las siguientes: ITEM UNIDAD DESCRIPCI \u00d3NC A N T I D A D 1 ud Suministro y montaje de OMNICELL - ER14505S - BATER\u00cdA, LITIO, AA, 3'6V, 2400mAh1 2 ud Suministro y montaje de KEYSTONE - 2460 - BATTERY HOLDER 1 3 ud Suministro y montaje de microcontrolador de MICROCHIP - PIC18LF2525-I/SP - 8- BIT MCU, 48K FLASH, PDIP282 4 ud Suministro y montaje de MULTICOMP - 2227MC-28-06-07-F1 - Z\u00d3CALO, DIL, 0.6\", 28V\u00cdAS2 5 ud Suministro y montaje de NKK SWITCHES - GW12RHP - INTERRUPTOR OSCILANTE, SPDT, ON-ON 2 6 ud Suministro y montaje de ALPS - SKHHARA010 - INTERRUPTOR, T\u00c1CTIL, PCB, 2.55N2 7 ud Suministro y montaje de Resistencia 10 k , 0'25W, 1% 8 8 ud Suministro y montaje de placa a topos de 160x100mm. 19 ud Suministro y montaje de sensor de temperatura MCP9804-E/MS. 1 10 ud Suministro y montaje de placa MSOP a DIP para sensor. 1 11 ud Suministro y montaje de m\u00f3dulo Xbee de MaxStream 1mW con chip antena. 2 12 ud Suministro y montaje de placa DIP para m\u00f3dulo Xbee. 213 ud Suministro y montaje de LUMBERG - 1613 20 - HEMBRA, CC, 90 GRADOS, MONTAJE PCB .1 14 ud Suministro y montaje de LUMBERG - NES/J 135 - MACHO, BAJA TENSI\u00d3N, 1.35mm.1 15 ud Suministro y montaje de condensador electrol\u00edtico 0,1 uF, 16V. 1 16 ud Suministro y montaje de condensador electrol\u00edtico 1 uF, 16V. 217 ud Suministro y montaje de condensador electrol\u00edtico 10 uF, 16V. 118 ud Suministro y montaje de condensador 1 nF. 219 ud Suministro y montaje de STMICROELECTRONICS - BAT48 - DIODO, SCHOTTKY, PEQUE\u00d1A SE\u00d1AL2 20 ud Suministro y montaje de Resistencia 330 k , 0'25W, 1% 2 21 ud Suministro y montaje de ptenciometro multivuelta 10 k .1 22 ud Suministro y montaje de Interruptor MSP 121C N/A 650mA Negro 323 ud Suministro y montaje de led estandar amarillo 1 24 ud Suministro y montaje de regulador de tensi\u00f3n LM317. 1 25 ud Suministro y montaje de regulador de tensi\u00f3n 7805. 126 ud Suministro y montaje de LCD alfanum\u00e9rico de 2x16 127 ud Suministro, montaje y mecanizado de caja pl\u00e1stica.120x60x40mm. 128 Pa Peque\u00f1o material, cables... 1MEDICIONES 5.2 Cuadro de Precios Unitarios En los Precios Unitarios figuran en letra y cifra los precios totales de cada una de las unidades que aparecen en la obra sin detallar su descomposici\u00f3n. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 94ITEM UNIDAD DESCRIPCI\u00d3N CANTIDAD Prec. Unitario TOTAL 1 ud Suministro y montaje de OMNICELL - ER14505S - BATER\u00cdA, LITIO, AA, 3'6V, 2400mAh13 , 6 4 3 , 6 4 (TRES EUROS Y SESENTA Y CUATRO C\u00c9NTIMOS ) 2 ud Suministro y monta je de KEYSTONE - 2460 - BATTERY HOLDER 1 1,53 1,53 (UN EURO Y CINCUENTA Y TRES C\u00c9NTIMOS ) 3 ud Suministro y montaje de microcontrolador de MICROCHIP - PIC18LF2525-I/SP - 8-BIT MCU 7 6 , 4 7 (SEIS EUROS Y CUARENTA Y SIETE EUROS ) 4 ud Suministro y montaje de MULTICOMP - 2227MC-28-06-07-F1 - Z\u00d3CALO, DIL, 0.6\", 28V\u00cdAS11 , 5 8 1 , 5 8 (UN EURO Y CINCUENTA Y OCHO C\u00c9NTIMOS ) 5 ud Suministro y montaje de NKK SWITCHES - - INTERRUPTOR OSCILANTE 12 , 0 2 2 , 0 2 (DOS EUROS Y DOS C\u00c9NTIMOS ) 6 ud Suministro y montaje de ALPS - SKHHARA010 - INTERRUPTOR, T\u00c1CTIL, PCB, 2.55N10 , 8 9 0 , 8 9 (OCHENTA Y NUEVE C\u00c9NTIMOS ) 7 ud Suministro y monta je de Resistencia 10 k , 0'25W, 1% 1 0,27 0,27 (VEINTISIETE C\u00c9NTIMOS ) 8 ud Suministro y monta je de placa a to pos de 160x100mm. 1 4 4 (CUATRO EUROS ) 9 ud Suministro y monta je de sensor de tem peratura MCP9804-E/MS. 1 4,15 4,15 (CUATRO EUROS Y QUINCE C\u00c9NTIMOS ) 10 ud Suministro y monta je de placa MSOP a DIP para sensor. 1 1,55 1,55 (UN EURO Y CINCUENTA Y CINCO C\u00c9NTIMOS ) 11 ud Suministro y montaje de m\u00f3dulo Xbee de MaxStream 1mW con chip antena. 1 17 17 (DIECISIETE EUROS ) 12 ud Suministro y monta je de placa DIP para m\u00f3dulo Xbee. 1 2,7 2,7 (DOS EUROS Y SETENTA C\u00c9NTIMOS ) 13 ud Suministro y montaje de LUMBERG - 1613 20 - HEMBRA, CC, 90 GRADOS, MONTAJE PCB .11 , 7 9 1 , 7 9 (UN EURO Y SETENTA Y NUEVE C\u00c9NTIMOS ) 14 ud Suministro y montaje de LUMBERG - NES/J 135 - MACHO, BAJA TENSI\u00d3N, 1.35mm.11 , 41 , 4 (UN EURO Y CUARENTA C\u00c9NTIMOS ) 15 ud Suministro y monta je de condensador electrol\u00edtico 0,1 uF, 16V. 1 0,75 0,75 (SETENTA Y CINCO C\u00c9NTIMOS ) 16 ud Suministro y monta je de condensador electrol\u00edtico 1 uF, 16V. 1 0,75 0,75 (SETENTA Y CINCO C\u00c9NTIMOS ) 17 ud Suministro y monta je de condensador electrol\u00edtico 10 uF, 16V. 1 0,75 0,75 (SETENTA Y CINCO C\u00c9NTIMOS ) 18 ud Suministro y monta je de condensador 1 nF. 1 0,75 0,75 (SETENTA Y CINCO C\u00c9NTIMOS ) 19 ud Suministro y montaje de STMICROELECTRONICS - BAT48 - DIODO, SCHOTTKY , PEQUE\u00d1A SE\u00d1AL10 , 7 1 0 , 7 1 (SETENTA Y UN C\u00c9NTIMOS ) 20 ud Suministro y monta je de Resistencia 330 k , 0'25W, 1% 1 0,27 0,27 (VEINTISIETE C\u00c9NTIMOS )PRECIOS DESCOMPUESTOS Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 95ITEM UNIDAD DESCRIPCI \u00d3N CANTIDAD Prec. Unitario TOTAL 21 ud Suministro y monta je de potenciometro multivuelta 10 k . 1 0,61 0,61 (SESENTA Y UN C\u00c9NTIMOS ) 22 ud Suministro y monta je de Interru 121C N/A 650mA Ne (DOS EUROS CON DIECINUEVE C\u00c9NTIMOS ) 23 ud Suministro y monta je de led estandar amarillo 1 0,49 0,49 (CUARENTA Y NUEVE C\u00c9NTIMOS ) 24 ud Suministro y monta je de re gulador de tensi\u00f3n LM317. 1 1,55 1,55 (UN EURO CON CINCUENTA Y CINCO C\u00c9NTIMOS ) 25 ud Suministro y monta je de re gulador de tensi\u00f3n 7805. 1 1,27 1,27 (UN EURO Y VEINTISIETE C\u00c9NTIMOS ) 26 ud Suministro y monta je de LCD alfanum\u00e9rico de 2x16 1 7,33 7,33 (SIETE EUROS Y TREINTA Y TRES C\u00c9NTIMOS ) 27 ud Suministro, monta je y mecanizado de ca ja pl\u00e1stica.120x60x40mm. 1 16 16 (DIECISEIS C\u00c9NTIMOS ) 28 Pa Pe que\u00f1o material, cables... 1 4,6 4,6 (CUATRO EUROS Y SEIS C\u00c9NTIMOS )PRECIOS DESCOMPUESTOS 5.3 Cuadro de Precios Descompuestos En el cuadro de precios descompuestos se de talla la descomposici\u00f3n de cada uno de los precios que figura en el Cuad ro de Precios Unitarios. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 96ITEM UNIDAD DESCRIPCI\u00d3N CANTIDAD Prec. Unitario TOTAL 1 ud Suministro y montaje de OMNICELL - ER14505S - BATER\u00cdA, LITIO, AA, 3'6V, 2400mAh13 , 6 4 3 , 6 4 Material: OMNICELL - ER14505S - BATER\u00cdA, 3,64 Mano de obra: hr Horas traba jadas 0 12 0 Total 3,64 2 ud Suministro y monta je de KEYSTONE - 2460 - BATTERY HOLDER 1 KEYSTONE - 2460 HOLDER 0,93 0,93 Mano de obra: hr Horas traba jadas 0,05 12 0,6 Total 1,53 3 ud Suministro y montaje de microcontrolador de MICROCHIP - PIC18LF2525-I/SP Horas traba jadas 0 12 0 Total 6,47 4 ud Suministro y montaje de MULTICOMP - 2227MC-28-06-07-F1 - Z\u00d3CALO, DIL, 0.6\", 28V\u00cdAS21 obra: hr Horas traba jadas 0,05 12 0,6 Total 1,58 5 ud Suministro y montaje de NKK SWITCHES - GW12RHP - INTERRUPTOR OSCILANTE NKK Mano de obra: hr Horas traba jadas 0,05 12 0,6 Total 2,02 6 ud Suministro y montaje de ALPS - SKHHARA010 - INTERRUPTOR, T\u00c1CTIL, PCB, 2.55N20 - SKHHARA010 - INTERRUPTOR, PCB, 2.55N 0,29 0,29 Mano de obra: hr Horas traba jadas 0,05 12 0,6 Total 0,89 7 ud Suministro y monta je de Resistencia 10 k , 0'25W, 1% 8 0,27 2,16 Material: ud Resistencia 10 k , 0'25W, 1% 1 0,03 0,03 Mano de obra: hr Horas traba jadas 0,02 12 0,24 Total 0,27 8 ud Suministro y monta je de placa a to pos de 160x100mm. 1 4 4 Material: ud placa a topos de 160x100mm. 1 44 Mano de obra: hr Horas traba jadas 0 12 0 Total 4PRECIOS DESCOMPUESTOS Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 97ITEM UNIDAD DESCRIPCI\u00d3N CANTIDAD Prec. Unitario TOTAL 9 ud Suministro y monta je de sensor de tem peratura MCP9804-E/MS. 1 4,15 4,15 Material: ud sensor de temperatura MCP9804-E/MS. 1 1,75 1,75 Mano de obra: hr Horas traba jadas 0,2 12 2,4 Total 4,15 10 ud Suministro y monta je de placa MSOP a DIP para sensor. 1 1,55 1,55 Material: ud placa MSOP a DIP para sensor. 1 0,95 0,95 Mano de obra: hr Horas traba jadas 0,05 12 0,6 Total 1,55 11 ud Suministro y montaje de m\u00f3dulo Xbee de MaxStream 1mW con chip antena. 2 17 34 Material: ud m\u00f3dulo Xbee de MaxStream 1mW con chip antena. 1 16,4 16,4 Mano de obra: hr Horas traba jadas 0,05 12 0,6 Total 17 12 ud Suministro y monta je de placa DIP para m\u00f3dulo Xbee. 2 2,7 5,4 Material: ud placa DIP para m\u00f3dulo Xbee. 1 2,1 2,1 Mano de obra: hr Horas traba jadas 0,05 12 0,6 Total 2,7 13 ud Suministro y montaje de LUMBERG - 1613 20 - HEMBRA, CC, 90 GRADOS, MONTAJE PCB .11 , 7 9 1 , 7 9 Material: ud LUMBERG - 1613 20 - HEMBRA, CC, 90 GRADOS, MONTAJE PCB . 1 1,19 1,19 Mano de obra: hr Horas traba jadas 0,05 12 0,6 Total 1,79 14 ud Suministro y montaje de LUMBERG - NES/J 135 - MACHO, BAJA TENSI\u00d3N, 1.35mm.11 , 41 , 4 Material: ud LUMBERG - NES/J 135 - MACHO, BAJA TENSI\u00d3N, 1.35mm. 1 0,8 0,8 Mano de obra: hr Horas traba jadas 0,05 12 0,6 Total 1,4 15 ud Suministro y monta je de condensador electrol\u00edtico 0,1 uF, 16V. 1 0,75 0,75 Material: ud condensador electrol\u00edtico 0,1 uF, 16V. 1 0,15 0,15 Mano de obra: hr Horas traba jadas 0,05 12 0,6 Total 0,75 16 ud Suministro y monta je de condensador electrol\u00edtico 1 uF, 16V. 2 0,75 1,5 Material: ud condensador electrol\u00edtico 1 uF, 16V. 1 0,15 0,15 Mano de obra: hr Horas traba jadas 0,05 12 0,6 Total 0,75 17 ud Suministro y monta je de condensador electrol\u00edtico 10 uF, 16V. 1 0,75 0,75 Material: ud condensador electrol\u00edtico 10 uF, 16V. 1 0,15 0,15 Mano de obra: hr Horas traba jadas 0,05 12 0,6 Total 0,75PRECIOS DESCOMPUESTOS Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 98ITEM UNIDAD DESCRIPCI\u00d3N CANTIDAD Prec. Unitario TOTAL 18 ud Suministro y monta je de condensador 1 nF. 2 0,75 1,5 Material: ud condensador 1 nF. 1 0,15 0,15 Mano de obra: hr Horas trabajadas 0,05 12 0,6 Total 0,75 19 ud Suministro y montaje de STMICROELECTRONICS - BAT48 - DIODO, SCHOTTKY 0,11 0,11 Mano de obra: hr Horas traba jadas 0,05 12 0,6 Total 0,71 20 ud Suministro y monta je de Resistencia 330 k , 0'25W, 1% 2 0,27 0,54 Material: ud Resistencia 330 k , 0'25W, 1% 1 0,03 0,03 Mano de obra: hr Horas traba jadas 0,02 12 0,24 Total 0,27 21 ud Suministro y monta je de potenciometro multivuelta 10 k . 1 0,61 0,61 Material: ud potenciometro multivuelta 10 k .1 0,25 0,25 Mano de obra: hr Horas traba jadas 0,03 12 0,36 Total 0,61 22 ud Suministro y monta je de Interru ptor Horas traba jadas 0,02 12 0,24 Total 2,19 23 ud Suministro y monta je de led estandar amarillo 1 0,49 0,49 Material: ud led estandar amarillo 1 0,25 0,25 Mano de obra: hr Horas traba jadas 0,02 12 0,24 Total 0,49 24 ud Suministro y monta je de re gulador de tensi\u00f3n LM317. 1 1,55 1,55 Material: ud regulador de tensi\u00f3n LM317. 1 0,95 0,95 Mano de obra: hr Horas traba jadas 0,05 12 0,6 Total 1,55 25 ud Suministro y monta je de re gulador de tensi\u00f3n 7805. 1 1,27 1,27 Material: ud re gulador de tensi\u00f3n 7805. 1 0,67 0,67 Mano de obra: hr Horas trabajadas 0,05 12 0,6 Total 1,27 26 ud Suministro y monta je de LCD alfanum\u00e9rico de 2x16 1 7,33 de obra: hr Horas traba jadas 0,1 12 1,2 Total 7,33 27 ud Suministro, monta je y mecanizado de ca ja pl\u00e1stica.120x60x40mm. 1 16 16 Material: ud ca ja pl\u00e1stica.120x60x40mm. 1 44 Mano de obra: hr Horas trabajadas 1 12 12 Total 16 28 Pa Pe que\u00f1o material, cables... 1 4,6 4,6 Material: ud Cable, conectores, esta\u00f1o ... 1 44 Mano de obra: hr Horas traba jadas 0,05 12 0,6 Total 4,6PRECIOS DESCOMPUESTOS Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 995.4 Presupuesto El presupuesto es el siguiente: ITEM UNIDAD DESCRIPCI \u00d3N CANTIDAD PRECIO UNITARIO PRECIO TOTAL M\u00f3dulo 1 : Equipo a bater\u00eda con sensor de temperatura 1 ud Suministro y montaje de OMNICELL - ER14505S - BATER\u00cdA, LITIO, AA, 3'6V, 2400mAh1 3,64 3,64 2 ud Suministro y - 2460 - BATTERY HOLDER1 1,53 1,53 3 ud Suministro y montaje de microcontrolador de MICROCHIP - PIC18LF2525-I/SP - 8-BIT MCU, 48K FLASH, PDIP281 6,47 MULTICOMP - 2227MC-28-06-07-F1 - Z\u00d3CALO, DIL, 0.6\", 28V\u00cdAS1 1,58 1,58 5 ud Suministro y montaje de NKK SWITCHES - GW12RHP - INTERRUPTOR OSCILANTE, SPDT, ON-ON 1 2,02 2,02 6 ud Suministro y montaje de condensador electrol\u00edtico 10uF, 16V. 1 0,75 0,757 ud Suministro y montaje de STMICROELECTRONICS - BAT48 - DIODO, SCHOTTKY, PEQUE\u00d1A SE\u00d1AL1 0,71 0,71 8 ud Suministro y montaje de ALPS - SKHHARA010 - INTERRUPTOR, T\u00c1CTIL, PCB, 2.55N1 0,89 0,89 9 ud Suministro y montaje de Resistencia 10 k , 0'25W, 1% 3 0,27 0,81 10 ud Suministro y montaje de placa a topos de 160x100mm. 0,5 4 2 11 ud Suministro y montaje de sensor de temperatura MCP9804- E/MS.1 4,15 4,15 12 ud Suministro y montaje de placa MSOP a DIP para sensor. 1 1,55 1,55 13 ud Suministro y montaje de m\u00f3dulo Xbee de MaxStream 1mW con chip antena.11 7 1 7 14 ud Suministro y montaje de placa DIP para m\u00f3dulo Xbee. 1 2,70 2,7 15 Pa Peque\u00f1o material, cables... 0,5 4,6 2,3 TOTAL M\u00d3DULO 1 48,1 M\u00f3dulo 2 : Equipo de sobremesa 1 ud Suministro y montaje de LUMBERG - 1613 20 - HEMBRA, CC, 90 GRADOS, MONTAJE PCB .1 1,79 1,79 2 ud Suministro y montaje de LUMBERG - NES/J 135 - MACHO, BAJA TENSI \u00d3N, 1.35mm.11 , 4 1 , 4 3 ud Suministro y montaje de microcontrolador de MICROCHIP - PIC18LF2525-I/SP - 8-BIT MCU, 48K FLASH, PDIP281 6,47 MULTICOMP - 2227MC-28-06-07-F1 - Z\u00d3CALO, DIL, 0.6\", 28V\u00cdAS1 1,58 1,58 5 ud Suministro y montaje de NKK SWITCHES - GW12RHP - INTERRUPTOR OSCILANTE, SPDT, ON-ON 1 2,02 2,02 6 ud Suministro y montaje de condensador electrol\u00edtico 0,1 uF, 16V.1 0,75 0,75 7 ud Suministro y montaje de condensador electrol\u00edtico 1 uF, 16V. 2 0,75 1,5 8 ud Suministro y montaje de condensador electrol\u00edtico 10 uF, 16V. 1 0,75 0,759 ud Suministro y montaje de condensador 1 nF. 1 0,75 0,75 10 ud Suministro y montaje de STMICROELECTRONICS - BAT48 - DIODO, SCHOTTKY, PEQUE\u00d1A SE\u00d1AL1 0,71 0,71 11 ud Suministro y montaje de ALPS - SKHHARA010 - INTERRUPTOR, T\u00c1CTIL, PCB, 2.55N1 0,89 0,89 12 ud Suministro y montaje de Resistencia 330 k , 0'25W, 1% 2 0,27 0,54 13 ud Suministro y montaje de Resistencia 10 k , 0'25W, 1% 5 0,27 1,35 14 ud Suministro y montaje de ptenciometro multivuelta 10 k . 1 0,61 0,61 15 ud Suministro y montaje de placa a topos de 160x100mm. 1 4 4 16 ud Suministro y montaje de Interruptor MSP 121C N/A 650mA Negro3 2,19 6,57 17 ud Suministro y montaje de led estandar amarillo 1 0,49 0,49 18 ud Suministro y montaje de regulador de tensi\u00f3n LM317. 1 1,55 1,55 19 ud Suministro y montaje de regulador de tensi\u00f3n 7805. 1 1,27 1,2720 ud Suministro y montaje de LCD alfanum\u00e9rico de 2x16 1 7,33 7,33 21 ud Suministro y montaje de m\u00f3dulo Xbee de MaxStream 1mW con chip antena.11 7 1 7 22 ud Suministro y montaje de placa DIP para m\u00f3dulo Xbee. 1 2,70 2,7 23 ud Suministro, montaje y mecanizado de caja pl\u00e1stica.120x60x40mm.11 6 1 6 24 Pa Peque\u00f1o material, cables... 0,5 4,6 2,3 TOTAL M\u00d3DULO 2 80,32 TOTAL PRESUPUESTO 128,42 Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 1005.5 Resumen del Presupuesto El presupuesto para la ejecuci\u00f3n de los prototipos incluyendo el material y la mano de obra de montaje asciende a 128'42 \u20ac. (CIENTO VEINTIOCHO EUROS CON CUARENTA Y DOS C\u00c9NTIMOS) No se ha contemplado en el presupuesto las horas de dise\u00f1o y programaci\u00f3n de los prototipos. En caso de su fabricaci\u00f3n a gran escala el precio de montaje descender\u00eda notablemente debido sobre todo a: - Un mejor precio en la compra de los mate riales. La compra de grandes cantidades provoca que los proveedores ajustan m\u00e1s sus precios. Por ejemplo: PIC 18LF2525 : 1 ud 6'47 euros 100 ud 4'07 euros Se logra una rebaja en el precio de compra de un 37%. - Disminuci\u00f3n de la mano de obra en la fabricaci\u00f3n. En un proceso totalmente automatizado la mano de obra para la fabricaci\u00f3n ser\u00eda pr\u00e1cticamente nula. Por ejemplo: En este proyecto, la mano de obra imputada al total del presupuesto hace incrementar el total en un 26'7%. Considero que una producci\u00f3n en masa podr\u00eda significar una reducci\u00f3n del presupuesto en un 53%, alcanzando un total de unos 59 euros los dos m\u00f3dulos. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 1016 CONCLUSIONES El objetivo principal de este proyecto ha si do realizar un sistema de monitorizaci\u00f3n de la temperatura para bebes wire less. Este tipo de equipos no ex isten en el mercado actual a nivel dom\u00e9stico, aunque si se pueden en contrar aplicaciones espec\u00edficas a nivel hospitalario. Como objetivos secundarios se pretend\u00eda conseguir que los equipos dise\u00f1ados tuviesen un coste, consumo de energ\u00eda y tama\u00f1o m\u00ednimo. El proyecto ha presentado dos fases bien diferenciadas. Una primera etapa en la que se ha tenido que decidir la estruc tura de los m\u00f3dulos, se ha de finido el funcionamiento de ambos y se han escogido los componentes adec uados. Y una segunda etap a en la que se ha realizado la implementaci\u00f3n en una versi\u00f3 n de prototipo de los m\u00f3dulos y se ha comprobado su funcionamiento. Se ha dise\u00f1ado e implementado un m\u00f3dulo inal \u00e1mbrico, el cual dispone de un sensor de temperatura y funciona alimentado median te bater\u00eda, y un m\u00f3dulo de sobremesa, encargado de mostrar la lectura de temper atura y realizar un aviso sonoro en caso de alarma. En el m\u00f3dulo inal\u00e1mbrico la gesti\u00f3n de la energ\u00eda ha sido un factor determinante ya que de ello depend\u00eda la duraci\u00f3n de la bater\u00eda. Para la comunicaci\u00f3n wireles se ha utilizado la tecnolog\u00eda Zigbee. Esta tecnolog\u00eda ha sido dise\u00f1ada para aplicaciones de bajo consumo y baja tasa de transferencia de datos, por lo que la hac\u00eda ideal para esta aplicaci\u00f3n. Se ha profundizado en la comunicaci\u00f3n mediante esta tecnolog\u00eda as\u00ed como en la programaci\u00f3n de los micr ocontroladores en lenguaje C. Experimentalmente se ha comprobado el correcto funcionamiento del sensor comparando sus medidas con un term\u00f3metro digital de farmacia. Tambi\u00e9n se ha comprobado el rango de dist ancia alzanzado en la comuni caci\u00f3n, siendo los resultados satisfactorios y mostrados en el proyecto. Se puede afirmar que se ha alcanzado el objetivo principal del proyecto de manera satisfactoria. La posible producci\u00f3n de estos m\u00f3dulos a nivel comercial supondr\u00eda rellenar un hueco en el mercado de los term\u00f3metros todav\u00eda si n explotar. Gracias a estos m\u00f3dulos, se puede mejorar el control de la temperatura en beb\u00e9 s. Por extensi\u00f3n, tambi\u00e9n se podr\u00eda aplicar a adultos enfermos o con minusval\u00edas. Durante el desarrollo del proyecto han surgido m\u00faltiples aplicaciones adem\u00e1s de la inicial y posibles mejoras. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 102Como posibles mejoras y aplicaciones indi car que la tecnolog\u00ed a Zigbee permite la realizaci\u00f3n de redes de com unicaci\u00f3n con un \u00fanico m\u00f3dulo coordi nador, en nuestro caso el m\u00f3dulo de sobremesa. Con este tipo de red, se podr\u00eda monito rizar desde enfermer\u00eda a todos los pacientes de una planta hospitalaria de ma nera continua, o una madre podr\u00eda controlar a todos sus hijos. Otras posibles mejoras ser\u00eda la incorporaci\u00f3n de nuevos sensores capaces de medir el ritmo card\u00edaco, el ritmo resp iratorio e incluso la tensi \u00f3n sangu\u00ednea. Con estos nuevos sensores se podr\u00eda monitorizar las principales constantes vitales de beb\u00e9s, de enfermos, o incluso de deportistas de \u00e9lite. La muerte s\u00fabita causa m\u00faltiples muertes en los beb\u00e9s as\u00ed como en los deportistas de \u00e9lite. Los m\u00f3dulos multisensor podr\u00edan avisar al personal m\u00e9dico cuando alguna de las constantes vitales comenzasen a fallar, anticip\u00e1ndose el personal m\u00e9dico a la muerte s\u00fabita. Considero que queda justificada la necesidad de continuar desarrollando los prototipos dise\u00f1ados, mejor\u00e1ndolos en tama\u00f1o, precio y operatividad. A nivel personal he decidido realizar este proyecto ya que considero que una de las v\u00edas hacia una mejor atenci\u00f3n sanitaria tant o a nivel hospitalario como dom\u00e9stico, se realiza a trav\u00e9s de la prevenci\u00f3n y la vigilanc ia estrecha de las constantes vitales de los beb\u00e9s y pacientes. Por este motivo he pretendido desarrollar una herramienta que facilite a los padres la vigilancia de sus beb\u00e9s cuando estos se encuentren enfermos. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 1037 ANEXOS 7.1 Programa en CCS M\u00f3dulo 1. #include <18F2525.h> #device adc=10//La resoluci\u00f3n del m\u00f3dulo A/D es void beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 104#int_rda //Vector de interrupcion de la recepcion de datos {} tiempo_de_muestreo=((aux[0]-48)*10)+(aux[1]-48); delay_ms(1000); muestrea(); Monitorizaci\u00f3n Wireless Constantes Autom\u00e1tica y Electr\u00f3nica Industrial 105 envia(); inicio_TIMER1(); do { if (muestrea_envia==1) { output_low(PIN_C5); despierta delay_ms(20); // El Xbee tarda muestrea(); envia(); output_high(PIN_C5); // Si C5=1->SLEEP_RQ=1, Xbee entra en modo else { SCS1=1; SCS2=0; IDLE=1; sleep(); // Duermo el microcontrolador pero dejo el TIMER1, cuando provoque interrupci\u00f3n despierta. } }while (TRUE); } //FUNCIONES convierte_a_T() } void { // Direcci\u00f3n escritura Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 TIMER1 cada 500 ms. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 108set_timer1(0x0BDC);//Carga del TMR1 con el valor 3036, 0x0BDC es BBBB printf(\"ATMYBBBB\\r\"); delay_ms(1500); del m\u00f3dulo de destino // La PAN ID es 0x3332 baudios printf(\"ATBD3\\r\"); delay_ms(1500); 12. printf(\"ATCHC\\r\"); delay_ms(1500); // Se elige MODO SLEEP 1 controlado por un pin (1=sleep / 0=wake up). printf(\"ATSM1\\r\"); delay_ms(1500); // Graba todos los par\u00e1metros en Sale del modo comando printf(\"ATCN\\r\"); delay_ms(3000); printf(\"x\"); // se\u00f1al para el coordinador de fin de configuracion } Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 1097.2 Programa en CCS M\u00f3dulo 2. #include <18F2525.h> // alarma float const Tmin_default_valor=35.50; // valor predeterminado como minima temperatura para alarma int const Sample_default_valor=60; // valor mediante el cual se configura el tiempo de muestreo 60*500ms=30s int const Tmax_default_adress=0x0A; // direcci\u00f3n de EEPROM donde se guarda la maxima elegida por el usuario int const Tmin_default_adress=0x14; // direcci\u00f3n de EEPROM donde se guarda la T\u00aa minima elegida por el usuario int const Sample_default_adress=0x1E; // direcci\u00f3n de EEPROM donde se guarda el tiempo de muestreo de la T\u00aa long const pulsacion=300; // tiempo en ms que espera para evitar rebotes en los pulsadores int const primer_adress=0x28; // direccion donde guardo si el programa se ejecuta por primera vez // DECLARO FUNCIONES Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 110void inicio_LCD(); void inicio_Xbee(); void inicio_variables(); // DECLARO INTERRUPCIONES Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 111#int_TIMER1 //Vector de interrupci\u00f3n por TIMER1 (temporizador) void ((alarma==1)&&(activar_alarma==1)) { } else { if (contador_alarma==0) { output_low(PIN_C2); contador_alarma=1; } } } if (contador_TIMER1>180) void //por el { if getc(); //Se lee el dato recibido indice++; } Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 112 } if (comando==0) { if (kbhit()) { dato[indice]=getc(); aux[indice]=dato[indice]; indice++; recibido=1; } //PROGRAMA PRINCIPAL void main() { set_tris_c(00111000); //0 = salida, 1 = entrada // Si presiona el boton Menu (PIN C3) entra en Menu. if (input(PIN_C3)) { if (C3==-1) C3++; else{ opciones_menu(); } } // recibo dato del sensor... if ((recibido==1)) { contador_TIMER1=0; // El contador de sensor no conectado vuelve a cero. Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 113 index=0; // Si recibido la '+', indica que el Xbee del m\u00f3dulo sensor se est\u00e1 configurando if (dato[0]=='+') ini_xbee=0; // Si recibido la 'x', envio t_muestreo e indico que el Xbee del m\u00f3dulo sensor est\u00e1 configurado if (dato[0]=='x') { if (xbee_ok==1) { sensor_ok=0; printf(\"%d\",t_muestreo); {dato[index]='f';} } // Si recibido la 'z', el m\u00f3dulo sensor ha recibido el tiempo de muestreo if (dato[0]=='z') { sensor_ok=1; for (index=0;index<8;index++) {dato[index]='f';} } //Si del m\u00f3dulo sensor el Xbee y el sensor est\u00e1n configurados, recibo la temperatura y la muestro por pantalla. Industrial 114 } index=0; T_real=0; delay_us(15); if (T_real<T_min) { alarma=1; lcd_putc(\"\\n } else { else { } } } Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 115 void inicio_TIMER1() { contador_TIMER1=0; setup_timer_1(T1_INTERNAL|T1_DIV_BY_8); //Setup timer: TIMER1 cada set_timer1(0x0BDC);//Carga del TMR1 con el valor 3036, 0x0BDC Monitorizaci\u00f3n Wireless Constantes y Electr\u00f3nica Industrial 116 indice=0; escribe_dato_LCD(); // La direcci\u00f3n del (lcd_putc,\"\\fATCHC\\n\"); y Electr\u00f3nica Industrial 117 lcd_putc(\"\\f.esperando dato.\\n\"); } void escribe_dato_LCD() { { y m\u00ednima de alarma. Un byte de la eeprom viene de f\u00e1brica con valor entero -1. Leo una posici\u00f3n de memoria a la que llamo // \"primer\", si vale -1 es que se ejecuta por primera vez el programa y cargo las temperaturas iniciales, si es diferente de -1, cargo las que tenga guardada la eeprom. int primer; primer=read_eeprom(primer_adress); if (primer==-1) { Monitorizaci\u00f3n Wireless Constantes Vitalesde un write_float_eeprom(Tmax_default_adress,Tmax_default_valor); Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 119 { if (C3==-1) C3++; else aceptar=1; } if (input y Electr\u00f3nica Industrial 121 if (aceptar==0){ } Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 123 else { activar_alarma=0; output_low(PIN_C2); } delay_ms(pulsacion);} } if (activar_alarma==0) { \"); \"); } }while (salir); Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 124} void t_config() (temp_maxima) Configuro la variable temperatura m\u00e1xima. { salir=1; do { if (input (PIN_C3)) Autom\u00e1tica y Electr\u00f3nica Industrial 125else // Configuro la variable de la temperatura m\u00ednima. { salir=1; do { if (input (PIN_C3)) segundos; C3=-1; C4=-1; Monitorizaci\u00f3n Wireless Constantes Vitalesde un beb\u00e9 Autom\u00e1tica Electr\u00f3nica Industrial 126C5=-1; salir=1; do un beb\u00e9 Autom\u00e1tica y Electr\u00f3nica Industrial 1277.3 Ficheros En el cd adjunto al proyecto se encuentr an todos los ficheros de programaci\u00f3n as\u00ed como las hojas de caracter\u00edsticas t\u00e9cnicas de los equipos empleados. "}