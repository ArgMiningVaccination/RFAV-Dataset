{"title": "PDF", "author": "PDF", "url": "https://www.brookings.edu/wp-content/uploads/2014/11/Likelihood-Ratio-Based-Tests-Webinar-Slides.pdf", "hostname": "PDF", "description": "PDF", "sitename": "PDF", "date": "PDF", "cleaned_text": "Likelihood Ratio -Based Tests for Longitudinal Safety Data October 24, 2014 Ram Tiwari and Lan Huang Office of Biostatistics, CDER, FDA 1 Disclaimer The views expressed by the speakers of this talk are their own and do not necessarily represent those of FDA. 2 3 1. Lan Huang, Jyoti Zalkikar, and Ram Tiwari. A likelihood based method for signal detection with application to FDA' s drug safety data. Journal of the American Statistical Association (JASA), 106 (496), 1230 -1241, 2011 2. Lan Huang, Jyoti Zalkikar, Ram Tiwari. Likelihood ratio tests for longitudinal drug safety data. Statistics in Medicine, 33(14), 2408 -2424, 2014 3. Lan Huang, Ted Gou, Jyoti Zalkikar, Ram Tiwari. A review of statistical methods for safety surveillance. Therapeutic Innovation & Regulatory Science, 48 (1), 98 -108, 2014 Useful references 4 Outline Basic LRT method for large post -market safety database OB in -house tool development and illustration Longitudinal LRT method for data with exposure information Discussion 5 Large databases: AERS, Vigibase OMOP/IMEDS) Objective of the safety exploration -Signal detection in large safety database -Clinical trials database -Passive/active Background IxJ Safety Data -Matrix for AERS Database 1 ... n.J n.. Drugs AEs 6 Fix a drug, say Drug j, and construct a 2X2 table for each AE: If there are, say, 16,000 AEs, then there are 16,000 such 2x2 tables Most of the frequentist's methods and some Bayesian methods work with 2X2 tables 2x2 Table of nij Drugj Other drugs AEi nij Subtracted ni. Other AEs Subtracted Subtracted Subtracted nj. Subtracted n.. 7 . ~ ( )ij i in ) )j ij i in n Pois n n q 0:*ii H p q p :a i iH p qfor all AEs, i for all at least one AE, i RR=p/q, AE i vs. other AEs 0 max/ max L L LRa 8 Statistical model and hypothesis Likelihood Ratio Test (LRT) statistic Test Statistic is MaxLR =max of LR_ij (i=1 to I) over i=1,...,I AEs. LogLR and MaxLogLR used covariate (such as age or gender)(stratified analysis), we simply calculate the age -adjusted or gender adjusted expected cases. We first calculate the E_ijk, k=1,2 (by gender), then we combine them together. k kkk j k ik ij ijnnn behind the multinomial simulation for the null data 1 1. 1.~ .... ~ p n Poisson p unknown jnnn n nnn Then, Assume that the marginal totals n1., ..., nI., are fixed. Under H0, assume that n1j, ..., nIj are ind distributed as 11 Hypothesis t esting The distribution of MaxLR under H0 is not analytically tractable, we use Monte Carlo method to obtain the empirical dist. Cases can be generated using multinomial distribution ( n.j, (n1./n..), (n2./n..), ...., (nI./n..)) assuming homogeneous reporting rate. 12 Calculate MaxLR from observed data (one) Calculate MaxLRs from the 9,999 simulated null data. Threshold at alpha=0.05 is 95 percentile of the 10,000 (=1+9999) MaxLRs . Reject H0 if obs MaxLR > threshold. Compare the observed MLR and the ones from simulation --- p-value = P(MLR> obs MaxLR )= Max # of times simulated MaxLR > obs MaxLR /10000. Gatekeeping step -down process (1st, 2nd, 3rd, ...) P-value calculation 13 14 OB in -house tool for LRT method 15 Example Calcium Chloride And Glucose And Magnesi 637 4 Clopidogrel 419 5 Rosuvastatin 398 6 Atorvastatin 506 7 Calcium Chloride And Icodextrin Magn 150 8 Ticagrelor 109 And 46 10 Glyceryl Trinitrate LRT to longitudinal LRT (Motivation) 17 LRT Longitudinal LRT Count data Count data with exposure information Large post -market observational safety data Observational or clinical trial data Drug signals for one AE Or AE signals for one drug Same Multiple AEs and drugs Same Fixed time analysis Same Analysis over time using cumulative count data without planned alpha control Use alpha -spending for analysis over time covariate adjustment by stratification same Longitudinal LRT method (sequential LRT) for active surveillance General -Compare multiple AEs by drug -Compare two drugs for one AE of interest (1st occurrence or without recurrence) -Compare multiple drugs for one AE of interest (may have recurrence or combined AE terms) Control error rates and false discovery rate (FDR) 18 Define countable cases and drug exposure Countable cases: AEs that occur during the exposure period (other definitions: AEs occur several days after the drug exposure) Drug exposure -Event -time -Person -time -Exposure * ** 1 AE 2 AE 3 AE s=2 ** AE 1 s=2 s=3 1 Pi=1,js Pi=1,js Definition AE 2 AE s=2 1 Pds Pds Pds Definition of exposure -time 22 Working data structure (with event -time) 1 2 3 ... n.J Drugs AEs 1 2 3 14 Row total 1 At look k (k=1,..., K=5), there are two tables constructed from the individual level data. Pij is the event -time (unit here is day) for the AE i and drug j. We suppress k in the notation. Drugs 23 Exposure -based longitudinal LRT Methods using event -time H0: p i=qi over i=1,...I, if J (drug) is fixed. RR i=pi/qi,=1 under H0, i=1,..., I, which is relative event -rate of ith AE vs. other AEs for fixed drug P q Poisson Poisson jk ijk i k i k ijk njk k n n n ijk jk ijk jk i k ijk ijk jk ijk kn n n P P k PLRn P n n n n PEE n E P The likelihood ratio is then jkijk jk aijk a n LR LRijk i jk ,...,1, max max Test statistic is 25 Working data structure (with person -time) J=1 1 n11k ~)( ), ( ~ 21 21 2111 11 11 k k kk k k P q Poisson nP p Poisson n H0: p 1=q2 , RR 1=p1/q2, relative risk of ith AE vs. the other AE for fixed drug j; or relative risk of ith drug vs. the other drug for fixed AE j. ))(,( ~ | 21 111111 11 1. 1. 11 k kk k k k kP PRRP RRn 21 1121 112121 1111 1121 11 21 1121 11 k kk k kn k kk n kk n n k kk kn kk n kk kP PP nEE nn En P Pn nPn Pn LRk k k kk k The likelihood ratio is then Test statistic is kk k ak a n Hkn n Hkn Hk kpq pLR 1. 011 1. 11 ,11,11 ,11 11 .2,1, max max i LR LRijk jk 28 Relationship seqLRT with CSSP and maxSPRT CSSP statistic is the number of adverse events. seqLRT statistic is maxLR ; same null data simulation process and assumption For maxSPRT : Let n.k=n.1k be the total # cases up to time-interval k. ndrugk=n11k is the # k kk drug drug k kkdrug drug n n n k k k kk k n n nn n n nnLRTM MM 1.. 21 1111 1. 11Mn P PP nEk k kk k k 29 Working data structure (with exposure -time) Jth ... ... i ... ... ... I -time) The, AE,th *j fixed aFor ** *. * * *.* * ** ** * djdj djd dj dj js np p Test is p d=qd over d=1,..,D if J (AE) is fixed RR d=pd/qd, i=1,...,D is relative risk of dth drug vs. other drugs for fixed AE j*. 31 The likelihood ratio is then Test statistic is D d LR LRdjk d jk ,...,1, max max jkdjk jk * * * *. *.* Statistic is MaxLR jk (discussed in earlier slides) The distribution of MaxLR jk under H0 is not analytically tractable We use Monte Carlo method to obtain the empirical dist for each k Cases can be generated \"cumulatively' using multinomial distribution. Cases can also be generated using multinomial for each individual time -period and then summing -up over time Distribution of LRT under H0 33 Null data generation (cumulatively) .,...,1 (,( ~ |) I iPP PPnl Multinomia n n n kkI k jk jk Ijk ,...,1 )), ,...,(, ( ~ |) ,..., *. *. * *1 D dPP n n n kDk kk For event -time and person -time cases I is the total # of AEs or drugs under comparison. For exposure -time cases, D is total # of drugs under comparison. The parameters in the multinomial distribution are from the observed data. 34 Calculate MaxLR from observed data (one) over time (k=1, 2, 3,..., K) Calculate MaxLRs from the 9,999 simulated null data for each time period At each time period, compare the observed MLR and the ones from simulation --- p-value = 1-rank of the observed maxLR among the 10000 maxLRs . If p-value< alpha(k) - reject H0 and identify signals P-value calculation (for each period k) 35 Alpha -Spending Functions and Decision Rules Specify the error rate to be spend at look k=1,...K. This can be monotonic power functions such as alpha spending functions: Kkk cum )( k rrk cum 121)( Kk1)( kk21)( The second formulation does not depend on K. 36 Other choices of alpha -spending boundary functions are: O'Brien -Fleming, Pocock , Lan -DeMets , etc. At look k, the AE associated with the maxLR in the obs data is a signal for the particular drug if the p -value is < alpha(k). There could be secondary signals with next lower ordered values of LR, after maxLR , in the observed data, that have -value <alpha(k): LR2, LR3..... (step -down procedure). Alpha -Spending Functions and Decision Rules 37 Application of LRT methods to Pooled clinical trial data for PPIs PPIs are a class of drugs that decrease gastric acid secretion through inhibition of the proton pump. It helps in the secretion of acid from the stomach glands. In a recent study, it has been found that proton pump inhibitors (PPIs) are associated with increased risk of hip fractures (side effect) (Yang et al. 2006). The increased risk of hip fractures is attributed to osteoporosis caused by proton pump inhibitors. Pooled clinical trial data from FDA/OTS/OCS legacy database PPIs were concomitantly used with test drugs for treating osteoporosis among targeted patients. 38 Pooled data with 10 trials (sample sizes from hundreds to thousands). # Subjects using concomitant PPIs is about 10% of the total sample size. A total of 14 drugs (7 test drugs, and 7 test drug+PPIs) are included in the exploration. Use calendar time methods to Pooled clinical trial data for PPIs 39 AEs signals with p<alpha(k) by drug (event -time) k=1 2 29731 50364 AE signals 3 6 34 43 74 muscle cramp (rr) 4.1 2.3 4.4 Bone pain (rr) 2.2 Placebo +PPIs ndotj 95 273 1094 4833 9043 AE signals 0 0 23 26 30 muscle cramp (rr) 6.8 muscle spasms (rr) 3.9 40 Comparison of PL vs. PL+PPIs (I=2) using Sequential LRT method (person -time) AE is a composite AE (AEOST) including many AE terms associated with osteoporosis (J=1), 1st occurrence of AEOST. PL+PPIs vs. PL (I=2) Sample sizes Ndotj for j=1 are 57, 163, 232, 439, and 500 for analysis periods 1, 2, 3, 4, and 5, respectively. Rr values are 4.7, 2.4, 2.5, 1.9, 1.7 for k=1 to 5. When k=1, the p -value from seqLRT is 0.001. PL+PPIs had higher relative risk vs. PL for AEOST (<alpha(1)=0.025), stop the search by sequential method. 41 Safety signals for multiple occurrences of AEOST (PL+PPIs vs. PL, I=2) by longLRT (exposure -time) k=1 2 3 4 5 ndotj 65 195 286 647 787 rr 5.7 3.2 2.9 2.5 2.4 pvalue 0 0 0 0 0 PL+PPIs is a signal for AEOST for k=1 to 5 periods . Do not stop monitoring the signals over time 42 Safety signals for multiple occurrences of AEOST (I=14 drugs) by longLRT (exposure -time) k=1 2 5 ndotj 174 549 815 3902 6041 PL+PPIs rr 5.9 3.4 3 1.8 1.6 pvalue 0 0 0 0 0 Lasoxifene+ PPIs rr 1.1 1.9 2 pvalue 0.99 0 0 PTH+PPIs rr 5.9 2 2.3 pvalue 0 0 0 Bazedoxifen e+PPIs rr 2.2 0.9 pvalue 0 0.99 43 Discussion One AE or multiple AEs, one drug and multiple drugs Drug class and AE group Count data or data with exposure Fixed time analysis or analysis over time Rate and risk Different definitions of exposure Method for incorporating the study effect 44 References Cook, A. J., Wellman, R.D., Tiwari, R.C., Li, L., Heckbert , S., March, T., Heagerty , P., and Nelson, J.C. (2012), ``Statistical approaches to group sequential monitoring of postmarket safety surveillance data: Current state of the art for use in the mini -sentinel pilot,\" Pharmacoepidemiol Drug Saf, 21 suppl , 72-81. Li, L. (2009), ``A conditional sequential sampling procedure for drug safety surveillance,\" Statistics Medicine , 28, Platt, R. (2007), ``Real -time vaccine 2): S89 -95. Noren et al. 2010 ( See # 1) O'Brien, P.C. and Fleming, T.R. (1979), ``A multiple testing procedure for clinical trials,\" Biometrics , 35, 549 -556. Platt R., Carnahan R.M., Brown J.S. et al. 2012, \"The U.S. Food and Drug Administration's Mini -Sentinel program: S.J. (1977), ``Group sequential methods clinical trials,\" Biometrika , 64, 191 -200. Schuemie , M.J. (2011), ``Methods for drug safety signal detection in longitudinal observational databases: LGPS and LEOPARD,\" Pharmacoepidemiology and Drug Safety -299 Y.X., Lewis, J.D., Metz, D.C. (2006), ``Long term k jk i k ijk jk k jkn n n n n n n n n ijk ijk jk ijk jk ijk i k i k k i k k i k k n n njk jk kkn n n n n n P P P P P PLRTnn PP Poisson LRT 47 Notations for the following plots on drug exposure * Indicates start date of drug j (or d) and ** indicates stop date of drug j (or d). Assume that each subject takes a single drug (or drug combination); different subject may take different drugs or drug combinations. Circled dots indicate occurrences of AEs (AE i, i=1, 2, 3,.....). Only AEs between * and ** are countable cases and are shown in the plots over time. P1ijs is the event -time for sth subject taking jth drug and having 1st occurrence of ith AE. P2ijs is the event -time for sth subject taking jth drug and having 2nd occurrence of ith AE. Pijs=P1ijs is the event -time for sth subject taking jth drug and having 1st occurrence of ith AE, which is also person -time when we only consider AE without recurrence or the 1st occurrence of one AE with repeated occurrences Pds is the exposure -time for sth subject taking dth drug and having multiple AEs during the exposure duration 48 Exposure for ith AE and jth (dth) drug (aggregation of subject -level information) ij siL silS s i . d d sds d ds d P P PP P . ,. For event time, S is the total # of subjects, and L(i,s) is the total # of occurrences of ith AE for sth subject. For person -time, For exposure -time, 49 Simulation using the information from the Pooled clinical trial data seqLRT for 1st occurrence of AEOST (J=1), PL+PPIs AEOST (J=1), multiple drugs D 1d .0 dj ..0 ,.1 0 1 *. *. * *1 .1 RR ,1 ,. ,...,1 )), n 50 Simulation setup For H0 data, RR i1=1 For Ha data, RR i1=c (PL+PPIs vs. PL). c=1.2, 1.5, 2, 4, 6, 10 Sample size as z*n .1k c=1, 2, 4, 10 Simulation 1000 data for each case 51 Performance evaluation Conditional power: -Pr(k)=#rejecting H0 at When data is generated under H0, pr(k) is conditional error rate and power - type-I error rate for seqLRT For longLRT without stopping the procedure, we use cumulative error rate cumer(k)=pr(1)+pr(2)...+pr(k) 52 Patterns on error rate (rr=1 H0 data, z=1, similar for z=2, 4)) k=1 2 3 4 5 seqLRT ndotj to 4 pr 0.00.10.20.30.40.50.60.70.80.91.0 rr1 2 3 4 k 1 2 3 4 5 power 0.00.10.20.30.40.50.60.70.80.91.0 rr1 2 3 4 k 1 2 3 4 5 Conditional power Unconditional power 54 Patterns on power (seqLRT), rr=2, z=0.5 to 4 pr 0.00.10.20.30.40.50.60.70.80.91.0 z0 1 2 3 4 k 1 2 3 4 5 power 0.00.10.20.30.40.50.60.70.80.91.0 z0 1 2 3 4 k 1 2 3 4 5 Conditional power Unconditional power 55 Patterns on (conditional )power (longLRT) Z=1, relative risk from 1.2 to 4 RR=2, z from 0.5 to 4 pr 0.00.10.20.30.40.50.60.70.80.91.0 rr1 2 3 4 k 1 2 3 4 5 pr 0.10.20.30.40.50.60.70.80.91.0 z0 1 2 3 4 k 1 2 3 4 5 56 "}