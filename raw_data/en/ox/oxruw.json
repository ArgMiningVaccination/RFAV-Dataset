{"title": "PDF", "author": "PDF", "url": "https://eprints.nottingham.ac.uk/14360/1/thesis.pdf", "hostname": "PDF", "description": "PDF", "sitename": "PDF", "date": "PDF", "cleaned_text": "Detecting Adverse Drug Reactions in the General Practice Healthcare Database Jenna Marie Reps School of Computer Science University of Nottingham A thesis submitted for the degree of Doctor of Philosophy 2014Acknowledgements I would like to acknowledge and thank my supervisors Professor Jonathan Garibaldi and Professor Uwe Aickelin, whos guidance made this thesis possible, my family for their continued support during my PhD and my friends for helping to keep me motivated.Abstract The novel contribution of this research is the development of a super- vised algorithm that extracts relevant attributes from The Health Im- provement Network database to detect prescription side e ects. Pre- scription drug side e ects are a common cause of morbidity through- out the world. Methods that aim to detect side e ects have his- torically been limited due to the data available, but some of these limitations may be overcome by incorporating longitudinal observa- tional databases into pharmacovigilance. Existing side e ect detect- ing methods using longitudinal observational databases have shown promise at becoming a fundamental component of post marketing surveillance but unfortunately have high false positive rates. An extra step is required to further analyse and lter the potential side e ects detected by existing methods due to their high false positive rates, and this reduces their e\u000eciency. In this thesis a novel methodology, the supervised adverse drug reaction predictor (SAP) framework, is presented that learns from known side e ects, and identi es patterns that can be utilised to detect unknown side e ects. The Bradford-Hill causality considerations are used to derive suitable attributes as in- puts into a learning algorithm. Both supervised and semi-supervised techniques are investigated due to the limited number of de nitivelyknown side e ects. The results showed that the SAP framework im- plementing a random forest classi er outperformed the existing meth- ods on The Health Improvement Network longitudinal observational database, with AUCs ranging between 0.812-0.937, an overall MAP of 0.667, precision values between 0.733-1 and a false positive rate \u00140:013. When applied to the standard reference the SAP frame- work implementing a support vector machine obtained a MAP score of 0.490, an average AUC of 0.703 and a false positive rate of 0.16. The false positive rate is lower than that obtained by existing methods on the standard reference.Contents Contents iv List of Figures ix Nomenclature xv 1 Introduction 1 1.1 Background THIN Database 196 B Drugs 205 C Software Details and Preliminary Work 211 C.1 Result Tables 219 References 268 viiiList of Figures 2.1 Illustration of data contained An example entity relationship diagram for an SRS database based on the The online form for submitting suspected ADRs via the Yellow Card Scheme in the of a classi er partitioning the attribute space. Using the training data (blue dots are labelled as ADR and red as non- ADR) a function is trained to partition the space into ADR sections and non-ADR sections. This can then be used to predict whether a new data-point is an ADR or non-ADR based on where the data point lies in the of the maximum number of points separable in every possible way by a decision tree to classify drug-medical event pairs as the support vector machine classi er. The hyper- plane separating the classes is positioned such that the distance between the hyperplane and the closest data points from either ROC plots for the di erent methods. The black line is drugs. . . . . . . plots for the speci c comparison. The gure on the left is the whole speci city range, the gure on the right is for the speci- city within the interval [0 :9;1]. The orange, red, yellow, green and blue curves correspond to MUTARA 180, HUNT 180, TPD 1, TPD . . . . pairs. . . . . . 118 4.3 Illustration of combining drug records and medical event records. 120 5.1 The framework implemented to train the four di erent classi ers using a variety of ndrugs with known side e ects. These general classi ers are then used to predict the class for unlabelled data. . 140 xLIST OF FIGURES 5.2 The ROC curves for the di erent classi ers used to predict the ADRs of the drugs. The red curve represents the random forest classi er, the orange curve represents the support vector machine classi er, the green curve represents the logistic regression classi er and the blue curve represents the er. . . . . the SAP algorithm implement- ing each of the classi ers when applied the Semi-Supervised ADR Predictor algorithm. This algorithm uses labelled and unlabelled data for the drug of interest only during training. The technique applied depends on the percentage of labelled curves for the SSAP framework at 6 di erent values of critwhen applied to the di erent drugs. The black, blue, red, orange, yellow and green curve correspond to critvalues of 0:9, curves for the SSAP framework at 6 di erent values of critwhen applied to Ibuprofen. The black, blue, red, orange, yel- low and green curve correspond to critvalues of 0:9, 0:7,0:5,0:3,0:1 and 0:05 respectively. ROC curves for the SSAP framework repeated multiple times for the drug Ibuprofen at a critvalue of 0:1 to investigate 5.8 The AUC for the ROC plots obtained by applying the semi-supervised clustering and the self training classi cation within the SSAP frame- work to ROC plots for the SAP algorithm, implementing a random forest (black) and the existing methods MUTARA 180(orange), HUNT ROC plots for the SAP algorithm, implementing a random forest (black) and the existing methods MUTARA 180(orange), HUNT ROC plots for the SAP algorithm, implementing a random forest (black) and the existing methods MUTARA 180(orange), HUNT . . . . . 197 A.2 A screen shot of the patient table contained within the THIN screen shot of the therapy table contained within the THIN screen shot of the medical table contained within the THIN example of the branch of the THIN READ code tree. . . . . . 200 A.6 An example of drug-medical event pair, where the drug is and the medical event is . ADE Adverse drug event. ADR Adverse drug reaction. AUC Area under the ROC curve: a measure of general signalling ability. DOI Drug of interest. HOI Health outcome of interest. HUNT Highlighting UTARs Negating TARs: a method for signalling ADRs using LODs. IC Information component: the measure of association used by the TPD method. IC\u0001 A measure of association change over time used by the TPD method. KNN K-nearest neighbour. xiiiLIST OF FIGURES LOD Longitudinal observational database. LR Logistic regression. MAP Mean average precision. MUTARA Mining Unexpected Temporal Association Rules given the An- tecedent: a method for signalling ADRs using LODs. NB Naive Bayes. OMOP Observational Medical Outcomes Partnership. pAUC Area under the partial ROC curve: a measure of signalling ability for a de ned speci city interval. RF Random forest. RME Risk medical events: the set of medical event that are observed for at least one patient within a month of being prescribed the drug of interest. ROC Receiver operating characteristic: an illustration of the perfor- mance of a binary classi er. ROR Reporting odds ratio: a measure of association. SAP Supervised ADR predictor: the novel framework for signalling ADRs developed through this thesis. SIDER A side e ect resource containing drug-medical event pairs corre- sponding to ADRs. xivLIST OF FIGURES SRS Spontaneous reporting system. SSAP Semi-supervised ADR predictor: a novel framework for signalling ADRs developed throughout this thesis. SVM Support vector machine. THIN The Health Improvement Network. TPD Temporal Pattern Detection: an ADR signalling method devel- oped for LODs that looks for temporal changes in the association strength between and drug and medical event. WHO World Health Organization. xvChapter 1 Introduction The occurrence of negative side e ects due to prescribed medication is a health issue that occurs worldwide. The early detection of side e ects is imperative for the prevention of unnecessary morbidities or mortalities. Two types of electronic healthcare databases are frequently used to extract data for the detection of side e ects, the spontaneous reporting system (SRS) databases and the longitudinal observational databases (LODs). Many methods have been developed for the SRS databases but these databases have a limited perspective and do not contain the data required to detect all side e ects. This has prompted the focus towards using the LODs, but the proposed methods tend to be unsupervised. In this thesis, supervised and semi-supervised techniques capable of detecting side e ects by utilising the data contained in LODs are investigated. The rst part of this chapter focuses on the research background and motivation, this is followed by the aims and objectives. The chapter concludes with the thesis organisation that provides the outline of each chapter. 11.1 Background & Motivation All prescribed drugs have side e ects under certain conditions [170]. A negative e ect following the ingestion of a drug is referred to as an Adverse Drug Event (ADE) and is de ned as `any untoward medical occurrence that may present during treatment with a medicine but which does not necessarily have a causal relationship with the treatment' [206]. When an ADE has been linked to a spe- ci c drug it becomes an Adverse Drug Reaction (ADR). An ADR is de ned by the World Health Organization as a response to a medicine which is noxious and unintended, and which occurs at doses normally used in humans from the pro- phylaxis, diagnosis or therapy of disease, or for the modi cation of physiological function [182]. As ADRs can lead to patient morbidity or mortality, their early discovery is essential. As a consequence, the safety of a new drug is extensively analysed throughout its development. Unfortunately, the ability to analyse a drug's toxi- city is limited by the clinical study designs. The pre-clinical studies of a drug's development, involving animal testing, are done to initially assess a drug's toxi- city [25], however, the ability to infer ADRs is limited by the inability of animal testing to be completely informative for e ects on humans [133]. If a drug passes the initial toxicity analysis, it is then tested on humans during phases i{iii, with the trial population size increasing incrementally after each phase. Phase i will often involve testing the drug by giving it to healthy individuals under unrealistic conditions (i.e., the individuals cannot smoke, drink alcohol, exercise excessively and may have food limitations enforced) [38]. It is also widely known that clini- cal trials can be biased towards certain demographics, for example the majority 2of individuals tested during phase i trails are white males [38]. Clinical trials involve testing the drug on a limited population size, with the largest population size used during phase iii, but this generally only contains up to 3000 individuals [38]. Due to numerous reasons, including the limited trial population size and the unrealistic conditions of the trials, many ADRs are undetectable during phase i-iii studies and can only be identi ed after the drug is marketed [11]. It is also clear that ADRs that result from polypharmacy (i.e., when multiple drugs are prescribed at the same time) will be di\u000ecult to detect. The reason is, due to the limited population being tested, it is impossible to investigate all the di erent drug combinations. Studies investigating the prevalence of ADRs have provided evidence that many ADRs are not discovered prior to marketing. The results indicate that up to 6.5% of UK hospital admissions are due to ADRs [135] with similar rates also being observed in the US hospitals (6.7%) [103]. Another study found a similar prevalence within a UK paediatric hospital (4%) [62]. Research suggests ADRs are more common in geriatric patients (older than sixty ve), in females and in patients taking more than one drug [17]. It has also been highlighted that the lack of e\u000ecient means to detect ADRs causes a burden in terms of cost and quality of life. Furthermore, this burden appears to be getting worse. It has been reported that ADRs could cost the UK $637 million each year [43], with $466 million being due to ADR hospital admissions and $171 million being due to ADRs during hospitalisation. These estimates do not take into consideration additional medical costs or loss of earning while in hospital due to an ADR. A study by Wu et al. (2010) compared the frequency of ADRs as the cause of hospital admission over 1999 to 2009 and showed the number of people admitted to hospital due to 3ADRs has increased over the ten years at a greater rate than the rate of hospital admission [207]. Further, they found 26,399 people died in hospital in the UK over the ten years as a result of an ADR [207]. This corresponded to a probability of almost one in twenty ADRs resulting in death. One explanation for the increase in the number of ADRs over the years is due to polypharmacy [112]. This highlights the importance of continuous post-marketing surveillance of drugs and motivates the requirement of new methods that can identifying ADRs e\u000eciently. When a new potential ADR association is detected, the potential ADR is referred to as being signalled. The majority of current post-marketing surveillance techniques make use of the SRS databases. These databases contain records of suspected ADRs, that were originally restricted to submissions made by medical practitioners and coroners, but it is becoming increasingly common for them to enable the general public to submit reports. The SRS databases have many limitations that prevent them signalling ADRs e\u000eciently and they cannot be used to quantify ADR risks [57], nor can they be used to consistently identify risk factors. It is widely known that the majority of ADRs signalled by the existing methods applied to SRS databases do not correspond to ADRs [172]. Retrospective studies have con rmed their inability to e\u000eciently signal all ADRs, as the methods applied to SRS databases were unable to signal some ADRs before they were discovered by other means [3]. This has prompted the demand for better surveillance techniques [43] [207] and to use other forms of data to complement drug safety using SRS. An alternative approach for signalling ADRs, that has recently surfaced, is to use data contained within LODs. The LODs are not restricted to a speci c period of time around the drug prescription and can contain patient medical histories 4spanning decades. These databases may present to opportunity to e\u000eciently discover new ADRs [198] and enable ADR risks to be quanti ed. Their impor- tance for future post-marking surveillance has been expressed [203]. The existing methods proposed for the LODs are unsupervised and many are derived from the SRS methods [216] but new methods have been presented that are based on epidemiology techniques [156]. Unfortunately, these methods have been shown to have a high false positive rate [156], due to the di\u000eculty distinguishing between association and causation, and this may reduce their signalling e\u000eciency. The majority have been developed for a common data model [115; 131] (the integra- tion of multiple LODs into a general database) rather than speci c databases. Not all data can be converted into the common model [214], so information may be lost. Therefore, it is of interest to also develop methods that are speci c to a single database, as new information may be revealed. It may be possible to develop a method with a low false positive rate by considering the Bradford- Hill causality consideration [19], as these are often used within extensive post marketing investigations to con rm causality . The Health Improvement Network (THIN) database is an example of a LOD that contains approximately 6% of the general practice records within the UK. The THIN database contains complete medical records and prescription records (while the patient is registered) for all registered patients at participating prac- tices. The THIN database contains heterogeneous data and has hierarchal struc- tures embedded within it. An example of one of the hierarchal structures con- tained in the database is the recording of the medical events (i.e., administrative events, illnesses, symptoms, laboratory tests/results and medical history). The medical events are recorded via READ codes, these codes have ve levels of 5speci city and follow a tree structure. Little work to date has focused on using the THIN database for general postmarking surveillance and no ADR signalling method has been speci cally developed. Research has suggested that the THIN database potentially holds a wealth of information [105]. If its complex struc- ture can be dealt with, then its integration into post-marketing surveillance may enable ADRs to be signalled e\u000eciently. 1.2 Aims & Objectives As this research is interdisciplinary it has both a clinical and technical aim. The overall clinical aim of this project is to develop a data-mining algorithm for a speci c LOD, the THIN database, that can detect ADRs and discover new in- formation to improve current post marketing drug surveillance. The technical aim is to develop an algorithm that can classify a pair consisting of a drug and medical event (drug-medical event pair) as a causal relationship or non-causal relationship. The algorithm must have a low false positive rate and a su\u000eciently high true positive rate. This algorithm has multiple applications as it can iden- tify causation in databases containing discrete information. One such example is using databases containing customer shopping histories to identify items that when purchased in uence a di erent item being purchased in the future. Another useful implementation of the algorithm using market data could be to identify the impact of promotions and nd what purchases are caused by the promotion. The advantage over sequential pattern mining is that the algorithm does not require the events to be common. 61.2.1 Hypotheses The THIN database potentially contains a wealth of information but this is hidden within a magnitude of heterogeneous data containing many underlying hierarchal structures. The abilities of the existing ADR signalling methods developed for LODs are likely to be impacted by the structure of the THIN database and also by their inability to distinguish between association and causation. These limiting factors may prevent the extraction of all the information that is potential avail- able by mining the THIN database. To extract all the possible information and utilise the full potential of the THIN database, novel supervised/semi-supervised methods may need to be developed. It is therefore hypothesised that, H1Current ADR signalling algorithms developed for LODs are not suitable for ADR detection when they are implemented on the THIN database. H2Novel ADR signalling algorithms applied to the THIN database will be able to consistently perform better than existing LOD ADR signalling algorithms if they 1) deal with the hierarchal structures within the THIN database, 2) incorporate new attributes essential for determining causality and 3) use known ADR knowledge. H3Novel ADR signalling algorithms applied to the THIN database will outcom- pete existing methods developed for the Observational Medical Outcomes Partnership (OMOP) common model when considering the speci ed drug and health outcomes of interest [141]. H4Novel ADR signalling algorithms applied to the THIN database will be able to generate new ADR signals. 71.2.2 Objectives To address the research hypotheses the following research objectives are proposed, with the hypothesis they are linked to indicated in brackets. 1. Determine the benchmark for signalling ADRs using the THIN database and identify limitations ( H1). 2. Propose suitable attributes for each drug-medical event pair that may help separate association from causation or that are speci c to the THIN database (H2.1 -H2.2 ). 3. Develop a novel supervised/semi-supervised ADR signalling algorithm for implementation on the THIN database that can accurately signal ADRs (H2.3 ). The requirements are, (a) A low false positive rate. (b) To be e\u000ecient. (c) To be robust. 4. Evaluate the novel algorithm on the THIN database. (a) Compare the general signalling ability of the novel ADR signalling algorithm and the existing methods applied to the THIN database (H2). (b) Evaluate the novel ADR signalling algorithm's ability on the OMOP speci ed drug and health outcomes of interest ( H3). (c) Generate new ADR signals ( H4). Chapters 3-6 focus on Objectives 1-4 respectively. 81.3 Thesis Organisation The continuation of this thesis is organised as follows. Chapter 2 presents the literature review that is split into a pharmacovigilance section and a pattern recognition section. The pharmacovigilance section presents an overview of the current techniques and the recent advances. The Bradford-Hill causality consid- erations are discussed, as ADRs represent a causal relationship and the criteria may present the opportunity to distinguish ADRs from non-ADRs. The exist- ing methods developed for di erent healthcare databases are summarised, with their connection to the Bradford-Hill causality considerations evaluated. The nal part of the pharmacovigilance section focusses on the new initiatives cur- rently taking place that aim to improve the way ADRs are signalled. The pattern recognition part presents the statistical learning theory view of supervised and semi-supervised learning. The main supervised and semi-supervised algorithms, that are used during the later chapters of the thesis, are summarised. In Chapter 3, the benchmark for the ADR signalling ability of the THIN database is determined by applying a selection of the existing methods to the THIN database. As there is no perfect gold standard for signalling ADRs, two di erent comparisons were applied. The rst comparison involved analysing all the possible drug-medical event pairs for a set of speci c drugs and consider- ing only the drug-medical event pairs listened as known ADRs on the website NetDoctor [176] to be ADRs and all other pairs to be non-ADRs. This enabled the evaluation of the methods when there is a large number of non-ADRs, but the comparison was limited due to the possibility of ADRs listed on NetDoctor being incorrect and due to unknown ADRs. The second comparison, termed the 9speci c comparison, only evaluated the drug-medical event pairs corresponding to ADRs listed on drug packaging or de nitively known non-ADRs. The speci c comparison enabled a more realistic evaluation and highlighted methods that are non-consistent. In Chapter 4, attributes that are suitable inputs for a learning algorithm to distinguish ADRs and non-ADRs were proposed. The attributes included values from existing method, novel attributes derived from the Bradford-Hill causality criteria or novel attributes derived by considering the structure of the THIN database. The technique for extracting and cleansing the data are described and mathematical formula for calculating each attribute are presented. In Chapter 5, the learning algorithm is developed and tentative results are presented. The rst part of the chapter proposes a novel supervised technique that learns from a mixture of drugs and, once learned, can be applied to any drug. In the second part, a novel semi-supervised technique is presented that uses the limited number of known ADRs for a drug of interest to generate a model that is speci c to the drug. Both the supervised and semi-supervised models are evaluated on a selection of drugs. The evaluation suggests that a supervised model trained on multiple drugs will outperform a semi-supervised model trained on a single drug. This is advantageous, as the supervised model can be trained on drugs that have been marketed for years and can be applied to newly marketed drugs that have limited toxicity knowledge. In Chapter 6 the novel supervised algorithm is applied to more drugs and compared with a selection of existing methods using the speci c comparison technique. The results showed that the novel supervised algorithm was often signi cantly better and had a better mean average precision (MAP) score and 10lower false positive rate than existing methods. An additional evaluation was con- ducted by investigating the novel supervised algorithm's ability when considering the health outcomes of interest (HOIs) and drugs of interest (DOIs) speci ed by the OMOP. The evaluation showed that the novel supervised algorithm obtains a lower false positive rate than existing methods (0 :16) and is able to signal a high proportion of de nitively known ADRs. Therefore, the novel supervised al- gorithm has the potential to extract new pharmacovigilance knowledge and may help signal ADRs shortly after new drugs are marketed. The nal chapter of the thesis contains the conclusion that highlights the key results of the research and answers the research questions proposed in the introduction. Areas of future work are proposed, such as the modi cation of the algorithm to return quantitative information about the risk of each ADR signalled. The journal and conference contributions derived from this research are presented at the end of Chapter 7. 1.4 Contribution to Knowledge This research has presented the rst supervised and semi-supervised methods for signalling ADRs using LODs. New techniques for generating labels that are es- sential for supervised/semi-supervised algorithms have been presented and novel attributes that can distinguish between association and causation were proposed. The research also highlighted the current limitations with evaluating the methods, as restricting the evaluation to a small number of de nitively known drug-medical event pairs may prevent an accurate evaluation due to ignoring the numerous drug-medical event pairs that are associated due to confounding but 11including more pairs into the evaluation may introduce error due to unknown ADRs. This research has contributed to four journal papers (two published, one in print and one under review) and four conference papers. A full list of the journal and conference papers produced during this research is presented at the end of Chapter 7. 12Chapter 2 Literature Review `Prevention is the next frontier for pharmacovigilance, beyond simply generating alerts.' N. Moore [121] 2.1 Current Pharmacovigilance 2.1.1 Introduction In 1961 a link was discovered between pregnant mothers ingesting the drug Thalidomide and then giving birth to infants with congenital malformations [167]. This widespread incident highlighted the importance of drug safety and prompted the start of systematic approaches to monitor the safety of marketed medications [29]. The research into medication safety is commonly referred to as pharma- covigilance. This involves the detection, assessment and prevention of ADRs for any marketed drug. The aim of pharmacovigilance is to identify ADRs, study relevant data and then investigate each ADR to assess risk factors. This knowl- 13edge can then be used to help prevent ADRs that would otherwise lead to patient morbidity or mortality; helping to improve healthcare. The process of identifying new ADRs involves signalling sets consisting of one or many drugs and an adverse event that may correspond to an ADR. There are di erent de nitions for the term ADR signal in the context of pharmacovigilance but generally it means there is information to suggest a previously unknown causal relationship between some medication and an adverse event. The World Health Organization's (WHO) de nition of an ADR signal is `reported information on a possible causal relationship between an adverse event and a drug, the relationship being unknown or incompletely documented previously. Usually, more than a single report is required to generate a signal, depending on the seriousness of the event and quality of the information' [53; 111]. Almeno et al. (2005) interpret this as being able to `view a signal as any information, qualitative or quantitative, that prompts further investigation on the relationship between a drug and an event' [1]. Once an ADR signal is generated, the medication and adverse event are stud- ied further with more stringent statistical tests to con rm whether the signal is true, meaning there is su\u000ecient evidence to con rm a causal relationship between the medication and the adverse event. Conversely, if there is not su\u000ecient ev- idence, then the signal is false. In e ect, ADR signalling is a way of ltering all the possible combinations of drug and adverse event pairs so that only the combinations that are most likely to correspond to ADRs remain to be inves- tigated further. This is important as it is not possible to e\u000eciently investigate the thousands or even millions of possible combinations of drugs and suspected ADRs in ne detail. 14Overall, the process of identifying an ADR (a causal relationship between a drug and medical event) requires three steps [136]; 1.Signal generation/detection - this step involves analysing all drug-medical event pairs representing a possible ADR and highlighting the ones that are most suspicious. 2.Signal re nement - after signals are generated in step 1 for some drug- medical events pairs these drug-medical event pairs are actively surveyed to look for more evidence that they may correspond to an ADR. 3.Signal evaluation - this is when a single in depth investigation (formal epi- demiological study) is performed to determine if there is causality between a drug and a medical event that has been signalled in step 1 and re ned in step 2. Early pharmacovigilance depended on professionals manually investigating hard copies of reports detailing suspected ADRs. These professionals would then identify commonly occurring suspected ADRs or highly noxious suspected ADRs as signals [113; 145]. The limitations with this methodology was that collabora- tion was di\u000ecult prior to the World Wide Web so the reports were only collected from a segment of the population and less obvious ADRs may never have been suspected and reported or may have been di\u000ecult to identify. With the advances in technology enabling rapid communication between borders and helping pool large quantities of data together, many of the original limitations are beginning to disappear [198]. Using the large collections of electrically stored data, we are now presented with the opportunity to apply data mining methods and gener- ate ADR signals more e\u000eciently [35], as less time is required before there is a 15su\u000ecient number of ADR incidences reported to enable the signal generation [158]. The majority of existing pharmacovigilance methods that use large databases for ADR signal detection are applied to the SRS databases. The SRS databases are readily available electronic databases that contain a collection of voluntary reports of suspected ADRs, often containing millions of reports. This type of database has been used to successfully signal many ADR signals, but the signals cannot be considered de nitive [119]. There are also well documented limitations with using SRS databases for ADR signalling, due to these databases relying on people recognising and reporting suspected ADRs [63; 79; 168]. It has been sug- gested that these limitations may prevent the detection of rare ADRs [79] or lead to delays in generating ADR signals [93]. The standard procedure for automating the generation of ADR signals in SRS databases relies on calculating a measure of disproportionality corresponding to how often the adverse event is reported after a speci c drug compared to a baseline determined by how often it is reported after any drug within an SRS database [119]. As there is no gold standard for ADR signal detection, each country tends to have a di erent preference for the choice of disproportionality method applied to his SRS database. The main dis- proportionality methods applied to the SRS databases and their limitations are detailed in Chapter 2.1.3. Recently the LODs have caught the attention of pharmacovigilance researches as it o ers a unique perspective for ADR signal generation and is starting to become more readily available [180]. The LODs suitable for pharmacovigilance contain timestamped medical records and timestamped prescription records for patients over large periods of time. Rather than relying on people suspecting 16ADRs like the SRS databases, potential ADRs can be inferred using temporal relationships between the medical and prescription records for a patient. This may enable the detection of rare ADRs or ADRs with a high background rate [180] that can not be identi ed by mining the SRS databases. Additionally, as generating ADR signals by mining the LODs does not require people noticing potential ADRs, it may be possible to generate ADR signals earlier than by mining the SRS databases. In Chapter 2.1.4, the current ADR signalling methods developed for the LODs are described, along with their limitations. The continuation of the pharmacovigilance section of the literature review in- cludes a section summarising causality, and the frequently applied Bradford-Hill causality considerations [19]. This is followed by a description of the current methodologies for detecting ADRs by mining the SRS databases and the new advances into mining ADRs using LODs. The nal section summarises the cur- rent pharmacovigilance initiatives and highlights how this eld of research may change with the integration of multiple electronic healthcare databases. 2.1.2 Causality The de nition of a statistical association is `a relationship between two measured quantities that renders them statistically dependent' [183] . Whereas the term causality is de ned as `a relationship between two events, the cause (or incidence) event and e ect (or consequent) event, where the e ect event is dependent on the cause event' [169]. Therefore a causal relationship is also an association but not all associations are causal. It is clear that an ADR represents a causal relationship, as the adverse event is a result of a patient ingesting a speci c drug and would 17not have occurred if the patient did not have the drug. The rst step in current ADR discovery, namely signal generation, nds drug-medical event pairs that are associated and the later two steps, signal re nement and evaluation, aim to determine if the found association is also a causal relationship. A common method to assess causality between an antecedent and consequence is to use the Bradford-Hill causality considerations [19] that proposes nine factors that need to be considered, 1.Strength - how much do the antecedent and consequence appear to be associated? A high association would suggest causation however a low as- sociation does not mean there is no causation. 2.Consistency - has the relationship been observed in di erent patients and situations? (In the context of ADRs, has it been reported in multiple pa- tients and databases?). 3.Speci city - is the relationship speci c (e.g., there are few other associa- tions containing the antecedent or consequence). This factor has limitations as many ADRs are the result of multiple causes. An alternative interpreta- tion is whether the population experiencing the relationship is speci c (e.g., old, young or female). 4.Temporality - the order of the antecedent and consequence (e.g., did the medical event make the patients more prone to the drug or did the drug cause the medical event?). 5.Biological Gradient - is there an increasing monotonic relationship be- tween the frequency/amount of the antecedent and the frequency of the 18consequence (e.g., does a higher dosage of the drug increase the medical event frequency?). 6.Plausibility - does it make sense? However, this is not a necessary feature as plausibility depends on current knowledge and even the improbable could be true. 7.Coherence - does the relationship con ict with known facts? (e.g., Do we know drug-medical events pairs that are de nitely not ADRs?). 8.Experimentation - does changing the antecedent change the consequence? (e.g., Does the medical event start when the drug starts and stop when it stops?). 9.Analogy -are there similarities with known causal relationships (e.g., does the ADR exist for a similar drug)?. The more Bradford-Hill causality factors covered by a method, the more likely it is to correctly identify causal relations and therefore identify ADRs. In Chap- ters 2.1.3.2 and 2.1.4.3 the range of Bradford-Hill causality factors considered by each of the existing ADR signalling methods are determined. 2.1.3 Spontaneous Reporting Databases 2.1.3.1 Overview The SRS databases were one of the rst resources to contain vast quantities of pharmacovigilance data and enable an aggregated analysis [152]. Their presence in the eld of pharmacovigilance has aided the discovery of many ADRs [106], 19Key A: medical event Ai: - Gender: \u0019; Age:21 1 b1 Figure 2.1: Illustration of data contained in SRS databases. but their application is limited [63; 172]. The databases contain linked drug and medical event records. Each link represents that the drug was a suspected cause of the medical event. In additional to the linked drug and medical records, there are also details specifying information about the patient that experienced the suspected ADR. An illustration of the data contained in SRS database is presented in Figure 2.1, where drugs are represented by squares and medical events are represented by circles. An example of the database design for an SRS database can be seen in Figure 2.2. The records in the database are submitted voluntarily by medical practitioners or the general public [118]. Two common examples of SRS databases are the Food and Drug Administration (FDA) Adverse Event Reporting System (AERS) [77; 184] in the USA and the Yellow Card Scheme SRS [118] run by the Medicines and Healthcare products Regulatory Agency (MHRA) and the Commission on Human Medicines (CHM) readID Figure 2.2: An example entity relationship diagram for an SRS database based on the FAERS database. The general process involved in reporting a suspected ADR into an SRS database is for a patient or doctor to ll out a form detailing the drug/drugs prescribed, the adverse event experienced, some information about the patient and information about the person making the report. An example of a typical SRS report submitted online via the yellow card scheme in the UK can be seen in Figure 2.3. The majority of elds in the form are not required and the entries are not validated during submission. This causes limitations as it is common for SRS databases to contain missing or incorrect data [137]. It is also known that SRS databases su er for bias reporting [173], especially under reporting [79]. Another issue is underascertainment, when the ADRs is not noticed (e.g., ADRs corresponding to medical events with a high background rate or rare ADRs may never be suspected) [173]. The SRS methods determine the association strength between a drug-medical event pair and pairs with a high association are signalled. The generated signals require further analysis as association does not imply causation [1]. This has 21 Figure 2.3: The online form for submitting suspected ADRs via the Yellow Card Scheme in the UK. 22prompted researches to state that the SRS methods are `initial lters' for iden- tifying ADR associations [8] and are not capable of generating de nitive signals. Once the SRS methods generate a signal, it is then re ned and nally evaluated. This means the causal relationship is not con rmed until much later in time than when the original signal occurred. The SRS databases generally have a xed point in time perspective, as limited past and present medical knowledge for each patient is known [12], the lack of historical data is illustrated in Figure 2.1. The actual rate that a drug is prescribed and the rate that a medical event occurs is unknown [172], as SRS databases only contain data on the drug prescriptions that may have resulted in an ADR. Consequently, the SRS methods estimate the baseline rate that a medical event occurs by nding out how often the medical event is reported with any drug in the database. Medical events that are reported disproportionally more often with the drug of interest compared to all the other drugs in the database are then ranked highly as suspected ADRs. The methods make use of a contingency table, see Table 2.1, summarising the number of reports that contain (or do not contain) the drug and event of interest. Each method estimates the baseline rate di erently, by using di erent combinations of the values in Table 2.1. Unfortunately, the estimation of the background rate, by using other drug reports, can limit the signals that are generated [76] and prevent some ADRs (e.g., those with a high background rate) being identi ed. In addition, both over- reporting and under-reporting can lead to skewed estimates for the background rates and in uence the signalling ability. Initially, the disproportionality methods relied on calculating measures linked to standard epidemiology statistical values such as the Reporting Odds Ratio 23Table 2.1: A sample contingency table used by the disproportionality methods applied to the SRS databases. EventYOther Event Total DrugX a b a+b Other d c+d Total a+c b+d a+b+c+d Table 2.2: The di erent SRS methods and the measures they implement to cal- culate the association between a drug-medical event Ratio In [196] the authors propose a novel PRR (NPRR) method, that takes a slightly di erent perspective, and they suggested that both the PRR and NPRR should be used to generate a signal. More recently, methods have been implemented that are based on arti cial neural networks, such as the Network (BPCNN) [10], or Bayesian Mean (EBGM) [50]. Table 2.2 summarises the di erent methods and displays their probabilistic derivations. The SRS signal generation methods are split between frequentist statistical approaches (ROR, PRR) and Bayesian statistical approaches (EBGM, BPCNN). The frequentist statistical methods assume that the parameters for a model are xed and they consider that the data comes from 1In the approach column, F represents frequentist and B represents Bayesian. 24a repeatable random sample. These methods do not require prior knowledge of a model and are computationally cheap. It follows that the advantage of fre- quentist methods for signal detection is that they are fast, which is an important factor due to the large quantities of data available. Conversely, the Bayesian sta- tistical methods assume that the data are xed and the parameters are unknown but described by a probabilistic distribution. These methods require some prior knowledge and can be computationally costly. The advantage of using Bayesian methods for signal detection is that, due to the parameters being non- xed, they can adapt over time when changes in the drug prescription habits may di er, such as when doctors change the prescription rates of drugs or prescribe drugs to patients for a non-standard indication. The methods all have signalling criteria, see Table 2.3. The frequentist meth- ods generate a signal for a drug-medical event pair when there are three or more case reports and the lower 95% con dence interval is greater than one. Their stan- dard errors, displayed in Table 2.4, are estimated using the woolf logit method [205], a method that approximates the distribution of the ln(ROR) and ln(PRR) as being normal. The EBGM generates a signal for a drug-medical event pair when the lower bound of the 90% credibility interval, EB05, is greater than two. The BPCNN signals a drug-medical event pair when its ICvalue minus two standard deviations changes from negative to positive. 2.1.3.2 Causality The SRS methods all work out the association strength between a drug and medical event based on the disproportionality measure. As the SRS databases sometimes contain the patient details such as age and gender it is possible for 25Table 2.3: The signalling criteria for the di erent SRS methods [50; 185] . The standard errors for the frequentist methods [185; algorithms to deal with the speci city criteria, but none of the existing methods does and the problem of missing values may make this di\u000ecult. The methods do not cover the consistency criteria when they are only applied to one SRS database and they do not deal with the biological gradient as they do not take into consideration the dosage of the drug. The SRS methods estimate the background risk of a medical event based on all other drugs rather than restrict- ing themselves to estimating the risk of the medical event based on similar drugs, therefore they do not consider the analogy criterion. Due to their restricted per- spective, they cannot cover the experimentation factor as this requires observing what happens when the drug stops and starts. The temporality, plausibility and coherence criteria are indirectly covered as people should only submit a report when a drug is suspected to have caused an ADR, and any suspected ADR would have occurred after the drug is taken and must be plausible and coherent oth- erwise it would not be suspected. However, people may make mistakes when 26Table 2.5: The Bradford-Hill causality considerations covered by each method.1 Criteria ROR PRR EBGM BPCNN Strength 4 4 4 4 Consistency 5 5 5 5 Speci city 5 5 5 5 Temporality \u000f \u000f \u000f 5 5 5 5 Analogy 5 5 5 5 reporting a suspected ADRs or may not know information that would otherwise make them reconsider that the medical event is a suspected ADR. The criteria that could be covered by SRS methods, but are not currently, are the consistency, analogy and possibly the speci city. The consistency criteria could be covered by using other SRS databases as a cross reference to see if there is evidence in other databases for the signals generated by the SRS methods. The analogy could be covered by comparing a drug of interest against drugs in the same family and using knowledge about existing ADRs for similar drugs and the speci city could be covered by comparing the drug and event disproportionali- ties between di erent groups of the population, such as the old or young. This information is summarised in Table 2.5. 2.1.3.3 Limitations The main limitations with signal generation using the disproportionality methods applied to SRS databases are due to database issues. The databases are known to contain missing or duplicated data and su er from inconsistent reporting such as 1\u000frepresents indirectly covered. 27under-reporting or over-reporting for new drugs or more serious adverse events [9]. It is often common for the SRS databases to be plagued by inconstancies due to changes in medical terminology over time or variance in the level of detail recorded for the medical event depending on the person making the report [9]. Bate et al. (2009) state that `disproportionality methods do not estimate reporting rates', as the reporting rate calculation requires the knowledge of drug usage and this is not contained in the SRS databases [9]. The e ect of this is that speci c adverse events will not be found, such as when a drug causes all events to increase or when an adverse event is common for many drugs. The two major consequences of the under-reporting are that there may be a large time lag between when a rare ADR is rst reported and when it is signalled, or it is possible that rare ADRs may never be detected. One retrospective study found that 19.6% of known ADRs were signalled by the PRR after other pharmacovigilance methods and 26.9% of known ADRs had not been signalled during the study period [3]. The SRS methods cannot be used for signal re nement or evaluation due to the limitation of not knowing the actual background rates that medical events occur or drug are prescribed. Therefore, it is not possible to develop a method capable of de nitively identifying ADRs that only uses the SRS databases, instead, other types of databases are required for the signal re nement and evaluation once signals have been generated by mining the SRS databases. 2.1.3.4 Summary Mining the SRS databases has aided new ADR discoveries, but the signals gen- erated by mining the databases require further evaluation and the majority of signals do not lead to ADR discovery [172]. A recent study provided evidence 28to suggest that limitations due to how the SRS data are collected may make it di\u000ecult for the disproportionality methods to identify ADRs with a high back- ground rate [70]. Furthermore, as a consequence of the the limited perspective of the SRS databases, they cannot be used to quantify ADR risks [119], nor can they be used to identify risk factors. 2.1.4 Longitudinal Observational Databases 2.1.4.1 Introduction The LODs are databases containing temporal medical data [12] on thousands or millions of patients, often spanning over many patient years. An example of an LOD is The Health Improvement Network (THIN) database, see appendix A, that is an electronic database containing the data stored in over 500 UK general practices [65]. The data consists of patient details such as their year of birth, gender, family links and timestamped medical and prescription records. It has been found to be a suitable representation of the UK [15] and it is not common to nd duplicated or missing data due to validation procedures. Researchers have assessed the validity of using the THIN database for pharmacovigilance by investigating whether known associations can be found using the data and concluded that its use is valid [105]. The database contains records of every medical event for a patient that the doctor has been informed of, as the data is extracted directly from the local GP databases and doctors must record all the relevant medical details each time a patient visits [85]. Unfortunately under- reporting is still possible in these types of databases, as some drugs can be bought rather than being prescribed and patients may not inform their doctor of all the 29medical events that they experience. It is also possible for LODs such as the THIN database to have inconsistencies in data recording between practices [78]. The THIN database also has issues with patients changing practices, as each patient is given an anonymous ID within their practice but when they change practices they will receive a new ID, and there are no links between the two IDs to identify them as representing the same patient [104]. The LODs o er a unique perspective for discovering ADRs as, unlike the SRS databases, they do not have direct links between drugs and medical events that are potential ADRs [161] but potential ADRs can be inferred using the temporal information. For example, if investigating ADRs that occur immediately after taking a drug, all the medical events that occur within 30 days of taking the drug can be agged as potential ADRs. The advantage of generating ADR signals using the LODs compared to the SRS databases are they contain patients' medical histories and include patients that did not experience adverse events after taking a drug [71]. Therefore they contain the background rates that a drug is prescribed or a medical event occurs [216] and are less prone to bias reporting due to not relying on voluntary reports. As the LODs are not restricted to nding ADRs that occur shortly after taking a drug, they could be used to nd ADRs that are not present till many years after taking a drug. Furthermore, the vast quantities of data contained in LODs makes them more suitable for detecting drug-drug interaction ADRs or child speci c ADRs. Figure 2.4 illustrates the data contained in LODs, and shows that the drug-medical event pairs that are potential ADRs can be found by investigating the [ t0;t1] period around each prescription. Another advantage of the LODs is that they have frequently been used for signal re nement and evaluation [31], so all three steps of detecting an ADR can be implemented 30time (years) pat1(\u001a) 2.4: Illustration of patients' longitudinal data contained in the THIN database. on a single LOD, making it possible to develop an e\u000ecient algorithm capable of de nitively detecting ADRs. Although, there may be issues with performing signal evaluation on the same data used to generate the signal. Numerous approaches have been suggested to signal ADR using LODs [26; 83; 90; 128; 216], but there algorithm that has been developed speci cally for the THIN database . The methods tend to calculate a measure of association between each medical event and drug. This is calculated by comparing the risk of the medical event for the drug taking population within a de ned time interval after the drug is prescribed with the risk of the medical event in some substituted population. These methods are based on the counterfactual theory of causality, where the observed risk of the medical event in the drug taking population is compared with the risk that would have been observed had the patients not taken the drug [122]. Once the patients take the drug, the second 31situation (i.e., patients not taking the drug) is counterfactual and unobservable, so an observable substitution is use instead to approximate the second risk. If the substitution does not match the counterfactual, then confounding is introduced and the measure of association di ers from the measure of causation [66]. An example of the counterfactual theory of causation is presented in Figure 2.5. It can be seen that the patient 1 given treatment 1 experienced medical event A but would not have experienced it if treatment 0 was given, so medical event A was caused by being given treatment 1 rather than treatment 0. However, it is impossible to observe patient 1 taking only treatment 1 and only treatment 0 at the same time, therefore an observable substitution is used to estimate causality. Association is determined by observing patient 2 taking treatment 0 and compar- ing the outcome with patient 1 taking treatment 1. Unfortunately, as the patients are di erent, the observed outcome over [ t0;t1] for patient 2 taking treatment 0 is di erent to what would have been observed for patient 1 given treatment 0 and the substitution comparison indicates that both medical event A and med- ical event B are associated with treatment 1. However, only medical event A is caused by treatment 1, the medical event B association is due to confounding introduced by the substitution. 32Key A: medical event A i: treatment i time t0 t1 Patient 1 B D 0 B1 A B Patient 1 B D 1 A B Patient 2 (substitute)G D 0 Figure 2.5: Illustration of the counterfactual theory of causaltion. 2.1.4.2 Methods Disproportionally Methods The disproportionality methods, such as SRS [216] and Temporal pat- tern Discovery (TPD) [128], compare the risk during the time interval [ t0;t1] centred around the drug of interest prescriptions with the risk during the time interval [t0;t1] centred around all drug prescriptions, so the substituted popula- tion is the patients taking any drug. This is illustrated in Figure 2.6. The TPD also looks for temporal changes in the measure of association, as this reduces the e ect of confounding by indication (i.e., when di erences arise between the patients taking the drug and those not taking the drug), as illustrated in Figure 2.7. Justi cation for using all other drug reports as a substitution, but keeping the same time interval of interest, is that medical events are not reported uni- formly over time [128], and it is common for the majority of medical events to be reported shortly after a prescription. By investigating the same period of time relative to the prescription, the potential bias caused by non-uniform reporting 33Key A: medical event A 2 B2 A5 2 D1 ... 2 B1 B2 Calculate risk after drugtime30 days 9 G1 3 A1 ... 1 D4 A1 Estimate background risk ( risk after other drug) Figure 2.6: Illustration of the disproportionality methods. is removed. To apply the standard SRS methods, described in Chapter 2.1.3, the contin- gency tables need to be determined using the LOD data. In [216], the authors presented three di erent proposals for calculating the contingency tables for a spe- ci c drugxand medical event yusing LODs. The spontaneous reporting system (SRS) and modi ed-spontaneous reporting system (modi ed-SRS) approaches performed similarly and both outperformed the distinct patient approach. Re- ferring to the set time period after the drug of interest is prescribed as the drug hazard period, the SRS approach calculates the a-dvalues in Table 2.1 as, ais the number of distinct times event yoccurs during any xhazard period, bis the number of distinct times any non{ yevent occurs during any xhazard period, c is the number of distinct times event yoccurs in any non{ xhazard period and d is the number of distinct times any non{ yevent occurs within any non{ xhazard 34timeu=[1,30] day B2 2 B2 A5 A4 2 D1 ... 2 B1 B2 Find temporal changes in risktimeu=[1,30] day interval v A1A3 9 G1 3 A1 ... A1 1 D4 A1 Estimate background temporal risk change (by calculating risk change for other drugs) Figure 2.7: Illustration of the TPD method. period. The modi ed-SRS approach is similar but considers the prescriptions that do not have medical events recorded. Therefore, bbecomes the number of distinct times any non{ yevent occurs during any xhazard period plus the num- ber ofxhazard periods that have no medical event recorded and dbecomes the number of distinct times any non{ yevent occurs within a non{ xhazard period plus the number of non{ xhazard periods that have no medical event recorded plus the number of distinct times non{ yevents are reported outside of a hazard period. The TPD method [128] compares the amount of patients that have the rst prescription of drug xin thirteen months followed by event ywithin a set time t relative to the expected number of patients if drug xand eventywere indepen- dent. The background rates that a medical event occurs is calculated based on how often it occurs within the hazard period for any drug. Letting, nt :ydenote the number of patients that are prescribed any drug for the rst time in 13 months and have event ywithin time t. 35nt x:denote the number of patients that have drug xfor the rst time in 13 months and are registered for any period over time t nt ::denote the number of patients that have any other drug for the rst time in 13 months and are registered for some period over time t. nt xydenotes the number of patients that have drug xfor the rst time in 13 months and event yoccurs within time tafter. The expected number of patients that have drug xand then event yin a time periodtis then, Et xy=nt x:nt :y nt ::(2.1) If for a given drug, the event occurs more than expected, the ratio between the observed and expected will be greater than one. By taking the log2of the ratio, a positive values suggests an interesting association between a drug and event. Modifying the equation to prevent the problem of rare events or drugs resulting in a small expectation that can cause volatility, a statistical shrinkage method is applied. IC=log2nt xy+ 1=2 Et xy+ 1=2(2.2) The shrinkage adds a bias for the ICtowards zero when an event or drug is rare. The credibility intervals for the ICare the logarithm of the solution to can nd possible drug and event associations of interest for a given 36t, however, the authors suggest that general temporal patterns can be found by comparing the ICof two di erent time periods. The follow-up period of primary interest is denoted by uand the control time period by v. This removes event and drug relationships that just happen to occur more in certain sub-populations. The di erent between the ICfor both xy\u0000log2nv xy As it was observed that medical events related to the cause of the drug are often assigned a high IC value after the prescription but also prior to the time the drug is prescribed, the TPD algorithm includes a lter thats ignores medical events that have a higher IC value on the day of prescription or a month before the prescription relative to the month after the prescription. Methods that calculate association tend to su er from confounding as associ- ation does not imply causation, so many of the medical events signalled due to a high association value may not be ADRs. One method that has been presented to counteract the problem of confounding is the ROR Regression (RORR) method [72]. The RORR e ectively lters the drugs that are signalled as ADRs by the 37ROR by determining whether the association may be due to confounding. The method applies two regression models, the rst model does not consider the e ect of covariates, letting yrepresent the medical event, and x1represent the drug, then the log odds of medical event y is, log(P(yjx1) 1\u0000P(Djx1)) =b0+b1x1 (2.7) whereb0is the background log odds ratio of medical event y. The second model considers the e ects of the covariates, xi;i> 1, and the log odds of yis calculated as, log(P(yjx1;x2;:::;xk) 1\u0000P(Djx1;x2;:::;xk)) =b0+kX i=1bixi (2.8) For each drug with a high ROR, the regression model only considering the drug, equation (2.7), and the regression model considering all the covariates, equation (2.8), are both applied and drugs that have similar b1values for both models are considered to be causes of medical event y. Unfortunately, its application on the THIN database is currently limited due to the requirement of choosing the appropriate covariates for each signal. This requires manual expert input for each signal, which would be time consuming. Sequential Pattern Methods Methods based on sequential pattern mining include Mining Unexpected Tem- poral Association Rules given the Antecedent (MUTARA) [91] and Highlighting UTARs Negating TARs (HUNT) [90]. These methods calculate the standard se- quential patterning mining measure known as leverage [134] that subtracts the expected proportion of all sequences that contain the drug followed by the medical event within a de ned time interval from the observed proportion. The expecta- 38tion is derived by calculating the risk within a randomly selected time interval for the population of patients never prescribed the drug. In e ect, this is similar to a retrospective cohort study as the cohorts are the patients exposed or non-exposed to the drug. The authors of MUTARA and HUNT refer to the patients prescribed the drug as users and patients never prescribed the drug as non-users. Both methods rst restrict their attention to subsequences of the user and non-user sequences. For each user sequence, the Thconstrained subsequence of interest is the subsequence of lengthThdays starting from the day the drug is rst prescribed. The value of Thdi ers between users depending on whether the user has a repeat prescription withinTedays after the rst prescription. If the user does not have a repeat prescription within Tedays of the rst prescription then Th=Te, whereas if the second prescription of the drug occurs sdays after the rst prescription where s\u0014TethenTh=s+Te. For each non-user, the Tcconstrained subsequence of interest is a subsequence of length Tcdays that is randomly chosen from the non-user's sequence. An illustration of this can be seen in Figure 2.8. De ningtotas the number of users and non-users, the supp(xT!y) is de ned as the number of user Thconstrained subsequences containing the medical event y divided bytot, thesupp(xT!) is the number of users divided by totandsupp(T!y) is the number of user Thconstrained subsequences that contain the medical event ydivided by totplus the number of non-user Tcconstrained subsequences that contain the medical event ydivided by tot. The leverage is calculated as, Leverage =supp(xT!y)\u0000supp(xT!)\u0002supp(T!y) (2.9) 39User 1 A3 2 A5 B2teth reference User 2 G4 2 2 D1teteth reference ... User n 2 B1teth reference Non-user 1 of the MUTARA and HUNT methods. 40In addition to calculating the standard leverage, a new measure called unexpected- leverage is also calculated. The unexpected-leverage (unexlev) makes use of a user's history to lter repeated medical events from the users's Thconstrained subsequence as these are `predictable' and unlikely to be ADRs. This is done by investigating a reference period prior to the rst prescription within the user's sequence and ltering medical events from the user's Thsubsequence if they oc- curred during the reference period. De ning supp( xT,!y) as the number of users who'sThconstrained subsequence contains medical event ybut who do not have medical event ywithin the reference period divided by totandsupp(T,!y) as the total of the number of users whose Thconstrained subsequence contains medical eventybut who do not have medical event ywithin the reference period plus the number of non-user Tcconstrained subsequences that contain the medical event yall divided by tot, the unexpected leverage is calculated as, unexlev =supp(xT,!y)\u0000supp(xT!):supp (T,!y) (2.10) MUTARA returns medical events ordered by unexlev and HUNT returns med- ical events in descending order of the ratio between the leverage rank and the unexpected-leverage rank, RankRatio =medical event rank based on leverage medical event rank based on unexpected-leverage(2.11) Other Methods Other methods for signalling ADRs using LODs that have been proposed include fuzzy logic methods [89], calculating the log likelihood over time [26], applying a 41Table 2.6: The di erent LOD ADR signalling algorithms and the causality criteria each of them covers.1 Criteria MUTARA HUNT TPD Modi ed SRS RORR Strength 4 4 4 4 4 Consistency 5 5 5 5 5 Speci city 5 5 5 5 \u0003 Temporality 4 4 4 5 5 Biological Gradient 5 5 5 5 \u0003 Plausibility 5 5 5 5 4 Coherence 5 5 5 5 5 Experimentation 5 5 5 5 5 Analogy 5 5 5 5 5 sequential version of the self controlled case series [83] or adapted epidemiology based approaches, see Chapter 2.1.5. These methods tend to su er from con- founding e ects and are likely to have a high false positive rate. However, it is worth noting that the self controlled case series is resilient to any xed in time confounding. Very few of these methods have been implemented on a range of LODs, so their robustness is unexplored. 2.1.4.3 Causality The LOD ADR signalling algorithms all cover the strength criteria as they cal- culated the dependancy of the occurrence of a medical event on the occurrence of a drug being prescribed. The ltering in the MUTARA/HUNT and the TPD algorithms means they cover the temporality criteria as medical events that occur before the drug are generally ltered. The modi ed SRS and RORR algorithms do not apply a lter, so they do not cover the temporality criteria. In e ect, the RORR covers plausibility by ltering out drug-medical event pairs that are asso- 1\u0003means that the factor could be incorporated but is currently not. 42ciated due to other causes, so the remaining drug-medical event pairs are more plausible ADRs. Additionally, it would be possible to include dosage and per- sonal attributes into the regression model used by the RORR, so the speci city and biological gradient could be included. The other causality criteria are not covered by the LOD algorithms. This is likely to be the reason why the existing LOD algorithms frequently signal medical events linked to the cause of taking the drug or medical events that are just common in the drug taking population. 2.1.4.4 Limitations The LOD databases have presented the opportunity to signal ADRs without the limitations associated with the SRS databases, but research has shown they have their own limitations [100; 131]. The main limitation is the e ect of confounding factors[198], as many drug-medical event pairs that are associated do not corre- spond to ADRs. The existing methods that signal drug-medical event pairs based on association do not consider the eight other Bradford-Hill factors, but some of these could be integrated by utilising the data available in the LODs. The RORR method has the potential to cover the most Bradford-Hill causality factors, but it is a signal re nement method rather than a signal generating method, as it requires a signal generating method such as the ROR to identify which drug- medical event pairs to apply the regression models on. Therefore, the RROR is limited by any limitations with the signal generating method it incorporates. 2.1.4.5 Summary The LOD algorithms show promise at becoming an integral part of pharmacovig- ilance in the future due to the wealth of information they potentially hold [198]. 43Although numerous methods have been developed for generating ADR signals using LODs, they have not been robustly analysed. Their theoretical founda- tions would suggest that they are likely to signal many non-ADRs due to the reliance on association. The RORR method, presented to identify confounding, requires initial drug-medical event pair signals to be generated, so it is a signal re nement method. There has been no method that combines signal generating and re nement into one, but such a method could signal drug-medical event pairs more e\u000eciently and obtain a lower rate of signalling non-causal relationships. 2.1.5 Combining Multiple Databases 2.1.5.1 Overview There has been a recent initiative to integrate multiple electronic healthcare data sources into one. Examples include the Mini-Sentinel [136], that will eventu- ally become Sentinel, a US Congress mandated pharmacovigilance system that contains medical data for more that 125 million Americans [124], the Exploring and Understanding Adverse Drug Reactions (EU-ADR) project [34], a European initiative set up in 2008 that contains data on over 30 million patients and the Observational Medical Outcomes Partnership (OMOP) that has a network of databases containing over 200 million patients. Numerous researchers have ex- pressed the signi cance of large pharmacovigilance sources in aiding the ability to discover ADRs e\u000eciently [144]. The initiatives may bridge gaps in the current pharmacovigilance, such as lack of knowledge concerning drug safety for minority groups [34]. The OMOP was formed to analyse the methodologies for pharmacovigilance 44using longitudinal data. The partnership have developed a common data model that enables the combination of di erent databases by transforming them into a general format [115; 131]. The OMOP have presented a magnitude of di er- ent techniques speci cally for signalling ADRs using longitudinal data, including cohort studies [107], disproportionality methods [216], case series methods [71], case control methods [71], case crossover methods [160] and propensity score based methods [159]. To enable an analysis of the methods, an approximate gold stan- dard consisting of 53 `ground truth' drug-medical event pairs (i.e., drug-medical event pairs that are known to be ADRs or non-ADRs) have been identi ed [141]. The ability of the methods to generate correct signals for these `ground truths', at their natural threshold, has been investigated [156]. The standardised `ground truths' only consider a selection of medical events, referred to as Health Outcomes of Interest (HOI) and a small subset of drugs known as Drugs Of Interest (DOI). Tables 2.7-2.8 display the OMOP's proposed HOIs and DOIs. Unfortunately, there are few studies investigating the methods abilities in generating signals when a large number of drug-medical event pairs are studied, however this is more realistic [143]. The OMOP methods tend to be based on standard epidemiological studies that aim to identify associations between drugs and medical events by nding medical event that have a greater incidence after a drug compared to the medical event's estimated background incidence. Many methods have been presented and the seven that have been extensively investigated as described below. The rst method, the High{throughput Screening by Indiana University (HSIU), is 1READ codes do not exist for the exact medical event, so GI ulcer READ codes are given. 2READ codes do not exist for the exact medical event, so mortality due to cardiac or patient died READ codes are given. 45Table 2.7: The Heath Outcomes of Interest de ned by the OMOP [80] and their corresponding THIN READ codes. Medical event THIN READ code K043. a cohort approach [80]. A cohort study follows a group of patients that have a common attribute or event (such as a drug prescription) and assesses outcome risk factors [178]. The Observation Screening method [155] calculates the screening rate within the drug population (the frequency of a outcome divided by the total risk time) and normalises this by dividing it by an estimate for the background screening rate. This is either the screening rate in a non-risk period (frequency in a pre-exposure period divided by the total pre-exposure time period) or the screening rate in a control group. The third method, the Disproportionality Analysis (DP) [216], identi es associations by comparing the rate that a medical event occurs within the drug population relative to the rate it occurs within some other population, similar to the SRS methods in Chapter 2.1.3. The Univariate Self-control Case Series (USCCS), based on the method devel- oped in [54], can be considered a cohort based study but where the exposed and non-exposed patients are the same. The approach partitions the cases' timelines 46Table 2.8: The Drugs of Interest de ned by the OMOP, table from [80]. DOI Drug Name DOI non-harard periods and compares the incidence in the hazard periods with the incidence in the non-hazard periods [200]. Fixed in time con- founding is overcome within the USCCS by using the same patients as the exposed and non-exposed. The Multi-Set Case Control Estimation (MSCCE) method is a case control approach that selects cases based on the occurrence of a speci- ed condition and selects control that do not have the condition and are active over the required observation period (i.e., have events reported before and after the period) [217]. The Bayesian Logistic Regression (BLR) [87] method applies a logistic regression approach using prior knowledge to initialise the coe\u000ecients that determine the weight that each covariate has on the nal output. The nal method is the Information Component Temporal Pattern Discovery (ICTPD), summarised in Chapter 2.1.4.2. The seven methods only cover the Bradford-Hill association strength consid- eration and some incorporate lters to cover the temporality. Consistency is indirectly incorporated due to the combination of multiple data sources. Some of the methods, such as the BLR, remove confounding by adjusting for covariates or apply strati cation to reduce confounding by age and gender. The seven OMOP methods described above were applied in the Non-Speci c Association (NSA) experiment, whereby the ten DOIs were paired with all possi- ble outcomes and the signals generated by each method at their natural thresholds were determined [80]. The majority of methods have many parameters that de- termine their performance and the study applied the methods over a range of parameter values to identify the optimal performance. This shows that addi- tional work is required to tune these existing methods depending on the database being used. The performance of the seven OMOP methods during the NSA ex- 48Table 2.9: The OMOP methods NSA experiment results. MethodOptimal Scores over the NSA AUC is presented in Table 2.9. It can be observed that all seven methods had False Positive Rates (FPRs) greater than 0 :25 and Mean Average precision (MAP) scores less than 0 :015. The AUC values ranged from 0 :6\u00000:735, as the AUC corresponds to the probability that an ADR is ranked above a non-ADR (rank 1 being the highest) [20], there is still approximately 30%-40% chance than a non-ADR will be ranked higher than an ADR. A recent study investigated potential loss from mapping the raw THIN data into the common data model [214]. A few existing methods were applied to both the raw THIN database and the THIN database mapped to the common data model. The results of the study suggested that the existing methods performed equally well on the raw and mapped data when considering the signals generated for the 53 ground truths. However, the study showed that 55% of drug codes and 25% of medical events codes could not be mapped from THIN into the common model [214], and this is likely to have detrimental e ects when more than the 53 ground truths are considered. This highlights the important of developing database speci c methods, in additional to the common model methods, that can utilise all the data available and present an alternative perspective for ADR 49discovery. When improvements in the mapping to the common data model are developed, then any method developed for THIN could also be modi ed for im- plementation on the THIN mapped to the common data model (or any other common data model mapped database). 2.1.5.2 Summary Combining the databases means that it may be possible to generate signals ef- ciently [3]. However, the combination requires the data to be transformed and normalised and this has the potential to lose information and can negatively im- pact the e\u000eciency of signalling ADRs. It was demonstrated in [214] that many of the raw THIN data cannot be incorporated into the common data model, motivating the development of methods that are speci c to certain databases. Comparisons of existing OMOP methods have shown that they perform mod- erately on the common data model [156] and there is no optimal method. In addition, the methods had a high false positive rate, even when the number of drug-medical event pairs being investigated is controlled. It is likely that the methods will be further hindered when applied to determine a drug's complete set of side e ects as there will be a surplus number of drug-medical event pairs corresponding to non-ADRs. 2.1.6 Pharmacovigilance Summary Adverse drug reactions are becoming an increasing burden on the NHS [166]. Existing post-marketing surveillance of drugs is limited by underlying issues as- sociated with SRS databases [79]. Many ADRs are only being found years after the drugs are marketed and as a result, many patients su er serious health issues 50that could be avoided with improved ADR knowledge. Rare ADRs that are hard to identify, ADRs corresponding to medical events with a high background rate or less serious ADRs may never be detected by data-mining algorithms applied to SRS databases [173]. As a result there has been a recent demand for improved post-marketing surveillance [129; 190]. One recent solution has been to develop data-mining algorithms for LODs or to combine multiple electronic healthcare databases as a resource for ADR detection. Unfortunately the current methods developed for LODs have a high false positive rate [156] and have not been extensively investigated due to a lack of a complete `gold standard' [33]. The high false positive rate is probably due to confounding caused by the countless number of possible covariates. Integrating the Bradford- Hill causality considerations into a signalling method is one possible consideration to reduce the negative impact of confounding factors and therefore reduce the number of false positive signals. The Bradford-Hill causality considerations have been used to help distinguish between associations that are causal, and those that are not. As confounding causes the associations that are non-causal, the Bradford-Hill causality considerations must be able to indirectly identify some confounding. The majority of existing methods only cover a few of the Bradford- Hill causality considerations, however, there is potential to extract data from the LODs to enable novel methods that cover more of the criteria. This could then reduce the number of false positives. The THIN database is a LOD that contain medical data for over 10 million patents, often spanning decades of years per patient. The general benchmark for the THIN database is unknown, as only a few methods have been investigated by considering the signals generated for a small set of 54 `ground truth' drug-medical 51event pairs [214]. A speci c method to signal ADR using the THIN database may generate novel signals that cannot be generated using the common data model nor the SRS databases. There are inconsistencies in the recording of data into the THIN database [78], but this may be overcome by developing a novel method that takes this into account. 522.2 Pattern Recognition In the previous part of the literature review the existing pharmacovigilance tech- niques that tend to signal ADRs by calculating an estimate for the relative risk of each drug-medical event pair were summarised. The medical events with a large estimated relative risk are then signalled, or alternatively `classi ed', as poten- tial ADRs. These methods can be considered unsupervised learning algorithms, algorithms that infer hidden structure without being taught [2], as they do not use knowledge of existing ADRs to learn intrinsic di erences between ADRs and non-ADRs. Rather, they use a single attribute such as the relative risk estimate to distinguish between ADRs and non-ADRs. The limitation with relying on a single attribute, such as the relative risk, is that confounding can occur and cause many non-ADRs to have a high relative risk estimate. This results in the techniques having high false positive rates and reduces the e\u000eciency in detecting ADRs. There has been no research to date that extracts attributes for drug-medical event pairs from LODs and then uses known ADRs as a means to learn the un- known ADRs based on their attributes, although in [113] the authors use chemical knowledge and learn from known ADRs. This type of learning is called supervised learning [74]. During the training stage, supervised learning requires attributes that describe each data-point and knowledge of the `classes' that the data-points belong to. In the context of ADR signalling each drug-medical event pair would represent a data-point and their attributes would correspond to values that could be used to distinguish between ADRs and non-ADRs. Examples of suitable at- tributes include the risk of the medical event within a de ned time period after 53taking the drug or the average age of the patients experiencing the medical event after the drug. Labels need to be assigned to each data-point (i.e., each drug- medical event pair) to de ne their class, for example the pair cipro oxacin and tendon rupture would be in the class ADR whereas the pair cipro oxacin and normal menopause are in the class non-ADR. In the pharmacovigilance eld this has been unexplored in general due to the uncertainty with knowing what med- ical events are de nitely ADRs or non-ADRs of a drug . If a su\u000ecient number of labelled data-points could be generated then a supervised algorithm could be trained. This would enable classi cation of any drug-medical event pair whose ADR status is unknown, as an ADR or non-ADR. If suitable attributes were chosen so that it was possible to distinguish between medical events linked to drugs due to confounding factors and true ADRs, then a supervised algorithm could o er signi cant improvement over existing ADR signalling methods . In the following section the theory behind supervised learning and the main al- gorithms applied are described. This is followed by a summary on semi-supervised learning, the technique developed to deal with the situation of having labels that are di\u000ecult to generate [30]. Due to the conundrum that applying supervised learning for signalling ADRs imposes, requiring knowledge of ADRs to extract knowledge of ADRs, it may be impossible to generate the required number of labeled data-points and a semi-supervised algorithm may be more appropriate. 542.2.1 Supervised Learning 2.2.1.1 Introduction Supervised learning is the process of learning from examples to infer the rela- tionship between inputs and outputs. A training set consisting of inputs (also known as attributes) and their corresponding outputs are used to `supervise' the training of a function that is capable of generalising the mapping between input and output. The trained function can then be used to predict the output of any unseen input coming from the same distribution as the training set inputs. When the outputs are discrete they are referred to as classes or labels and the supervised learning is known as classi cation. Alternatively, when the output is continuous the supervised learning is known as regression [37]. For example, if the odds ratio (OR) and risk di erence (RD) attributes are known for a thou- sand di erent drug-medical event pairs and for each pair their class (ADR or non-ADR ) is also known, then supervised learning could be applied to partition the attribute space into areas likely to correspond to ADRs and areas likely to correspond to non-ADRs, see Fig 2.9 illustrating the ideal situation where ADRs and non-ADRs are separable in the space determined by the OR and RD. Formalising the previous statement, the training set Anis a collection of inputs xi2Xand corresponding outputs yi2Ypairs, An=f(x1;y1);(x2;y2);:::;(xn;yn)g (2.12) Where each pair ( xi;yi) are assumed to be independent identically distributed samples from an unknown joint probability distribution P. In general, X\u001aRm 55RD RDOR OR ADR non-ADRnew data-point predicted as data-point predicted as non- ADR Training PredictionFigure 2.9: Illustration of a classi er partitioning the attribute space. Using the training data (blue dots are labelled as ADR and red as non-ADR) a function is trained to partition the space into ADR sections and non-ADR sections. This can then be used to predict whether a new data-point is an ADR or non-ADR based on where the data point lies in the attribute space. 56andY\u001aRfor regression or Y=f\u00001;1gfor binary classi cation. The task of supervised learning is to nd a function f:X!Y, wheref2H(a class of functions). As the training data is considered to consist of nindependently identically distributed samples from an unknown joint probability distribution P(x;y), then the task of supervised learning is to develop a function fthat models the de- pendency within the joint distribution. There are two di erent approaches for producing machine learning models, the discriminative model and the generative model. The discriminative model aims to determine the conditional distribution of the class label given the input, P(yjx) , by using a parametric model and determining the model's parameter values with the aid of the training set [102]. The generative method calculates the joint probability distribution, P(x;y), and makes use of this distribution to predict the conditional distribution [102]. In gen- eral, if the training set is su\u000eciently large (depending on the complexity of the model), discriminative models have been shown to perform better [92], however, generative models have the advantage of being able to incorporate unlabelled data [102]. This is advantageous when generating labels becomes costly. To nd the optimal function f2Hfor mapping the inputs to their outputs it is necessary to evaluate each functions performance. This is calculated by a non-negative loss function, L:Y\u0002Y!R+, that determines a measure of error between the predicted output f(xi) and the real output yi. Various loss functions have been proposed, examples for binary classi choice of the loss function that is implemented should be chosen based on the speci c classi cation problem [4]. The integral of the model's loss function over the joint probability distribution gives the generalisation error, or risk, R(f) =Z L(f(x);y)dP(x;y) the risk, R(g\u0003) = inf fR(f) (2.14) The goal of a discriminative learning algorithm is to nd the function within a class of possible functions, f\u00032H, that minimises the risk, f\u0003= arg min f2HR(f). Unfortunately it is often the case that the Bayes estimator does not belong to the class of possible functions. Methods that aim to determine the function that minimises the risk include empirical risk minimisation a simple and generally e\u000ecient means to deter- mine a suitable function. The empirical risk measures the di erence between the predicted output values and the true output values by calculating the average of the loss function over each data-point in the training set, Remp(f;An) =1 nnX i=1L(f(xi);yi) (2.15) The empirical risk minimisation method then identi es the function ffrom a 58model of possible functions Hthat minimises the empirical risk, f\u0003= arg min f2HRemp(f) It is clear that the choice of model that determines the possible functions has a direct impact on the results returned by the empirical risk minimisation method. The idea behind the structural risk minimisation is to pick a sequence of models,fHsjs2Ng, than increase in size and nd the argument that minimises a trade o between the empirical risk and a penalty that penalises large models (models with a large capacity), f\u0003= arg min f2Hs;s2NRemp(f) +pen(s;n) (2.16) wherenis the size of the training data. As the empirical risk only estimates the actual risk, it is of interest to nd bounds on the di erence between the actual and empirical risk, as this gives an indication into the predictive suitability of any functions that are determined using a supervised learning model. Extensive analysis by [187] managed to show that the actual risk is bounded by the empirical risk and an additional term than corresponds to the complexity of the model. With probability 1 \u0000\u0011the following holds, R(f)\u0014Remp(f) +r h(log(2n=h)\u0000log(\u0011=4)) n(2.17) wherehis the VC dimension of the class of functions H, this is a measure of their complexity. The VC dimension of a class of functions is the maximum number of points that can be separated in every possible way by those functions over a 594 4 4 5 Figure 2.10: Illustration of the maximum number of points separable in every possible way by a linear classi er. de ned space [189]. A visual example demonstrating that a linear classi er has a VC dimension of 3 can be seen in Figure 2.10. It can be seen that 3 non-collinear points can be separated by a line in every possible way, but this is not the case for 4 points, as the far right graph shows two lines are required. In general the bound can be represented as, Test error\u0014Training error + Complexity of set of models (2.18) Training a highly complex model may lead to over tting, where the training error is minimised but the model is not generalised and performs poorly on the testing data. On the other hand, a less complex model is likely to have a high training error. Therefore, the perfect model determines a function that has a low training error but is also as simple as possible. The complexity of the model depends on H, the class of functions, and this is determined by the classi er being applied. The most widely applied classi ers are the Decision Tree [81], Naive Bayes [101], Logistic Regression [84], Support Vector Machine [39] and K-Nearest Neighbours (KNN) [56]. Each of these have di erent model assumptions and are brie y summarised in the following section. 60RR OR non-ADR\u00143ADR>3<4RD non-ADR\u00142ADR>2 \u00154 Figure 2.11: Example of a decision tree to classify drug-medical event pairs as ADRs or non-ADRs. 2.2.1.2 Classi ers Decision Tree The decision tree classi er is a directed tree that recursively partitions the at- tribute space into sub-spaces. An illustration of a hypothetical decision tree can be seen in Figure 2.11. A decision tree is non-parametric [116], self explanatory [116] and has the advantage of being una ected by heterogeneous data or di er- ent features that have varied ranges. This means that the data does not need to be extensively processed before applying the classi er. Unfortunately, it has been described as 'greedy' as noise or irrelevant attributes in the training set can greatly impede its performance [139]. The decision tree can be constructed with a bottom-up [95] or top-down [149] approach. Generally speaking, the algorithm uses a splitting measure to calculate how well an available partitioning of the space separates the classes. During each iteration in the top-down approach, the optimal partitioning is applied to the current subspace, or the subspace stops being partitioned when the splitting 61measures shows there is no possible partition that can lead to a su\u000ecient gain or the stopping criterion is satis ed. In general, the splitting criteria is only based on a single attribute during each iteration. This is known as univariate splitting [116] and the measures are often based on impurity based criteria such as the Gini index [21] or information gain [138]. The information gain takes its origin from information theory and measures the change in the entropy value that is caused by partitioning the space. The entropy value corresponds to the uncertainty within a set. Considering the binary classi cation problem where there are two class, let p1andp2represent the pro- portion of the data-points within the set Sthat are in class 1 or \u00001 respectively, then the entropy is, E(S) =\u00002X i=1pilog2pi (2.19) If the data-points in a set are all from one class, without loss of generality, assume they are from class 1, then p1= 1 (log2p1= 0) andp2= 0 soE= 0, the lowest possible value. If the data-points in a set are spread equally between the two classes,p1=p2= 0:5, then the entropy is the highest possible value E= 1. It is clear that choosing a partitioning with the highest information gain minimises the entropy and leads to a nal partitioning of the space into numerous subspaces that are dense in a single class. The main limitations of using information gain as the splitting measure for a decision tree classi er is that there is a bias towards partitioning based on attributes with large ranges [201] that can lead to over- tting and it is common for the space to be fragmented into a surplus number of small subspaces. The Gini index is another splitting measure frequently implemented. The 62Gini index is calculated for a set Sby, Gini(S) = 1\u00002X i=1p2 i (2.20) The Gini index is minimised when the majority of the data-points within set S belong to one class. In this case, one of the pivalues will be close to one and the others will be small. The square term in the Gini index calculation puts more emphasis on larger values. Squaring the pivalue close to one has little e ect, whereas the closer a pivalue is to zero, the more it becomes reduced when squared. So a set Scontaining data-points spread between di erent classes will have a small value forP2 i=1p2 iand therefore a Gini index close to 1. The average Gini index is the weighted average of the Gini index based on partitioning the set Sinto subsets Siusing the values of a single attribute A, wherejSjcorresponds to the number of elements in the set S, Gini(S;A) =X ijSij jSjGini(Si) (2.21) The decision tree is generated by nding the partitions that minimise the average Gini index. Research comparing the di erent univariate splitting measures has often concluded that the choice has little e ect on the decision tree as there does not appear to be an overall superior measure [116]. Naive Bayes The Naive Bayes classi er uses the training set to determine the distribution of the class label, P(Y), and the conditional distribution of the input attributes 63given the class label, P(XijY) fori2[1;n], and then use these combined with Bayes rules and a conditional independence assumption to nd the most probable class for any future inputs. The conditional independence assumption is used to simplify the number of parameters required by the model and enables an e\u000ecient calculation of the distribution P(YjX). Consider three random variables, X, Y and Z. It is de ned that X is condi- tionally independent of Y given Z if, P(XjY;Z) =P(XjZ). Assuming that the input features are conditionally independent given the class label, then, P(X1;X2;:::;XnjY) and using the conditional independence the expression for the conditional prob- ability of the class label given the input data is, P(Y=ykjX1;:::;Xn) =P(Y=yk)Q iP(XijY=yk)P jP(Y=yj)Q iP(XijY=yj)(2.23) As the denominator in equation (2.23) is independent of the choice of class label, it can be ignored. The classi er simply determines the most probable class label 64for an input by, Y= arg max ykP(Y=yk)Y iP(XijY=yk) (2.24) The classi er, although limited by its unrealistic assumption of conditional inde- pendence, has performed well for some real life classi cation problems [47]. In [146] the authors state that a known limitation of the Naive Bayes classi er is that it does not perform optimally when the classes are non-linearly separable. Logistic Regression Logistic regression is a discriminative model so it assumes a distribution for P(YjX) and uses the training data to determine the parameter values. Logistic regression is applied when the classi cation is binary and does not required the inputs to be normally distributed, have equal variance within each class nor be linearly related [27]. The main disadvantage with the classi er is that it uses maximum likelihood to determine the parameter values and this requires larger training sizes than for linear regression. It is suggested that a minimum of 50 cases per predictor are used [27]. The logistic regression model is based on the assumption that the log odds of a data-point belonging to a class given its nattributes can be expressed as a linear combination of the data-points attributes. Under this assumption the log odds is expressed as, ln(P(YjX)=(1\u0000P(YjX))) =w0+nX i=1wiXi 65by taking the exponential and re-arranging, the conditional model used by logistic regression for the two class problem is, P(Y= classi er assigns the class for an input xbased on arg max ykP(Y=ykjX= x), it is clear that class 0 is assigned when 1 <exp (w0+P iwiXi) (or equivalently 0<w 0+P iwiXi) and class 1 is assigned otherwise. Support Vector Machine The Support vector machine (SVM) classi er is a parametric model that aims to nd the hyperplane that separates the classes while maximising the distance between the data-points and the hyperplane, see Figure 2.12. For the two class problem, the SVM works by nding two parallel hyperplanes such that they separate the two classes and there are no points between the two hyperplanes. The equations of two hyperplanes are w:xi+b= 1 and w:xi+b=\u00001. The bit in-between the hyperplanes is referred to as the `margin'. This is what needs to be maximised to ensure the classes are separated as much as possible. As the distances between the two hyperplanes is 2 =jjwjj, by minimisingjjwjjwe can nd the maximum separation between the classes. Previously in Chapter 2.2.1.1 it was shown that the actual risk of a classi er is bounded by the empirical risk and a term that depends on the capacity/complexity of the set of decision functions 66y xw\u0001x+b= 0w\u0001x+b= 1 w\u0001x+b=\u000012kwk bkwkw Figure 2.12: Illustration of the support vector machine classi er. The hyperplane separating the classes is positioned such that the distance between the hyperplane and the closest data points from either class is maximised. de ned by the classi er. The decision functions used by the SVM classi er are the hyperplanes w:x+b. It has been proven that for the set of hyperplanes (w:x) = 0 such that min ijw:xij= 1 for set of decision functions [188], h\u0014R2A2(2.25) where R is the radius of the smallest ball centred at the origin that covers the setX. This de nes an upper bound on the capacity/complexity of the SVM classi er. In the separable in a zero empirical risk and minimises the capacity of the model. When the data is non-separable (i.e. there is no hyperpane that can cleanly split the classes), slack variables are introduced to enable the misclassi cation of some data-points. The aim is to maximise the margin while minimising the degree of misclassi yi(w:xi+b)\u00151\u0000\u001bi;\u001bi\u00150 An addition to the optimisation problem includes incorporating kernel functions that map the data-points into a space where they are separable [125]. K-Nearest Neighbour The K-nearest neighbour (KNN) classi er is non-parametric, this means it does not assume the data come from a speci c distribution. The classi er is described as a lazy algorithm as it does not use the training data to generalise (generate a probabilistic distribution) [199], this makes the training state highly e\u000ecient, but can cause the testing step to become costly. The classi er requires the data to come from a metric space, but the measure of distance can be any suitable metric. The classi er works by taking the majority vote of the knearest neighbours, where distance is determined by the de ned metric. If the set Nk(x) is the set of indices corresponding to the K nearest 68neighbours of 7, and for an input xthree of its neighbours are class \u00001 and four are class 1 then the input would be assigned the class 1. The algorithm can be modi ed to use the distance of the neighbours as weights so that closer neighbours have more in uence [49]. 2.2.1.3 Ensemble Methods An ensemble classi er considers the outputs from multiple trained classi er to determine the class of a data-point [130]. In general, the method combines multi- ple diverse `weak learners' to produce a `strong learner'. The motivation behind an ensemble classi er is to reduce the bias that can occur when considering single classi ers and to reduce the variance than can occur due to the choice of data used during training [23]. There exists a magnitude of options for generating diverse classi ers including building models from di erent samples of the data [22], using di erent models [51] or building models that use di erent subsets of attributes [82]. There are also di erent ways to combine the predictions from the classi ers, such as deter- mining the class by voting that returns the modal class or weighted voting that incorporates the con dence of the classi ers or error estimations as weights to produce a weighted sum of the votes. Another method, known as stacking, is to use the outputs of the classi ers as inputs into a new meta classi er that does 69the nal classi cation [177]. The most widely implemented ensemble methods that use sampling of the training data set are known as bagging [22] and boosting [60]. Bagging involves iteratively generating classi ers that are built on di erent training sets and re- turning the class with the highest number of votes based on these classi ers. The di erent training subsets are produced by drawing with replacement from the whole training set. Bagging has a statistical basis and can be considered similar to averaging as it reduces the classi er's variance [23; 130]. The advantage of bagging is that is it resistant to noise, however, experiments have shown that with a little noise present it is not as accurate as other methods such as boosting [46]. Boosting has its foundations in learning theory and the general aim is to pro- duce a sequence of classi ers that are used to generate a weighted vote for the overall class. The misclassi cations of the previous classi ers in the sequence have an in uence on the weights assigned during classi cation in the later sequence classi ers. The most widely used boosting classi er is the AdaBoost classi er developed by Freund and Schapire [61] that generates a sequence of simple clas- si ers (hm2H, whereHis a class of simple classi ers) and weights ( \u0015m2R) by giving more importance to data-points that were misclassi ed by the simple clas- si ers earlier in the sequence. The nal classi cation makes use of the weighted majority vote sgn(PM m=1\u0015mhm(x)). Considering ( Xi;Yi);i2[1;n] to be i.i.d. samples where Yi2f\u0000 1;1gandXi2xthen the sequence is determined by, 1, to step 1. In step 1 the algorithm nds the simple classi er in Hthat has the smallest weighted misclassi cation and then calculates the corresponding lambda based on the ratio of correct classi cations to misclassi cations. The weights that de- termine the importance of correctly classifying each datapoint are then updated in step 2. If the simple classi er misclassi ed datapoint ithen\u0000\u0015mhm(Xi)Yiwill be positive and therefore the weight given to it will increase, alternatively if the classi er was correct the weight will decrease. Boosting has been shown to often work well but it has been hypothesised that results by boosting may be impeded when there is noise present in the training set [46; 59]. The random forest is a non-parametric ensemble classi er that produces a `forest' containing multiple decision trees and determines the class based on ma- jority voting whereby each tree in the forest is given one vote [24]. Each decision tree is built on a di erent random sample of the training set, where sampling is done with replacement. Let the training set Dn=f(X1;Y1);(X2;Y2);:::;(Xn;Yn)gconsists ofni.i.d. pairs of random variables sampled from the joint distribution ( X;Y) whereX=R andY=f0;1g. We represent the marginal posteriori er gnmisclassifying =Pfgn(X;Dn)6=Yg It has the Bayes classi er, g\u0003(x) = 1f\u0011(x)\u00151=2g, minimises the probability of error [45] and this probability of error for the Bayes classi er L(g\u0003) is referred to as the Bayes risk. A sequence of classi ers ( fgng) is for if8\u000f>09N2Ns.t.8n\u0015NjL(g\u0003)\u0000L(gn)j<\u000f. randomised classi er gn(X;\u0012;Dn) uses a random variable \u0012to determine its prediction, where \u0012takes its values from some measurable space. The probability of error for the randomised classi er can be calculated as, L(gn) =Pfgn(X;\u0012;Dn)6=YjDng Givenmidentically distributed draws from the random variable \u0012,\u0012m= (\u00121;:::;\u0012m) where each of the \u0012isare considered independent conditionally on X;Y andDn, the random forest classi er is constructed such that it takes the majority vote of mdecision they prove that if the sequence of random classi ers is consistent then so is the voting classi er. This result implies that if the sequence of random decision trees generated by the random forest is consistent then the probability of error of the random forest tends to the Bayes risk as the number of random 72trees increases. One example of the randomisation procedure used to generate the random classi ers by the random forest is to use bagging. In this case each decision trees is built on a random sample of the training data. Another common method is to randomly sample from the attributes available in the training data and train each tree on a di erence set of attributes. Some random forest classi ers incorporate the randomness by generating decision trees that interactively pick a random attribute to partition the attribute space until each partition only contains a single data-point from the training set, and then the class returned for a new data-point is the class of the training data-point corresponding the the subspace that the new data-point is in [24]. This method has been shown to have similarities with the nearest neighbour classi er [110]. 2.2.1.4 Supervised Learning Summary In this section the statistical learning theory undermining supervised learning was summarised and the main supervised classi ers currently implemented were presented. It is clear that given su\u000ecient historical data it is possible to learn underlying patterns within the data that can be used to form future predictions. As the THIN database contains a large quantity of historical data, supervised learning techniques can be applied with the aim of inferring medical information that can help improve current healthcare. In the later parts of this section the ensemble classi ers, that make use of multiple classi ers with the aim of improving the classifying accuracy on average, were discussed. In particular, the focus was aimed towards the random forest as this classi er can be applied to heterogeneous data and by incorporating bagging it can be more resilience to noise. These are the two key issues associated with the THIN database, suggesting the random 73forest may have excellent performance when applied to classify ADRs using the THIN database. The majority of existing algorithms for signalling ADRs using electronic health- care databases are unsupervised as they do not include known ADR labels when detecting patterns and instead nd general structures of interest within the data. The reason few supervised algorithms exist is due to the lack of known ADRs pre- venting the ability to have su\u000ecient quantities of labelled data. However, if these labels can be discovered then a supervised algorithm, with appropriate attributes, may signi cantly outperform its unsupervised counterpart. Due to clinical tri- als and knowledge gained over the time that a drug is actively prescribed, some ADRs are de nitively known and could be used as labels. If there are some labels but not enough, then an alternative method would be to apply semi-supervised learning. Semi-supervised learning is a mixture of supervised and unsupervised learning techniques. In involves the inclusion of unlabelled data-points into the training stage of an algorithm when there is a small number of labelled data- points [30]. It is often observed that including unlabelled data-points during training can lead to an improvement in performance of the algorithm [30]. This is discussed further in the next section. 2.2.2 Semi-Supervised Learning 2.2.2.1 Introduction Supervised classi cation was previously introduced, where the aim is to nd a function that approximates the joint distribution between the random variables XandYwhen given nrandom i.i.d. samples. Unfortunately, it is not always 74possible to observe both XandYtogether a su\u000ecient number of times as the labelYcan be scarce or costly to determine [30]. When the number of labelled samples in the training set is low, any classi er trained on the data is likely to perform poorly [140]. When the number of labelled data-points are scarce but unlabelled data-points are readily observable, under certain assumptions, knowledge of the marginal dis- tribution can result in an improvement in the function that approximates the joint distribution. Semi-supervised learning algorithms make use of unlabelled data- points to learn the marginal distribution and incorporate this in addition to the labelled data-points when inferring the joint distribution. Formally, given both labelled (f(Xi;Y)gl i=1) and unlabelled ( fXigl+u i=l+1) data the aim of the supervised learner is to infer the joint probability distribution P(X;Y) where the labelled data-points are i.i.d. samples from the joint distribution and the unlabelled data- points are i.i.d. from the marginal distribution P(X). In general there are more unlabelled data-points, l<<u In the remainder of this introduction, the main semi-supervised techniques are summarised and the limitations associated to the assumptions they make to enable the incorporation of unlabelled data are discussed. Self-training Algorithm The self-training algorithm [40] trains a classi er on the labelled data and then applies the trained classi er on the unlabelled data to predict their class. The algorithm then assumes that some of the predicted classes of the unlabelled data- points are true and moves these from the unlabelled dataset into the labelled dataset. The algorithm continues until the unlabelled dataset is empty. Gener- 75ally the algorithm considers the model predictions for the unlabelled data-points with the greatest prediction con dences to be true, however, this is not always the case when the classes are non-separable [215]. Consequently, the self-training algorithm can perform poorly when the classes are non-separable. Early mistakes can have huge impacts as misclassi cations will be incorporated into the training of the classi ers in future iterations, potentially leading to further misclassi ca- tions. Probability Generating Models The aim of each classi er is to identify the most probable class given the in- put, arg max Yp(YjX), and this can be determined using a generative model. The generative model makes use of Bayes rule to show that arg max Yp(YjX) = arg maxYp(XjY)p(Y) and this implies that the class can be determined when the conditional distribution p(XjY) and marginal distribution p(Y) are known. If the conditional distribution and marginal distributions are assumed to come from a speci ed model then given the training data D, the most likely parameter value\u0012is, ^\u0012= arg of \u0012that 76locally maximises p(Dj\u0012). The limitations with the probability generating models are that the probabilistic model needs to be de ned and an incorrect model will lead to inaccurate results [215]. It can be di\u000ecult to determine the conditional distribution if the number of labelled data-points is small [215]. This technique is more appropriate if there is additional knowledge about the data (e.g., the distribution the data come from is known). Co-training The semi-supervised method of co-training [16] is when two di erent classi ers are trained, in a similar style to self-training except they learn from each other and unlabelled data is iteratively added to each classi er's labeled data based on the predictions of the other classi er. The process of co-training at learning speedkis, 1.Initially let the training sample be L1=L2=f(X1;Y1);:::;(Xl;Yl)g. 2.Repeat until unlabelled data is used up: f(1)fromL1and a er from the unlabelled data. In e ect, the algorithm forces the two classi ers, using di erent views, to agree on the prediction of the unlabelled data, and the chance of over tting is reduced. 77The co-training algorithm assumes that the data can be partitioned into two di erent views but how this is done is not always obvious. One limitation of this algorithm is that it requires the two views to be conditionally independent given the class [41], P(X(1)jY;X(2)) =P(X(1)jY) P(X(2)jY;X(1)) =P(X(2)jY) Although in [6] the authors argue that the conditional independance can be re- laxed. They suggested that co-training can be applied as long as the two views are not highly correlated. However, many situations are likely to violate this assumption. For example, in the context of classifying a drug-medical event pair as a side e ect, if one view uses the knowledge of when the drug occurs relative to the medical event and the other view uses association strength, these views are likely to be highly correlated. If the drug is only observed before the medical event occurs and not after then this will probably mean there is also a strong association between the drug and medical event. In Chapter 2.2.1.1, the error of a classi er was shown to be bounded by the training error and the term that corresponds to the complexity of the model. It is known that a complex model that minimises the training error may not generalise well to unseen data as it may over- t. Co-training aims to reduce the complexity of a model by restricting the function space, and therefore reduces the error [215]. 782.2.2.2 Semi-Supervised Clustering When there are no labelled data available, unsupervised techniques such as clus- tering are applied to nd intrinsic patterns within the data [88] without learning from labelled data. Examples include the k-means clustering that initially assigns each data-point into a random cluster and then iteratively moves each data-point into the cluster that is closest [73]. The distance between the data-point and each cluster is based on the cluster centre, the average of the data-points within that cluster. Recent semi-supervised techniques have involved the incorporated of a small number of labelled data to bias the clustering [7]. For example, in [7] the authors use the labelled data to determine the initial centres in the k-means clus- tering algorithms and x the labelled data-points into one cluster. Alternative approaches to improving clustering with additional knowledge has involved using must or cannot be in the same cluster constraints [191] or interactive clustering [32], where the semi-supervised clustering algorithm adapts based on If the labels are given, the seed-constrained K-means clustering algorithms, developed in [7] improves the unsupervised k-means algorithm by using the labels data to determine the initial cluster centres and then applies the k-means algo- rithm while xing the labelled data to their known cluster. The set of data-points input into the seed-constrained K-means algorithm is the set fx1;x2;:::;xng, the value ofKinput isk(the maximum number of classes in the labelled data) and the initial seeds are Sl=fxi:xiis labelled as class l g. The seed-constrained k-means algorithm is described in Algorithm 1. As there will be labels rather than constrains for the ADR detection problem, the seed-constrained K-means algorithm presents a simple and e\u000ecient data-points X=fx1;x2;:::;xng,xi2Rd, number the seed-constrained K-means algorithm developed in [7] if the number of labelled data are low. A common problem with clustering is that the measure of distance this is most suitable for a given problem is generally unknown [210]. The Euclidean distance metric is the standard one implemented, but this treats each attribute equally and assumes the attributes are independent [208]. For many clustering problems these assumptions are unrealistic. This has prompted researchers to develop methods that use the limited number of labelled data available for semi-supervised learning to learn the optimal metric space. By learning the suitable metric space, clustering techniques can be improved [208]. 2.2.2.3 Metric Learning An area of recent research is using additional knowledge to determine the optimal metric, see [99] for a summary. As clustering looks for closely connected com- munities within the data, the measure of `closeness' will impact the results, and the standard Euclidean distance may not be most suitable [208]. In [211] the au- thors proposed learning the metric prior to clustering, whereas in [14] the metric learning is embedded into the clustering and gets applied during each iteration. 80In [211], the authors proposed a metric learning algorithm that uses knowledge of constraints (i.e. labelled data-points that are in the same cluster as must-link and data-points that are in di erent clusters as cannot-link) to learn a mapping from the original attribute space into a new space that maximises the distance between data-points in di erent clusters while adding a constraint to the maxi- mum distance that data-points in the same cluster can be apart. The algorithm applies eigenvalue optimisation and is highly e\u000ecient. The known constraints are used to determine S, representing the set of all index pairs for data-points that are similar (e.g., (1 ;3)2Smeans that data-point 1 and data-point 3 are known to be in the same cluster), and D, representing the set of index pairs for data-points that are di erent (e.g., (1 ;5)2Smeans that data-point 1 and data-point 5 are known to be in di erent clusters). The inner product of two d\u0002nreal valued matrices, A;B2Rd\u0002n, is denoted by hA;Bi:=Tr(ATB), where Tr(A) means the trace of the matrix Aand the cone of positive semide nite matrices is denoted by Sd +. Given a pair of data-points xi;xj2XDi L, the matrix Xij= (xi\u0000xj)(xi\u0000xj)T. If = (i;j) is an index pair, then X \u0011Xij. The matrix XSis de ned byXS=P (i;j)2SXijand\u0018 X =X\u00001=2 2De\u0000h\u0018 X ;Si=\u0016\u0018 X P 2De\u0000h\u0018 X ;Si=\u0016. The metric learning process, that uses these matri- ces, is presented in Algorithm 2. The must-link and cannot-link constrains can be determined when some la- belled drug-medical event pairs are known. The must-link pairs are all combina- tion consisting of any two of the known ADRs pairs or all combinations consisting of any two of the known non-ADRs pairs. The cannot-link pairs are all the possi- ble combinations consisting of one of the known ADR pairs and one of the known 81Input : metric learning algorithm from [211] non-ADR pairs. It is then possible to apply the metric learning described by Algorithm 2 to e\u000eciently learn the optimal metric space. 2.2.2.4 Semi-Supervised Learning Summary In this section the frequently applied semi-supervised techniques have been sum- marised. The semi-supervised techniques can, under certain assumptions, im- prove classi cation/clustering by incorporating the unlabelled data when the number of labelled data are scarce [30]. Out of the semi-supervised classi cation techniques discussed (i.e, self-training, co-training and probability generating), the self-training algorithm is most applicable for classifying ADRs due to the probability generating algorithm requiring prior knowledge of the distributions [215], of which is unknown, and the di\u000eculty with determining the non-correlated views required by the co-training algorithm. Alternatively, the most semi-supervised clustering technique 82seed-constrained k-means [7] algorithm as this is e\u000ecient and takes advantage of the labelled data available. However, as discussed previously, clustering can be improved by applying metric learning [208]. As the ADR classi cation/clustering is required to be e\u000ecient, a suitable metric learning algorithm to apply to im- prove the clustering and ensure e\u000eciency is the one presented in [211]. The choice of semi-supervised classi cation or semi-supervised clustering will need to be determined. 2.2.3 Pattern Recognition Summary Statistical learning theory is a eld of research that aims to learn or identify intrinsic patterns within data. These patterns can then be applied to make future predictions, and in the medical context, they can be used to aid decision making such as what drug to prescribe to a patient. When there are a su\u000ecient number of labelled data, supervised learning can be applied whereby a general function is learned that accurately maps the input into the output. Numerous methods have been proposed that can produce a function that has a minimal training error but will also perform well on future data [39; 56; 81; 84; 101]. Ensemble methods have been presented that are able to combine multiple classi ers to reduce the variance and can improve the classi cation accuracy. Unfortunately, issues arise when using real life data. Such examples include the introduction of noise, di\u000eculties generating labels or the presence of missing data. Ongoing research aims to develop methods that can produce an accurate function when there are issues present. In the case of insu\u000ecient labels, semi-supervised techniques have been proposed that make use of unlabelled data [215]. However, there is no guarantee 83that semi-supervised algorithms will outperform their supervised counterpart [30]. Nonetheless, semi-supervised techniques have been successfully implemented on real life problems [108] and may be suitable for determining ADRs when there is a lack of known ADRs. 2.3 Literature Review Summary The rst section of the literature review focussed on the current techniques being applied by the pharmacovigilance community. The literature is full of techniques for signalling ADRs using LODs, but no method has been presented that was de- veloped speci cally for the THIN database and few studies have applied a range of methods on the THIN database. Therefore, there has been no extensive analy- sis of applying ADR signalling methods on the THIN database and a benchmark is unknown. The current research does highlight the inherent di\u000eculties in accu- rately determining current benchmarks for ADR signalling techniques, and this will need to be addressed in order to nd the THIN benchmark. The majority of existing methods for signalling ADRs using LODs rely on measures of association strength or temporality and do not cover the seven other Bradford-Hill causality considerations [19]. Furthermore, they do not take into consideration attributes speci c to the database being used, but database speci c attributes may o er a unique insight into causality. As a consequence, the existing ADR signalling methods tend to be a ected by confounding and this causes them to generate many false positives [156]. It may be possible to reduce the negative e ects of confounding by generating attributes for each drug-medical event pair based on the remaining seven Bradford-Hill causality considerations 84or by generating attributes speci c to the database. The justi cation is that the Bradford-Hill causality considerations help distinguish between association and causation, something that is currently lacking within the existing methods. This may then result in a low false positive rate. The existing ADR signalling techniques developed for LODs are unsuper- vised, as they do not learn from drug-medical event pairs that are known ADRs or non-ADRs. The reasoning being that it is di\u000ecult to obtain a large number of drug-medical event pairs with de nitive ADR or non-ADR labels. However, if a su\u000ecient number of ADR and non-ADR pairs were determined, then supervised or semi-supervised techniques could be applied, using suitable attributes, to iden- tify new ADRs. The semi-supervised techniques may be advantageous when the number of labelled drug-medical event pairs are limited, for example in the case when a drug is rarely prescribed, then its ADRs may be generally unknown and the number of labelled data will be small. A supervised or semi-supervised technique that uses attributes based on the Bradford-Hill causality considerations or speci c to the THIN database may be able to reduce the negative e ects of confounding by identifying and utilising patterns linked to ADRs or non-ADRs. The random forest ensemble algorithm is a suitable classi er to apply when there is a su\u000ecient number of labelled data due to its ability to handle heterogeneous data and its resilience to noise. When the number of labelled data is low, a self-training algorithm or a semi-supervised clustering algorithm may yield improved results. If such an algorithm signalled ADRs with a low false positive rate, then a larger number of drug-medical event pairs likely to correspond to ADRs could be evaluated extensively by rigorous epidemiological studies, and this is likely to result in new ADRs being discovered 85e\u000eciently. In addition, the supervised/semi-supervised technique that considers more than just the association strength and temporality factors of the Bradford- Hill causality considerations (and may reduce the e ects of confounding) is likely to outperform the existing ADR signalling methods on the THIN database and on the OMOP standard reference. 86Chapter 3 Existing Methods Comparison `One result from the DOI-HOI experiment was a number of reproducibly high false positive rates across methods and data sources.' Dubey et al. [48] 3.1 Introduction So far in this thesis, the research hypotheses and aims have been de ned and the current research within the eld has been summarised. Numerous ADR signalling methods, speci c for LODs, have been proposed, but few have been applied directly on the THIN database. As there has been no extensive application of existing methods applied on the THIN data, the general benchmark is unknown. As the aim of this research is to developed a suitable ADR signalling algorithm speci cally for the THIN data, it is necessary to determine the current benchmark (i.e., the suitability of the existing methods on the THIN database). 873. Existing Methods Comparison In this chapter, the motivation for choosing two di erent types of comparison is given and followed by a description of the existing method implementations. The methodology used to determine the `true' labels for each drug-medical event pair is proposed, as the signals generated by each method will be compared with the `truth'. The various measures used to analyse each method's signalling ability are then presented and the comparisons are conducted. The chapter ends with a summary of the key results of both comparisons and the ADR signalling benchmark values for the THIN data are presented. 3.2 Motivation ADRs are a consequence of multiple factors, for example, an ADR may only occur when the patient is a certain age and gender, eats a speci c diet or has certain ongoing illnesses [94]. As a consequence, ADRs are di\u000ecult to identify and it is common for many ADRs to be unknown [147]. This means there is no extensive gold standard, as there is no complete list of de nitive ADRs for any drug, and this makes it di\u000ecult to accurately benchmark ADR signalling algorithms. Motivated by the lack of gold standard, in [179], the authors developed a list of drug-medical event pairs known to represent ADRs or non-ADRs, but, although the list it expanding over time [70], it initially only considered four medical events. Further research has focused on producing a larger reference standard [33] containing drug-medical event pairs with de nitive labels, but the number of drug-medical pairs is still often less than a hundred. In previous studies, on non-THIN data, the authors have used the HOI-DOI reference standard containing 53 drug-medical event pairs with de nitive labels, 883. Existing Methods Comparison and applied the existing methods to these pairs to determine how they compare and set an approximate benchmark [156]. In [156] the TPD and ROR 05signalled 16 drug-medical event pairs out a possible 53, with 6 and 4 known ADRs being signalled respectively. The benchmarks, over a range of electronic healthcare databases, for the TPD were an AUC of 0.73 and AP of 0.41 and for ROR 05 an AUC of 0.68 and an AP of 0.2. The study also concluded that the existing methods obtain a similar performance and the existing methods have a high false positive rate, this was also evident in [162]. In the later study, the benchmark AUC obtained was 0.83. A previous study determined the benchmark for the signalling ability of exist- ing methods on the THIN database using the HOI-DOI reference standard [214]. The paper applied three existing methods, including the PRR and USCCS, to the THIN database mapped into the common data model and the raw THIN database. The results of the study, on the HOI-DOI reference standard, showed that the PRR and USCCS returned sensitivity values of 0 :67 and 78 respectively and speci city values of 0 :68 and 59 respectively on the mapped THIN database. Similar values were obtained by applying the PRR on the raw THIN data. Un- fortunately, as the HOI-DOI reference standard restricts the analysis to a small subset of drug-medical event pairs, the impact of false positives is likely to be reduced (as there are less pairs to generate false positive on). This comparison may also add bias due to the choice of HOIs and DOIs included in the analysis. For example, the known ADRs included in the HOI-DOI reference standard have generally been signalled by numerous sources and may be easier to signal. Unfor- tunately, there has been no analysis of existing methods on the THIN database that includes a larger set of drug-medical event pairs, but this may be a more 893. Existing Methods Comparison realistic analysis. To enable an extensive analysis of the signalling ability of the existing meth- ods on the THIN database, additional comparisons with di erent perspectives and bias are required. The rst perspective, referred to as the general compari- son, generates signals using the existing methods for all the drug-medical event pairs satisfying the condition that the medical event occurs for at least one patient during the month after the drug. The true label for each drug-medical event pair is determined using current knowledge of ADRs, where only drug-medical event pairs currently known to be ADRs are considered true ADRs. Unfortunately, the known ADR status of each drug-medical event pair is not de nitive, as some ADRs may be unknown, so this introduces error into the general comparison. The second perspective, referred to as the speci c comparison, is similar to compar- isons previously conducted [156], as it only analyses drug-medical event pairs that are either de nitively non-ADRs or listed on drug packages as ADRs. However, the speci c comparison considers a larger number of drug-medical event pairs than the HOI-DOI reference standard, so there may be less bias. The speci c comparison is less a ected by a lack of ADR knowledge than the general com- parison, but may have errors due to drug package listed ADRs being potentially incorrect, due to the di\u000eculty in determining causality. In summary, as there is no gold standard, numerous comparisons need to be conducted to determine an extensive benchmark for the existing methods sig- nalling ability on the THIN database. The HOI-DOI reference standard bench- mark has been determined but this benchmark is limited due to potential bias caused by non-randomly selecting drug-medical event pairs. The general com- parison will evaluate the methods without the selection bias, but will introduce 903. Existing Methods Comparison bias due to a lack of ADR knowledge. Finally, the speci c comparison is a trade o between the previous comparisons and potentially contains bias from both non-random selection and a lack of ADR knowledge, but both types of bias are relatively reduced. 3.3 Existing Methods To enable a fair comparison the TPD, MUTARA, HUNT and modi ed ROR methods, described in Chapter 2.1.4.2 were applied to investigate the one to thirty day period after the drug is prescribed (i.e., the month after). If each method used a di erent time period, the comparison would be biased. 3.3.1 TPD In this study the TPD was implemented as described in [128], with IC value over the time period corresponding to the 30 days after the rst prescription in 13 months ( u= [0;30]) contrasted with the IC value over the time period corresponding to the 27 to 21 months prior to prescription ( v= [\u0000822;\u0000639]), but two di erent lters were investigated: TPD is applied and medical events with an ICvalue the month prior to prescription or an ICvalue on the prescription day greater than the IC value during the month after the prescription are ltered (TPD 1). \u000fThe TPD is applied and medical events with an ICvalue the month prior to prescription greater than the ICvalue during the month after the pre- scription are ltered (TPD 2). 913. Existing Methods Comparison The justi cation for choosing two lters is due to the possibility that ADRs can occur and be reported to doctors on the same day as the prescription, so ltering events with an ICvalue on the day of prescription greater than the ICvalue during the month after the prescription may prevent detection of some ADRs. 3.3.2 MUTARA & HUNT Two di erent lengths for the reference period were investigated as the length of the reference period determines the per patient lter stringency and the op- timal stringency is unknown for the THIN database. The reference period for MUTARA 60and HUNT 60is set to be the time period starting from two months prior to the prescription and ending the day before the prescription. The reference period for MUTARA 180and HUNT 180is set to be the time period starting from six months prior to the prescription and ending the day before the prescription. The reference periods are chosen to end the day before the prescribed as this gave better preliminary results. The other parameter values used are: T c= Te= 30, as this corresponds to the time period of a month after the drug prescription. 3.3.3 ROR The `Spontaneous reporting system' style transformation [216] is applied, where SRS style reports consisting of a patient, drug prescription and possible ADR are inferred from the LOD by discovering all the medical events that occur within 30 days of a drug prescription. Signals are only generated for medical events that have been reported with the drug of interest a minimum of 3 times. 923. Existing Methods Comparison 3.4 Determining Labels 3.4.1 ADR Labels The drug-medical event pair ( ; ), consisting of a drug and a medical event , that correspond to an ADR were found using the online medical website Net- Doctor [176] or using SIDER [98], a side e ect resource containing side e ects mined from drug packaging. 3.4.1.1 Online The online medical website, NetDoctor, lists known ADRs for the majority of drugs available. The ADR strings for a general drug were mined from the website. A string match was then applied to nd the corresponding READ codes ( e.g, SELECT READcode FROM Drugcodes WHERE description like '%ADR string%'), and each of the READ codes ( is) that matched the NetDoctor listed ADRs were paired to the drug and added to the set ^A, ^A=f( ; )j is listed as an ADR to on NetDoctorg 3.4.1.2 SIDER The SIDER side e ect resource contains information on drugs' ADRs and indi- cations that were obtained by applying text mining to drug packaging. In total, the resource contains 996 drugs, 4192 ADRs and 99423 drug-medical event pairs corresponding to ADRs. The drug-medical event pairs, ( ; ), corresponding to 933. Existing Methods Comparison ADRs were extracted from SIDER to generate the set A, A=f( ; )j is listed as an ADR to in SIDERg 3.4.2 Noise Labels The noise labels were manually extracted by examining the THIN READ code tree. READ codes corresponding to irrelevant events such as `Family history', `Nationality', `Job type', `Chronic illnesses' (as this research focusing on acute immediately occurring ADRs) or `administrative events' were extracted and paired with all the drugs in the THIN database to generate the set N, N=f( ; )j is irrelevant ; 2THINg 3.5 Measures For each drug, , and medical event, , the existing algorithms determine a measure of association between and . The TPD uses the IC\u000105( ; ), MU- TARA uses unexlev ( ; ), HUNT uses the rank ratio, rank in descending order of lev( ; ) divided by rank in descending order of unexlev ( ; ), and the modi ed SRS used the ROR 05( ; ) (reporting odds ratio lower 95% con dence interval). This measure of association is referred to as the rank score in the remained of this chapter. 943. Existing Methods Comparison Table 3.1: The signalling criteria of the existing methods Method Rank Score Signal Criteria TPD IC\u000105 IC\u000105>0 MUTARA unexlev unexlev> SRS ROR 05 ROR 05>1 Table 3.2: A worked example of comparing the existing methods signals and the known truth. Known Truth ADR Non-ADR SignalledYesTrue Positive False Positive (TP) = 10 ( FP) = 200 NoFalse Negative True Negative (FN) = 12 ( TN) = 500 3.5.1 Natural Thresholds The existing methods generate signals at their natural threshold, indicated in Table 3.1. The methods performances at their natural thresholds are generally uninformative as the natural threshold is an arbitrary cut o . However, in this thesis I will present the methods performances at their natural thresholds to en- able comparison with existing work that has used these thresholds. To determine the method's ability to signal ADRs, the signals at the natural threshold are com- pared with the known truth. If a signalled drug-medical event pair is a true ADR then it's a True Positive, else it's a False Positive, conversely, if a non-signalled drug-medical event pair is a true ADR then it's a False Negative, else it's a True Negative, as summarised in Table 3.2. The measures of interest for the natural threshold can then be calculated as; Sensitivity = TP=(TP+FN) (3.1) 953. Existing Methods Comparison Table 3.3: An example of the medical event list associated to a speci c drug and ordered by an existing method' rank score. Medical Event Rank Score Known ADR y(i) Event 1 2.34 No y(1)= 0 Event 5 2.12 Yes y(2)= 1P(2) = 1=2 Event 4 1.75 Yes y(3)= 1P(3) = 2=3 Event 2 1.74 No y(4)= 0 Event 3 0.68 No y(5)= 0 Speci city = TN=(TN+FP) (3.2) So, using the example in Table 3.2, the Sensitivity is 10 =(10 + 12) and the speci- city is 500 =(500 + 200). 3.5.2 Ranking Ability To determine the general ranking ability, each existing method is applied and returns a ranked list of the drug-medical event pairs being investigated in de- scending order of the rank score. Table 3.3 shows an example of the output of a method when considering the ranking of the medical events paired to the same drug. The function yi, known as the truth, is 1 if the ithranked medical event is a known ADR and 0 otherwise. The precision of each method at cuto K, denotedP(K), is de ned as the fraction of known ADRs that occur in the top Kevents of the list returned by each method for a speci c drug, see Eq. (3.3). P(K) =PK i=1y(i) K(3.3) 963. Existing Methods Comparison Table 3.4: An example of the medical event list for all the drugs and ordered by one of the algorithms. Drug Medical Event Rank Score Known ADR y(i) Drug 10 Event 7 2.34 No y(1)= 0 Drug 10 Event 5 2.12 Yes y(2)= 1 Drug 2 Event 56 1.75 Yes y(3)= 1 Drug 9 Event 7 1.74 No y(4)= 0 Drug 2 Event 16 0.68 No y(5)= 0 The average precision (AP) is a measure that can be used to determine how well a method generally ranks the medical events associated to a drug. This measure has previously been applied to compare methods implemented on the common data model [156]. The AP is calculated by nding the average P(K) for eachK corresponding to a known ADR, AP =P K:y(K)=1P(K) P iy(i)(3.4) Using Table 3.3 as an example, as there are two known ADRs returned (P iy(i)= 2) and the known ADRs in the table are ranked second and third we have fK: y(K)= 1g=f2;3g, so the AP 2=1=2 + 2=3 2=7 12(3.5) To give a general measure of the ranking ability of each algorithm over all the drugs investigated, the receiver operating characteristic (ROC) curves are computed. The ROC plots were generated by combining all the results for each method, as illustrated in Table 3.4. The ROC curves are formed by plotting the sensitivity against (1\u0000specificity ). The Area Under the Curve (AUC) [28], was 973. Existing Methods Comparison approximated using the trapezoidal rule for a range of specificity values (AUC [a;b] corresponds to the partial AUC [193] when only considering the specificity within the interval [ a;b]). To compare the AUCs of various methods DeLongs test at a 5% signi ance level is implemented [44]. 3.6 General Comparison 3.6.1 Method For the general comparison the method was as follows. Step 1: Find the set of drug-medical event pairs such that the medical event is recorded within a [1 ;30] day time period after the drug for any patient. G=f( ; )j occurs within the [1 ;30] day time interval centred around the day of the prescription of drug for any patientg. Step 2: Determine the ground truth for each drug-medical event pair (( ; )2 G), Truth( ; >>< >>:ADR; if ( ; )2 For each drug-medical event pair (( ; )2G), calculate the method's rank score. Step 4:\u000fNatural threshold- Determine signals using rank score and signal criteria. If ( ; ) is signalled and Truth( ; ) is ADR then this is a TP, otherwise it is a FP. Conversely, if ( ; ) is not signalled and Truth( ; ) is ADR then this is a FN, otherwise it is a TN. 983. Existing Methods Comparison Table 3.5: The speci city and sensitivity at the natural thresholds for the di erent algorithms (3dp). Algorithm Signals Sens Spec Precision Plot the ROC curves and calculate the AUCs using the rank scores and Truth for each drug-medical event pair. The AP is also calculated on the list of medical events for each drug that are ordered in descending order of the assigned rank score, see Table 3.3. The existing methods were applied to 27 drugs for 6 drug families, for information about the drugs investigated, see Appendix B. 3.6.2 Results Table 3.5 shows the specificity andsensitivity for the di erent methods at their natural thresholds and the number of signals generated. As HUNT does not have a natural threshold, the top 10% of medical events were considered to be signalled. The AUC [0;1]ranged between 0.005 (ROR 05) to 0.011 (HUNT 180and HUNT 60), as presented in Table 3.6. Figures 3.1a and 3.1b show the ROC plots for the di erent methods. Figure 3.2a shows the AP scores for the di erent methods over the range 993. Existing Methods Comparison (a) Whole speci city range (b) Section of speci city greater than 0.7 Figure 3.1: The ROC plots for the di erent methods. The black line is the line x=y. 1003. Existing Methods Comparison Table 3.6: The AUC of drugs investigated. The family of drugs that the methods perform worse on overall were the sulphonylureas with AP scores ranging from 0 :0088\u00000:0687. The algorithms all performed well on the calcium channel blockers, with AP scores ranging from 0 :0236\u00000:1988, but the ROR 05performed worse for all the calcium channel blockers investigated. The methods also performed well for the tricyclic antidepressants with AP scores ranging between 0 :0499\u00000:1670. It can be seen in Figure 3.2a that generally the methods perform similarly between the same drugs of the same class, apart from the methods performing much better for benzylpenicillin sodium compared to the other penicillin drugs. The box plots of the AP scores for the di erent methods seen in Figure 3.2b show overall the TPDs, MUTARAs and HUNTs perform equally and outperform the ROR 05. The MUTARA algorithm has the highest median AP score over all the drugs and is more consistent, whereas the performance of the TPD and HUNT varies more between the drugs. 3.6.3 Discussion The results show that the methods' natural thresholds operate at di erent strin- gencies. The most stringent method was the TPD 1 that returned 1893 signals, 1013. Existing Methods Comparison (a) Bar chart of the AP scores for each drugs. (b) Box plot showing the median, quartiles and minimum/maximum AP scores. Figure 3.2: AP results for each method applied for each drugs. 1023. Existing Methods Comparison the lowest out of all the methods, with a high speci city of 0.953 and low sensi- tivity of 0.09, whereas the less stringent was the MUTARA 60that returned 67624 signals with a high sensitivity of 0.933 and a low speci city of 0.109. This was not unexpected as the TPD threshold used the lower con dence interval value rather than the actual IC\u0001value and the TPD applied a statistical shrinkage. The results also show that none of the methods was able to signal the known ADRs without being swamped by false positives signals. The AUC results show that the methods perform similarly and no method had a higher partial AUC for all three restricted speci city intervals studied (AUC [0;1],AUC [0:7;1]and AUC [0:9;1]). Overall no method consistently outperformed the others over all the drugs investigated in this study, however, either the TPD 1 or HUNT had the highest AP score for the majority of the drugs studied. The ROR 05generally performed the worse, but still had a higher AP score than the other methods for the drug phenoxymethylpenicillin. The results obtained in this study were consistent with previous results as theP(10) for MUTARA and HUNT averaged 0 :065 and 0:122 respectively in this study and were 0 :1 and 0:1\u00000:3 respectively in previous work [91][90]. The P(10) for the TPD method applied to Nifedipine in this study was 0 :7, the same as on the UK IMS Disease Analyzer database [128]. However, there was deviation between the AP score of the ROR 05in this study (0 :01\u00000:06) and in the study by Zorych et al. [216] (0.1-0.15), this is probably due to this study using real data with redundant READ codes and Zorych et al. using simulated data. The general comparison also demonstrated that the existing methods generate a large number of false positive signals. The main limitation of this comparative study was the assumption that if 1033. Existing Methods Comparison a drug pair ( ; ) is not in the set of known ADRs, A1, then it is a non- ADR. This is not true, as some pairs may be unknown ADRs, as there is no de nitive complete list of ADRs for any drug. The consequence of this is that the truesensitivity ,specificity and AP scores may be di erent to that the values obtained. However, the methods should be able to correctly rank the known ADRs and these are likely to be more common and obvious than the unknown ones. Therefore, if the method is unable to correctly rank the known ADRs above other events (and obtain a low AP in this study) then it is unlikely to identify the unknown ADRs, so the AP scores determined in this study still give insight into the methods abilities to detect ADRs. Another limitation was the READ code redundancy. The negative e ect of noise may get ampli ed due to the redundancy causing there to be a larger number of noise READ codes. It may be the case that the methods would have higher AP scores if there was a way to group READ codes corresponding to the same medical event. 3.7 Speci c Comparison 3.7.1 Method Due to similar results being obtained in the general comparison by the MU- TARA and HUNT methods implemented with di erent reference periods, only the MUTARA 180and HUNT 180were applied for the speci c comparison. The method for the speci c comparison is as follows. Step 1: Find the de nitive non-ADRs drug-medical event pairs corresponding to the drug of interest or the drug-medical event pairs listed as ADRs on 1043. Existing Methods Comparison 's drug packaging, G=f(^ ; )2 NS Aj^ = g. Step 2: De ne the truth for each drug-medical event in G, Truth( ; ) =8 >>< >>:ADR; ( ; )2 A ; )2 N(3.7) Step 3: For each drug-medical event pair (( ; )2G), calculate the method's rank score. Step 4:\u000fNatural threshold- Determine signals using rank score and signal criteria. If ( ; ) is signalled and Truth( ; ) is ADR then this is a TP, otherwise it is a FP. Conversely, if ( ; ) is not signalled and Truth( ; ) is ADR then this is a FN, otherwise it is a TN. \u000fGeneral Ranking - Plot the ROC curves and calculate the AUCs using the rank scores and Truth for each drug-medical event pair. The AP is also calculated on the list of medical events for each drug that are ordered in descending order of the rank score assigned by the existing method. The existing methods were applied for ve drugs, Nifedipine, Cipro oxacin, Ibupro- fen, Budesonide and Naproxen, Results and Discussion For the speci c comparison, MUTARA performed better at general ranking than the other methods, with greater AUC, AUC [0:9;1]and AP values, see Table 3.7. This result contradicts the general comparison results, that showed none of the 1053. Existing Methods Comparison SpecificitySensitivity 0.0 0.5 1.0 1.00.80.60.40.20.0 SpecificitySensitivity 0.00.20.40.60.81.0 1.00.8 Figure 3.3: The ROC plots for the speci c comparison. The gure on the left is the whole speci city range, the gure on the right is for the speci city within the interval [0 :9;1]. The orange, red, yellow, green and blue curves correspond to MUTARA 180, HUNT 180, TPD 1, TPD 2and the ROR 05respectively. 1063. Existing Methods Comparison Table 3.7: The ranking ability of the existing methods obtained in the speci c comparison. 3.8: The signals returned by the existing methods at their natural thresh- olds. The natural threshold used for HUNT was the rank ratio greater than 1. Method TP FP FN TN Sensitivity 0.111 existing methods outperforms any other when considering the overall ranking. However, the TPD was the method that returned the least number of false pos- itives and obtained the greatest precision, 0 :122. In agreement to previously obtained results, the speci c comparison showed that the existing methods signal many false positives at their natural thresholds, see Table 3.8. To identify why the TPD's ranking performance decreased relative to MU- TARA for the speci c comparison, the ranked list of drug-medical events pairs returned by the TPD was manually investigated. Interestingly, the manual inves- tigation showed that the READ code redundancy was to blame, as the TPD did not assign a consistent IC\u000105for READ codes corresponding to the same medical event, and the READ codes matching the SIDER ADR strings tended to have lowerIC\u000105values than other READ codes corresponding to known ADRs but 1073. Existing Methods Comparison not exactly matching the SIDER ADR string (e.g. If a SIDER ADR string was `vomiting' , then the THIN READ code with a description `vomiting' would be labelled as an ADR, but `O:E vomiting' or `[D] vomiting' would not be labelled). However, this does highlight that the TPD is not consistent and, although its performance may improve if di erent labels were used, it still struggles to assign a highIC\u000105to all READ codes corresponding to known ADR medical events . Previous studies have also identi ed inconsistency with the TPD [80]. The speci c comparison appears to be a better way to compare the methods as the results are not limited by unknown ADRs. The potential bias introduced by only considering a subset of drug-medical event pairs has the advantage of highlighting methods that are not consistent. It can be argued that a perfect method would assign a similar rank score to READ codes corresponding to the same medical event, so methods unable to do this may be awed. 3.8 Summary In this chapter, four existing LOD ADR signalling methods were compared by applying them to the THIN database for a range of drugs. The comparisons mea- sured how well they ranked the known ADRs or signalled known ADRs at their natural thresholds. As there is no golden standard, two di erent comparisons were applied. The rst comparison compared the methods on a wide range of drug-medical event pairs but introduced bias by assuming there are no unknown ADRs, whereas the second comparison removed the bias of assuming there are no unknown ADRs but incorporated bias by only investigating a selection of drug- medical events pairs and by assuming drug packaging listed ADRs are correct. 1083. Existing Methods Comparison The results highlight the issue of comparing existing methods without a golden standard. If a golden standard existed (i.e., for one drug all the ADRs were known), the methods could be applied to all the drug-medical event pairs for the speci c drug and accurate measures could be obtained. However, when there is no gold standard, then bias is introduced and the results obtained may not be a true re ection of the methods abilities. Nonetheless, considering the results of both comparisons and previous studies, the limitations of the existing methods were determined. The general comparison showed that no method was superior over all the drugs considered, however the speci c comparison indicated that MUTATA is more consistently than the TPD. The main conclusion is that, for both comparisons, the existing methods failed to signal known ADRs without signalling a super uous quantity of non-ADRs, resulting in a low precision benchmark of 0 :122 for the speci c comparison and 0:058 for the general comparison. The general ranking benchmarks for the general comparison are an AP of 0 :2, an AUC of 0 benchmarks the speci c comparison are an AP of 0:315, an AUC of 0 :770 and an AUC [0:9;1]of 0:032. Future methods should aim for higher scores. 109Chapter 4 Incorporating Causation `The application of Austin Bradford-Hill's criteria for evaluation causal associations in pharmacovigilance and pharmacoepidermiology is very useful.' Saad A.W. Shakir [163] 4.1 Introduction So far in this thesis, the current research focus was summarised and the existing pharmacovigilance methodologies were presented. In the previous chapter the benchmark measures were determined by applying the current ADR signalling methods on the THIN database and it was concluded that they have a high false positive rate. In this chapter the processes implemented to generate and transform the data extracted from the THIN database are described. The main focus is the proposal of suitable attributes that o er insight into causality. The aim is to use these attributes as inputs into a learning algorithm that will be 1104. Incorporating Causation trained to signal ADRs with a low false positive rate. 4.2 Motivation The main limitation of ADR signal detecting using LODs is the abundance of confounding factors [68] [174]. The majority of medical events that occur after a drug are related to pre-existing illnesses, but these are still strongly associated to the drug. The existing methods can be considered unsupervised methods that aim to approximate the measure of causation between a drug-medical event pair. This is done by comparing the risk of the medical event after the drug compared with a substitute, such as the risk in a control population [91] or the risk when considering every other prescription [128]. Unfortunately, this only measures association as the choice of substitute introduces confounding [117], for example, as argued in [114], the choice of drug treatment may be in uenced by the patient's medical history and the doctors preferences. To reduce the number of signals corresponding to medical events that are related to the drug cause, some authors have developed lters, such as ignoring medical events that occur more often before the drug than after [128; 161]. The consistently high false positive rate that occurs when the methods are applied to LODs suggests that these lters are still unable to removed all the e ects of confounding and this hinders the e ectiveness of the existing methods. The signals they generate require further analysis [148] and rare ADRs may not be signalled [143]. To develop an improved ADR signalling algorithm, it is important to iden- tify a way to distinguish between association and causation in observational data. Such an algorithm would have a reduced false positive rate as it would be resilient 1114. Incorporating Causation against confounding e ects. Causality is often determined using a randomised controlled experiment [154], where treatments and controls are randomly assigned to control confounding [153]. This cannot be implemented using observational data, as there is no control over who is assigned a treatment. In [67], the authors highlight the issues associated with using observational data for causal inference. A common technique to identify causality using observational data is to apply a supervised algorithm with additional knowledge that incorporates confounding factors, such as tting a regression model that incorporates parameters based on confounding [58]. In [132] and [42] the authors manually investigated causal- ity between a single drug and a single medical event by investigating suitable measures of the Bradford-Hill causality considerations that can be derived from pharmacovigilance data. The Bradford-Hill causality considerations are often used when determining causation [164] and researchers have discussed the im- portance of applying these considerations within pharmacovigilance [52]. In this thesis, the idea is expanded by removing the requirement of a manual inspection. Instead, an algorithm is implemented that learns to determine causality between each drug-medical event pair based on Bradford-Hill causality derived attributes, as this will increase e\u000eciency and enable a wider search. The novel idea is to train a supervised algorithm using attributes based on latent variables (not di- rectly observed), derived from the Bradford-Hill causality considerations, rather than observable variables. In this chapter, the attributes that add insight on causality, derived from a selection of the Bradford-Hill causality considerations, are proposed and explored. 1124. Incorporating Causation 4.2.1 Data Cleansing The THIN database contains validation elds indicating the integrity of each record. Only records that are valid are extracted from the database and records corresponding to patients with a missing date of birth or gender are deleted. Any records containing an invalid age such as a negative number or greater than one hundred and twenty years are also removed. Patients whom are newly registered present a problem in the THIN database as they often come to the practice with a magnitude of historical and existing conditions that get recorded during their rst few visits even when the condi- tions initially occurred years previously. This is often referred to as `registration event dropping'. Studies have shown that the probability of `registration event dropping' is signi cantly reduced after a patient has been registered at the same practice for a year [104]. To prevent this biasing the results the medical records that were recorded within the rst year of each patient being registered are deleted from the THIN database. The last month of prescription records for patients are also ignored to prevent under-reporting, as implemented in [143]. 4.2.2 Data Extraction 4.2.2.1 Formulation Denoting the cleansed THIN data by = f P; Eg, where Pis the set of valid drug prescription reports and Eis the set of valid medical event reports contained in the THIN database. Throughout this thesis, the ithelement of the vector xis represented by xi. Each prescription record, !2 P\u001aR8, is a vector containing the details about the prescription, where !2R8and, 1134. Incorporating Causation !1: is the corresponding record's patient ID (who had the prescription). !2: is the corresponding record's prescribed drug. !3: is the corresponding record's gender (1 if male, 0 if female). !4: is the corresponding record's date of prescription (when the prescription was issued). !5: is the corresponding record's patient's age (time in days between the patients date of birth and when the prescription was issued). !6: is the corresponding record's dosage (dosage of the drug issued). !7: is the corresponding record's British National Formulary (BNF) code (a code specifying the general family of the drug). !8: is the corresponding record's noise value (the total number of drugs pre- scribed within the [ \u000030;30] day time interval centred around the prescrip- tion date). Each medical event record in the complete THIN database, 2 E\u001aR5, is a vector containing the medical event report details, where 2R5and, 1: is the corresponding record's patient ID (who had the medical event). 2: is the corresponding record's READ code (corresponding to medical event). 3: is the corresponding record's date of recording (when the medical event was reported). 4: is a binary value representing if a READ code with the same Level 3 READ code parent as the record has been recorded for the patient before. If it is the rst time the value is 1, otherwise it is 0. 5: is a binary value representing if a READ code with the same Level 4 READ code parent as the record has been recorded for the patient before. If it is the rst time the value is 1, otherwise it is 0. 1144. Incorporating Causation As it can be seen, each medical event is recorded via a READ code. The READ codes have a tree structure with ve levels of speci city, as described in Appendix A. Therefore, the term drug-medical event pair is analogous to the term drug- READ code pair. For clarity, the drug-medical event pair corresponding to drug and READ code is denoted by ( ; ). Unfortunately, the READ codes are redundant, and multiple READ codes can correspond to the same medical event but with slight variance in the description. For example, the READ code `91a..' may represent `had a chat with patent' and the READ code `91b..' may represent `discussion with patient at his request', both these READ codes correspond to the medical event of talking to the patient, but di er slightly. 4.2.2.2 Extraction For a given drug, , it is possible to extract prescription records of interest in three di erent ways. The rst method extracts all the records containing the drug (where!2was previously denoted as the drug prescribed in therapy record !), P :=f!2 Pj!2= g (4.1) In the latter part of this chapter the prescription records in the set P are used to nd a rough measure of association, by investigating the medical events that occur shortly before the drug compared with the medical events that occur shortly after a drug. As there is no restriction on how far apart the prescription records in the set P are for the same patient, some prescriptions, for the same patient, may be recorded in short succession. This may cause bias when investigating the medical events that occur shortly before one prescription, as they may be caused 1154. Incorporating Causation by the previous prescription. To reduce this bias a second method to extract reports containing drug is proposed. For two therapy records, !;\u0003!2 P , the records correspond to the same patient when both patient IDs are the same, !1=\u0003!1, and correspond to the same drug when !2=\u0003!2. The second method only extracts reports if the drug was not previously prescribed, to the same patient, within the previous 13 months, ^ P :=f!2 P jf\u0003!2 P n!j!1=\u0003!1;!2=\u0003!2;tm(\u0003!4;!4)2[0;13]g=;g Where the function tm(a;b) : Date\u0002Date!Zdenotes the time in months from dateato dateb. As di erent drugs from the same family are often prescribed, due to the rst drug not being e ective or the patient reacting badly, there can still be bias when using ^ P . To further reduce the bias, only prescription records where there has been no previous prescription of a similar drug within the previous 13 months are considered, P :=f!2 P jf\u0003!2 Pn!j!1=\u0003!1;!7=\u0003!7;tm(\u0003!4;!4)2[0;13]g=;g Figure 4.1 is a graphic representation of the di erent ltering that is imple- mented to extract the data, where a drug is considered ltered if it is surrounded by a red square. Each line represents the sequence of drug records ordered by time, where drug 1 and 2 are from the same drug family (have the same BNF code). The top line represents no ltering, so all drug records are included in the analysis, the middle line represents ltering a drug if the same drug was recorded 1164. Incorporating Causation Key i: un ltered drug i i : ltered drug i P: 13 months 19 months 28 months 124 months 2 ^ P: 1 1 2 1 2 P: 1 1 2 1 2 Figure 4.1: Illustration of ltering done during data extraction. within 13 months previously, and the bottom line represents ltering a drug if a drug in the same family was recorded within the 13 months previously. Using the prescription record subsets for the drug , it is possible to determine the `risk' drug-READ code pairs that correspond to potential acutely occurring ADRs by nding all the READ codes that occur within 30 days of any prescription of , see Equation 4.2. Figure 4.2 illustrates how the `risk' drug-READ code pairs corresponding to drug 1 are determined, where the medical events represented by circles are paired with drug 1 if they occur between the square representing drug 1 and the red line. A short time period is used as the focus of this research is on discovering ADRs that occur immediately after ingesting a drug. It was determined that investigating the 30 days after a drug is prescribed was the best trade o between having a su\u000eciently large period of time after the prescription to allow patients time to report the medical event while not having the time period too large that many erroneous medical events will be reported. RME =f 2j 2 E;9!2 P where!1= 1;td(!4; 3)2[1;30]g (4.2) 1174. Incorporating Causation Key A : READ code A i : drugi Pat 1: a1 130 130 f1 x6a6 2 130 x6 2 Pat 2: 4.2: Illustration of determining risk drug-medical event pairs. where the function td(a;b) : Date\u0002Date!Zrepresents the time in days from dateato dateb. One suitable approach to determine ADRs to drug using LODs is to combine medical event reports with prescription reports containing when the medical event report occurs within a set time frame around the prescription report. Let [u;v];P be a relationship between the prescription records of drug ( P ) and the medical event records ( E) de ned by the records having the same patient ID ( !1= 1) and the medical event report occurring within the set time period around the date of the prescription report ( (4.3) As illustrated in Equation (4.3), each element in the set [u;v];P contains the combined prescription reports containing and medical event reports of interest, where the medical event report occurred with the [ u;v] day interval around the 1184. Incorporating Causation prescription record. For each combined record, \u0014= (!; )2 [u;v];P , the rst eight elements correspond to the prescription record ( \u0014i=!i;i2[1;8]) and the last ve elements correspond to the medical event record ( \u0014i= i\u00008;i2[9;13]). Similarly, the set of combined reports of interest can be calculated when only considering the rst time prescriptions in 13 months of drug or the prescriptions of drug that have no similar drug prescribed within the previous 13 months by substituting the set P with the set ^ P or P respectively, ^ [u;v];P 3)2[u;v]g (4.5) The aim of this thesis is to develop a classi er such that, for each `risk' drug- READ code pair containing drug , ( , 2RME ), the pair is classi ed as either an ADR or non-ADR. To develop such a classi er requires generating suitable attributes for each pair and learning from pairs that are known ADRs and non- ADRs. In the next section the proposed attributes based on the Bradford-Hill causality considerations and THIN structures are derived. 4.2.3 Data Derivation After cleansing and extracting the data of interest, the data can now be trans- formed into suitable attributes. The set of combined reports containing READ code that occur within the [ u;v] time interval centred around the prescription 1194. Incorporating Causation Pat 1: a1 1uv 1uv f1 x6a6 4.3: Illustration of combining drug records and medical event records. of drug is, [u;v];P E =f\u00142 [u;v];P j\u001410= g (4.6) The equivalent sets when only considering the prescriptions of drug for the rst time in 13 months or prescriptions of drug when a similar family drug has not been prescribed within the last 13 months are, ^ [u;v];P E =f\u00142^ [u;v];P j\u001410= g (4.7) and [u;v];P E =f\u00142 [u;v];P j\u001410= g (4.8) respectively. This is graphically illustrated in Figure 4.3, where the medical event reports are represented by circles and the drugs are represented by squares. For each prescription of drug 1, the time interval [ u;v] centred around the prescription is investigated, and any medical event report occurring within the interval is combined with the report to produce a new combined report. 1204. Incorporating Causation Table 4.1: Contingency table calculations for the epidemiological association mea- sures. READ code not READ code Drug j [1;30];P E j j [1;30];P j\u0000j [1;30];P E [1;30];P E j 4.2.3.1 Association Strength `Prospective inquiries into smoking have shown that the death rate for cancer of the lung in cigarette smokers is nine to ten times the rate in non-smokers' - Bradford-Hill [19]. The association strength criterion concentrates on how associated the READ code and drug are [19]. Previously implemented measures of association derived from LODs are the IC \u0001used by the TPD algorithm [128], see Chapter 2.1.4.2, or the IC\u000105. These values measure the association between the READ code and drug during the `hazard' period that occurs after the prescription relative to some `non-hazard' time period. x 1=IC\u0001 (4.9) x 2=IC\u000105 (4.10) Alternative measures are the risk ratio (RR), odds ratio (OR) and risk dif- ferent (RD) that are frequently used in epidemiological studies to measure the association between an exposure and disease [194]. These measures contrast the rate of disease in a population that is exposed to some risk with the rate of the disease in a population not exposed. In [151] the author states that, if there are other (non-drug) su\u000ecient causes of a medical event, then the frequency of these 1214. Incorporating Causation has a greater impact on the medical event and drug's risk ratio measure than the risk di erence measure. So the measures can generate varying strengths of association for the same drug-READ code pair. The RD investigates the additive di erence between the risk of having the READ code after the drug of interest is prescribed compared to the risk of having the READ code after any other drug prescription [181]. Using Table 4.1 the RD can be calculated by, x 3= (j [1;30];P j)(4.11) The RR estimates the risk of having the READ code in the month after the drug of interest is prescribed divided by the risk of having the READ code in the month after any other drug, the measure has been incorporated to signal ADRs in SRS databases [9]: x j)(4.12) The OR calculates the ratio between the odds that a READ code occurs in the 1224. Incorporating Causation drug of interest group and the odds that a READ code occurs in any other drug group. There has been much debate into the usefulness of this measure, in [165] the authors state that the OR should not be used in place of the RR although in [194] they argue that the OR and RR are di erent measures and as long as the OR is not considered on the same scale as the RR then it is worthwhile: x 9= (j Temporality `Does a particular diet lead to disease or do the early stages of the disease lead to those peculiar dietetic habits?' - Bradford-Hill [19]. The temporality criteria concerns itself with the direction of the relationship between the READ code and drug. This is an important factor, and has been highlighted in other criteria for causation [86]. It measures if the READ code occurs after the drug, or the other way round. If the READ code and drug are associated but the READ code frequently occurs before the drug, then this may suggest the medical event corresponding to the READ code causes the drug and not the other way round. The rst values of interest are the after and before ratios (AB ratios). The 1234. Incorporating Causation AB ratios calculate how many prescriptions of have the READ code recorded between 1 and 30 days after the prescription divided by how many have the READ code recorded between 1 and 30 days before the prescription, this is a basic implementation of the self controlled cross-over method. x 12=j [1;30];P E j=j [\u000030;\u00001];P E j [\u000030;\u00001];P E j(4.14) Other suitable attributes for the temporality criterion are the lters that have been implemented by existing LOD ADR signalling algorithms, where x 15and x 16correspond, respectively, to the TPD Filter 1 and the TDP Filter 2 , the modi ed versions of the TPD lter applied initially in [128] and adapted in [143]. The nal attribute, x 17, is the output of the LEOPARD algorithm described in [161]. 4.2.3.3 Speci city `If the association is limited to speci c workers and to particular sites and types of disease and there is no association between the work and other modes of dying, then clearly that is a strong argument in favour of causation' - Bradford-Hill [19]. The third Bradford-Hill consideration is how speci c an association is. In gen- eral, speci city is interpreted as the drug only causes a single, speci c, ADR [67]. Consequently, many researchers, including [151] and [67], argue this is not very informative, as many drugs cause multiple ADRs . Other researchers have 1244. Incorporating Causation suggested modifying the interpretation of the speci city criteria [197]. Weiss ar- gues that an association is speci c when both the outcome and the exposure are speci c or when only speci c people that are exposed have the outcome. This prompts the novel speci city attributes proposed in this thesis. The rst considers how speci c the READ code is, justi cation for this is that general outcomes are likely to occur by chance as they probably have a high background rate, but if a speci c READ code occurs frequently after the drug of interest is prescribed then this may give reason to suspect it as an ADR. The rst speci city attribute uses the READ code hierarchal level, x 18=i, where corresponds to a level iREAD code (4.15) If the drug and READ code association is only found in a certain subpopulation then this may also be suggestive of an ADRs. Therefore attributes are developed based on the age and gender of the patients experiencing the READ code after the drug compared to all the patients who are prescribed the drug. A suitable method to measure if a speci c age group experience after is to compare the average age of the patients who experience within 1 to 30 days after with the 1254. Incorporating Causation average age of the patients prescribed . x by a similar argument, it is also useful to calculate a measure to compare the ratio of patients that experience within 1 and 30 days of that are male relative to the ratio of patients who are prescribed and are male. x 22= (X `The fact that the death rate from cancer of the lung rises linearly with the number of cigarettes smoked daily, adds a very great deal to the simple evidence that cigarette smokers have a higher death rate than non-smokers.' - Bradford-Hill [19]. The biological gradient criterion in the context of ADR detection considers the 1264. Incorporating Causation dosage of the drug. Often, but not always the case, an ADR is more likely to occur when the drug is ingested at a high dosage compared to a low dosage [36]. In [192] the authors used the Pearson's correlation and logistical regression to measure the biological gradient. However, in [142], it was shown that the Pearson's correlation was di\u000ecult to calculate using data from the THIN database. Therefore di erent measures are required. The proposed novel biological attribute, calculated below, contrasts the aver- age drug dosage for the patients that experience within 1 to 30 days of with the average drug dosage for all the patients prescribed , x 25= `Because of an observed association some preventative action is taken, Does it in fact prevent?' - Bradford-Hill [19]. The nal Bradford-Hill causality consideration investigated is experimentation. There is deviation between the meaning behind experimentation, some authors assume it relates to intervention (i.e. if the drug stops does the medical event, if the drug restarts does the medical event follow?) [175], whereas others believe it corresponds literally to experiments that have been conduced and their results [64]. In this thesis we adopt the intervention interpretation and apply a retrospec- tive investigation to nd instances where a patient stopped taking the drug for a while and then restarted, and refer to this as a retrospective intervention. Unfor- 1274. Incorporating Causation tunately, few patients experience retrospective interventions and this limits the experimentation attribute's usefulness. If a patient has two or more independent prescriptions of the drug, it can be observed whether the medical event often occurs shortly after the prescriptions but never shortly before. If this is the case, then this is a very strong implication that the medical event is an ADR. Equation 4.19 shows the calculation for the proposed novel attributes based on the Bradford-Hill experimentation causality consideration. It is determined by nding the number of patients that have READ code within 1 to 30 days of two or more independent prescriptions of but never within 1 to 30 days before any prescriptions of divided by the number of patients that have two or more independent prescriptions consistency, plausibility and coherence require additional resources for their calculation and are not tackled in this thesis. The analogy factor is indirectly incorporated by using a supervised algorithm, as attributes similarities for the drug-READ code pairs corresponding to known ADRs are learned and used to infer new ADRs. 4.2.3.7 THIN Speci c The attributes speci c to the THIN database make use of the READ code struc- ture and additional information available that might help distinguish between an 1284. Incorporating Causation ADR and non-ADR. The rst attribute gives a measure of how much noise there is present for the READ code and drug as it is harder to classify drug-READ code pairs with a large measure of noise as the attribute values are likely to be misleading. To determine the level of noise, the average number of prescriptions that occur within the two month interval centred around the prescription of is calculated for all patients and compared with the average number of prescriptions that occur within the two month time interval centred around the prescription of drug for the patients that also experienced READ code within 1 to 30 days. x 27= (X (4.20) The next attribute investigates whether, for each READ code that occurs within 1 and 30 days of a prescription of , the patient has previously experienced (or its level 3 parent). If many patients have previously experienced a more general version of but not itself, then this is a sign that is not an ADR to drug . The reason is that is likely to have occurred due to an illness progression rather than it being caused by the drug. This prompts, x 28= THIN speci c attributes use the READ code structure to help distin- guish between associations that are causal and associations that are due to illness progressions. These attributes calculate the AB ratio when only considering the more general versions of all the READ codes. Therefore, if the association has occurred due to the illness progression, the AB ratio for the more general versions 1294. Incorporating Causation of the READ codes should be small, even if the AB ratio for the actual READ code is large. Letting \b 3denote the set of READ codes that have the same level 3 parent as , then the AB ratio is calculated on the transformed data, x 29=j[ 4denotes the set of READ codes that have the same level 4 parent as and the AB ratio is calculated, x 30=j[ A Note on Dependency Many of the attributes derived from the same Bradford-Hill causality consid- erations may have some statistical dependency but also give slightly di erent perspectives. The statistical dependency is unlikely to have any negative conse- quences on the future classi ers as either feature selection is applied to remove any redundancy or the methods are una ected by statistical dependency. The random forest is a decision tree based classi er; decision trees partition the at- tribute space based on measures such as entropy. At each iteration the decision tree will simply pick the partitioning of an attribute space based on how well it separates the classes, dependency of two attributes will not have any negative e ect on this process. For the other classi er used throughout this research, fea- ture selection will be performed prior to training. Feature selection will choose a 1304. Incorporating Causation subset of attributes to be used by the classi er that maximises its performance. If two dependant attributes negatively a ect the classi er then the optimal feature subset will only contain a maximum of one of them. 4.2.4 Data Description The attribute vector for a drug-READ code , i) corresponding Bradford-Hill causality consideration derived attribute vectors for the drug and each of its `risk' READ codes i(the READ codes recorded within 1 to 30 days from any prescription of ). 4.2.5 Data Transformation 4.2.5.1 Continuous Attributes The importance of processing the data has been stressed in [127], one vital stage in processing is to ensure each attribute is treated equally by a classi er. This is done by normalising the data. Normalisation scales the nominal attribute data between two values [96], this ensures the optimal performance of some learning algorithms [127]. The three frequently implemented normalisation techniques are, N1(z-score Normalisation, useful if data bounds are unknown) f:X!X;fz\u0000score(x) = (x\u0000\u0016X)=(\u001bX) N2(Min Max Normalisation, data are scale f:X!X;fMinMax (x) = (x\u0000minX)=(maxX\u0000minX) 1314. Incorporating Causation Table 4.2: The results of KNN with leave one out cross validation when the di erent normalisations are applied to the data, k=8 (preliminary was optimal). Normalisation range [ \u00001;1]) f:X!X;fdecimal (x) =x=10j;j= minfj2Nj8xi2Xjxi=10jj<1g Table 4.2 shows the results when a KNN algorithm was applied with leave one out cross validation on labelled data for 25 drugs with the data transformations N1-N3 and no transformation. The optimal solution was obtained when the N1 transformation was applied, as the AUC was the greatest. Therefore, the N1 transformation will be used to transform any continuous attributes prior to any learning algorithm in the remainder of this thesis. 4.2.5.2 Discrete Attributes The discrete attributes, x 15\u0000x 18are not normalised. The binary attributes do not require any transformation, but the non-binary discrete attribute x 18corre- sponding to the READ code hierarchal level does. As described in [127], dummy attributes (binary attributes corresponding to the each value of the discrete at- tribute) are generated for x 18, see Table 4.3 for an example. Due to the linear dependancy between x 18's dummy attributes, one can be discarded, so only four of the dummy attributes are used. If we denote the z-score normalisation of the continuous attributes and the creation of dummy attributes for the discrete at- 1324. Incorporating Causation Table 4.3: Example of how a discrete attribute is transformed into its dummy attributes. Orignal Dummy Attributes READ code lv lv1 lv2 lv3 lv4 lv5 1 1 0 0 0 0 2 0 1 0 0 0 3 0 0 1 0 0 4 0 0 0 1 0 5 0 0 0 0 1 3 0 0 1 0 0 tributes by the mapping f:R30!R33, then this leads to the transformed data X =ff(x);x2^X g. 4.2.6 Feature Selection In preliminary work I investigated the usefulness of di erent Bradford-Hill causal- ity considerations based attributes for predicting ADRs. A multivariate lter known as the Correlation-based Feature Selection (CFS) algorithm [69] was ap- plied to a range of attributes. This feature selection technique aims to nd a subset of attributes such that each individual attribute in the subset is more cor- related to the label/class than it is to other attributes in the subset. Therefore, only attributes that o er new insight for predicting the label/class are included, the others will be removed, as they are generally redundant. The paper detail- ing this preliminary work can be found in appendix C. However, in the actual framework proposed within this work, I will use wrapper feature selection prior to the classi cation (except for random forest) as wrapper feature selection chooses the attribute subset based on how well the classi er performs when trained using only the subset of attributes, this is more useful than a multivariate lter as it 1334. Incorporating Causation considers the classi er performance rather than just relying on correlations. A wrapper approach to feature selection implements a heuristic search through the power set of the attributes. It aims to nd the attribute subset that, when used as input into a classi er, maximises the classi ers performance. For ex- ample, consider the attribute set fx1;x2;x3g, the power set of these attributes isffgfx1g;fx2g;fx3g;fx1;x2g;fx1;x3g;fx2;x3g;fx1;x2;x3gg. A wrapper that performs an exhaustive search will apply the classi cation using every possible subset of attributes (all the power set) and choose the subset for which the clas- si er performed the best. In general it is not suitable to perform an exhaustive search and a local optimal subset (hopefully with a good performance) will be found instead. A forward search starts with one attribute and iteratively investigates the addition of a single attribute at a time until there is no further improvement possible. A backwards search starts with all the attributes and iteratively investigates the removal of a single attribute at a time until there is no further improvement possible. These searchers described above are referred to as `greedy' as the process of adding (or removing) an attribute cannot be reversed once done. This leads to the searchers nding local optimal subsets rather than global optimal ones. In the future work I will implement a greedy backwards feature selection algorithm named 'rfe` available in the R caret package. This algorithm requires inputting the size of the attribute subset desired. It iteratively removes attributes based on their ranking of importance by the naive Bayes classi er until the at- tribute subset is reduced to the desired size. I will search for the subsets of size 5, 10, 15, 20, 25, 30 and 33. I will then select the subset out of these seven that max- imises the classi er performance (prediction accuracy). Naive Bayes was chosen 1344. Incorporating Causation as this classi er assumes conditional independence, so it is more likely to be neg- atively a ected by attributes' dependencies. Details about the chosen attributes returned by wrapper feature selection throughout this research can be found in appendix C.2. 4.3 Summary In this chapter methods to generate thirty-three attributes for each drug-READ code pair have been proposed. These attributes may help identify causal relation- ships as they are derived from the Bradford-Hill causality considerations [19] that has been used frequently to investigate causality between a single drug-medical event pair. In addition, THIN speci c attributes were presented with the aim of preventing issues that arise due to the hierarchal READ code structure. The attributes were explored and it was determined that z-score normalisation should be applied to transform the continuous data and optimise the results of any learn- ing algorithms applied. The foundations have been set to enable the development of a novel framework for ADR signalling that incorporates causal knowledge and the THIN data structure. In Chapter 5, the attributes proposed in this chapter and their transformations will be used as inputs into a learning algorithm which will be trained, using the knowledge of known ADRs and non-ADRs, to distinguish between causal and non-causal relationships. 135Chapter 5 Developing The ADR Learning Framework `Our evaluation showed that the phenotypic information (when available) largely improved the performance of ADR prediction models. ' M. Liu [113] 5.1 Introduction In the previous chapter suitable attributes based on the Bradford-Hill causality considerations and speci c to the THIN database were proposed, with the aim of being used as inputs into a learning algorithm capable of identifying causality and hence, able to signal ADRs. This was the rst step toward testing the main hypothesis being investigated in this thesis, that a framework that incorporates attributes that give insight into causality and attributes speci c to the THIN database into a learning algorithm that uses knowledge of existing ADRs will 1365. Developing The ADR Learning Framework signal ADRs without a high false positive rate. The second step is determining which learning algorithm is optimal. In this chapter the focus is on developing an algorithm for detecting ADRs by applying supervised and semi-supervised techniques that utilised knowledge of existing ADRs and non-ADRs. The sub question answered in this chapter is what will yield a better ADR signalling algorithm, a supervised approach that is trained on labelled data corresponding to a variety of drugs, or a semi-supervised approach that uses the labelled and non-labelled data for a single drug? 5.2 Motivation Generally ADR signalling methods using data contained in SRS databases and LODs have been unsupervised, however, numerous supervised algorithms have been presented to classify ADR using chemical structures and known ADRs. One of the rst algorithms that used chemical structures to infer ADRs was de- veloped for a speci c group of drugs known as the CEPT inhibitors [209]. This idea was expanded to simultaneously identify multiple ADRs [5] where the authors prosed two novel algorithms that incorporate knowledge of chemical structures and known ADRs, extracted from SIDER [98], to infer new ADRs. The rst algo- rithm learns associations between drug attributes and known ADRs and uses this knowledge to infer new ADRs. The second algorithm, based on a method of pre- dicting disease-causing genes [186], uses a di usion process that incorporates the similarities between drugs and the similarities between ADRs. The overall mea- sure of how likely a drug causes an ADR was calculated using a combination of the values returned by the two algorithms. More recent methods have utilised target 1375. Developing The ADR Learning Framework protein information in addition to chemical structure and ADR knowledge, and used these to generate attributes that are fed into a predictive model [109; 212] or included biological and phenotypic (e.g., indications and known ADRs) based at- tributes [113]. In [113] the presented framework detected ADRs with a precision of 66.17% and a recall of 63.06% and it was shown that including attributes based on known ADRs improves the ability of the classi er and increases the recall and precision. This is a key result, as it shows that incorporating knowledge of known ADRs into an algorithm for signalling ADRs may decrease the false positive rate. ADR signalling algorithms applied to LODs have exceptional potential to identify new ADRs [204], but are currently limited by the high number of false positives [156]. An ADR signalling algorithm that generates attributes based on LODs, but also incorporates known ADR labels may reduce the number of false positives and should outperform the existing unsupervised algorithms. As an ADR represents a causal relationship, any attributes used by a learning algorithm to distinguish between ADRs and non-ADRs need to contain information about causality. In Chapter 4 suitable attributes for each drug-medical event pair based on the strength, temporality, speci city, biological gradient and experimentation factors of the Bradford-Hill causality considerations were investigated, as well as attributes speci c the to THIN database. These attributes are suitable inputs into a causality learning algorithm as they are frequently implemented by researchers to determine causal relations [42]. In Chapter 3.4, labels were extracted from the SIDER resource for known ADRs, and noise medical events were extracted using the READ code tree. Using the generated attributes and the known labels it may be possible to learn areas of the attribute space that suggest a drug-medical event pair represent an ADR. It is hypothesised that such an algorithm would 1385. Developing The ADR Learning Framework reduce the time required to de nitively identify ADRs and enable a wider search for ADRs. Overall, this would improve current healthcare. 5.3 Algorithms After the THIN data has been processed, as described in Chapter 4, for each drug of interest , we can assign class labels to some of the drug-READ code pairs (class ADRs or class non-ADRs). Therefore, the set of Bradford-Hill causality consideration attribute vectors X is partitioned into labelled data, ( X L;Y L) = f(x;y)jx2X andyis the known label g, and unlabelled data, X U=f(x;y)jx2 X and the label is unknown g. The aim of the learning algorithms is to determine a predictive function f:X!Y, using the labelled data and the unlabelled data, that can then be applied to the attributes of a new drug-medical event pair, ( \u0003; \u0003), to predict the pair's class. 5.3.1 Supervised ADR Predictor Supervised methods only use the labelled data ( X L;Y L). The Supervised ADR Predictor (SAP) framework signals ADRs by applying a classi er that is trained onndrugs to a drug not used to train the classi er. Using a su\u000eciently large value fornensures that there is an adequate number of labels. In this study the value ofnused is 24 as this corresponded to approximately 10 ;000 labelled data- points. As the drug being investigated is not used in the training, no knowledge of existing ADRs for that drug is required, so the SAP framework can be applied to newly marketed drugs. The framework is illustrated in Figure 5.1. 1395. Developing The ADR Learning Framework Input training drugs:A= f i;i2[1;n]g DetermineS= f( ; )j 2 Figure 5.1: The framework implemented to train the four di erent classi ers using a variety of ndrugs with known side e ects. These general classi ers are then used to predict the class for unlabelled data. 1405. Developing The ADR Learning Framework 5.3.1.1 Training Stage Starting with the THIN data, , and the set of training drugs, A=f i;i2 [1;24]g, the rst step is determining the `risk' drug-medical event pairs for each of the training drugs. These are all the medical event and drugs pairs,( i; ) , where the medical event is observed to be recorded, for at least one patient, within 30 days after a training drug iwas recorded. The set containing all these `risk' drug-medical event pairs where the drug is a training set drug is denoted byS. Next, the Bradford-Hill causality consideration based attributes and the THIN speci c attributes are extracted for each pair in Swith a corresponding label that is\u00061. The labels are determined (using the sets Aand Nde ned in Chapter 3.4) by, Y =8 >>>>< >>>>:1 if ( ; ; )2 N: 0 else:(5.1) labelled ;Y )j( ; )2S;Y 6= 0g. the labelled data is used to train the classi er, it is processed according to the chosen classi er being implemented. The processing step is represented by the function \u001a:X!X. For the random forest classi er, \u001ais the z-score function, \u001a(x) = (x\u0000\u0016)=\u001b, where\u0016is the mean of Xand\u001bis the standard deviation of X. For the SVM, Naive Bayes and Logistic Regression, \u001arepresents z-score normalisation and wrapper feature selection (see appendix C.2) [157]. The nal step is using the processed labelled data to train and return the clas- 1415. Developing The ADR Learning Framework si er,sk:X!Y, using leave one out cross-validation. The classi er is trained so thatsk(xab) = 1 represents drug acausing medical event bandsk(xab) =\u00001 represents drug anot causing medical event b. The trained random forest clas- si er is represented by s1:X!Y, the SVM is represented by s2:X!Y, the Logistic regression is represented by s3:X!Yand the Naive Bayes classi er is represented by s4:X!Y. 5.3.1.2 Prediction Stage Once the classi er, sk:X!Y, is trained, the SAP algorithm can then be applied to any drug \u0003not used in training. The set of attribute vectors, X \u0003= fx \u0003 j 2RME \u0003g, corresponding to `risk' drug-medical event pairs containing the drug being investigated are extracted and processed. The trained classi er is then applied to each of the data-points, x \u0003 2X \u0003, to predict whether the drug \u0003and medical event correspond to an ADR. The nal output for classi er k is the set of medical events that correspond to the signalled drug-medical event pairs To analyse the SAP algorithm a set of 25 drugs were chosen, D=f i;i2[1;25]g. For each drug, i2D, the SAP algorithm was trained on the set of drugs in Dexcluding iand then validated by being applied to i. The inputs into the SAP framework were, A=f j2Djj6=igand \u0003= i. The predictions of the classi ers on each labelled data-point (not used during training), sk(x i ), are then compared with the truth, Y i , to measure the ability of the classi er. Using the validation set, ( X i;Y 2RME i;Y i 6= 0g, the 1425. Developing The ADR Learning Framework Table 5.1: The results of the di erent classi ers at their natural thresholds for 53 2 784 24 51 9 777 0.32 2 610 12 63 7 779 0.16 true positives ( TP), false positives negatives true negatives ( TN), for each the results of the classi ers at their natural threshold and Figure 5.2 presents the ROC plots and partial ROC plots of the classi ers, re- spectively. Bar charts of the AUC and AUC [0:9;1]values returned by the classi er for the three drugs are displayed in Figure 5.3. The random forest classi er had signi cantly greater AUC [0:9;1]s for all three drugs investigated at a 5% signi - cance level. However, the random forest's AUC was only signi cantly greater for 1435. Developing The ADR Learning Framework SpecificitySensitivity 0.0 0.5 1.0 1.0 0.8 0.6 0.4 0.2 0.0 (a) Nifedipine: all speci city SpecificitySensitivity 0.0 0.2 0.4 0.6 0.8 1.0 1.0 0.8 0.6 (b) Nifedipine: high speci city SpecificitySensitivity 0.0 0.5 1.0 1.0 0.8 0.6 0.4 0.2 0.0 (c) Cipro oxcin: all speci city SpecificitySensitivity 0.0 0.2 0.4 0.6 0.8 1.0 1.0 0.8 0.6 (d) Cipro oxcin: high speci city Figure 5.2: The ROC curves for the di erent classi ers used to predict the ADRs of the drugs. The red curve represents the random forest classi er, the orange curve represents the support vector machine classi er, the green curve represents the logistic regression classi er and the blue curve represents the Naive Bayes classi er. 1445. Developing The ADR Learning Framework SpecificitySensitivity 0.0 0.5 1.0 1.0 0.8 0.6 0.4 0.2 0.0 (e) Ibuprofen: all speci city SpecificitySensitivity 0.0 0.2 0.4 0.6 0.8 1.0 1.0 0.8 0.6 (f) Ibuprofen: high speci city Figure 5.2: Continuation of the ROC plots. Nifedipine (p-value: 0. 0.164 0.052 respectively). The AUC for the random forest classi er was in the range [0 :823;0:912], indicating excellent performance. The other classi ers also performed well with the lowest AUC value of 0 :730 obtained by the SVM for Nifedipine. The random forest and SMV were able to signal between 24% \u000035% and 22%\u000040% of the known ADR READ codes for the three drugs respectively. In- terestingly, the classi ers all managed to keep the number of false positives low, aggregating over the three drugs, 85%, 77%, 52% and 62% of the signals returned by the random forest, SVM, Naive Bayes and logistic regression classi ers, re- spectively, were known ADRs. Consequently, although only approximately 30% of known ADRs were signalled by the random forest classi er at its natural thresh- 1455. Developing The ADR Learning Framework RF SVM LR and AUC [0:9;1]values for the SAP algorithm implementing each of the classi ers when applied for the drugs Nifedipine, Cipro oxacin and Ibuprofen. 1465. Developing The ADR Learning Framework old, the majority of signals were true, so no additional ltering would have been required to further validate the signals. This is an improvement over the existing methods (see Chapter 3). When investigating the signal overlap between the classi ers, in general the SVM returned the greatest number of unique signals (6 for Ibuprofen, 6 for Nifedipine and 2 for Cipro oxacin) although the random forest also had some unique ones (4 for Ibuprofen, 2 for Nifedipine and 4 for Cipro oxacin). This suggests it may be of interest to investigate applying an ensemble technique that integrates the results obtained from all four classi ers. 5.3.1.4 Summary The classi ers that use the Bradford-Hill causality consideration based and THIN speci c attributes and additional knowledge of known ADRs and non-ADRs show excellent promise at e ectively signalling ADRs. These classi ers are trained on drugs that are not investigated, so there is no requirement of known ADRs for the drugs investigated and the classi ers had a high speci city and sensitivity. Out of the four classi er investigated, the random forest returned signi cantly better results and was also the classi er that required the least amount of pre- processing, making it highly e\u000ecient. All four classi ers obtained a su\u000eciently high speci city in addition to constraining the number of false positives. The benchmark AUC for the supervised classi ers is set at 0 :91 and the benchmark AUC [0:9;1]are set at 0 :048 Cipro Ibuprofen and 0 1475. Developing The ADR Learning Framework 5.3.2 Semi-Supervised ADR Predictor In the previous section a general classi er was proposed but the combinations of attribute values that suggest a drug-medical event pair corresponds to an ADR may vary for each drug, so information may be lost by combining the labelled data for a variety of drugs. However, it is di\u000ecult to determine a speci c classi er with a high accuracy as the number of known ADRs per drug is generally less than a hundred or so, but the number of `risk' drug-medical event pairs are often in the thousands. When there is only a small number of labelled data, but surplus unlabelled data, it has been shown that semi-supervised techniques may yield more accurate results [126]. In this section a novel semi-supervised framework is proposed. A frequently implemented example of a semi-supervised technique is the self- training wrapper algorithm, summarised in Chapter 2.2.2.1. This algorithm trains a classi er on labelled data and then gets the classi er to `teach' itself by applying the trained classi er on the unlabelled data and adding any unlabelled data-point and its prediction to the labelled data, if the classi er is con dent of the predic- tion [215]. In [195], the authors showed that the performance of a self-training approach and supervised approach is comparable by applying self-training using a tree based classi er to a natural language classi cation problem. This motivates the investigation of a self-training approach that incorporates a random forest to learn from the labelled and unlabelled data. Unfortunately, the self-training approach requires a su\u000ecient number of initial labelled data, as classi ers per- form poorly when trained on a small set of data [55], and an incorrect initial model will get interactively worse. When the size of the initial labelled data is 1485. Developing The ADR Learning Framework small, a semi-supervised clustering algorithm may be more appropriate as a small number of labels can be used to aid clustering by adding bias [7]. Therefore, in this Section, two semi-supervised algorithms are presented to signal ADRs using labelled and unlabelled data corresponding to one drug; a self-training random forest and a semi-supervised k-means clustering. The framework for Semi-Supervised ADR Predictor (SSAP), contains both the self-training algorithm and the semi-supervised clustering, is presented in Figure 5.4. The value crit\u0003represents the critical value that is used to determine whether the self-training or semi-supervised clustering is applied during the SSAP framework, based on the fraction of total data that is labelled. This value will be determined by investigating the performance of both semi-supervised techniques when applied to data with a range of labelled data sizes. 5.3.2.1 Self Training Random Forest The self training random forest iteratively trains a random forest on the labelled data for drug , (X 0g, but after each random forest is built, it is applied to the unlabelled data X U=fx j 2 RME ;Y = 0gand any unlabelled data point assigned a predicted class with a con dence greater than 0 :9 is removed from the unlabelled set and added to the labelled set. The self training stops when the stopping criteria is met, either all the originally unlabelled data-points are moved into the labelled set or the iteration has run for twenty times. In detail, the self train process is: Once the nal random forest is trained, the nal iteration model ^ s:X!Y, is applied to the unlabelled data X U. The algorithm returns the predicted class of the unlabelled data, ^ s(x);x2X U, or the con dence of the data point being in 1495. Developing The ADR Learning Framework Input drug DetermineS= f( ; )j 2RME g Extract data: (X Train Random Forest Classi er using (X L;Y ) Apply trained Ran- dom Forest to X U Add unlabelled data-points with con dence\u0015 0:9 to labelled Is stopping point reached? Apply nal Random Forest toX Uand return probability of class ADRNoApply Metric Learning to Apply Semi- supervised k-means to (M(X L);Y ) Return from ADR cluster centreSelf Training Classi er Figure 5.4: The framework for the Semi-Supervised ADR Predictor algorithm. This algorithm uses labelled and unlabelled data for the drug of interest only during training. The technique applied depends on the percentage of labelled data. 1505. Developing The ADR Learning Framework Input : Labelled data: X L;Y ), Unlabelled data: X Uand : forest applied to unlabelled data, si(X U) Initialization :L1=;,U1=X U fori= 1;2;3;:::do forest, si:X!Y, on labelled data ( 3: The self train random forest the ADR class. 5.3.2.2 Semi-supervised Clustering The semi-supervised clustering technique is proposed for replacing the self-training random forest when there is insu\u000ecient number of labelled data. The semi- supervised clustering method has two steps, the rst step applies metric learning [211] using the labelled data, X L, to learn a mapping, M:X!X, of the at- tribute space that minimises the distance between data-points in the same class while adding a constraint to keep data-points from di erent classes su\u000eciently far apart. The second step is the application of the seed-constrained k-means clus- tering algorithm [7] to ), whereX =X U[X L. The k-means algorithm uses the labelled data to deter- mine the initial centres of the clusters and xes the labelled data to a cluster, the unlabelled data-points are then iteratively assigned to the cluster with the clos- est centre until convergence. Both the metric learning and the semi-supervised k-means algorithm are described in Chapter 2.2.2.1. In detail, the process is: 1515. Developing The ADR Learning Framework 1. Apply with \u0016= output the nal cluster or the distance from the nal ADR centre, jjM(xi)\u0000\u00161jj, where\u00161is the centre of the ADR cluster. The algorithm returns the predicted cluster of the unlabelled data-points or the distance between the data point and the ADR cluster centre. 5.3.2.3 Results and Analysis The self-training random forest algorithm and semi-supervised clustering algo- rithm implemented the SSAP framework both to the drugs Nifedip- ine, Cipro oxacin and Ibuprofen to analyse the results. For each drug, i, the labelled data was extracted, ( X i;Y i) =f(x i ;Y into ( X i L;Y i L), and validation, (X i U;Y i U), sets. (X i;Y i) = (X i L;Y i L)[ (X i U;Y i U) 1525. Developing The ADR Learning Framework (X i L;Y i L)\\ (X i U;Y i U) =; The data input into the algorithms as labelled data was ( X i L;Y i L) and the data input into the algorithms as unlabelled data was X i U. The algorithms were anal- ysed by investigating the ROC plots determined by comparing their predictions on the validation data ^ s(x);x2X i Uwith the truth Y i U. Both algorithms were applied for varying values of crit=jX i Lj=jX ij, to investigate if there is an obvi- ous threshold value of critthat can be used to determine which semi-supervised algorithm to apply when the SSAP framework is implemented (i.e., does the self-training algorithm always outperform the semi-supervised clustering when crit\u0015crit\u0003?). Figure 5.8 displays the AUC of the ROC plots obtained by applying the semi- supervised clustering or self-train classi er The AUCs varied for the semi- supervised clustering and self-train classi er respectively. For Nifedipine, both algorithms performed their respective best, with AUCs of 0 :80 and 0:88 for the clustering and self-train respectively, when 90% of the data was labelled, whereas for Ibuprofen, both algorithms performed their respective best when only 5% of the data was labelled. This shows that the semi-supervised techniques did not always improve in performance when the value of critwas increased, this is further evident in Figures 5.5-5.6. Futhermore, this suggests that the SSAP framework does not require a large number of labelled data, as, in general, the performance seems to be similar for low and high values of crit, but the performance depends on the quality of labelled data. To investigate how much the initial labels a ect the performance, both semi- 1535. Developing The ADR Learning Framework SpecificitySensitivity 0.0 0.5 1.0 1.00.80.60.40.20.0 SpecificitySensitivity 0.0 0.5 1.0 SpecificitySensitivity 1.00.80.60.40.20.0 (b) Cipro oxacin Plot: Self Training, Right Plot: Clustering Figure 5.5: The ROC curves for the SSAP framework at 6 di erent values of crit when applied to the di erent drugs. The black, blue, red, orange, yellow and green curve correspond to critvalues of 0:9, 0:7,0:5,0:3,0:1 and 0:05 respectively. 1545. Developing The ADR Learning Framework SpecificitySensitivity 0.0 0.5 1.0 1.00.80.60.40.20.0 SpecificitySensitivity 0.0 0.5 1.0 1.00.80.60.40.20.0 Figure 5.6: The ROC curves for the SSAP framework at 6 di erent values of crit when applied to Ibuprofen. The black, blue, red, orange, yellow and green curve correspond to critvalues of 0:9, 0:7,0:5,0:3,0:1 and 0:05 respectively. Left Plot: Self Training, Right Plot: Clustering. 1555. Developing The ADR Learning Framework SpecificitySensitivity 0.0 0.5 1.0 1.00.80.60.40.20.0 SpecificitySensitivity 0.0 0.5 1.0 1.00.80.60.40.20.0 Figure 5.7: The ROC curves for the SSAP framework repeated multiple times for the drug Ibuprofen at a critvalue of 0:1 to investigate consistency. Left Plot: Self Training, Right Plot: Clustering. supervised techniques were applied multiple times with a critvalue of 0:1, but the initial labels were varied. The results are displayed in Figure 5.7. It can be seen that the performance varied each time, and although the semi-supervise clustering produced good results four out of the ve times, one time it performed very poorly, worse than random guessing when considering a high speci city. This is probably due to bad initial labels resulting in a poor model that then gets worse as the unlabelled data are incorporated. This is not ideal, as there is no control on the labelled data available, and applying one of the semi-supervised techniques may yield poor results for certain labelled data. There does not appear to be an optimal value for crit\u0003so, rather than only ap- plying one of the algorithms, it may be optimal to apply both the semi-supervised clustering and self-trained classi er, and generate signals based on both values. 1565. Developing The ADR Learning Framework 0.90.70.50.30.10.05ClusteringSelf Train Mean Figure 5.8: The AUC for the ROC plots obtained by applying the semi-supervised clustering and the self training classi cation within the SSAP framework to the di erent drugs at varied critvalues. 1575. Developing The ADR Learning Framework 5.3.2.4 Summary The results show that a semi-supervised approach that only uses data for the drug of interest generally performs well but the performance can be a ected by initial errors in the self training or metric learning. The consequence is that the SSAP framework is not as consistent as the SAP framework, and although it may occasionally produce better results (depending on the initial labelled data), it may also perform very poorly. It was observed that the SAP algorithm, with the random forest classi er, had a greater AUC than either of the semi-supervised algorithms for all the critvalues investigated for all three drugs. Overall, the SAP algorithm produced better and more consistent results. It also has the additional bene t of not requiring knowledge of existing labels for the drug being investigated, unlike the SSAP algorithm. 5.4 Summary In this chapter two di erent frameworks were proposed to signal ADRs. The frameworks were then applied to data, where the truth was known, and mea- sures were calculated to determine the suitability of each framework. The rst framework implemented a supervised algorithm and was trained using labelled data corresponding to a selection of drugs not being investigated. The second framework used a semi-supervised approach and was train using the labelled and unlabelled data for the drug of interest. The ROC plots show that the SAP framework, using a random forest classi- er, consistently generates superior results. Interestingly, using the labelled data for the drug of interest generally leads to a worse performance. Therefore, the 1585. Developing The ADR Learning Framework conclusion of this chapter is that a general model, that uses Bradford-Hill causal- ity consideration attributes and THIN speci c attributes, trained on independent drugs yields the optimal solution. The tentative results suggest such a framework is capable of signalling ADRs with a low false positive rate. It is now of inter- est to determine how this general model compares with existing ADR signalling algorithms and investigate if it is robust. 159Chapter 6 Evaluating The ADR Learning Framework `As there is no true gold standard, prospective evaluation of signal detection methods remains a challenge.' P. M. Coloma[33] 6.1 Introduction In the previous chapters, a novel idea of automating the application of the Bradford-Hill causality considerations for mass signalling of ADRs was developed. In Chapter 4 the attributes derived from the Bradford-Hill causality considera- tions were presented, and used as inputs into a learning algorithm in Chapter 5. The tentative results of the novel learning algorithm, named the SAP framework, suggest that training a general classi er using knowledge of existing ADRs on attributes based on the Bradford-Hill causality considerations and THIN speci c 1606. Evaluating The ADR Learning Framework attributes may present the opportunity to signal ADRs with a high precision and su\u000eciently high speci city. In this chapter, the SAP framework is evaluated by applying the speci c comparison used in Chapter 3 and also by determining the frameworks ability on the HOI-DOI reference standard, as this enables a general comparison with previous and future work. As it was hypothesised that the SAP framework will be able to generate new signals that can not be generated by existing methods, the framework will also be applied to the drug-medical event pairs for a selection of drugs that are not de nitively known as ADRs or non-ADRs. The signals generated will be presented as this o ers another perspective into the e ectiveness of the SAP framework and may highlight new ADRs. 6.2 Motivation The existing methods are known to su er from the high false positive rate [156] and this means that further investigation needs to be applied to the signals that are generated. If the SAP framework has a low false positive rate, then this additional investigation will not be required, increasing the e\u000eciency of ADR signalling. As the high false positive rate is due to signalling strong associations that are non-causal but occur due to confounding e ects, the SAP framework should be more resilient to a high false positive rate as the Bradford-Hill causality considerations should help distinguish between associations due to confounding, and associations due to causation [19]. Evaluating the SAP framework on the standard reference [80] will enable other researchers to readily compare their methods with the SAP framework 1616. Evaluating The ADR Learning Framework and the SAP framework can be compared with previous results. However, this standard reference may be biased due to only considering a selection of HOIs. Therefore, the speci c comparison is also applied to evaluate the SAP framework and determine the false positive rate when a larger number of drug-medical event pairs are analysed. If the SAP framework is shown to have a low false positive rate, but this does not inhibit its general ability, then this would be a step forward for pharmacovigilance. 6.3 Evaluation using the Standard Reference A recent standard reference set has been introduced to enable a fair comparison between methods applied to di erent databases. The standard reference con- tains ten DOIs and nine HOIs (discussed in Chapter 2.1.5), and consists of 53 de nitively known ADR or non-ADR drug-medical event pairs (9 ADRs and 44 non-ADRs). The SAP framework was applied for each of the 53 drug-medical event pairs on the THIN database and the signals generated by the framework were compared with the known truth. Previously, the benchmark measures over all the methods and a variety of databases are an AUC of 0 :77 and an AP of 0 :49, the method obtaining these values had a sensitivity of 0 :56, a speci city of 0 :82 and a positive predictive value of 0:38 [156]. The previous comparisons have all concluded that existing methods have a high false positive rate ( \u00150:18 [156]). On the THIN database the benchmark values were a sensitivity of 0 :67, a speci city of 0 :68 and a precision of 0:33 [214]. 1626. Evaluating The ADR Learning Framework 6.3.1 Method The SAP framework was evaluated by generating signals for each DOI after train- ing the SAP framework on the other nine DOIs. As some of the DOIs have drugs in common, the drugs used during training were always excluded from the vali- dation to prevent bias. Due to the limited number of drug-medical event pairs available for training, the random forest classi er was found to perform poorly on the reference standard, so the SAP framework with a support vector machine classi er embedded was used instead. It was also found, due to the limited train- ing size, that feature selection was required to reduce the number of attributes used by the SAP framework. The attributes not used were the TPD lter 1 (x 15) and TPD lter 2 ( x 16), LEOPARD ( x 17), experimentation ( x 26) and the risk di erent ( x 4-x 5), risk ratio ( x 7-x 8) and odds ratio ( x 10-x 11) when only considering the rst time the drug is prescribed in 13 months or the rst time any drug in the same family is prescribed in 13 months. 6.3.2 Results Table 6.1 presents the results of the signals generated using the SAP framework for the standard reference. The number of TPs was 6, the number of FPs was 7, the number of FNs (excluding the pair antibiotics and acute liver failure as that was not experienced by any patients in the subsection of the THIN database used) was 2 and the number of TNs was 37. Therefore, at its natural threshold, the SAP framework had a sensitivity of 0 :75, a speci city of 0 :84, a precision of 0:46 and a false positive rate of 0 :16. The general raking ability measures were a MAP (average AP) score of 0 :490, 1636. Evaluating The ADR Learning Framework Table 6.1: The results of the SAP framework with the support vector machine classi er on the 53 standard reference set of DOIs an average P(10) of 0 :2875. The DOIs antibiotics and betablockers were not used in the previous calculation due to them having no positive drug-medical event pairs, so the measures are unde ned. 6.3.3 Discussion Previous benchmarks for existing methods using the common data model on the standard reference set were an AP ranging between 0 :25\u00000:49 an AUC ranging between 0:59\u00000:77 and a false positive rate ranging between 0 :18\u00000:89 [156]. The false positive rate of 0 :16 returned by the SAP framework was lower than existing methods obtained in previous studies, but the general ranking measures were comparable with the optimal existing methods. Therefore, the results of the SAP framework using the THIN database for the standard reference set show that the 1This DOI-HOI pair was Not Observable (NO) using the THIN database 1646. Evaluating The ADR Learning Framework SAP framework is able to generate signals as well as the existing methods applied to the common data model but it has a lower false positive rate. This provides evidence to support the hypothesis that generating methods for speci c database rather than the common data model may enable new signals to be generated and supports the hypothesis that incorporating knowledge of existing methods and attributes based on causation will reduce the number of false positives generated by the method. The SAP framework was limited in this evaluation due to the small number of DOIs and HOIs resulting in a small training set. This shows that the SAP framework has even more potential, as when the training size increases, the ability of the classi er will increase and the SAP framework is likely to perform better. As the SAP framework's performance was as good, or maybe better, than existing methods when the training set was small, it is likely to signi cantly outperform the methods when more DOIs and HOIs are used to train the classi er. The evaluation also highlighted how adaptable the framework it, as it can use any classi er within it, so the most suitable classi er can be chosen based on the situation. Furthermore, the SAP framework only requires the classi er to be tuned and feature selection to be applied, so the number of parameters is relatively low compared to many of the existing methods, making its application more e\u000ecient. 1656. Evaluating The ADR Learning Framework Method Signal Criteria Ranking Criteria SAP Framework Class with most votes Con dence of class ADR ROR 05 ROR 05>1 ROR 6.2: and ranking criteria of the methods. 6.4 Speci c Comparison 6.4.1 Method The speci c comparison, as conducted in Chapter 3.7, was repeated for the drugs Nifedipine, Cipro oxacin, Ibuprofen, Budesonide and Naproxen and including the SAP framework as an additional method. The di erent criteria used by each method to generate signals or rank the pairs are described in Table 6.2. The speci c comparison was chosen to be implemented in addition to evaluating the SAP on the standard reference as this enables a more rigorous evaluation of the SAP's ability to generate signals with a low false positive rate. An additional investigating is implemented by applying the SAP framework to the `risk' drug-medical event pairs that are not de nitively known as non-ADRs or listed as ADRs on the drug packaging (i.e., the unlabelled drug-medical event pairs). This will enable potentially new ADRs to be discovered. 6.4.2 Results 6.4.2.1 Nifedipine Natural Thresholds Table 6.3 displays the ADR signalling methods abilities at their natural thresh- 1666. Evaluating The ADR Learning Framework Table 6.3: The results of the signals generated by the di erent ADR signalling methods applied to Nifedipine at their natural 6.4: The general the Curve (AUC), partial AUC (AUC [0:9;1]) and Average Precision (AP), results of the di erent ADR signalling methods applied to Nifedipine. 180, SRS and HUNT 180signalled the greatest number of known ADRs, 54, 44 and 42 respectively. However, these methods also incorrectly signalled many non-ADR and had low presicion values (0 :145\u00000:212). The SAP framework had the highest presicion, 0 :733, speci city, 0 :987 and F- score, 0:473. This was due to the low number of false positives. General Ranking Table 6.4 displays the AUC, AUC [0:9;1]and AP values for the ve ADR signalling methods. The SAP framework had the highest AUC, AUC [0:9;1]and AP, with values 0.889, 0.054 and 0.596 respectively. The AUC of the SAP framework was not signi cantly greater the AUC for MUTARA 1The TPD result both the TPD 1and TPD 2were applied. 1676. Evaluating The ADR Learning Framework Table 6.5: The results of the signals generated by the di erent ADR signalling methods applied to Cipro oxacin at AUC [0:9;1](p-value 0.471). The ROC plots are presented in Figure 6.1. The worse performing method was the ROR 05, with an AUC of 0 :691 and an AP of 0:129. Unlabelled Data Signals Out unlabelled drug-medical event pairs containing Nifedipine, 233 were signalled as ADRs by the SAP framework and are displayed in Appendix D. The signals (and the number of patients experiencing them 30 days after the drug) included itching/pruritus ( \u00151976), appetite loss (203), tiredness (1848), excessive thirst (36), torticollis (71), dizziness (2585) and benign essential tremor (91). There were also heart related signals such as unstable angina (120) and acute myocardial infarction (114). 6.4.2.2 Cipro oxacin Natural Thresholds The methods had variable sensitivities, ranging from 0 :073 for HUNT 180to 1 for MUTARA 180and speci cities, ranging from 0 :0151 for MUTARA 180to 1 for the SAP framework. This suggests their natural thresholds act at varying 1686. Evaluating The ADR Learning Framework Table 6.6: The general ranking, Area Under the Curve (AUC), partial AUC (AUC [0:9;1]) and Average Precision (AP), results of the di erent ADR signalling methods applied to was able to signal approximately 25% of the known ADRs and did not signal any non-ADRs. MUTARA 180signalled all the 55 known ADRs but also signalled 327 non-ADRs. The TPD performed the worse for Cipro oxacin, with the lowest F-score of 0 :110 compared to the others that ranged from 0 :252\u00000:382. General Ranking For the drug Cipro oxacin, MUTARA 180had the greatest AUC, 0 :851 but the SAP framework performed better when only considering a low speci city, with a AUC [0:9;1]of 0:048. The SAP framework also had the greatest AP value, 0:614 compared to the APs of the other methods (0 :140\u00000:547). The AUC of MUTARA 180s ROC curve was not signi cantly greater than the AUC of the SAP framework ROC curve (p-values 0 :241), neither was the AUC [0:9;1]of the ROC curve for the SAP framework compared to the AUC [0:9;1]of MUTARA 180s ROC curve (p-value 0 :235. The ROC plots for the methods applied to signalled ADRs of Cipro oxacin can be seen in Figure 6.1. Unlabelled Data Signals 1696. Evaluating The ADR Learning Framework Table 6.7: The results of the signals generated by the di erent ADR signalling methods applied to Ibuprofen at there natural TPD 0.068 0.050 Table 6.8: The general ranking, Area Under the Curve (AUC), partial AUC (AUC [0:9;1]) and Average Precision (AP), results of the di erent ADR signalling methods applied to Ibuprofen. The signals generated the SAP framework applied to the drug Cipro oxacin are listed in Appendix D. Out drug-medical event pairs con- taining Cipro oxacin, 125 pairs were signalled as corresponding to ADRs. Some of the interesting signals include hypothyroidism (324), depressed mood (625), oral aphthae (285), muscle injury/strain (46), congestive heart failure (542), Incoordi- nation symptom (807), canidial balanitis (67), confused (434), achilles tendinitis (130), left ventricular failure (318) and panic disorder (192). 6.4.2.3 Ibuprofen Natural Thresholds The results of the methods applied to Ibuprofen at their natural threshold are presented in Table 6.7. It can be seen that MUTARA 180was able to signal the 1706. Evaluating The ADR Learning Framework majority of known ADRs (69/75) at its natural threshold but it also signalled 538 non-ADRs. The SAP framework signalled less, approximately 30% of the known ADRs (23/75), but managed to only signal 3 non-ADRs, this resulted in the SAP framework obtaining the greatest presicion, 0.885 and F-score, 0.455. General Ranking The SAP the greatest AUC, 0.903, and AUC [0:9;1], 0.057, and than the AUC and AUC [0:9;1]corresponding to the sec- ond best method MUTARA 180, with an AUC value of [0:9;1]of 0.045 (p-values 0.037 and 0.044 respectively). The SAP framework also had the greatest AP value, 0.654 compared with 0.498, 0.196, 0.102 and 0.076 correspond- ing MUTARA 180, HUNT 180, TPD and the ROR 05respectively. These general ranking measures are contained in Table 6.8. The ROR 05actually performed worse than random guessing, with an AUC value under 0 :5 and was unable to signal any known ADRs at a high speci city as its AUC [0:9;1]was 0. Unlabelled Data Signals When the SAP framework was applied to unlabelled data corresponding to Ibupro- fen, there was a total of 200 signals out of a possible 7700. The signalled pairs included the medical events Nausea (3084), rash ( \u00156155), tiredness symptom improved (22539) and myalgia (2246). A complete list of signals is contained in Appendix D. 1716. Evaluating The ADR Learning Framework Table 6.9: The results of the signals generated by the di erent ADR signalling methods applied to Budesonide at there natural Speci city Presicion SAP 26 0 535 0.5 1 1 0.667 ROR 05 23 29 360 175 0.442 0.327 0.031 Table 6.10: The general the Curve (AUC), partial AUC (AUC [0:9;1]) and Average Precision (AP), results of the di erent ADR signalling methods applied to Budesonide. Table displays the results of the signals generated for Budesonide by the meth- ods at their natural threshold. The SAP framework did not signal the most known ADRs, MUTARA 180signalled 49 out of 52 known ADRs, but it was able to signal 50% and all the signals were correct (0 false positives). MUTARA 180signalled 308 false positives, so only 49 out of the 357 signals generated by MUTARA 180 correspond to known ADRs. The TPD generated the least number of signals, 13 in total, and only 1 corresponded to a known ADRs, making it the wore per- forming method. The F-score of the SAP framework, 0.667, was over double the other methods' F-scores, in the range [0 :031;0:240]. 1726. Evaluating The ADR Learning Framework General Ranking The SAP framework performed excellently on the drug Budesonide with an AUC of 0.937, a AUC [0:9;1]of 0.070 and a 0.767. Both the AUC and the AUC [0:9;1] of the SAP framework was signi cantly greater AUC 180(p-values 0.0126 and 0.022 respectively), the best perform- ing method with an AUC of 0.855 and a AUC [0:9;1]of 0.0524. The results for all the methods are presented in Table 6.10. The methods that obtained the lowest ranking performance were the TPD and ROR 05, although their AUC values were approximately 0 :7, suggesting all the methods performed well for Budesonide. Unlabelled Data Signals There were a total of 206 signals out of a possible 5219 generated by the SAP framework when applied to unlabelled drug-medical events pairs containing Budes- onide. A selection of the interesting medical events signalled as ADRs to Budes- onide are (607), essential hypertension (2258), appetite loss (82), bloating (71), drug and other substances-adverse e ects in therapeu- tic use (281), alopecia unspeci ed (100), tremor (201) and patient's condition worsened (927). For a list of all the signalled medical events see Appendix D. 6.4.2.5 Naproxen Natural Thresholds The SAP framework was able to signal approximately 40% of the known ADRs and out of the signals generated, 89% corresponded to known ADRs and only 11% 1736. Evaluating The ADR Learning Framework Table 6.11: The results of the signals generated by the di erent ADR signalling methods applied to Naproxen at there natural 0.388 176 0.119 Table 6.12: The general the Curve (AUC), partial AUC (AUC [0:9;1]) and Average Precision (AP), results of the di erent ADR signalling methods applied to Naproxen. signal 90% of the known ADRs, but only 20% of the total signals corresponded to ADRs, the remain- ing 80% were non-ADRs. The SAP framework had the greatest F-score, 0.539, with the other methods obtaining 0.324, 0.265, 0.174 and 0.119 for MUTARA 180, HUNT 180, the ROR 05and TPD respectively. These results are presented in Table 6.11 and the ROC plots are displayed in Figure 6.1. General Ranking The general ranking performance of the methods varied when applied to Naproxen, this can be seen in Table 6.12. The SAP framework and MUTARA 180performed well, obtaining AUC values of 0.883 signi The SAP frameworks' AP was greater than the other methods, 0.7, compared with the other methods ranging from 0.136 (ROR 05) to 0.503 (MUTARA 180). The ROR 05performed poorly, with an AUC of 0.51, not much improvement on random guessing, and a AUC [0:9;1]of 0, showing it was not able to signal any known ADRs when the speci city if high. Unlabelled Data Signals When the SAP framework was applied to the 4540 unlabelled drug-medical event pairs containing the drug Naproxen, a total of 302 pairs were signalled as cor- responding to ADRs. For a list of all the medical events contained in these drug-medical event pairs see Appendix D. The medical events of interest are de- pression (1677), abdominal pain (1077), acquired hypothyroidism (588), anxiety breathlessness (873), hoarse (172), nausea present (232), constipa- tion (308), unstable angina (24), vomiting (38), left ventricular failure (230), obstructive jaundice (13), acute retention of urine (13), acute non-ST segment elevation myocardial infarction (27), ocular hypertension (147), drug stopped- medical advice (529), spasms (14), congestive heart failure (368) and atria utter (20). 6.4.3 Discussion The SAP framework had a greater AUC value for four out of the ve drugs investigated and a greater AUC [0:9;1]for all ve drugs, compared to the existing methods. The AUC and AUC ADR Learning Framework SpecificitySensitivity 0.0 0.5 1.0 1.00.80.60.40.20.0 SpecificitySensitivity 0.0 0.2 0.4 0.6 0.8 1.0 1.0 0.8 (a) Nifedipine SpecificitySensitivity 0.0 0.5 1.0 1.00.80.60.40.20.0 SpecificitySensitivity 0.0 0.2 0.4 0.6 0.8 1.0 1.0 0.8 (b) Cipro oxcin Figure 6.1: The ROC plots for the SAP algorithm, implementing a random forest (black) and the existing methods MUTARA 180(orange), HUNT 180(red), TPD (green) and ROR 05(blue). 1766. Evaluating The ADR Learning Framework SpecificitySensitivity 0.0 0.5 1.0 1.00.80.60.40.20.0 SpecificitySensitivity 0.0 0.2 0.4 0.6 0.8 1.0 1.0 0.8 (c) Ibuprofen SpecificitySensitivity 0.0 0.5 1.0 1.00.80.60.40.20.0 SpecificitySensitivity 0.0 0.2 0.4 0.6 0.8 1.0 1.0 0.8 (d) Budesonide Figure 6.1: The ROC plots for the SAP algorithm, implementing a random forest (black) and the existing methods MUTARA 180(orange), HUNT 180(red), TPD (green) and ROR 05(blue). 1776. Evaluating The ADR Learning Framework SpecificitySensitivity 0.0 0.5 1.0 1.00.80.60.40.20.0 SpecificitySensitivity 0.0 0.2 0.4 0.6 0.8 1.0 1.0 0.8 (e) Naproxen Figure 6.1: The ROC plots for the SAP algorithm, implementing a random forest (black) and the existing methods MUTARA 180(orange), HUNT 180(red), TPD (green) and ROR 05(blue). 1786. Evaluating The ADR Learning Framework level, for three of the ve drugs (Ibuprofen, Budesonide and Naproxen). This suggests that the SAP framework is overall better at ranking ADRs. As the SAP framework's AUC [0:9;1], the AUC when the speci city is high and the false positive rate is low, was always greater than the existing methods, this shows that the SAP framework is able to signal ADRs more precisely. This is also evident by the AP score of the SAP framework being greater than the existing methods for all ve drugs, resulting in an overall Mean Average Precision (MAP) score of 0:667 compared to 0 :531, 0:297, 0:145 and 0:118 corresponding to MUTARA 180, HUNT 180, TPD and ROR 05respectively. The SAP framework was able to signal a high percentage of ADRs while main- taining a low number of false positives. Although MUTARA 180signalled more ADRs, it also signalled many false positives. Over all ve drugs, the number of SAP and MUTARA 180signals that were true positives were 115 and 299 respec- tively, but the number of false positives were 15 and 1733 respectively. Therefore, 88:5% of the SAP framework signals are likely to correspond to ADRs, while only 14:7% of MUTARA 180's signals are likely to be ADRs. This means MUTARA 180's natural threshold signals probably need additional ltering, whereas this is not necessary when the SAP framework is implemented. Overall, the SAP framework managed to signal 115 out of the 325 ADRs. This corresponds to a minimum of 35 :4% of the ADRs being identi ed, as READ code redundancy may mean that some of the 64 :6% remaining non-signalled ADRs READ codes may correspond to the same medical event as the signalled READ codes. This value may be further improved by training the SAP framework on more drugs, or by adding additional attributes based on the remaining Bradford- Hill causality considerations (consistency, plausibility and coherence). The SAP 1796. Evaluating The ADR Learning Framework framework was also able to signal medical events that had a low frequency during the 30 day period after the drug, and medical events with a high background rate such as depression and myocardial infarction. These medical events are often di\u000ecult to signal by the existing SRS methods [70] as the association strength is often very weak. The TPD, HUNT 180and ROR 05performed worse than the SAP framework and MUTARA 180. The methods were unable in general to signal ADRs without being swamped by false positives and obtained MAP scores of less than 0 :5, suggesting their general ranking ability was poor on the drug-medical event pairs investigated. The TPD method may have been inhibited as it only analyses patients that have a long medical history, due to it investigating the 27 months to 21 month time period prior to the prescription. Therefore, the amount of data available for the TPD algorithm may have been smaller relative to other methods. The natural threshold of HUNT 180>1 appeared to act at a similar stringency as MUTARA 180suggesting this is a good threshold to apply. It is clear that the SAP framework was consistent over the drugs investigated and did not perform poorly on any instance. MUTARA 180also returned consis- tent results, however, the other three existing methods returned mixed results. They performed poorly for Naproxen and Ibuprofen, with the ROR 05being worse than random guessing and TDP performing little better. When the SAP framework was applied to the unlabelled data corresponding to the ve drugs it was able to signal many suspected ADRs and highlighted some potentially new ADRs. The results obtained from the unlabelled data were very promising but require further evaluation to con rm causality. The SAP framework successfully signalled known ADRs with obscure descriptions, and 1806. Evaluating The ADR Learning Framework this is additional evidence to support its ability. 6.5 Summary The results of the SAP framework applied on the standard reference set of 53 drug-medical event pairs provide evidence that the SAP framework is able to signal ADRs with a low false positive rate. The results of applying the SAP framework on a subset of the THIN database and the results of applying ex- isting method to the common data model are comparable. This is impressive as the common data model contains more data than the subset of the THIN database used through this research. The results provide evidence to support the argument that methods should be developed for speci c databases to utilise the whole data, as it is known that information can be lost when transforming LODs into the common data model [214]. It is also clear that single databases in their raw form are useful sources for pharmacovigilance. The results also show that introducing attributes based on the Bradford-Hill causality considerations to tackle the problem of confounding can reduce the number of false positives signals. The results of the speci c comparison show that the novel SAP framework out- performs the existing methods evaluated in this thesis (MUTARA 180, HUNT 180, ROR 05and TPD) and signalled ADRs with a low false positive rate. The SAP framework appears to be the rst ADR signalling technique that has manage to signal a su\u000ecient number of ADRs using LODs while obtaining a low false positive rate. This is an improvement over current pharmacovigilance techniques applied to LODs and may increase the e\u000eciency in discovering ADRs. Possible 1816. Evaluating The ADR Learning Framework reasons for the SAP framework's performance are the inclusion of Bradford-Hill causality consideration attributes and attributes speci c to the THIN database or its ability to learn from known ADRs. The SAP framework was able to generate new ADR signals, but further anal- yse needs to be performed before the the signals can be con rmed as true or not. The bene t of the SAP framework is that prior results can be used to update the framework as the signals it generates are con rmed as ADRs or non-ADRs. The SAP framework's performance should increase over time as the number of known de nitive ADRs or non-ADRs increases. 182Chapter 7 Conclusions This thesis has focused on developing an ADR signalling framework, speci cally for the THIN database, that can identify ADRs with a low false positive rate. It was determined that the current ADR signalling techniques, applied to the THIN database, had a high false positive rate and the majority of signals were non-ADRs. The plausible reasons for this were that the existing methods cannot distinguish between causation and association and they do not take into account the hierarchal structures embedded within the THIN database. To overcome this issue of the methods signalling ADRs based on the strength of association rather than causation, a generalisation of the technique of consider- ing the Bradford-Hill causality considerations to determine signals was proposed. The technique was generalised by calculating attributes based on ve of the Bradford-Hill causality considerations (association strength, temporality, biologi- cal gradient, speci city and experimentation), using the THIN database, and then using knowledge of existing ADRs to nd patterns embedded within the attribute values that could be used to signal ADRs. By applying a learning technique, a sixth Bradford-Hill factor, analogy, is also indirectly incorporated. Furthermore, attributes that incorporated knowledge of the THIN hierarchal structures were 183also proposed and used as attributes into the learning algorithm. These attributes helped identify medical events that occurred before the drug was taken but then progressed or were recorded inconsistently. It was shown that the SAP framework, a classi er trained using data consist- ing of Bradford-Hill causality considerations and THIN speci c attributes corre- sponding to drug-medical event pairs that are known ADRs or non-ADRs, can be applied to a di erent drug-medical event pair to determine if the pair is an ADR or not with an speci city of 0 :75 and a sensitivity of 0 :84. The natural threshold false positive rate was lower than existing methods, showing that the SAP framework overcomes the current limitation of a high false positive rate that plagues the existing ADR signalling methods for LODs. In the continuation of this chapter the contributions of this work are sum- marised, and suggestions are made for future directions of work to follow on from this research. The dissemination of this research is reported in the conclusion of this chapter. 7.1 Contributions This thesis has made the following contributions: \u000fDetermined the benchmark for the existing methods on the THIN database There is no golden standard for signalling ADRs [179] due to the lack of de nitive knowledge of existing ADRs for each drug. In [214], the authors applied a selection of ADRs signalling techniques to the raw THIN database and a mapped version of the database to determine if signals are lost during 184the mapping. This was the rst example of the THIN database being inves- tigated for ADR signal detection. Benchmarks for the standard reference using the raw THIN database were determined, but the authors did not apply an extensive analysis and the standard reference may contain bias. In Chapter 3, an extensive analysis was conducted by applying a selection of existing ADR signalling methods (Reporting Odds Ratio, Temporal Pat- tern Discovery, Mining Unexpected Temporal Association Rules given the Antecedent and Highlighting Unexpected temporal association rules Negat- ing Temporal association rules) to the THIN database and analysing the signals with two di erent perspectives. The ROR and TPD had been com- pared with other methods in numerous studies [156] [80] and the authors concluded that the methods performed similarly, so rather than applying all the existing methods, only these two were chosen. MUTARA and HUNT had not be incorporated in any previous comparison, so they were also added to the investigation. The previous comparisons had concluded that the methods had a high false positive rate [156] and this limited there abil- ity. The comparisons conducted in this research showed, consistent with previ- ous results, that the four existing method had a high false positive rate. An interesting result was that their performance deteriorated when the num- ber of drug-medical event pairs being investigated increased, although this may be partially due to the e ect of unknown ADRs causing their results to seem worse than they are. When considering a smaller subset the drug- medical event pairs, where only de nitively known ADRs or non-ADRs are 185included, the 0:315 re- The sensitivity and speci city ranged between 0 :061\u00000:894 and 0:0366\u00000:959 respectively. The comparison suggested that the existing ADR signalling methods are unsuitable for signalling ADRs using the THIN database due to the large number of false positive signal generated. It would be di\u000ecult to extensively investigate each signal generated and the majority of them would be false. \u000fProposed suitable attributes to distinguish association from cau- sation The THIN database is a LOD containing prescription and medical histo- ries for millions of patients. It o ers the potential to infer temporal causal relationships between drugs and medical events, but no ADR signalling technique had been developed speci cally for the THIN database. Exist- ing methods, developed for alternative databases, determine the association strength between a drug-medical pair and signal the pairs with the great- est association. This causes a high false positive rate, as many medical events can be highly associated to a drug due to non-causal reasons. When investigating a single drug-medical event pair, researchers have often con- sidered the Bradford-Hill causality considerations to draw conclusions [164]. As the THIN database contains data that can be used in consideration of many Bradford-Hill causality considerations, in this work, a generalisation and automatisation of this idea was proposed by extracting Bradford-Hill causality considerations based attributes from the THIN database. The attributes were then used as inputs into a learning algorithm. This is the 186 rst attempt of such an approach. The attributes proposed in Chapter 4 are a mixture of existing and novel cal- culations to cover ve of the Bradford-Hill causality considerations, namely, association strength, temporality, speci city, biological gradient and exper- imentation. The association strength based attributes and the majority of the temporality attributes were extracted from existing pharmacovigilance methods. The speci city, biological gradient, experimentation and tempo- rality BA ratios are all novel attributes that were developed in this work. As this work was focussing on a ADR signalling technique, speci cally for the THIN database, novel attributes were also presented in Chapter 4 to deal with the hierarchal structure within the THIN data. It was concluded in Chapter 3 that the existing methods struggle with illness progressions or re- dundancy within the THIN database. By using the THIN medical event hi- erarchy, attributes were proposed that identify medical events that are more detailed or similar to medical events that were reported before the drug. Di erent attributes may be required for di erent healthcare databases, de- pending on any database speci c issues that are identi ed. \u000fDeveloped a novel supervised/semi-supervised technique for causal inference using THIN After proposing the novel learning algorithm for signalling ADRs, the fo- cus fell on what would be better, to develop a supervised classi er that is trained on labelled data corresponding to a collection drugs or to apply a semi-supervised algorithm that is trained on both labelled and unlabelled data for the drug being investigated? 187In previous work, [5] and [113], researchers have trained classi ers to signal ADRs using chemical data and known ADRs. It was shown that these tech- niques attained a high recall and precision and the results provided evidence that incorporating knowledge of ADRs into models improves performance. The existing methods for signalling ADRs using LODs are unsupervised and do not incorporate knowledge of existing ADRs. In Chapter 5, two learning algorithm frameworks, that use the attributes derived from the THIN data (described Chapter 4), were presented. The su- pervised technique, the SAP framework, applied a classi er that is trained on labelled data corresponding to various drugs. The semi-supervised tech- nique, the SSAP framework, applied either a self-train random forest or a semi-supervised clustering technique to both the unlabelled and labelled data of a single drug. It was concluded that the SAP framework outper- formed the SSAP self-train and semi-supervised approach and the SAP framework returned consistent results. This was the rst attempted of im- plementing supervised or semi-supervised techniques to infer ADRs using a LOD. The SAP framework consistently returned a low false positive rate, even when the training set was small. As the consuming element of the SAP framework is the training aspect, the SAP framework is highly e\u000ecient once trained and training rarely needs to occur. The SAP framework was also shown to be robust, as it was consistently able to signal ADRs with a low false positive rate over a range of drugs. \u000fEvaluated the SAP framework on the THIN database 188In Chapter 6 the SAP framework was compared with the TPD, ROR, MU- TARA and HUNT methods for a range of drugs using the THIN database. The results con rmed that the SAP framework, using Bradford-Hill causal- ity considerations and THIN speci c attributes and learning from known ADRs, was able to signalled ADRs with a low false positive rate, unlike the existing methods. The SAP framework obtained a greater Average Precision and AUC [09;1]for all the drugs investigated. The current bench- marks, set by the SAP framework, for ADR signalling methods using the THIN database are a MAP of 0 :667, a sensitivity of 0 :354 and a precision of 0:885. These results provided evidence to con rm the second hypothesis, that novel ADR signalling algorithms applied to the THIN database will outperform existing methods if they deal with the hierarchal structures in the THIN database, incorporate causality based attributes and learn from existing ADRs. The SAP framework was able to generate new ADRs signals when it was applied to unlabelled drug-medical event pairs. This supports the third hypothesis. Unfortunately, additional analysis is require to con rm if the signals are true or false. The SAP frameworks ability on the OMOP DOI-HOI standard reference containing ten DOIs and nine HOIs was limited by the training size avail- able. However, the SAP framework's ability to generate ADR signals using the THIN database was comparable to the existing methods ability us- ing the common data model. This is an impressive result as the common data model contains more data, and the SAP framework obtained a lower 189false positive rate than existing methods. The performance of the SAP framework is likely to improve as the training size increases, so the SAP framework is likely to outcompete the existing methods when a larger stan- dard reference set is developed. Therefore, the fourth hypothesis, that the SAP framework will outcompete the existing methods when considering the standard reference, cannot be currently con rmed but the results do provide limited evidence to support it. 7.2 Future Work The areas of research that follow on from this research are now presented. \u000fGenerating attributes for the remaining Bradford-Hill causality considerations In Chapter 4, attributes were developed that cover ve of the nine Bradford- Hill causality considerations. The sixth, analogy, was indirectly incorpo- rated due to using a supervised technique that looks for patterns within ADRs. The remaining considerations are consistency, plausibility and co- herence. Future work could aim to generate new attributes to cover these remaining considerations. Possible suggestions for suitable attributes are, to calculate the strength of association in di erent databases, such as SRS databases, for the consistency factor or to incorporate attributes relating to chemical structure knowledge, such as in [113], for the coherence factor. There are two possible ideas to determine attributes for plausibility. The rst idea is to mine the web, such as medical forums, and identify if the drug-medical event pair have been frequently mentioned as corresponding 190to a possible ADR. In [202], the authors have used text mining techniques to identify ADRs and this idea could be adapted. The second idea is to indirectly tackle plausibility by ruling out other possibilities, this could be done by applying sequential pattern mining and ltering the explainable medical events (medical events that have progress from a prior illness). \u000fCombining the SAP and SSAP frameworks using an ensemble In this research a supervised framework and a semi-supervised framework were proposed in Chapter 5. Four classi ers, support vector machine, ran- dom forest, naive Bayes and logistic regression and two semi-supervised algorithms, self-trained random forest and semi-supervised k-means were applied to the data and analysed. The results showed that the random for- est classi er performed the best, so this was selected and used in Chapter 6, although when the training set was small, the support vector machine classi er performed better. Future would could involved investigating an ensemble technique that uses the prediction of all the learning algorithms developed in Chapter 5 to get a nal aggregated prediction. \u000fQuantifying the ADRs This research has produced a framework that can e\u000eciently and precisely signal ADRs. Using this framework to signal the ADRs, the signalled ADRs could then be investigated and the additional risk of having the medical event due to taking the drug could be determined. This follow up work would add accurate quantitative information to ADRs, something that is currently lacking [171]. 191\u000fIdentifying risk factors corresponding to the ADRs In addition to quantifying the ADRs, the signals could also be investigated to determine risk factors. Possible methods of achieving this would be to apply association rule mining [213] to the patients' sets of medical history for all the patients taking the drug and all the patients taking the drug and experiencing the ADRs, and then identify the rules that occur more frequently in the patients experiencing the ADR. \u000fMake the SAP framework run in realtime The causal based attributes for each drug-medical event pair could be stored such that when new therapy and medical records are added to the database the attributes are updated. The SAP framework could then be applied to determine if the signal status of any drug-medical event pair has changed. The learning model used within the SAP framework could also be re-trained after a su\u000ecient amount of new data is added, and could incorporate new labels as addition ADR knowledge is gained. \u000fRemoving the redundancy in the READ codes The READ code structure has redundancy and there are multiple READ codes for the same medical event. This causes issues when trying to aggre- gate how frequently a medical event occurs after the drug of interest for the same population as the redundancy partitions the medical event and these partitions have smaller frequencies than if they were all grouped together. If future worked aimed to develop an algorithm that could group the READ codes that correspond to the same medical event together, the results of the ADR signalling algorithms on the THIN database would improve. 192\u000fAdapting the framework to identify drug-drug interactions Many researchers have identi ed the requirement of identifying drug-drug interactions ADRs. The THIN databases contains data that may be used to signal drug-drug interaction ADRs and the SAP framework can readily be adapted. Future work could aim to identify when a patient is taking two drugs within a similar time interval and then, for drug A, drug B and medical event 1, generate the attributes developed in Chapter 4 for three di erent prescription situations, the rst would be patients only taking drug A, the second would be for patients only taking drug B and the third would be patients taking both drugs. The three sets of attributes could be combined into one data-point corresponding to drug A, drug B and the medical event 1. 7.3 Dissemination A list of publications that have been the result of this research are listed below. 7.3.1 Journal Papers Submitted \u000fJenna M. Reps, Jonathan M. Garibaldi, Uwe Aickelin, Daniele Soria, Jack E. Gibson and Richard B. Hubbard .A Bradford-Hill causality criteria based side e ect signalling framework . Submitted to IEEE Transactions on Knowledge and Data engineering. Accepted 193\u000fJenna M. Reps, Jonathan M. Garibaldi, Uwe Aickelin, Daniele Soria, Jack E. Gibson and Richard B. Hubbard . Signalling paediatric side e ects using an ensemble of simple study designs. Drug Safety, 2014. \u000fJenna M. Reps, Jonathan M. Garibaldi, Uwe Aickelin, Daniele So- ria, Jack E. Gibson and Richard B. Hubbard .A novel semi-supervised algorithm for rare prescription side e ect discovery . IEEE Journal of Biomed- ical and Health Informatics, 2013. M. Reps, Jonathan M. Garibaldi, Uwe Aickelin, Daniele Soria, Jack E. Gibson and Richard B. Hubbard .Comparison of algorithms that detect drug side e ects using electronic healthcare databases . Soft Computing, 2013. 7.3.2 Conference papers \u000fJenna M. Reps, Jonathan M. Garibaldi, Uwe Aickelin, Daniele Soria, Jack E. Gibson and Richard B. Hubbard .Attributes for causal inference in electronic healthcare databases . In proceedings of the 26th IEEE International Symposium on Computer-Based Medical Systems (CBMS), 2013. \u000fJenna M. Reps, Jonathan M. Garibaldi, Uwe Aickelin, Daniele Soria, Jack E. Gibson and Richard B. Hubbard .Comparing data- mining algorithms developed for longitudinal observational databases . In Proceedings of the 12th Annual Workshop on Computational Intelligence (UKCI), 2012. 194\u000fJenna M. Reps, Jonathan M. Garibaldi, Uwe Aickelin, Daniele Soria, Jack E. Gibson and Richard B. Hubbard .Discovering sequen- tial patterns in a UK general practice database . In proceedings of the 1st IEEE-EMBS International Conference on Biomedical and Health Informat- ics (BHI), 2012. \u000fJenna Reps, Jan Feyereisl, Jonathan M. Garibaldi, Uwe Aickelin, Jack E. Gibson, Richard B. Hubbard .Comparing data-mining algo- rithms developed for longitudinal observational databases . In Proceedings of the 11th Annual Workshop on Computational Intelligence (UKCI), 2011. \u000fFeng Gu, Jan Feyereisl, Robert Oates, Jenna Reps, Green- smith, Uwe Aickelin in the Den- dritic Cell Algorithm . In Proceedings of the 10th International Conference on Arti cial Immune Systems (ICARIS 2011), 2011. 195Appendix A The THIN Database Introduction The THIN database is a longitudinal resource containing temporal medical data corresponding to over 3.5 million active patients and 11.5 million total patients. The data are anonymously extracted from each individual general practice's Vi- sion clinical system, validated and combined to generate the THIN database. The current database is 326Gb and covered 6.05% of the UK in 2012, with over 0.6 billion medical records (i.e., entries detailing an instance of a medical event such as an illness, observation or laboratory event) and approximately 1 billion ther- apy records (i.e., entries detailing an instance of a drug prescription). There is a slightly higher relative proportion of female patients than male patients in the database, with 47.7% of a patients being male and 52.3% being female, whereas the 2011 census suggests the UK population is 49.1% male and 50.9% female. The number of general practices included within the database is expanding over time, with 12 new practices recruited during the rst three quarters of 2013. 196Figure A.1: An entity relationship diagram of the THIN database. The database is also expanding due to recently occurring records from registered practices being added over time. Structure The structure of the main THIN database is illustrated in Figure A.1, there are additional tables not included into the diagram due to them not being incor- porated within this research. The three main tables are the patient table, the therapy table and the medical table, see Figures A.2-A.4. Each patient within the THIN database is represented by a unique anonymous patient id, named the combid, and the patient table contains the attributes of each patient (e.g., their year of birth, their body mass index, their smoking habits, the year they reg- istered and the date of death if they have died). The medical table stores the temporal data regarding the patients' medical events. Each entry in the medical table contains a combid that refers to the patient experiencing the medical event, 197a READ code that corresponds to a medical event and the date that the medical event occurred. The READ codes are there due to database normalisation, but one advantage of using the READ codes rather than string descriptions to repre- sent a medical event is that they have a hierarchical structure that may be useful when applying data analysis. The READ codes and their structure are discussed in greater detail further in thin Chapter. The therapy table contains records regarding drug prescriptions. Each therapy record contains the combid referring to the patient being prescribed the drug, a drugcode corresponding to the drug being prescribed and the prescription date. The drugcode is also introduced due to database normalisation. The drugcode does not have an obvious structure but each drugcode is linked to up to three British National Formulary (BNF) codes corresponding to the main chemical components that make up the drug. The BNF codes do have a hierarchical structure and can be used to identify similar groups of drugs. The BNF codes are also discussed in greater detail in the latter section of this Chapter. READ Codes The READ codes are a clinical terminology thesaurus used for recording medical events within General Practice databases. Each medical event is encoded into a READ code, and the READ code consists of ve elements from the alphabet f1\u00009;a\u0000z;A\u0000Z;\u000fg. The READ codes have a hierarchal tree structure with ve levels. The medical events become more speci c as the level increases, so the child READ codes correspond to the same medical event as their parent READ code but are more speci c. The level of a READ code x=x1x2x3x4x5is calculated 198Figure A.2: A screen shot of the patient table contained within the THIN database. Figure A.3: A screen shot of the therapy table contained within the THIN database. 199Figure A.4: A screen shot of the medical table contained within the THIN database. Figure A.5: An example of the branch of the THIN READ code tree. 200as, Lv(x) =8 >< >:arg minif(i\u00001)jxi=\u000fgif9is.t.xi=\u000f 5 otherwise :(A.1) An example of a branch in the READ codes is, A\u000f\u000f\u000f\u000f Infectious and parasitic diseases (level 1) A1\u000f\u000f\u000f Tuberculosis (level 2) A12\u000f\u000fOther respiratory tuberculosis (level 3) A120\u000fTuberculosis pleurisy (level 4) A1201 Tuberculosis of pleura (level 5) where it can be seen that all the READ codes above are infections and the infec- tion represented by the READ code becomes more detailed as the level increases. A graphical illustration of this section of the READ code tree can be seen in Figure A.5. Unfortunately, the READ codes have redundancies and a single medical event may have multiple corresponding READ codes found in widely varying branches of the READ code tree. This can lead to issues during data analysis as it is di\u000ecult to aggregate the data for the READ codes corresponding to the same medical event, and the partitioning can result in a lower con dence in the results that are obtained. There are also problems with inconsistent READ code usage by medical sta . For example, some sta may frequently enter high level speci c READ codes while others may have a tendency to enter low level READ codes that are less speci c. Furthermore, it is common to nd `temporal READ code progressions', where a low level READ code is initially recorded and shortly in 201Figure A.6: An example of the branch of the British National Formulary (BNF) tree. time afterwards a child or grand-child READ code is recorded due to additional knowledge being obtained. BNF Codes The BNF codes are based on BNF sections. They have a hierarchal tree structure linking drugs that are prescribed for the similar indication (i.e., the reason for being given the drug), and drugs with the same BNF code are from the same drug family. Figure A.6 illustrates a branch of the BNF code tree. If we consider each BNF code to be represented by yi=yi1:yi2:yi3:yi4, where each element is in the alphabetf1\u000015;00g, thenyi1is the primary category, yi2is the secondary category,yi3is the tertiary category and yi4is the quaternary category. There are 15 di erent primary categories, these primary categories relate to the the most general description of the drug indication. The similarity between two BNF codes 202yi1 Category 1 Gastro-intestinal system 2 Cardiovascualar system 3 Respiratory system 4 Central nervous system 5 Infections 6 Endocrine system 7 Obstetrics, gynaecology, and urinary-tract disorders 8 Malignant disease and immunosuppression 9 Nutrition and blood 10 Musculoskeletal and joint diseases 11 Eye 12 Ear, nose, and oropharynx 13 Skin 14 Immunological products and vaccines 15 Anaesthesia can be calculated as, S(yi;yj) =jfyikjyik=yjkgj max(jfkjyik6= 00gj;jfkjyjk6= 00gj)(A.2) where the similarity measure is 1 if and only if the two BNF codes are the same, and greater than zero if and only if the BNF codes correspond to drugs prescribed for a similar indication. Issues & Validation There are known issues with the database including concept drift and problems with the level of time stamp detail. In general, the data is validated during extraction and additional elds are added into the tables to indicate the integrety of each record, so problematic records can be excluded from the study. 203Data Collection Issues One of the main limitations of the THIN data is changes in the way data is collected or the type of data collected over time may lead to concept drift. Over time the READ codes that are actively used may change, new READ codes may get added and old READ codes may be removed. For example, it is common for old records to contain the READ code 'ZZZZZ' corresponding to an unmappable medical event. The drug prescription rate is unlikely to stay constant over time, as new knoweldge of suspected ADRs or new studies detailing the e ectiveness of a drug can impact a General Practioneers decision to prescribed a drug. It is also common for new drugs to be introduced. Time Stamps Each record in the medical and therapy table contains a time stamp. These time stamps are the day that the doctors entered the event of prescription into the database. As the time stamp is only in days, it is not possible to determine the order for the medical events and prescriptions within one day. When a medical event and prescription are recordered for the same paient on the same day it may be possible that the patient was prescribed the medication due to the medical event or that the medical event is an adverse drug reaction of the medication. To address the uncertainty of the order of events with the same timestamp for the same patient, the medical events recorded on the day a drug is prescribed are often ignorred from the calculation of assocation between a drug and medical event. 204Appendix B Drugs Drugs Investigated NSAIDs The drugs Ibuprofen, Ketoprofen, Fenoprofen and Celecoxib used in this study are all from the same drug family known as non-steroidal anti-in ammatory drugs (NSAIDs). These drugs are typically prescribed for continuous pain associated with in ammation and have a variety of common side e ects including gastroin- testinal disturbances, hypersensitivity reactions and depression. Rarer side ef- fects include congestive heart failure, renal failure and hepatic failure. Elderly patients are more prone to side e ects associated with NSAIDs. In this study the the drugs tended to be prescribed sightly more to females with the male propor- tion ranging from 0 :335\u00000:405 and to older patients, although Ibuprofen was prescribed to younger patients more than the other NSAID drugs. The NSAID drug prescribed the most was Ibuprofen with over a million rst in 13 month 205Table B.1: Information about the NSAID drugs investigated in this paper. Total is the number of times the drug is prescribed for the rst time in 13 months, age is the average age of the patients who are prescribed the drug for the rst time in 13 months and male proportion is the number of patients that are male divided by the total number of patients who are prescribed the drug for the rst time in 13 months. Drug Total TPD MUTARA ROR was only prescribed 1225 times for the rst time in 13 months, see Table B.1. Quinolones The quinolones are a class of drugs used to treat bacterial infections such as res- piratory track are drugs from the quinolone family that are investigated in this paper. The quinolones have many side e ects, includ- ing tendon rupture. The average age of the patients prescribed the quinolones for the rst time in 13 months was similar between all the drugs, around the late fties. The male proportion shows that females are prescribed quinolones more than males, but this was more obvious for nor oxacin and nalidixic acid. Cipro oxacin was the most prescribed quinolone and moxi oxacin was the least common, with only 1465 prescriptions. Table B.2 shows the information on the drugs from the THIN database. 206Table B.2: Information about the Quinolone drugs investigated in this paper. Total is the number of times the drug is prescribed for the rst time in 13 months, age is the average age of the patients who are prescribed the drug for the rst time in 13 months and male proportion is the number of patients that are male divided by the total number of patients who are prescribed the drug for the rst time in 13 months. Drug Total TPD MUTARA ROR about the tricyclic drugs investigated in this paper. Total is the number of times the drug is prescribed for the rst time in 13 months, age is the average age of the patients who are prescribed the drug for the rst time in 13 months and male proportion is the number of patients that are male divided by the total number of patients who are prescribed the drug for the rst time in 13 months. Drug Total TPD MUTARA ROR Age are a family of drugs used to treat depression and are known to cause, among others, cardiovascular and central nervous system side e ects. The three drugs, doxepin, lofepramine and nortriptyline where selected in this paper. The tricyclic antidepressants investigated are prescribed to patients with similar ages and genders and tend to be prescribed more often to older females. The main di erence between the drugs is that doxepin is only prescribed to 6752 patients whereas the other two drugs are prescribed to more than 10000 patients, see Table B.3. 207Table B.4: Information about the calcium channel blocker drugs investigated in this paper. Total is the number of times the drug is prescribed for the rst time in 13 months, age is the average age of the patients who are prescribed the drug for the rst time in 13 months and male proportion is the number of patients that are male divided by the total number of patients who are prescribed the drug for the rst time in 13 months. Drug Total TPD MUTARA ROR felodipine and verapamil are all calcium channel blocker that are used to treat high blood pressure and raynaud's phenomenon. It is common for the calcium channel blockers to be prescribed with other drugs and applying the existing algorithms to detect side e ects on the calcium channel blockers will investigate the e ect of confounding due to multiple prescriptions. The drug ni dipine was previously used to investigate the TPD applied to the UK IMA Disease Analyzer, so investigating the calcium channel blockers will also give insight into how robust the TPD is when applied to di erent electronic healthcare databases. The calcium channel blockers are generally prescribed for the rst time in 13 months to patients around 65 years old. Amlodipine and nicardipine are prescribed only slightly more to females than males, whereas the other calcium channel blockers investigated are prescribed even more often to females. Amlodipine and nifedipine have been prescribed over 100000 times for the rst time in 13 months in the THIN database, but nicardipine has only been prescribed 2796 times, see Table B.4. 208Table B.5: Information about the sulphonylurea drugs investigated in this paper. Total is the number of times the drug is prescribed for the rst time in 13 months, age is the average age of the patients who are prescribed the drug for the rst time in 13 months and male proportion is the number of patients that are male divided by the total number of patients who are prescribed the drug for the rst time in 13 months. Drug Total TPD MUTARA ROR and glipizide. They are a class of antidiabetic drugs used for the management of type 2 diabetes mellitus. The sulphonylureas are prescribed for the rst time in 13 months to older patients will an average age around 65 years old and all the sulphoylureas investigated except tolbutamide are prescribed more often to males, with approximately equal male proportions. Glipizide and tolbu- tamide are the less frequently prescribed sulphonylurea drugs. The general infor- mation about each of the sulphonylurea drugs can be seen in Table B.5. Penicillins The last drug family is the Penicillin drugs amoxicillin, ampicillin, ucloxacillin, benzylpenicillin and phenoxymethlypenicillin. These drugs are used to treat bac- terial infections. The number of times the drugs are recorded as being prescribed in the THIN database varies between 2000 to over two million. There is also a divergence between the average age of the patients prescribed each of the drugs, 209Table B.6: Information about the penicillin drugs investigated in this paper. Total is the number of times the drug is prescribed for the rst time in 13 months, age is the average age of the patients who are prescribed the drug for the rst time in 13 months and male proportion is the number of patients that are male divided by the total number of patients who are prescribed the drug for the rst time in 13 months. Drug Total TPD MUTARA ROR generally being prescribed to younger patients than many of the other drugs families investigated in this paper. The male proportion is fairly similar between the di erent penicillin drugs, with females being prescribed the drug more often than males, see Table B.6. 210Appendix C Software Details and Preliminary Work C.1 Software Details The data were stored in MS SQL server and the data manipulation (generation of the Bradford Hill causality consideration attributes) was performed using SQL. The classi cation was performed using the function `train' and the feature se- lection used to pre-process the data prior to classi cation for all the classi ers expect random forest was the function `rfe' within the `caret' package [97] in the open source software R. The `rfe' function found the subset of attributes that maximised the accuracy of the classi cation. The `train' function trained the various classi ers based on maximising the AUC performance measure using a parameter grid search. 211C.2 Wrapper Feature Selection Table C.1: The features selected and their rank of importance based on applying naive Bayes wrapper for the analysis performed in Chapter 5. Attribute Nifedipine Cipro oxacin Ibuprofen Subset 5 5 LEOPARD ( 5 5 4 (30) 212C.3 Preliminary Work The following is extracted from my conference paper title `Attributes for causal inference in longitudinal observational databases': Feature Selection In this study we apply a multivariate lter, the Correlation-based Feature Se- lection (CFS) algorithm algorithm is not a speci c classi er. The CFS algorithm nds the optimal feature subset based on the trade-o between how correlated the class labels are to the feature subset and how intercorrelated the features of the subset are. The feature selection was applied to the attributes descirbed in Tables C.2-C.3. The data used in this study are extracted from The Health Improvement Network database (www.thin-uk.com) and can be found at: http://www.ima.ac.uk/reps. Results Table C.4 shows that the optimal attribute subset to use for ADR discovery is LEOPARD, RD 13BNF, ABratio Level 3, Gender Ratio and Read Code Level. The temporal and strength attributes had the greatest correlation with the class labels, whereas 75% of the dosage attributes has a zero correlation measure. Discussion The results show that the temporal and strength attributes are key for signalling ADRs as these had the highest correlation with the class labels but the speci city attributes Gender Ratio and Read Code level o ered potentially new in sight than 213Table C.2: Attribute Summary Table Feature Criterion Description RR, RD, OR Strength The Risk Ratio, Risk Di erence and Odds Ratio for all prescriptions. RR13d,RD 13d,OR 13dStrength The Risk Ratio, Risk Di erence and Odds Ratio for drugs prescribed for the rst time in 13 months. RR13BNF,RD 13BNF ,OR 13BNFStrength The Risk Ratio, Risk Di erence and Odds Ratio for drugs corresponding to a bnf that has not been prescribed in the last 13 months. IC\u0001 Strength The TPD Information Component as calculated in [128] lowerIC \u0001 Strength The lower 95% interval of the tion Component as calculated in [128] Age STDEV Speci city Standard deviation of patient's age who experience medical event after drug di- vided by standard deviation of the ages for all the patients. Gender Ratio Speci city Male proportion of patients experiencing the medical event within 30 days of the drug divided by male proportion of pa- tients prescribed the drug. RR drug / RR bnf Speci city The RR of the drug divided by the RR for all the drugs in the same family. Read Code Level Speci city The speci city level of the medical event: general (level 1)- speci c (level 5). ABratio Level 2 Temporality How often the level 2 version of the med- ical event is recorded after the prescrip- tion compared to before. ABratio Level 3 Temporality How often the level 3 version of the med- ical event is recorded after the prescrip- tion compared to before. LEOPARD [161] Temporality 1 if the drug is prescribed signi cantly more after the medical event than before, 0 otherwise. OEfilt1[128] Temporality 1 if the IC \u0001is greater the month before the drug than the month after, 0 other- wise. OEfilt2[128] Temporality 1 if the IC \u0001is greater on the day of pre- scription compared to the month after, 0 otherwise. 214Table C.3: Attribute Summary Table Feature Criterion Description Dosage Ratio Dosage Average dosage of patients experiencing the medical event within 30 days of the drug divided by average dosage of pa- tients prescribed the drug. High Low Ratio Dosage Proportion of patients given the high- est dosage that experience the medical event (within 30 days) divided by the proportion of patients given the lowest dosage that experience the medical event (within 30 days). Spearman's rank Dosage The Spearman's rank correlation coef- cient between the patient dosage and f0;1gindicating if the patient experi- enced the medical event within 30 days. Pearson product- momentDosage The Pearson product-moment correla- tion dosage andf0;1gindicating if the pa- tient experienced the medical event within 30 days. Repeat 1 Experiment Number of patients that have medical event in at least two distinct hazard peri- ods and not in their non-hazard periods divided by the number of patients that have at least two distinct hazard periods and have medical event in one hazard pe- riod. Repeat 2 Experiment Number of patients that have medical event in two distinct hazard periods and not in their non-hazard periods divided by the occurrence in the non-hazard pe- riods. 215available via the temporal and strength attributes. The experiment and dosage attributes investigated in this paper did not o er su\u000ecient additional information than what could be gained from the RD 13BNF or the LEOPARD attributes, although there does appear to be some correlation between the class labels and both the Pearson's correlation rank attribute and the Repeats attributes. The reason the dosage attributes did not have a greater correlation with the class labels may be due to a limiting factor of comparing di erent measurement types. The dosages can be recorded via di erent measurement types for exam- ple `mg', `%', `mm x cm xcm' or the measure type may be missing. As it is di\u000ecult to determine if xquantity of `mg' is greater than yquantity of '%', the dosage attributes were calculated only considering prescriptions measured in `mg' (as this was the most popular). Unfortunately this resulted in occasional issues due to `mg' measured prescriptions of some drugs investigated always being the same quantity or many prescriptions of a drug not being included in the dosage attribute calculations. The experiment attributes were also limited if the drug investigated was rarely repeated. Furthermore, the experiment attributes may have been biased in this study due to using known ADRs, as if an ADR is known and a patient experiences the ADR after the drug then the doctor is likely to no- tice this and not prescribed the drug to that patient in the future. One possible way to overcome this issue would be to use only newly discovered ADRs in the data as the medical records may be more likely to have patients, who at the time unknowingly experienced the ADRs, having a repeat prescription. 216Table C.4: The results of the CFS algorithm ordered by the measure of correlation with the class labels. Attributes not selected by the CFS algorithm have the attribute they are most correlated to listed in the CFS rank column. Attribute Class Correlation CFS Rank LEOPARD Gender Ratio 0.0663 4 Repeats 1 0.0651 LEOPARD Repeats 2 0.0651 LEOPARD 0.0608 RD 13BNF Read Code Lv 0.0279 5 RRDrug/RRBNF 0 - Dosage Ratio 0 - High Low Ratio 0 - Age STDEV 0 - Spearman's' rank 0 - 217Conclusion In this paper we have applied feature selection to attributes we generated based on the Bradford Hill causality criteria to determine suitable attributes to be used by a general learning algorithm to identify side e ects in LODs. This is the rst time suitable attributes for identifying causal relations between prescribed drugs and medical events have been explored and the results now present the opportunity to develop novel learning algorithms. We have found that the speci city attributes o er additional information for ADR signalling and it would be advantageous to include them into ADR signalling algorithms. Unfortunately the experiment and dosage attributes were not very correlated with the class labels but this is likely to be due to current limitations. Possible future work could focus on developing a way to compare prescriptions with di erent measurement types so all the prescription data can be used for calculating the dosage attributes or involve developing attributes that cover the remaining Bradford Hill causality criteria (plausibility, coherence, consistency and analogy). 218Appendix D SAP Result Tables ADR Signalling Framework Results The signals generated by the SAP framework on the unlabelled data for the drugs Nifedipine, Cipro oxacin, Ibuprofen, N131. Cervicalgia - neck 3659 D00.. Upper respiratory infection NOS 6865 M0z.. ed NOS 5167 M12z1 Eczema NOS 2785 16C6. Back pain without 2385 2.... Examination / Signs 2845 R021z [D]Rash and other c skin 2792 N142. Blocked ear 994 2202D82. O/E - wax in auditory canal 1939 892.. Informed consent for procedure 1976 M03z0 Cellulitis NOS 2326 856.. 347 ZV681 [V]Issue of repeat prescription 2994 8BMC. Prescription collected by 1922. Sore mouth 476 H02.. Acute pharyngitis 1055 8C1B. Nursing care blood sample M0... Skin and tissue infections 963 8CA.. Patient given advice 5746 E2B.. rectal examination done 484 22L.. O/E - wound healing 325 H26.. Pneumonia due to organism relief 1455 F502z Otitis externa NOS 1962 1J4.. UTI 1551 History / symptoms 1610 1C... Ear/nose/throat symptoms 287 58D.. Ultrasound scan 259 AB01. Dermatophytosis of nail 939 M07z. Local infection skin/subcut tissue J43.. Other 2128. Patient's 5198 F1310 Benign essential tremor 91 2227. O/E - rash present 836 8C9.. Reassurance given 671 A781. Viral warts 420 J50zz Intestinal obstruction NOS 134 C2621 Vitamin B12 de ciency 323 8H9.. Planned advice 1570 73050 Irrigation of external auditory canal for removal of wax9722 8B21. Drug prescription 637 2315. Resp. H060. 2569 19EA. Change in bowel habit 812 8P... Removal of surgical material and sutures 230 M230. Ingrowing nail 521 E112. Single major R0040 [D]Dizziness 2585 7G223 Oral aphthae 645 2241C8.. Nasal symptoms OS 301 NEC 20 19FZ. Diarrhoea symptom NOS 374 ed limb present 440 H17.. Allergic 504 M12.. Contact dermatitis and other eczemas 316 2D... Ear, nose + throat examination 610 5882. Spirometry 386 M036z Cellulitis and abscess of leg 8H21. Admit emergency unsp. 470 68M.. Spirometry screening 381 70560 Carpal tunnel for microbiological test Eu32z [X]Depressive episode, unspeci 294 225J1544 Helicobacter gastritis 15 ZGB62 Advice about side e drug treatment 55 M05.. Impetigo 242 2G5.. O/E - foot 5012 ZGB64 [D]Glucose, level abnormal 318 F4Kz1 Eye pain NOS 522 Z1B13 Change of dressing 348 6A... Patient reviewed 360 G3111 Unstable 329 8B41. Repeated prescription 6599 N30z8 Bone infection NOS, of other speci ed site 70 2268B3A2 Medication decreased 1337 N0946 Arthralgia 624 E2003 Anxiety Supraventricular tachycardia NOS Abscess NOS 157 Left ventricular failure NOS 182 8C1.. care tachycardia 57 1424 thirst 36 ZV700 [V]Routine checkup Problem situation 238 E2C01 Anger reaction 10 168.. Tiredness symptom 1848 J521. Irritable colon - Irritable bowel syndrome 848 5.... Radiology/physics in medicine 706 F504. Impacted cerumen (wax in 2278HQ2. Refer for ultrasound investign 403 8B24. Prescription given no examination of patient 907 SD... Super cial injury 446 7L143 Intravenous blood transfusion NEC 303 ZV411 [V]Other eye problems 420 AB200 Candidiasis of mouth 445 1B1X. Behavioural problem 3 ZGB17 Advice to stop treatment 18 8B316 Medication changed 2761 ZGB67 Advice about drug dosage 208 4JK21 High vaginal swab culture negative 7 H170. Allergic rhinitis due to skin/subc infection NOS 646 ZV720 [V]Examination of eyes and vision 114 R1320 [D]Echocardiogram 28 G83.. Varicose veins of the legs 752 7K6Z2 Injection of therapeutic substance into joint 372 2281B5.. Incoordination symptom 2893 AB20. Candidiasis of A7814 Plain NOS 282 Z1823 Chaperone refused 44 N135z Torticollis NOS 71 195.. Indigestion symptoms 365 1M... Pain 634 M12z2 Infected eczema 186 7G2E3 Dressing of skin NEC 731 1BT.. Depressed mood 908 S64.. Intracranial injury NOS 290 196.. Type of GIT pain 437 Table D.1: The medical events signalled by the SAP framework with the random forest classi er for the drug Nifedipine. The medical events are ranked by the con dence returned by the classi er for the medical event belonging to the ADR class. Cipro oxacin Read Code Medical Event Frequency 1BT.. Depressed mood 625 2227. O/E - rash present 329 E2B.. Depressive disorder NEC 779 229A53.. Herpes zoster 364 892.. consent for procedure 2861 66R5. Rep.presc. treatment changed 515 C04.. R021z [D]Rash and other nonspeci c F4430 9 8C1B. Nursing care blood sample taken 3263 E2741 Transient insomnia 164 81H.. Dressing of wound 4336 Constipation NOS 433 testing 3209 R021. [D]Rash and other nonspeci c skin eruption 176 260 ventricular systolic Muscle injury / strain 46 2127. Patient's condition worsened 1099 8B311 Medication given 2556 1D13. a pain 1931 8H77. Refer to physiotherapist 602 G580. Congestive heart failure 542 8B313 Medication commenced 929 Z1B13 Change of dressing 247 Z1K13 Removal of suture from skin 15 Z4G1B Giving encouragement to continue treatment 7 M18z. Pruritus NOS 576 8H9.. Planned telephone contact 581 E112. Single major depressive episode 87 Eu32z [X]Depressive episode, ed 356 ZV681 [V]Issue of K2710 397 conduction studies 18 8BAA. Pain relief 782 R0300 [D]Appetite loss 88 8C15. Nursing care - dressing 981 681.. Screening - general 905 771Qz Diagnostic rigid sigmoidoscopic exam of sigmoid colon NOS134 Resp. system examined NAD 988 N2470 Swelling of limb 328 AB200 Candidiasis of mouth 501 1B13. Anxiousness 700 313B. Audiogram 86 ZZZZZ converted code 4445 1982. Nausea present 428 1M10. Knee pain 685 7C032 Unilateral total orchidectomy - unspeci 39 8C1.. Nursing care 1124 Dehydration NEC 90 1B5.. 423.. Haemoglobin estimation 70 AB220 Candidal balanitis 67 2841. Confused 434 8B3A3 New medication R0420 [D]Swelling head or Panic disorder 192 ZL233 Under care of district nurse 55 H17.. Allergic rhinitis 158 8B316 Medication changed 727 G581. Left ventricular failure 318 E2003 Anxiety with depression 254 41D0. Blood sample taken 1984 233R0073 [D]Lethargy 157 4 N2174 Achilles Intramuscular injection of vitamin 7G2A6 of hormone implant 54 J4101 Ulcerative colitis 103 C3661 Fluid retention 94 S6460 Minor head injury 6 A3B11 Meticillin resistant staphylococcus M1616 [SO]Epididymis 31 8H4B. Referred Screening 724 8H76. Refer to dietician 150 ZV700 [V]Routine health checkup 48 R1057 [D]Glucose, blood Malignant pleural e 15 R1100 [D]Albuminuria 27 Z174L Skin care 36 J50zz Intestinal obstruction NOS 102 C11y3 Impaired fasting glycaemia 45 44120 Urea and electrolytes compression bandage for skin ulcer 31 Table D.2: The medical events signalled by the SAP framework with the random forest classi er for the drug Cipro oxacin. The medical events are ranked by the con dence returned by the classi er for the medical event belonging to the ADR class. Ibuprofen Read Code Medical Event Frequency D00.. Iron de ciency anaemias 1876 198.. Nausea 3084 not speci ed exam. - Asthma 3253 and subcut tissue infection NOS 599 K190. Urinary tract infection, site not speci ed 4806 H06z0 Chest infection NOS 17499 1D14. C/O: a rash 6155 1982. Nausea present 987 168.. Tiredness symptom 2937 535.. Standard chest X-ray 1465 R090. sinus disease NOS 907 ed accident unspeci ed 919 ZV720 [V]Examination of eyes and vision 147 8C1.. Nursing care 4083 8C15. Nursing care - dressing 2028 1AG.. Recurrent urinary tract infections 500 196.. Type of pain 984 1737. Wheezing 1553 181.. Palpitations 1860 413.. Laboratory test requested 7598 1B321 Weakness of leg 177 8C1L. Wound care 884 23... Examn. of respiratory system 1535 ZV681 [V]Issue of repeat prescription 3691 81H5. 8B41. Repeated prescription 6877 R021. [D]Rash and other nonspeci Otitis 1Y... Patient feels well 2684 AB20. Candidiasis of mouth and 6A... Patient 1255 1739. bursitis 919 of removal of wax9848 A07y0 Viral gastroenteritis 355 8HQ2. Refer 1D13. C/O: a pain 12907 8C1B. Eye symptoms 1863 Informed 3444 TGyz3 Accidental injury NOS 70 D41yz Other speci ed disease of blood or blood forming organ NOS148 1D131 C/O - pain in hallux 212.. Patient examined 3042 7G2B1 Injection of therapeutic substance into skin 183 41D0. Blood sample taken 8004 2128. Patient's condition the same 14124 N30z8 Bone infection NOS, of other speci ed site Acute myocardial 7L172 Refer to chiropodist 941 7G251 Drainage of lesion NEC 189 H00.. Acute nasopharyngitis 1627 ZL146 R0052 [D]Insomnia NOS 246.. pressure reading Refer for 7376 F4Kz4 of eye NOS 282 ZV583 [V]Attention to or 7L171 ed organism 489 19FZ. Diarrhoea symptom NOS 728 677B. Spasm of muscle Panic disorder 933 1954. Indigestion 1326 4617. MSU = abnormal 173 ZGB62 Advice about side e ects of drug treatment Postoperative N2241 Ganglion of joint 115 R082. of urine Shoulder NOS 1898 ciency Converted code 21209 1A7.. Vaginal discharge symptom 1047 585.. Other diagnostic ultrasound 4618. Urine dipstick test 704A0 Therapeutic Otorrhoea Corns NOS 127 243Table D.3: The medical events signalled by the SAP framework with the random forest classi er for the drug Ibuprofen. The medical events are ranked by the con dence returned by the classi er for the medical event belonging to the ADR class. 244Budesonide Read Code Medical Event Frequency R090. [D]Abdominal pain 1436 K190z Urinary tract infection, site N245. Pain in limb 5360 1A1.. Micturition frequency 892 892.. Informed consent for procedure 1286 D00.. Iron de ciency anaemias 670 413.. N142. Pain in lumbar spine 2397 1B8.. Eye symptoms 875 1B8Z. Eye symptom NOS 352 1M10. Knee pain 1999 N131. Cervicalgia - pain in neck 2365 Z4A.. Discussion tract falls 1528 R021z 1407 8H77. Refer to physiotherapist 1176 given no examination of patient 524 [V]Attention to surgical dressings or sutures 233 M12z0 16C6. Back 81H.. Dressing of wound 3827 M07z. Local 1133 canal 762 8H9.. Planned telephone contact 664 E2001 Panic disorder 432 7L172 Blood withdrawal for testing 6199 8C1B. Nursing care digit NOS 254 review 273 8B41. Repeated prescription 3431 22J.. O/E - dead 1112 J155. hip 1182 symptom 314 M2yz. Other skin and subcutaneous Anxiety states NOS 471 677B. Advice given 2990 2126. Patient's H06z0 Chest Heartburn 634 8C1.. Nursing care 1349 7G22. Removal of repair material from skin 668 G20.. Essential hypertension 2258 N0945 Arthralgia of the pelvic region and thigh 519 M12.. Contact dermatitis and other eczemas 223 1C3.. M12z1 Eczema NOS 2033 424.. Full blood count - FBC 451 1C9.. Sore throat symptom 3604 2488C15. Nursing care - dressing 771 7.... Operations, procedures, sites 259 ZV725 [V]Radiological examination NEC 63 22L.. O/E - wound healing 8E... Physiotherapy/remedial therapy 1413 58D.. Ultrasound scan 205 8BAA. Pain relief 890 1.... History / symptoms 1628 8BI.. medication J0931 Coated tongue 33 R0734 [D]Bloating 71 16Z3. Recurrence of problem 499 Z1B.. Dressing of skin or wound 252 N2132 Lateral epicondylitis of the elbow 570 J5730 Rectal haemorrhage 516 J521. Irritable colon - Irritable bowel syndrome 787 4131. Blood test requested 1374 73050 Irrigation of external auditory canal for F301z Trigeminal 2128. using questions 5625 6A2.. Coronary heart disease annual review 758 K20.. Benign prostatic hypertrophy 390 N094. Pain M03z. Cellulitis and abscess NOS 339 N2470 Swelling of limb 362 TJ... Drugs and other substances-adverse e ects in theraputic use281 1A53. Lumbar ache - renal 405 F4Kz1 Eye pain NOS 207 7K36. Diagnostic arthroscopy of knee 129 2508B21. Drug prescription 309 Balanoposthitis 98 J0854 2G5.. mouth 1042 33C.. Circulatory function tests 274 67E.. Foreign travel advice 1578 32... Electrocardiography 789 4.... Laboratory procedures 521 M180. 308 Eustachian tube dysfunction eruption 364 M2400 Alopecia unspeci ed 100 246.. O/E - blood pressure reading 1966 J64.. Cholelithiasis 249 16ZZ. General symptom NOS 377 F340. Carpal tunnel syndrome 399 2D... Ear, nose + throat examination 659 41B1. Blood test due 1127 2517M07z Cryotherapy to organ NOC NOS 184 46... Urine examination 294 R0103 [D]Tremor NOS 201 SE... Contusion (bruise) with K4211 Vulvitis unspeci N2133 Olecranon bursitis 256 E2003 Anxiety N2410 Myalgia unspeci ed 527 and anus 231 J0250 Dental Foot pain 349 8H4B. Referred to rheumatologist 239 8H5B. Referred to Arthralgia 255 15C.. Vaginal irritation F504. Impacted cerumen (wax in ear) NEC 28 F52z. Otitis media NOS 1426 8CAK. Patient given telephone advice out of hours 570 R0904 [D]Abdominal cramps 43 893.. Post operative monitoring 130 J10y4 Oesopheal re ux without mention of oesophagi- tis1108 535.. Standard chest X-ray 914 1J... Suspected condition 651 Z1B13 Change of dressing 191 patient 199 2127. Patient's condition worsened 927 N2452 Pain in leg 656 Table D.4: The medical events signalled by the SAP framework with the random forest classi er for the drug Budesonide. The medical events are ranked by the con dence returned by the classi er for the medical event belonging to the ADR class. 253Naproxen Read Code Medical Event Frequency E2B.. Depressive disorder NEC not 1507 1C9.. Sore throat symptom 1707 R021z [D]Rash and other nonspeci c skin eruption NOS 1034 1BT.. Depressed mood 858 535.. Standard chest X-ray 797 413.. Laboratory test requested 3664 461.. Urine exam. - general 445 892.. Informed consent for procedure 1173 Z4A.. Discussion 2371 H05z. Upper respiratory infection NOS 372 590 rash present 337 7L17. Blood withdrawal 4328 H1y1z Nasal cavity and sinus disease NOS 286 1Z... History/symptom NOS 632 1CA2. Hoarse 172 16E.. Feels unwell 411 7G22. Removal of repair material from skin 497 8B4.. Previous treatment continue 2945 662.. Cardiac disease monitoring 5045 255R0608 [D]Shortness of breath 556 G20.. Essential hypertension 2348 8H76. Refer to dietician 199 G66.. Stroke and cerebrovascular accident unspeci ed 232 H06z1 Lower resp tract infection 867 SP255 Postoperative wound infection, unspeci ed 278 1982. Nausea present 232 761Fz Diagnostic breoptic endoscopic exam upper GI withdrawal for 5052 1737. Sore mouth 196 8C1.. Nursing 721 8C17. Nursing care - injections 388 M05.. Impetigo 226 196.. Type of GIT pain 184 F4D0. Blepharitis 318 19EA. Change in bowel habit 234 E2273 Impotence 628 M180. Pruritus ani 243 2561739. Shortness of breath 571 22L.. O/E - wound healing 147 2516. Abdomen examined - NAD 326 J1011 Re 166 ZV681 [V]Issue of repeat prescription 1485 E2001 Panic disorder care - dressing 539 M0... Skin and subcutaneous tissue infections 488 F4Kz1 Eye 160 G3111 Unstable angina 24 R060A [D]Dyspnoea 233 M2yz. Other skin reviewed 21724 D00y1 UTI 702 K28y6 75 23... Examn. of respiratory system 272 7G2E3 Dressing of skin NEC 263 8BI.. Other medication review 301 1972. Epigastric pain 800 4.... Laboratory procedures 342 R0701 [D]Vomiting 38 41D0. Blood sample taken 3007 7C242 Standard circumcision 33 8CA.. Patient given advice 2562 4142. Blood sample -> Haematol Lab 426 1Y... Patient feels well 765 E112. Single major depressive episode 107 ZV583 [V]Attention to surgical dressings or sutures 149 G5y34 Ventricular hypertrophy 19 73050 Irrigation of external auditory canal for removal of wax2577 7L064 Amputation below knee 4 J3030 Unilateral inguinal 56 8H5B. Referred 677B. Advice about treatment given 1684 Eu431 [X]Post - traumatic stress disorder 31 7P051 Ultrasound of abdomen 31 2126. Patient's condition improved 6857 8CAL. Smoking cessation advice 1621 Converted code 4290 Subcutaneous injection of M15y1 Obstructive medical 115 F587. 510 44121 and electrolytes abnormal abdomen 12 8B42. Previous treatment repeat 1333 8B24. Prescription given no examination of patient 293 1B8Z. Eye symptom NOS 274 7701z Other excision of appendix NOS 26 SK160 Other hip injuries 31 259M111. Atopic dermatitis/eczema 444 ZL233 Under care of district nurse 20 2841. Confused 203 7G2E. Dressing of skin or wound 324 [D]Cough Non-pressure ulcer 4131. Blood test requested 969 R0822 [D]Acute retention of urine 13 G65.. Transient cerebral ischaemia 282 79360 Implantation of intravenous cardiac pacemaker system15 8H7R. Refer to chiropodist 260 1968. cate - oedema of ankles 434 2G5.. O/E - foot 920 2601B321 Weakness of leg 33 M270. Decubitus (pressure) Nocturnal cough / wheeze 94 7NB13 [SO]Lower leg NEC 98 7G2EA Two layer compression bandage for skin ulcer 14 R021. [D]Rash and other nonspeci c skin eruption 172 M0z.. Skin and subcut tissue infection NOS 149 7G251 Drainage of lesion of skin NEC 58 G3071 Acute non-ST segment in- 2128. Patient's condition the same 3954 7G2E1 Dressing of burnt skin NEC 44 H03.. Acute tonsillitis 544 8HB2. Medical follow-up 851 261J50zz for X-Ray 2396 7G033 Excision of lesion of skin NEC 146 Eu32z [X]Depressive episode, unspeci ed 488 N094M Arthralgia F4E51 Xanthelasma 28 ZGB66 pylori gastrointestinal tract infec- tion10 17 K10y0 Pyelonephritis unspeci ed 14 G831. Varicose veins of the leg with eczema 315 1.... History / symptoms 695 761F1 Diagnostic gastroscopy NEC 74 44120 Urea and electrolytes normal 68 7G223 Removal of suture from skin NEC 262782Gz Diagnostic retrograde exam vertigo or nystag- mus232 8CA40 Pt advised re wt reducing nger injuries, Ryu8A NEC 16 R0102 [D]Spasms NOS 14 F4005 Eye infection 11 1C14. Blocked ear 325 R082. [D]Retention of urine C2621 Vitamin B12 de ciency 103 G57y7 Sinus 12 2638C9.. Reassurance given 291 761Fy Diagnostic breoptic endoscopic exam upper GI tract OS15 R0043 [D]Vertigo NOS 534 Z4G1B Giving encouragement to continue treatment 23 7M05z Laser therapy to organ NOC NOS 11 8B3A1 Medication increased 956 Z1K13 Removal of suture from skin 22 ZV57C [V]Palliative care 84 SD... Super cial injury 202 TE640 Insect bite NOS 130 246.. O/E - blood pressure reading 2878 M0212 Paronychia cholecystectomy 63 3 7M371 Radiotherapy NEC 145 SN52. Drug hypersensitivity NOS 78 19FZ. symptom NOS 140 O/E wax in Intermittent claudication Monitoring of 91 2641AG.. Recurrent urinary tract infections 107 2127. Patient's condition worsened 861 R090z [D]Abdominal pain NOS 39 ZL146 Under care of deputising GP 34 R0904 [D]Abdominal cramps 27 68... Screening 1200 N2470 Swelling of limb 342 ZV49z [V]Unspeci ed limb or problem 72550 theraputic use422 H33zz Asthma NOS 26 R0720 [D]Di\u000eculty Congestive heart 368 7M0G1 Aspiration of other lesion of organ NOC 20 Z1745 Ear care 19 M01.. Furuncle - boil 225 679.. Health education - subject 188 F4Ey4 Cyst of eyelid NOS 20 7717z Other excision of colon NOS 8 Z174O Post-surgical wound care 16 N0810 Loose body in joint, unspeci ed joint 19 K272z Other penile in ammatory disorder NOS 5 M1271 Sunburn 39 8HB20 Medical follow-up - normal 69 G20z. Essential hypertension NOS Local 8BA.. Other misc. therapy 174 7920y Saphenous vein graft replacement of coronary artery OS7 Table D.5: The medical events signalled by the SAP framework with the random forest classi er for the drug Naproxen. The medical events are ranked by the con dence returned by the classi er for the medical event belonging to the ADR class. 267References [1] J. Almeno , J. M. Tonning, A. L. Gould, and et al. Perspectives on the use of data mining in pharmacovigilance. Drug Safety , 28(11):981{1007, 2005. 14, 21 [2] E. Alpaydin. Introduction to machine learning . MIT press, 2004. 53 [3] Y. Alvarez, A. Hidalgo, F. Maignen, and J. Slattery. Validation of statisti- cal signal detection procedures in EudraVigilance post-authorization data. Drug Safety , 33(6):475{487, 2010. \u0010nez, I. Garc\u0013 F. Casacuberta. On the use of di erent loss functions in statistical pattern recognition ap- plied to machine translation. Pattern Recognition Letters , 29(8):1072{1081, 2008. 58 [5] N. Atias and R. Sharan. An algorithmic framework for predicting side e ects of drugs. Journal of Computational Biology , 18(3):207{218, 2011. 137, 188 [6] M.-F. Balcan, Blum, and K. Yang. Co-training and expansion: Towards 268REFERENCES bridging theory and practice. In Advances in Neural Information Processing Systems , pages 89{96, 2004. 78 R. Semi-supervised clustering by seed- ing. In Proceedings of 19thInternational Conference on Machine Learning (ICML) , 2002. 79, 80, 83, 149, 151 [8] A. Bate. Bayesian con dence propagation neural , 30(7):623{625, 2007. 23 [9] A. Bate and S. J. W. Evans. Quantitative signal detection using sponta- neous ADR reporting. Pharmacoepidemiology and Drug Safety , 18(6):427{ 436, 2009. 24, 28, 122 [10] A. Bate, M. Lindquist, I. R. Edwards, S. Olsson, R. Orre, A. Lansner, and R. M. De Freitas. A bayesian neural network method for adverse drug reaction signal generation. European Journal of Clinical Pharmacology , 54(4):315{321, 1998. 24 [11] J. A. Berlin, S. C. Glasser, and S. S. Ellenberg. Adverse event detection in drug development: recommendations and obligations beyond phase 3. American Journal of Public Health , 98(8):1366{1371, 2008. 3 [12] J. M. Bernardo, M. J. Bayarri, J. O. Berger, A. P. Dawid, D. Heckerman, A. F. M. Smith, and M. West. Bayesian methods in pharmacovigilance. pages 421{438. Oxford University Press, 2011. 23, 29 [13] G. Biau, L. Devroye, and G. Lugosi. Consistency of random forests and 269REFERENCES other averaging classi ers. The Journal of Machine Learning Research , 9:2015{2033, 2008. 72 [14] M. Bilenko, S. Basu, and R. J. Mooney. Integrating constraints and metric learning in semi-supervised clustering. In Proceedings of the 21stInter- national Conference on Machine Learning (ICML) , page 11. ACM, 2004. 80 [15] B. T. Blak, M. Thompson, H. Dattani, and A. Bourke. Generalisabil- ity of The Health Improvement Network (THIN) database: demographics, chronic disease prevalence and mortality rates. Informatics in Primary Care, 19(4):251{255, 2011. 29 [16] A. Blum and T. Mitchell. Combining labeled and unlabeled data with co- training. In Proceedings of the 11thAnnual Conference on Computational Learning Theory , pages 92{100. ACM, 1998. 77 [17] F. T. Bourgeois, M. W. Shannon, C. Valim, and K. D. Mandl. Adverse drug events in the outpatient setting: an 11-year national analysis. Phar- macoepidemiology and Drug 19(19):901{910, 3 [18] O. Bousquet, S. Boucheron, and G. Lugosi. Introduction to statistical learning theory. In Advanced Lectures on Machine Learning , pages 169{ 207. Springer, 2004. 58 [19] A. Bradford-Hill. The environment and disease: Association or causation? Proceedings of the Royal Society of Medicine , 58:295{300, 1965. 5, 17, 18, 84, 121, 123, 124, 126, 127, 135, 161 270REFERENCES [20] A. P. Bradley. The use of the area under the ROC curve in the evaluation of machine learning algorithms. Pattern Recognition , 30(7):1145{1159, 1997. 49 [21] L. Breiman, J. Friedman, R. Olshen, and C. Stone. Classi cation and regression trees . Wadsworth International Group, 1984. 62 [22] L. Breiman. Bagging predictors. Machine Learning , 24(2):123{140, L. Breiman. Bias, variance, arcing classi ers. 1996. 69, 70 [24] L. Breiman. Random forests. Machine Learning , 45(1):5{32, 2001. 71, 73 [25] T. Brodniewicz Pharmaceutica [26] J. S. Brown, M. Kulldor , K. A. Chan, R. L. Davis, D. Graham, P. T. Pettus, S. E. Andrade, M. A. Raebel, L. Herrinton, D. Roblin, et al. Early detection of adverse drug events within population-based health networks: application of sequential testing methods. Pharmacoepidemiology and Drug Safety , 16(12):1275{1284, 2007. 31, 41 [27] R. P. Burns and R. Burns. Business research methods and statistics using SPSS . Sage, 2008. 65 [28] R. Caruana and A. Niculescu-Mizil. Data mining in metric space: an empir- ical analysis of supervised learning performance criteria. In Proceedings of the10thInternational Conference on Knowledge Discovery and Data Min- ing (KDD ), pages 69{78, 2004. 97 271REFERENCES [29] O. Caster and I. R. Edwards. Re ections on attribute and decision in pharmacoviglance. Drug Safety , 33(10):805{809, 2010. 13 [30] O. Chapelle, Zien, et al. Semi-supervised learning , vol- ume 2. MIT press Cambridge, 2006. 54, 74, 75, 82, 84 [31] Z. Clancy, S. W. Keith, C. Rabinowitz, M. Ceccarelli, J. J. Gagne, and V. Maio. Statins and colorectal cancer risk: a longitudinal study. Cancer Causes & Control , pages 1{6, 2013. 30 [32] D. Cohn, R. Caruana, and A. McCallum. Semi-supervised clustering with user feedback. Constrained Clustering: Advances in Algorithms, Theory, and Applications , 4(1):17{32, 2003. 79 [33] P. Coloma, P. A. P, F. Salvo, M. Schuemie, C. Ferrajolo, A. Pariente, A. Fourrier-Rglat, M. Molokhia, V. Patadia, J. van der Lei, M. Sturken- boom, and G. Tri r\u0012 o. A reference standard for evaluation of methods for drug safety signal detection using electronic healthcare record databases. Drug Safety , 31(1):13{23, 2013. 51, 88, 160 [34] P. M. Coloma, M. J. Schuemie, G. Tri r\u0012 o, R. Gini, R. Herings, J. Hippisley- Cox, G. Mazzaglia, C. Giaquinto, G. Corrao, L. Pedersen, et al. Combining electronic healthcare databases in europe to allow for large-scale drug safety monitoring: the EU-ADR project. Pharmacoepidemiology and Drug Safety , 20(1):1{11, 2011. 44 [35] P. M. Coloma, G. Tri r\u0012 o, M. J. Schuemie, R. Gini, R. Herings, J. Hippisley- Cox, G. Mazzaglia, G. Picelli, G. Corrao, L. Pedersen, et al. Electronic 272REFERENCES healthcare databases for active drug safety surveillance: is there enough leverage? Pharmacoepidemiology and Drug Safety , 2012. 15 [36] A. Coppen, M. Abou-Saleh, P. Milln, J. Bailey, and K. Wood. Decreas- ing lithium dosage reduces morbidity and side-e ects during prophylaxis. Journal of A ective Disorders , 5(4):353{362, 1983. 127 [37] M. Cord and P. Cunningham. Machine learning techniques for multimedia: case studies on organization and retrieval . Springer, 2008. 55 [38] O. P. Corrigan. A risky business: the detection of adverse drug reactions in clinical trials and post-marketing exercises. Social Science & Medicine , 55(3):497{507, 2002. 2, 3 [39] C. Cortes and V. Vapnik. Support-vector networks. Machine Learning , 20(3):273{297, 1995. 60, M. Culp and G. Michailidis. An iterative algorithm for extending learn- ers to a semi-supervised setting. Journal of Computational and Graphical Statistics , 17(3):545{571, 2008. 75 [41] S. Dasgupta, M. L. Littman, and D. McAllester. Pac generalization bounds for co-training. Advances in Neural Information Processing Systems , 1:375{ 382, 2002. 78 [42] T. M. Davidson and W. M. Smith. The bradford hill criteria and zinc- induced anosmia: a causality analysis. Archives of Otolaryngology { Head & Neck Surgery , 136(7):673{676, 2010. 112, 138 273REFERENCES [43] E. C. Davies, C. F. Green, S. Taylor, P. R. Williamson, D. R. Mottram, and M. Pirmohamed. Adverse drug reactions in hospital in-patients: a prospective analysis of 3695 patient-episodes. Public Library of Science one, 4(2):e4439, 2009. 3, 4 [44] E. R. DeLong, D. M. DeLong, and D. L. Clarke-Pearson. Comparing the areas under two or more correlated receiver operating characteristic curves: a nonparametric approach. Biometrics or , and G. Lugosi. A probabilistic theory of pattern recognition , volume 31. Springer, 1996. 72 [46] T. G. Dietterich. An experimental comparison of three methods for con- structing ensembles of decision trees: Bagging, boosting, and randomiza- tion. Machine Learning , 40(2):139{157, 2000. 70, 71 [47] P. Domingos and M. Pazzani. On the optimality of the simple bayesian classi er under zero-one loss. Machine Learning , 29(2-3):103{130, 1997. 65 [48] A. K. Dubey, V. M. Castro, W. Mahamaneerat, S. Goryachev, T. D. Wang, C. D. Herrick, V. S. Gainer, and S. N. Murphy. Investigating OMOP positives Trans- actions on 6(4):325{327, 1976. 69 274REFERENCES [50] W. DuMouchel. Bayesian data mining in large frequency tables, with an ap- plication to the FDA spontaneous reporting system. The American Statis- tician , 53(3):177{190, 1999. 24, 26 and B. \u0014Zenko. Is combining classi ers with stacking better than selecting the best one? Machine Learning , 54(3):255{273, 2004. 69 [52] I. R. Edwards. Considerations on causality in pharmacovigilance. The International Journal of Risk & Safety in Medicine , 24(1):41{54, 2012. 112 [53] I. R. Edwards and C. Biriell. Harmonisation in pharmacovigilance. Drug Safety , 10(2):93{102, 1994. 14 [54] C. P. Farrington. Relative incidence estimation from case series for vaccine safety evaluation. Biometrics , 51(1):228{235, 1995. 46 [55] R. L. Figueroa, Q. Zeng-Treitler, S. Kandula, and L. H. Ngo. Predicting sample size required for classi cation performance. BioMed Central Medical Informatics and Decision Making , 12(1):8, 2012. 148 [56] E. Fix and J. L. Hodges. Discriminatory analysis. nonparametric discrimi- nation: Consistency properties. International Statistical Review/Revue , 57(3):238{247, 1989. 60, 83 [57] P. Fontanarosa, D. Rennie, and C. D. DeAngelis. Postmarketing surveillance{ lack of vigilance, lack of trust. The Journal of the Ameri- can Medical Association , 292(21):2647{2650, 2004. 4 [58] D. Freedman. From association to causation via regression. Advances in Applied Mathematics , 18(1):59 { 110, 1997. 112 275REFERENCES [59] Y. Freund. An adaptive version of the boost by majority algorithm. Ma- chine Learning , 43(3):293{318, 2001. 71 [60] Y. Freund, R. Schapire, and N. Abe. A short introduction to boosting. Japanese Society For Arti cial Intelligence , 14(5):771{780, 1999. 70 [61] Y. Freund and R. E. Schapire. A desicion-theoretic generalization of on- line learning and an application to boosting. In Computational Learning Theory , pages 23{37. Springer, 1995. 70 [62] R. Gallagher, K. Bird, J. Mason, M. Peak, P. Williamson, A. Nunn, M. Turner, M. Pirmohamed, and R. Smyth. Adverse drug reactions caus- ing admission to a paediatric hospital: a pilot study. Journal of Clinical Pharmacy and Therapeutics , 36(2):194{199, 2011. 3 [63] S. A. Goldman. Limitations and strengths of spontaneous reports data. Clinical Therapeutics , 20:C40{C44, 1998. 16, 20 [64] K. J. Goodman and C. V. Phillips. Hill's criteria of causation . Wiley Online Library, 2005. 127 [65] R. L. Grant, V. M. Drennan, G. Rait, I. Petersen, and S. Ili e. First diagnosis and management of incontinence in older people with and with- out dementia in primary care: A cohort study using The Health Improve- ment Network primary care database. Public Library of Science Medicine , 10(8):e1001505, 2013. 29 [66] S. Greenland and H. Morgenstern. Confounding in health research. Annual Review of Public Health , 22(1):189{212, 2001. 32 276REFERENCES [67] D. A. Grimes and K. F. Schulz. Bias and causal associations in observational research. The Lancet , 359(9302):248{252, 2002. 112, 124 [68] K. Haerian, D. Varn, S. Vaidya, L. Ena, H. Chase, and C. Friedman. De- tection of pharmacovigilance-related adverse events using electronic health records and automated methods. Clinical Pharmacology & Therapeutics , 92(2):228{234, 2012. 111 [69] M. A. Hall. Correlation-based feature selection for machine learning . PhD thesis, The University of Waikato, 1999. 133, 213 [70] R. Harpaz, W. DuMouchel, P. LePendu, A. Bauer-Mehren, P. Ryan, and N. H. Shah. Performance of pharmacovigilance signal-detection algorithms for the FDA Adverse Event Reporting System. Clinical Pharmacology & Therapeutics , 93(6):539{546, 2013. 29, 88, 180 [71] R. Harpaz, W. DuMouchel, N. H. Shah, D. Madigan, P. Ryan, and C. Fried- man. Novel data-mining methodologies for adverse drug event discovery and analysis. Clinical Pharmacology & Therapeutics , 91(6):1010{1021, 2012. 30, 45 [72] R. Harpaz, K. Haerian, H. S. Chase, and C. Friedman. Mining electronic health records for adverse drug e ects using regression based methods. pages 100{107, 2010. 37 [73] J. A. Hartigan and M. A. Wong. Algorithm AS 136: A k-means cluster- ing algorithm. Journal of the Royal Statistical Society. Series C (Applied Statistics) , 28(1):100{108, 1979. 79 277REFERENCES [74] T. Hastie, R. Tibshirani, and J. J. H. Friedman. The elements of statistical learning , volume 1. Springer New York, 2001. 53 [75] M. Hauben and A. Bate. Data mining in pharmacovigilance. Pharmaceuti- cal Data Mining: Approaches and Applications for Drug Discovery , 6:341, 2009. 24 [76] M. Hauben, D. Madigan, C. M. Gerrits, L. Walsh, and E. P. Van Puijen- broek. The role of data mining in pharmacovigilance. Expert Opinion on Drug Safety , 4(5):929{948, 2005. 23 [77] M. Hauben, L. Reich, and S. Chung. Postmarketing surveillance of potentially fatal reactions to oncology drugs: potential utility of two signal-detection algorithms. European Journal of Clinical Pharmacology , 60(10):747{750, 2004. 20 [78] K. Haynes, W. B. Bilker, T. R. TenHave, B. L. Strom, and J. D. Lewis. Temporal and within practice variability in The Health Improvement Net- work. Pharmacoepidemiology and Drug Safety , 20(9):948{955, 2011. 30, 52 [79] L. Hazell and S. A. Shakir. Under-reporting of adverse drug reactions. Drug Safety , 29(5):385{396, 2006. 16, 21, 50 [80] P. HealthCare, S. N. Murphy, V. Castro, J. Colecchi, A. Dubey, V. Gainer, C. Herrick, and M. Sordo. Partners healthcare study re- port. http://omop.fnih.org/sites/default/files/PHCS_Final_OMOP_ StudyReport.pdf , 2011. Accessed: 2013-01-18. 46, 47, 48, 108, 185 278REFERENCES [81] E. G. Henrichon Jr and K.-S. Fu. A nonparametric partitioning procedure for classi cation. IEEE Transactions on Computers , 100(7):614{ 624, 1969. 60, 83 [82] T. K. Ho. The random subspace method for constructing decision forests. IEEE Transactions on Pattern Analysis and Machine Intelligence , 20(8):832{844, 1998. 69 [83] M. N. Hocine, P. Musonda, N. J. Andrews, and C. Paddy Farrington. Se- quential case series analysis for pharmacovigilance. Journal of the Royal Statistical Society: Series A (Statistics in Society) , 172(1):213{236, 2009. 31, 42 [84] D. W. Hosmer Jr, S. Lemeshow, and R. X. Sturdivant. Applied logistic regression . Wiley. com, 2013. 60, 83 [85] R. Hubbard, S. Lewis, J. West, C. Smith, C. Godfrey, L. Smeeth, P. Far- rington, and J. Britton. Bupropion the risk of sudden death: a self- controlled case-series analysis using The Health Improvement Network. Thorax , 60(10):848{850, 2005. 29 [86] D. Hume. A treatise of human nature. Second edition . Oxford: Oxford University Press, 1978. 123 [87] T. Jaakkola and M. Jordan. A variational approach to bayesian logistic re- gression models and their extensions. In Proceedings of the 6thInternational Workshop on Arti cial Intelligence and Statistics . Citeseer, 48 279REFERENCES [88] A. K. Jain, M. N. Murty, and P. J. Flynn. Data clustering: a review. ACM Computing Surveys (CSUR) , 31(3):264{323, 1999. 79 [89] Y. Ji, H. Ying, J. Tran, P. Dews, A. Mansour, and R. Massanari. A method for mining infrequent causal associations and its application in nding ad- verse drug reaction signal pairs. IEEE Transactions on Knowledge and Data Engineering , 25(4), 2012. 41 [90] H. Jin, J. Chen, H. He, C. Kelman, D. McAullay, and C. M. O'Keefe. Signal- ing potential adverse drug reactions from administrative health databases. IEEE Transactions on Knowledge and Data Engineering , 22(6):839{853, 2010. 31, 38, 103 [91] H. Jin, J. Chen, C. Kelman, H. He, D. McAullay, and C. M. OKeefe. Min- ing unexpected associations for signalling potential adverse drug reactions from administrative health databases. In Proceedings of the 10thPaci c- Asia Conference on Advances in Knowledge Discovery and Data Mining (PAKDD) , pages 867{876. Springer, 2006. 38, 103, 111 [92] A. Jordan. On discriminative vs. generative classi ers: A comparison of logistic regression and naive bayes. pages 841{848, 2002. 57 [93] R. A. Kamtane and V. Jayawardhani. Knowledge, attitude and perception of physicians towards adverse drug reaction (ADR) reporting: A phar- macoepidemiological study. Asian Journal of Pharmaceutical and Clinical Research , 5(3):210{214, 2012. 16 [94] J. C. Kando, K. A. Yonkers, and J. O. Cole. Gender as a risk factor for adverse events to medications. Drugs , 50(1):1{6, 1995. 88 280REFERENCES [95] M. J. Kearns and Y. Mansour. A fast, bottom-up decision tree pruning algorithm with near-optimal generalization. In Proceeding of the 15thIn- ternational Conference on Machine Learning (ICML) , volume 98, pages 269{277. Citeseer, 1998. 61 [96] S. B. Kotsiantis, D. Kanellopoulos, and P. E. Pintelas. Data preprocess- ing for supervised leaning. International Journal of Computer Science , 1(2):111{117, 2006. 131 [97] M. Kuhn. Building predictive models in R using the caret package. Journal of Statistical Software , 28(5):1{26, 2008. 211 [98] M. Kuhn, M. Campillos, I. Letunic, L. J. Jensen, and P. Bork. A side e ect resource to capture phenotypic e ects of drugs. Molecular Systems Biology , 6(1):343{349, 2010. 93, 137 [99] B. Kulis. Metric learning: A survey. Machine Learning , 5(4):287{364, 2012. 80 [100] R. Kunz and unpredictability of empir- ical comparisons of and non-randomised clinical trials. British Medical Journal , 317(7167):1185, 1998. 43 [101] P. Langley, W. Iba, and K. Thompson. An analysis of bayesian classi- ers. In Proceeding of the 10thNational Conference on Arti cial Intelligence (AAAI) , volume 90, pages 223{228, 1992. 60, 83 [102] J. A. Lasserre, C. M. Bishop, and T. P. Minka. Principled hybrids of gener- ative and discriminative models. In Proceeding of the 19thIEEE Computer 281REFERENCES Society Conference on Computer Vision and Pattern Recognition (CVPR) , volume 1, pages 87{94. IEEE, 2006. 57 [103] J. Lazarou, B. H. Pomeranz, and P. N. Corey. Incidence of adverse drug reactions in hospitalized patients. The Journal of the American Medical Association , 279(15):1200{1205, 1998. 3 [104] J. D. Lewis, W. B. Bilker, R. B. Weinstein, and B. L. Strom. The rela- tionship between time since registration and measured incidence rates in the general practice research database. Pharmacoepidemiology and Drug Safety , 14(7):443{451, 2005. 30, 113 [105] J. D. Lewis, R. Schinnar, W. B. Bilker, X. Wang, and B. L. Strom. Val- idation studies of the health improvement network (THIN) database for pharmacoepidemiology research. Pharmacoepidemiology and Drug Safety , 16(4):393{401, 2007. 6, 29 [106] J. Lexchin. Is there still a role for spontaneous reporting of adverse drug reactions? Canadian Medical Association Journal , 174(2):191{192, 2006. 19 [107] X. Li, S. Hui, P. Ryan, M. Rosenman, and M. Overhage. Statistical visu- alization for assessing performance of methods for safety surveillance using electronic databases. Pharmacoepidemiology and Drug Safety , 22(5):503{ 509, 2013. 45 [108] Y. Li, C. Guan, H. Li, and Z. Chin. A self-training semi-supervised SVM algorithm and its application in an EEG-based brain computer interface speller system. Pattern Recognition Letters , 29(9):1285{1294, 2008. 84 282REFERENCES [109] H. Liang-Chin, W. Xiaogang, and Y. C. Jake. Predicting adverse drug re- action pro les by integrating protein interaction networks with drug struc- tures. Proteomics , 13(2):313{324, 2013. 138 [110] Y. Lin and Y. Jeon. Random forests and adaptive nearest neighbors. Jour- nal of the American Statistical Association , 101(474):578{590, 2006. 73 [111] M. Lindquist, I. R. Edwards, A. Bate, H. Fucik, A. M. Nunes, and M. St\u0017 ahl. From association to alerta revised approach to international signal analysis. Pharmacoepidemiology and Drug Safety , 8(S1):S15{S25, 1999. 14 [112] M. O. Little and A. Morley. Reducing polypharmacy: Evidence from a simple quality improvement initiative. Journal of the American Medical Directors Association , 14(3):152{156, 2013. 4 [113] M. Liu, M. E. Matheny, Y. Hu, and H. Xu. Data mining methodologies for pharmacovigilance. ACM SIGKDD Explorations Newsletter , 14(1):35{42, 2012. 15, 53, 136, 138, 188, 190 [114] Z. Lu. Information technology in pharmacovigilance: Bene ts, challenges, and future directions from industry perspectives. Drug, Healthcare and Patient Safety , 1:35{45, 2009. 111 [115] D. Madigan and P. Ryan. Commentary: What can we really learn grom observational studies?: The need for empirical assessment of methodology for active drug safety surveillance and comparative e ectiveness research. Epidemiology , 22(5):629{631, 2011. 5, 45 283REFERENCES [116] O. Z. Maimon and L. Rokach. Data mining and knowledge discovery hand- book. Springer, 2005. 61, 62, 63 [117] G. Maldonado and S. Greenland. Estimating causal e ects. International Journal of Epidemiology , 31(2):422{429, 2002. 111 [118] D. J. McLernon, C. M. Bond, P. C. Hannaford, M. C. Watson, A. J. Lee, L. Hazell, and A. Avery. Adverse drug reaction reporting in the uk. Drug Safety , 33(9):775{788, 2010. 20 [119] strengths of the disproportionality analysis for identi cation of adverse drug reactions in a pharmacovigilance database. British Journal of Clinical Pharmacology , 72(6):905{908, 2011. 16, 29 [120] T. K. algorithm. IEEE Signal Pro- cessing Magazine , 13(6):47{60, 1996. 76 [121] N. Moore. The past, present and perhaps future of pharmacovigilance: homage to folke sjoqvist. European Journal of Clinical Pharmacology , 69(1):33{41, 2013. 13 [122] S. L. Morgan and C. Winship. Counterfactuals and causal inference: Meth- ods and principles for social research . Cambridge University Press, 2007. 31 [123] S. Mukherjee, P. Niyogi, T. Poggio, and R. Rifkin. Learning theory: stabil- ity is su\u000ecient for generalization and necessary and su\u000ecient for consistency 284REFERENCES of empirical risk minimization. Advances in Computational Mathematics , 25(1-3):161{193, 2006. 58 [124] A. Mullard. Unleashing the mini-sentinel. Drug 12(2):181{201, 68 [126] K. Nigam, A. McCallum, S. Thrun, and T. Mitchell. Text classi cation from labeled and unlabeled documents using EM. Machine Learning , 39(2- 3):103{134, 2000. 148 [127] R. Nisbet, J. Elder, and G. Miner. Handbook of Statistical Analysis & Data Mining Applications . Elsevier Incorporation, 2009. 131, 132 [128] N. Nor\u0013 en, J. Hopstadius, A. Bate, K. Star, and I. R. Edwards. Temporal pattern discovery in longitudinal electronic patient records. Data Mining and Knowledge Discovery , 20(3):361{387, 2010. 31, 33, 35, 91, 103, 111, 121, 124, 214 [129] J. L. Oliveira, P. Lopes, T. Nunes, D. Campos, S. Boyer, E. Ahlberg, E. M. Mulligen, J. A. Kors, B. Singh, L. I. Furlong, et al. The EU-ADR Web Plat- form: delivering advanced pharmacovigilance tools. Pharmacoepidemiology Safety 22(5):459{467, 2013. 51 [130] D. Opitz and R. Maclin. Popular ensemble methods: An empirical study. Journal of Arti cial Intelligence Research , 11:169{198, 1999. 69, 70 285REFERENCES [131] J. M. Overhage, P. B. Ryan, C. G. Reich, A. G. Hartzema, and P. E. Stang. Validation of a common data model for active safety surveillance re- search. Journal of the American Medical Informatics Association , 19(1):54{ 60, 2012. 5, 43, 45 [132] M. Perrio, S. Voss, and S. A. W. Shakir. Application of the bradford hill criteria to assess the causality of cisapride-induced arrhythmia. Drug Safety , 30(4):333{346, 2007. 112 [133] T. S. Peters. Do preclinical testing strategies help predict human hepato- toxic potentials? Toxicologic Pathology , 33(1):146{154, 2005. 2 [134] G. Piatetsky-Shapiro. Discovery, analysis, and presentation of strong rules. Knowledge Discovery in Databases , pages 229{238, 1991. 38 [135] M. Pirmohamed, S. James, S. Meakin, C. Green, A. K. Scott, T. J. Walley, K. Farrar, B. K. Park, and A. M. Breckenridge. Adverse drug reactions as cause of admission to hospital: prospective analysis of 18 820 patients. British Medical Journal , 329(7456):15{19, 2004. 3 [136] R. Platt and R. Carnahan. The US food and drug administration's mini- sentinel program. Pharmacoepidemiology and Drug Safety , 21(S1):1{303, 15, 44 [137] E. Poluzzi, and F. De Ponti. Drug-induced torsades de pointes: data mining of the public version of the fda adverse event report- ing system (aers). Pharmacoepidemiology and Drug Safety , 18(6):512{518, 2009. 21 286REFERENCES [138] J. R. Quinlan. Simplifying decision trees. International Journal of Man- Machine Studies , 27(3):221{234, 1987. 62 [139] J. R. Quinlan. C4. 5: programs for machine learning , volume 1. Morgan Kaufmann, 1993. 61 [140] S. J. Raudys and A. K. Jain. Small sample size e ects in statistical pattern recognition: Recommendations for practitioners. IEEE Transactions on Pattern Analysis and Machine Intelligence , 13(3):252{264, 1991. 75 [141] C. Reich, P. B. Ryan, P. E. Stang, and M. Rocca. Evaluation of alter- native standardized terminologies for medical conditions within a network of observational healthcare databases. Journal of Biomedical Informatics , 45(4):689{696, 2012. 7, 45 [142] J. M. Reps, J. M. Garibaldi, U. Aickelin, D. Soria, J. Gibson, and R. Hub- bard. Attributes for causal inference in electronic healthcare databases. 2013. 127 [143] J. M. Reps, J. M. Garibaldi, U. Aickelin, D. Soria, J. Gibson, and R. Hub- bard. Comparison of algorithms that detect drug side e ects using electronic healthcare databases. Soft Computing , pages 1{17, 2013. 45, 111, 113, 124 [144] M. J. Rho, S. R. Kim, S. H. Park, K. S. Jang, B. J. Park, and I. Y. Choi. Development common data model for adverse drug signal detection based on multi-center EMR systems. In Proceedings of 4thInternational Conference on Information Science and Applications (ICISA) , pages 1{7. IEEE, 2013. , pages 367{387. Springer, 2012. 15 [146] I. Rish. An empirical study of the naive bayes classi er. In Proceeding of the17thInternational Joint Conference on Arti cial Intelligence (IJCAM) Workshop on Empirical Methods in Arti cial Intelligence , volume 3, pages 41{46, 2001. 65 [147] T. RJ and H. MH. Safety of newly approved drugs: Implications for pre- scribing. The Journal of the American Medical Associaiton , 287(17):2273{ 2275, 2002. 88 [148] M. A. Robb, J. A. Racoosin, R. E. Sherman, T. P. Gross, R. Ball, M. E. Reichman, K. Midthun, and J. Woodcock. The US food and drug admin- istration's sentinel initiative: Expanding the horizons of medical product safety. Pharmacoepidemiology and Drug Safety , 21(S1):9{11, 2012. 111 [149] L. of decision trees classi ers- a survey. IEEE Transactions on Systems, Man, and Cybernetics, Part C: Applications and Reviews , 35(4):476{487, 2005. 61 L. Rosasco, E. De Vito, A. Caponnetto, M. Piana, and A. same? Neural Computation , 16(5):1063{1076, 2004. 57 [151] K. J. Rothman, S. Greenland, and T. L. Lash. Modern epidemiology . Wolters Kluwer Health, 2008. 121, 124 [152] Thiessard, A. Fourrier, B. Begaud, P. Tubert-Bitter, et al. Spontaneous reporting system modelling for data mining methods evalu- 288REFERENCES ation in pharmacovigilance. In Preceding of the AIME Workshop on In- telligent Data Analysis in Medicine and Pharmacology (IDAMAP) , 2003. 19 [153] D. B. Rubin. Estimating causal e ects of treatments in randomized and nonrandomized studies. Journal of Educational Psychology , 66(5):688{701, 1974. 112 [154] D. B. Rubin. Bayesian inference for causal e ects: The role of randomiza- tion. The Annals of Statistics , 6(1):34{58, 1978. 112 [155] P. B. Ryan, G. E. Powell, E. N. Pattishall, and K. J. Beach. Performance of screening multiple observational databases for active drug safety surveil- lance. In Proceedings of the 25thInternational Conference on Pharmacoepi- demiology & Therapeutic Risk Management (ICPE) , 2009. 46 [156] P. B. Ryan, D. Madigan, P. E. Stang, J. Marc Overhage, J. A. Racoosin, and A. G. Hartzema. Empirical assessment of methods for risk identi cation in healthcare data: results from the experiments of the observational medical outcomes partnership. Statistics in Medicine , 31(30):4401{4415, 2012. 5, 45, 50, 51, 84, 89, 90, 97, 138, 161, 162, 164, 185 [157] Y. Saeys, I. Inza, and P. Larraaga. A review of feature selection techniques in bioinformatics. Bioinformatics , 23(19):2507{2517, 2007. 141 [158] S. ectiveness Therapeutics 2007. R. J. Glynn, H. Mogun, and M. A. 289REFERENCES Brookhart. High-dimensional propensity score adjustment in studies of treatment e ects using health care claims data. Epidemiology , 20(4):512{ 522, 2009. 45 [160] S. M. designs in pharmacoepidemiologic Pharmacoepidemiology and Drug Safety , 6(S3):S51{S59, 1997. 45 [161] M. J. Schuemie. Methods for drug safety signal detection in longitudinal observational databases: LGPS and LEOPARD. Pharmacoepidemiology and Drug Safety , 20(3):292{299, 2011. 30, 111, 124, 214 [162] M. J. Schuemie, P. M. Coloma, H. Straatman, R. Herings, G. Tri r\u0012 o, J. N. Matthews, D. Prieto-Merino, M. Molokhia, L. Pedersen, R. Gini, F. Inno- centi, G. Mazzaglia, G. Picelli, L. Scotti, J. van der Lei, and M. Sturken- boom. Using electronic health care records for drug safety signal detection: A comparative evaluation of statistical methods. Medical Care , 50(10):890{ 897, 2012. 89 [163] S. A. W. Shakir. Causality and correlation in pharmacovigilance , pages 329{343. John Wiley & Sons Limited, 2005. 110 [164] S. A. W. Shakir and D. Layton. Causal association in pharmacovigilance and pharmacoepidemiology. Drug Safety , 25(6):467{471, 2002. 112, 186 [165] J. C. Sinclair and M. B. Bracken. Clinically useful measures of e ect in binary analyses of randomized trials. Journal of Clinical Epidemiology , 47(8):881{889, 1994. 123 290REFERENCES [166] R. Sirriyeh, S. McClean, and V. Robins. Introducing Patient Safety: The- ory, Policy and Practice , volume 1357, chapter 1, pages 3{20. SAGE Pub- 50 [167] A. abnormalities. The Lancet , 279(7224):303{305, 1962. 13 [168] W. P. Stephenson and M. Hauben. Data mining for signals in sponta- neous reporting databases: proceed with caution. Pharmacoepidemiology and Drug Safety , 16(4):359{365, 2007. 16 [169] A. Stevenson. Oxford dictionary of English . Oxford Reference Online Pre- mium. OUP Oxford, 2010. 17 [170] N. L. Story. Sexual dysfunction resulting from drug side e ects. Journal of Sex Research , 10(2):132{149, 1974. 2 [171] B. H. Stricker Psaty. Detection, veri cation, and quanti cation of adverse drug reactions. British Medical Journal , 329(7456):44{47, 2004. 191 [172] B. L. Strom. Potential for con ict of interest in the evaluation of sus- pected adverse drug reactions. Journal of the American Medical Associa- tion, 292(21):2643{2646, 2004. 4, 20, 23, 28 [173] B. L. Strom and J. L. Carson. Use of automated databases for pharma- coepidemiology research. Epidemiologic [174] M. Suling and I. Pigeot. Signal detection and based on longi- tudinal healthcare data. Pharmaceutics , 4(4):607{640, 2012. 111 [175] M. Susser. What is a cause and how do we know one? a grammar for pragmatic epidemiology. American Journal of Epidemiology , 133(7):635{ 648, 1991. 127 [176] The National Magazine Company Ltd. NetDoctor.co.uk - the UK's leading independent health website. http://www.netdoctor.co.uk . Accessed: 04- 02-2012. 9, 93 [177] K. M. Ting and I. H. Witten. Issues in stacked generalization. Journal of Arti cial Intelligence Research , 10:271{289, 1999. 70 [178] M. J. Titulaer, L. McCracken, I. Gabilondo, T. Armangu\u0013 e, C. Glaser, T. Iizuka, L. S. Honig, S. M. Benseler, I. Kawachi, E. Martinez-Hernandez, et al. Treatment and prognostic factors for long-term outcome in patients with anti-NMDA receptor encephalitis: an observational cohort study. The Lancet Neurology , 12(2):157{165, 2013. 46 [179] G. Coloma, , J. Kors, G. Polimeni, G. Miremont- Salam, M. Catania, F. Salvo, A. David, N. Moore, A. Caputi, M. Sturken- boom, M. Molokhia, J. Hippisley-Cox, C. Acedo, J. van der Lei, and A. Fourrier-Reglat. Data mining on electronic health record databases for signal detection in pharmacovigilance: which events to monitor? Pharma- coepidemiol Drug Safety , 18(12):1176{1184, 2009. 88, 184 G. Tri r\u0012 o, V. Patadia, M. J. Schuemie, P. M. Coloma, Gini, J. L. Scotti, et al. EU-ADR 292REFERENCES healthcare database network vs. spontaneous reporting system database: preliminary comparison of signal detection. Studies in Health Technology and Informatics , 166:25{30, 2011. 16, 17 [181] G. F. Dekker, C. Wanner, and C. Zoccali. Measures of e ect: relative risks, odds ratios, risk di erence, and `number needed to treat'. Kidney International , 72(7):789{791, 2007. 122 [182] Uppsala 04-04. 2 [183] G. Upton and I. Cook. A dictionary of statistics second edition . Oxford University Press, 2006. 17 [184] US Food and Drug Administration. Center for Drug Evaluation and Re- search. Adverse events reporting system (AERS). http://www.fda.gov/ cder/aers/default.htm . H. G. Leufkens, M. Lindquist, R. Orre, and A. C. Egberts. A comparison of measures of disproportionality for sig- nal detection in spontaneous reporting systems for adverse drug reactions. Pharmacoepidemiology and Drug Safety , 11(1):3{10, 2002. 24, 26 [186] O. Vanunu and R. A propagation-based algorithm for gene-disease associations. pages 54{52, 2008. 137 [187] V. Vapnik. The nature of statistical learning theory . springer, 2000. 58, 59 293REFERENCES [188] V. Vapnik and O. Chapelle. Bounds on error expectation for support vector machines. Neural Computation , 12(9):2013{2036, 2000. 67 [189] V. Vapnik, E. Levin, and Y. Le Cun. Measuring the vc-dimension of a learning machine. Neural Computation , 6(5):851{876, 1994. 60 [190] M. Wadman. Experts call for active surveillance of drug safety. Nature , 446(7134):358{359, 2007. 51 [191] K. Wagsta , and S. Schr\u007f odl. Constrained k-means clustering with background knowledge. In Proceedings of the 18thInterna- tional Conference on Machine Learning (ICML) , volume 1, pages 577{584, 2001. 79 [192] E. K. Wai, D. M. Ro ey, P. Bishop, B. K. Kwon, and S. Dagenais. Causal assessment of occupational bending or twisting and low back pain: results of a systematic review. The Spine Journal , 10(1):76{88, 2010. 127 [193] S. D. Walter. The partial area under the summary ROC curve. Statistics in Medicine , 24(13):2025{2040, 2005. 98 [194] S. D. Walter. Choice of e ect measure for epidemiological data. Journal of Clinical Epidemiology , 53(9):931{939, 2000. 121, 123 [195] B. Wang, B. Spencer, C. Ling, and H. Zhang. Semi-supervised self-training for sentence subjectivity classi cation. in Arti cial Intelligence , volume 5032 of Lecture Notes in Computer Science , pages 344{355. Springer Berlin Heidelberg, 2008. 148 294REFERENCES [196] J.-X. Wei, M. Li, Y.-H. Sun, Y. Lu, and H.-M. Xu. A novel method for signal detection of adverse drug reactions based on proportional reporting ratios. Pharmacy World & Science , 32(5):658{662, 2010. 24, 26 [197] N. S. Weiss. Can the `speci city' of an association be rehabilitated as a basis for supporting a causal hypothesis? Epidemiology , 13(1):6{8, 2002. 125 [198] B. Wettermark. The intriguing future of pharmacoepidemiology. European Journal of Clinical Pharmacology , 69(1):43{51, 2013. 5, 15, 43 [199] D. Wettschereck, D. W. Aha, and T. Mohri. A review and empirical evalu- ation of feature weighting methods for a class of lazy learning algorithms. Arti cial Intelligence Review , 11(1-5):273{314, 1997. 68 [200] H. Whitaker, C. Paddy B. Spiessens, and P. Musonda. Tu- torial in biostatistics: the self-controlled case series method. Statistics in Medicine , 25(10):1768{1797, 2006. 48 [201] A. P. White and W. Z. Liu. Technical note: Bias in information-based mea- sures in decision tree induction. Machine Learning , 15(3):321{329, 1994. 62 [202] R. W. White, N. P. Tatonetti, N. H. Shah, R. B. Altman, and E. Horvitz. Web-scale pharmacovigilance: listening to signals from the crowd. Journal of the American Medical Informatics Association , 20(3):404{408, 2013. 191 [203] R. A. Wilke, H. Xu, J. C. Denny, D. M. Roden, R. M. Krauss, C. A. Mc- Carty, R. L. Davis, T. Skaar, J. Lamba, and G. Savova. The emerging role 295REFERENCES of electronic medical records in pharmacogenomics. Clinical Pharmacology & Therapeutics , 89(3):379{386, 2011. 5 [204] A. M. Wilson, L. Thabane, and A. Holbrook. Application of data mining techniques in pharmacovigilance. British Journal of Clinical Pharmacology , 57(2):127{134, 2004. 138 [205] B. Woolf. On estimating the relation between blood group and disease. Annals of Human Genetics , 19(4):251{253, 1955. 25 [206] World Health Organization. Safety monitoring of medical products. guild- lines for setting up and running a pharmacovigilance centre. http://apps. who.int/medicinedocs/en/d/Jh2934e/ . Accessed: 2013-04-04. 2 [207] T. Y. Wu, M. H. Jen, A. Bottle, M. Molokhia, and et al. Ten-year trends in hospital admission for adverse drug reactions in england 1999-2009. Journal of the Royal Society of Medicine , 103(6):239{250, 2010. 4 [208] S. Xiang, F. Nie, and C. Zhang. Learning a mahalanobis distance metric for data clustering and classi cation. Pattern Recognition , 41(12):3600{3612, 2008. 80, 83 [209] L. Xie, J. Li, and P. Bourne. Drug discovery using chemical systems biol- ogy: identi cation of the protein-ligand binding network to explain the side e ects of cetp inhibitors. Public Library of Science Computational Biology , 5(5):e1000387, 2009. 137 [210] E. P. Xing, M. I. Jordan, S. Russell, and A. Ng. Distance metric learning 296REFERENCES with application to clustering with side-information. In Advances in Neural Information Processing Systems , pages 505{512, 2002. 80 [211] Y. Ying and P. Li. Distance metric learning with eigenvalue optimization. The Journal of Machine Learning Research , 13:1{26, 2012. 80, 81, 82, 83, 151 [212] Y. Yoshihiro, P. Edouard, and K. Masaaki. Drug side-e ect prediction based on the integration of chemical and biological spaces. Journal of Chemical Information and Modeling , 52(12):3284{3292, 2012. 138 [213] C. Zhang and S. Zhang. Association rule mining: models and algorithms . Springer-Verlag, 2002. 192 [214] X. Zhou, S. Murugesan, H. Bhullar, Q. Liu, B. Cai, C. Wentworth, and A. Bate. An evaluation of the THIN database in the OMOP common data model for active drug safety surveillance. Drug Safety , 36(2):119{134, 2013. 5, 49, 50, 52, 89, 162, 181, 184 [215] X. Zhu and A. B. Goldberg. Introduction to semi-supervised learning. Synthesis Lectures on Arti cial Intelligence and Machine Learning , 3(1):1{ 130, 2009. 76, 77, 78, 82, 83, 148 [216] I. Zorych, D. Madigan, P. Ryan, and A. Bate. Disproportionality methods for pharmacovigilance in longitudinal observational databases. Statistical Methods in Medical Research , 22(1):39{56, 2013. 5, 30, 31, 33, 34, 45, 46, 92, 103 [217] I. Zorych, P. Ryan, and D. Madigan. Observational 297REFERENCES Partnership multi-set case-control estimation speci cation . Foundation for the National Institutes of Health, 2009. 48 298 "}