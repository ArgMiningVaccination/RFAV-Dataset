{"title": "PDF", "author": "PDF", "url": "https://eprints.nottingham.ac.uk/29170/1/PhD%20Thesis%20Xiaoguang%20Xu%20ID%204121112%20final.pdf", "hostname": "PDF", "description": "PDF", "sitename": "PDF", "date": "PDF", "cleaned_text": "Models Xiaoguang Xu Thesis submitted to The University of Nottingham for the degree of Doctor of Philosophy May 2015Corrections The following errors were discovered after the binding of th e printed edition. The corrections are incorporated into the text of the online version only. p.29. the acceptance ratio is simplied diseases is a topic of great importa nce. Despite the enormous attention given to the development of methods for e fcient parame- ter estimation, there has been relatively little activity i n the area of nonparamet- ric inference for epidemics. In this thesis, we develop new m ethodology which enables nonparametric estimation of the parameters which g overn transmis- sion within a Bayesian framework. Many standard modelling a nd data analy- sis methods use underlying assumptions (e.g. concerning th e rate at which new cases of disease will occur) which are rarely challenged or t ested in practice. we relax these assumptions and analyse data from disease outbr eaks in a Bayesian nonparametric framework. We Bayesian nonparametric methods to small-s cale epidemics. In a standard SIR model, the overall force of infection is ass umed to have a parametric form. We relax this assumption and treat it as a fu nction which only depends on time. Then we place a Gaussian process prior on it a nd infer it using data-augmented Markov Chain Monte Carlo (MCMC) algor ithms. Our methods are illustrated by applications to simulated data a s well as Smallpox data. We also investigate the infection rate in the SIR model using our methods. More precisely, we assume the infection rate is time-varyin g and place a Gaus- sian process prior on it. Results are obtained using data aug mentation methods and standard MCMC algorithms. We illustrate our methods usi ng simulated data and respiratory disease data. We nd our methods work fa irly well for the stochastic SIR model. We also investigate large-scaled epidemics in a Bayesian no nparametric frame- work. For large epidemics in large populations, we usually o bserve surveil- lance data which typically provide number of new infection c ases occurring during observation periods. We infer the infection rate for each observation pe- iriod by placing Gaussian process priors on them. Our methods are illustrated by the real data, i.e. a time series of incidence of measles in London (1948-1957). iiAcknowledgements I feel very fortunate to have Philip O'Neill and Theodore Kyp raios as my su- pervisors. They were always there for me and I am very gratefu l for all their guidance, advice and patience during my PhD studies. Many thanks to my parents for all their support and patience. I would also like to thank my friends in Nottingham for making my life more enjoyable. Many thanks to the University of Nottingham School of Mathem atical Sciences who fully funded my PhD study. Finally, there is nothing I could do to sufciently express m y gratitude to Lin. She has been very supportive and understanding. iiiContents List of Figures VIII List of Tables XXVII 1 the overall force o f infection in small-scale epidemics the epidemic . . 72 3.2.3 Simulated partially from multi-group epidem ic data models in large pop- ulations infections . . . . 135 References 140 viiList of Figures 1.1 Samples drawn from Gaussian process priors. The gure sh ows two functions (solid and dotted) drawn from each of three Gau s- sian process priors with the squared exponential covarianc e func- tion. The sample functions are obtained using a discretizat ion of thex-axis of 60 equally spaced points. The corresponding covari - ance function is given Gaussian process priors. The gure sh ows two functions (solid and dotted) drawn from each of six Gaus- sian process priors with different covariance functions. T he func- tions are obtained using a discretization of the x-axis of 60 and 100 equally spaced points for plots (a) and (b) and plot (f) re - spectively. The corresponding covariance function is give n be- 5 random samples are generated from the GP with the same co - variance function, the squared exponential covariance fun ction, where the hyperparameters =1 and =1. The samples are obtained using a discretization of the x-axis of 60 observations (-1.15,0), (0.15,-1), (1.15, 0), 5 random samples are generated from the Gaussian process with the sam e covariance function, the squared exponential covariance f unc- hyperparameters =1 are obtained using a discretization of the x-axis for generating exact Poisson data via a thinni ng method. A Poisson time series, {sj}J j=1(+andmarks), is generated from a homogeneous Poisson process with rate, . At each point of the time series, a sample, g(sj), is drawn from the Gaussian pro- cess. Then the function value is transformed through the sig moid function so that it is in form of (g(sj))(marks) and is pos- itive and bounded above {rj}J j=1(\u00d7marks), are drawn uniformly on (0,)in the vertical coordinate. If the variates are greater than the transformed function values, the corresponding events are discarded ( +marks). The remaining events,{sj}J j=1(marks), are the exact Poisson events generated from the inhomogeneous Poisson process corresponding to th e mean of the inhomogeneous Poiss on process intensity (t)at each Poisson point compared with the true (t)generated from a transformed Gaussian process (see (2.1)) given by =60,T=7 and a zero mean and a value of hyperparameter, =1.5, for the Gaussian process. The Poisson data are shown by \" |\" marks. The 95% credible intervals are shown as well. Plot (b) shows the MCMC trace plot of the hyper- parameter compared with the true (dotted line) for the mean of the inhomogeneous Poiss on process intensity (t)at each Poisson point compared with the true (t)generated from a transformed Gaussian process given by=60,T=7 and a zero mean and a value of hyperpa- rameter, =1.5, for the Gaussian process. The Poisson data are shown by \" |\" marks. The 95% credible intervals are shown as well. Plot 2.3 (b) shows the MCMC trace plot of the hyperpa- rameter compared with the true (dotted line) for the (a) shows posterior mean of the inhomogeneous Poiss on process intensity (t)at each Poisson point compared with the true (t)generated from a transformed Gaussian process given by=40,T=5 and a zero mean and a value of hyperpa- rameter, =1.5, for the Gaussian process. The Poisson data are shown by \" |\" marks. The 95% credible intervals are shown as well. Plot 2.4 (b) shows the MCMC trace plot the hyperparame- tercompared with the true (dotted line) for the process int ensity (t)at each Poisson point compared with the truth (t) = 10 (dotted line). The Poisson data (\" |\" marks) are generated from the intensity (t) =10 within process int ensity (t)at each Poisson point compared with the truth (t) = 10 (dotted line). The Poisson data, different from the one in Fi gure 2.5, (\" |\" marks) are generated with the same parameter setting, i.e. from the intensity (t) =10 within a time region [0, 10].. . . 36 2.7 Posterior mean of the overall force of infection h(t)(solid line) at each infection time compared with the original data XtYt(dot- ted line) generated from the general stochastic epidemic wi th pa- rameters infection number of infective individuals a=1. The 95% credible intervals are shown as well. There is a total of 87 infections during the whole epidemic an d all the infection times are assumed to be known. The \" |\" marks in the plot represent the observed data, i.e. the infection tim es. The squared exponential covariance function is used for the Gau ssian process prior and the hyperparameter of the covariance Posterior mean of the overall force of infection h(t)(solid line) at each infection time compared with the original data XtYt(dot- ted line) generated from the general stochastic epidemic wi th pa- rameters infection tive individuals a=1. The 95% credible intervals are shown as well. There is a total of 130 infections during the whole ep i- demic and all the infection times are assumed to be known. The \"|\" marks in the plot represent the observed data, i.e. the infe c- tion times. The squared exponential covariance function is used for the Gaussian process prior and the hyperparameter of the co- variance function, , of the overall force of infection h(t)(solid line) at each infection time compared with the original data XtYt(dot- ted line) generated from the general stochastic epidemic wi th pa- rameters infection tive individuals a=1. The 95% credible intervals are shown as well. There is a total of 189 infections during the whole ep i- demic and all the infection times are assumed to be known. The \"|\" marks in the plot represent the observed data, i.e. the infe c- tion times. The squared exponential covariance function is used for the Gaussian process prior and the hyperparameter of the co- variance function, , 2 recovered by placing the Gaussian pro cess prior. Three plots show posterior mean of the overall force o f infection h(t)(solid line) at each infection time compared with the original data XtYt(dotted line) generated from the general stochastic epidemic with parameters =0.015, =1,N=150 and a=1. Plot (a) corresponds to the case where complete data are observed. Plot (b) corresponds to the case where removal times are known as well as the removal rate. Plot (c) correspo nds to the case where only removal times are known. The 95% cred- ible intervals are shown for each of the plot. The \" |\" marks in each plot represent the observed data, i.e. the infection times for plot (a) and the removal times for plot (b) and (c). There i s a total of 130 infections during the whole epidemic. The squar ed exponential covariance function is used for the Gaussian pr ocess prior and the hyperparameter of the covariance by placing the Gaussian pro cess prior where only removal times are known. Plot (a) shows MCMC trace plot of the hyperparameter, . Plot (b) and (c) show MCMC trace plot of the overall force of infection at time t=1.52 and t=2.03 respectively. The squared exponential covariance fun c- tion is used for the Gaussian process prior and the hyperpara m- eter of the covariance function, SE-Data 3 recovered by placing the Gaussian pro cess prior. Three plots show posterior mean of the overall force o f infection h(t)(solid line) at each infection time compared with the original data XtYt(dotted line) generated from the general stochastic epidemic with parameters =0.015, =1,N=200 and a=1. Plot (a) corresponds to the case where infection times are known. Plot (b) corresponds to the case where removal tim es are known as well as the removal rate. Plot (c) corresponds to the case where only removal times are known. The 95% cred- ible intervals are shown for each of the plot. The \" |\" marks in each plot represent the observed data, i.e. the infection times for plot (a) and the removal times for plot (b) and (c). There i s a total of 189 infections during the whole epidemic. The squar ed exponential covariance function is used for the Gaussian pr ocess prior and the hyperparameter of the covariance of infection h(t)(solid line) at each esti- mated infection time. The 95% credible intervals are shown a s well. There is a total of 30 infections during the whole epide mic and all the infection times and the removal rate are assumed t o be unknown. Only removal times are known. The \" |\" marks in the plot represent the observed data, i.e. the removal times . The squared exponential covariance function is used for the Gau ssian process prior and the hyperparameter of the covariance , hyperparameter, , upper bound h and number of thinned events, M, for the Smallpox data analysis. 52 xiiiLIST OF FIGURES 2.15 Posterior mean of the infection rate, (t)at each estimated in- fection time for the Smallpox data. The 95% credible interva ls are shown as well. There is a total of 30 infections during the whole epidemic and all the infection times and the removal ra te are assumed to be unknown. Only removal times are known. The \" |\" marks in the plot represent the observed data, i.e. the removal times. The squared exponential covariance functio n is used for the Gaussian process prior and the hyperparameter o f the covariance function, , recovered by placing three different Gaussian process priors. Three plots show posterior mean of the overa ll force of infection h(t)(solid line) at each infection time com- pared with the original data XtYt(dotted line) generated from the general stochastic epidemic with parameters infection rate =0.015, removal rate =1, initial number of susceptibles N=200 and initial number of infective individuals a=1. Plot (a) corresponds to the squared exponential covariance func tion see, (1.2). Plot (b) corresponds to the exponential covaria nce function see, (1.3). Plot (c) corresponds to the Mat\u00e9rn cova riance function with set to 3/2 see, (1.4). The 95% credible intervals are shown for each of the plot. The \" |\" marks in each plot rep- resent the observed data, i.e. the infection times. There is a total of 130 infections during the whole epidemic and all the infec tion times are assumed to be known. The hyperparameter of the thre e covariance functions, by placing three different Gaussian process priors. Three plots show posterior samples of the ov erall force of infection h(t)(solid line) at each infection time. Plot (a) corresponds to the squared exponential covariance functio n see, (1.2). Plot (b) corresponds to the exponential covariance f unction see, (1.3). Plot (c) corresponds to the Mat\u00e9rn covariance fu nction with set to 3/2 see, (1.4). The hyperparameter of the three co- variance functions, , 2.18 Smallpox recovered by placing three different Gaussia n process priors. Plot (a) corresponds to the squared exponential cov ari- ance function see, (1.2). Plot (b) corresponds to the expone ntial covariance function see, (1.3). Plot (c) corresponds to the Mat\u00e9rn covariance function with set to 3/2 see, (1.4). The 95% cred- ible intervals are shown for each of the plot. The \" |\" marks in each plot represent the observed data, i.e. the removal ti mes. There is a total of 30 infections during the whole epidemic an d only removal times are known. The hyperparameter of the thre e covariance functions, infection rate (t)(solid line) at each infec- tion time for SE-Data 1. The 95% credible intervals are shown as well. True infection rate (dotted line), =0.025. There is a total of 87 infections during the whole epidemic and all the infect ion times are assumed to be known. The \" |\" marks in the plot rep- resent the observed data, i.e. the infection times. The squa red exponential covariance function is used for the Gaussian pr ocess prior and the hyperparameter of the covariance infection rate (t)(solid line) at each infec- tion time for SE-Data 2. The 95% credible intervals are shown as well. True infection rate (dotted line), =0.015. There is a total of 130 infections during the whole epidemic and all the infec tion times are assumed to be known. The \" |\" marks in the plot rep- resent the observed data, i.e. the infection times. The squa red exponential covariance function is used for the Gaussian pr ocess prior and the hyperparameter of the covariance Posterior mean of the infection rate (t)(solid line) at each infec- tion time for SE-Data 3. The 95% credible intervals are shown as well. True infection rate (dotted line), =0.015. There is a total of 189 infections during the whole epidemic and all the infec tion times are assumed to be known. The \" |\" marks in the plot rep- resent the observed data, i.e. the infection times. The squa red exponential covariance function is used for the Gaussian pr ocess prior and the hyperparameter of the covariance the infection rate (t)(solid line) at each in- fection time compared with true infection rate (dotted line ). The 95% credible intervals are shown as well. There is a total of 2 22 infections during the whole epidemic and all the infection t imes are assumed to be known. The \" |\" marks in the plot represent the observed data, i.e. the infection times. The squared exp onen- tial covariance function is used for the Gaussian process pr ior and the hyperparameter of the covariance function, , is xed to 1. 73 3.5 Posterior mean of the infection rate (t)(solid line) at each esti- mated infection time for SE-Data 1 (plot (a) and plot(b)). Tr ue in- fection rate (dotted line), =0.025 and true removal rate, =1. The 95% credible intervals are shown in (a) and (b). Plot (a) i s the case where complete data are observed. Plot (b) is the cas e where only removal times are observed. The \" |\" marks in each plot represent the observed data, i.e. the infection times i n (a) and removal times in (b). Plot (c) shows density of the removal ra te for the second case. There is a total of 87 infections during t he whole epidemic. The squared exponential covariance functi on is used for the Gaussian process prior and the hyperparameter o f the covariance function, , Posterior mean of the infection rate (t)(solid line) at each esti- mated infection time for SE-Data 2 (plot (a) and plot(b)). Tr ue in- fection rate (dotted line), =0.015 and true removal rate, =1. The 95% credible intervals are shown in (a) and (b). Plot (a) i s the case where complete data are observed. Plot (b) is the cas e where only removal times are observed. The \" |\" marks in each plot represent the observed data, i.e. the infection times i n (a) and removal times in (b). Plot (c) shows density of the removal ra te for the second case. There is a total of 130 infections during the whole epidemic. The squared exponential covariance functi on is used for the Gaussian process prior and the hyperparameter o f the covariance function, , recovered by placing the Gaussian proc ess prior where only removal times are known. Plot (a) shows MCMC trace plot of the hyperparameter, . Plot (b) and (c) show MCMC trace plot of the infection rate at time t=2.42 and t=3.42 re- spectively. The squared exponential covariance function i s used for the Gaussian process prior and the hyperparameter of the co- variance function, , the infection rate (t)(solid line) at each esti- mated infection time for SE-Data 3 (plot (a) and plot(b)). Tr ue in- fection rate (dotted line), =0.015 and true removal rate, =1. The 95% credible intervals are shown in (a) and (b). Plot (a) i s the case where complete data are observed. Plot (b) is the cas e where only removal times are observed. The \" |\" marks in each plot represent the observed data, i.e. the infection times i n (a) and removal times in (b). Plot (c) shows density of the removal ra te for the second case. There is a total of 189 infections during the whole epidemic. The squared exponential covariance functi on is used for the Gaussian process prior and the hyperparameter o f the covariance function, , Posterior mean of the infection rate (t)(solid line) at each esti- mated infection time for SE-Data 4 (plot (a) and plot (b)). Tr ue removal rate, =0.7. The 95% credible intervals are shown in (a) and (b). Plot (a) is the case where complete data are obser ved. Plot (b) is the case where only removal times are observed. Th e \" |\" marks in each plot represent the observed data, i.e. the inf ec- tion times in (a) and removal times in (b). Plot (c) shows dens ity of the removal rate for the second case. There is a total of 222 infections during the whole epidemic. The squared exponent ial covariance function is used for the Gaussian process prior a nd the hyperparameter of the covariance function, , is xed to 1. . . 79 3.10 Smallpox data recovered by placing the Gaussian proces s prior. The plot (a) shows posterior mean of the infection rate, (t), at each estimated infection time using our Bayesian nonparame t- ric methods where the squared exponential covariance funct ion is adopted. The \" |\" marks in the plot represent the observed data, i.e. the removal times. The plot (b), obtained from Bec ker (1989), p.137, shows two estimation results of the infectio n rate for smallpox data from Becker's methods. The infection rate is assumed to be a decreasing function of time in the two models. . 81 3.11 Smallpox data recovered by placing the Gaussian proces s prior on(t). Four plots show densities of the removal rate, , the hy- perparameter, , the upper bound and the number of thinned events, Mrespectively. The squared exponential covariance func- tion for Dataset SE-Data 2 recovered by placing three different Gaussian process priors. Three plots show posterior mean of the infec - tion rate, (t)(solid line) at each infection time compared with the true (dotted line). The data are generated from the general stochastic epidemic with parameters infection rate =0.015, re- moval infective a=1. Plot (a) corresponds to the squared exponential covariance function see, (1.2). Plot (b) corresponds to the exponential covariance function see , (1.3). Plot (c) corresponds to the Mat\u00e9rn covariance function with set to 3/2 see, (1.4). The 95% credible intervals are shown for ea ch of the plot. The \" |\" marks in each plot represent the observed data, i.e. the infection times. There is a total of 130 infections d uring the whole epidemic and all the infection times are assumed to be known. The hyperparameter of the three covariance function s, , by placing three different Gaussia n process priors. Three plots show posterior mean of the infection rat e,(t) (solid line) at each estimated infection time. Plot (a) corr esponds to the squared exponential covariance function see, (1.2). Plot (b) corresponds to the exponential covariance function see , (1.3). Plot (c) corresponds to the Mat\u00e9rn covariance function with set to 3/2 see, (1.4). The 95% credible intervals are shown for ea ch of the plot. The \" |\" marks in each plot represent the observed data, i.e. the removal times. There is a total of 30 infection s dur- ing the whole epidemic and only removal times are known. The hyperparameter of the three covariance functions, , is set to 1. . . 85 xixLIST OF FIGURES 3.14 (a), posterior mean of the infection rate 1(t)(solid line) at each estimated infection time for SE-Data 5. True infection rate ,1= 0.005. The 95% credible intervals are shown as well. (b), pos te- rior mean of the infection rate 2(t)(solid line) at each estimated infection time for SE-Data 5. True infection rate, 2=0.005. The 95% credible intervals are shown as well. Only removal times of each group are known. The \" |\" marks in each plot represent the observed data, i.e. the removal times. The squared exponent ial covariance function is used for the Gaussian process prior a nd the hyperparameter, of the infection rate 3(t)(solid line) at each estimated infection time for SE-Data 5. True infection rate ,= 0.002 and true removal rate, =0.5. The 95% credible intervals are shown as well. (b), density of the removal rate. Only remo val times of each group are known. The \" |\" marks in the plot rep- resent the observed data, i.e. the removal times. The square d exponential covariance function is used for the Gaussian pr ocess prior and the hyperparameter of the covariance mean of the infection rate infants(t)(solid line) at each estimated infection time for the respiratory disease d ata (Hayakawa et al., 2003). The 95% credible intervals are show n as well. (b), posterior mean of the infection rate children(t)(solid line) at each estimated infection time for the respiratory d isease data. The 95% credible intervals are shown as well. Only re- moval times of each group are known. The \" |\" marks in each plot represent the observed data, i.e. the removal times. Th e squared exponential covariance function is used for the Gau ssian process prior and the hyperparameter of the covariance posterior mean of the infection rate adults(t)(solid line) at each estimated infection time for the respiratory disease d ata (Hayakawa et al., 2003). The 95% credible intervals are show n as well. (b), density of the removal rate. Only removal times in each group are known. The \" |\" marks in the plot represent the observed data, i.e. the removal times. The squared exponent ial covariance function is used for the Gaussian process prior a nd the hyperparameter of the covariance function, , is xed to 1. . . 96 3.18 Dataset SE-Data 2 recovered by placing the Gaussian pro cess prior with different Bayesian nonparametric methods. Two p lots show posterior mean of the infection rate, (t)and (t)(solid line) at each infection time respectively. The original dat aXtYt (dotted line) are generated from the general stochastic epi demic with parameters infection rate =0.015, removal number of susceptibles N=150 and initial number of infective individuals a=1. Only removal times are observed for both cases. Plot (a) corresponds to the case where the ap- proach discussed in Chapter 2 is used. Plot (b) corresponds t o the case where the approach discussed in Chapter 3 is used. Th e 95% credible intervals are shown for each of the plot. The \" |\" marks in each plot represent the observed data, i.e. the remo val times. The squared exponential covariance function is used for the Gaussian process prior and the hyperparameter of the cov ari- ance function, , is for (t)and (t)respectively. . . 98 xxiLIST OF FIGURES 3.19 Dataset SE-Data 3 recovered by placing the Gaussian pro cess prior with different Bayesian nonparametric methods. Two p lots show posterior mean of the infection rate, (t)and (t)(solid line) at each infection time respectively. The original dat aXtYt (dotted line) are generated from the general stochastic epi demic with parameters infection rate =0.015, removal number of susceptibles N=200 and initial number of infective individuals a=1. Only removal times are observed for both cases. Plot (a) corresponds to the case where the ap- proach discussed in Chapter 2 is used. Plot (b) corresponds t o the case where the approach discussed in Chapter 3 is used. Th e 95% credible intervals are shown for each of the plot. The \" |\" marks in each plot represent the observed data, i.e. the remo val times. The squared exponential covariance function is used for the Gaussian process prior and the hyperparameter of the cov ari- ance function, , is 2 and 1 for (t)and (t)respectively. . . 99 3.20 Smallpox data recovered by placing the Gaussian proces s prior with different Bayesian nonparametric methods. Two plots s how posterior mean of the infection rate, (t)and (t)(solid line) at each infection time respectively. Only removal times are ob- served for both cases. Plot (a) corresponds to the case where the approach discussed in Chapter 2 is used. Plot (b) correspond s to the case where the approach discussed in Chapter 3 is used. Th e 95% credible intervals are shown for each of the plot. The \" |\" marks in each plot represent the observed data, i.e. the remo val times. The squared exponential covariance function is used for the Gaussian process prior and the hyperparameter of the cov ari- ance function, , is 2 and 1 for (t)and (t)respectively. . . 100 4.1 An example number of infectives Itwith Uk=5, where the trajectory for the number of infectives Itwith Uk=5, where analysed by Cauchemez & Ferguso n's method. Posterior mean (solid line) and true value (dashed l ine) of the infection rates over 1 year for the SIR epidemic simula ted with mean infectious period, 1/ =14 days. The infection rates vary every two weeks with a period of 1 analysed by Cauchemez & Ferguso n's method. Posterior mean (solid line) and true value (dot) of t he number of infectives over 10 years for the SIR epidemic simu- lated with mean analysed by Cauchemez & Ferguso n's method. Posterior mean (solid line) and true value (dot) of t he total number of new infections over 10 years for the SIR epide mic simulated with mean infectious . of MCMC algorithm for the SIR epidemic si mu- lated with mean infectious period, 1/ =14 days under Cauchemez & Ferguson's method. The plots show MCMC trace of the report- ing rate, , the initial number of susceptibles, S0, the infection rate for the rst observation period, 0, the infection rate for the 11thobservation period, 10, the initial number of infectives, I0 and the total number of new infections for mean (solid line) and true value (dashed line) of the infection rates over 1 year for the SIR epidemic simulated wi th mean infectious period 1/ =14 days under the BNP method. The infection rates vary every two weeks with a period of 1 yea r.120 4.8 Posterior mean (solid line) and true value (dot) of the nu mber of infectives over 10 years for the SIR epidemic simulated wi th mean infectious period 1/ =14 days under the BNP method. . 121 xxiiiLIST OF FIGURES 4.9 Posterior mean (solid line) and true value (dot) of the to tal num- ber of new infections over 10 years for the SIR epidemic simu- lated with mean infectious period 1/ =14 for the SIR epidemic s imu- lated with mean infectious period, 1/ =14 days under the BNP method. The plots show MCMC trace of the reporting rate, , the initial number of susceptibles, S0, the infection rate for the rst observation period, 0, the infection rate for the 11thobservation period, 10, the initial number of infectives, I0, the total number of new infections for the rst observation period and the hyp er- line) and true value (dashed line ) of the infection rates over 10 years for the SIR epidemic simulated with mean infectious period, 1/ =14 days under BNP method using a periodic covariance the Gaussian . 124 4.12 Posterior mean (solid line) and true value (dot) of the n umber of infectives over 10 years for the SIR epidemic simulated wi th mean infectious period, 1/ =14 days under BNP method using a periodic covariance the Gaussian process. . . algorithm for the SIR epidemic s im- ulated with mean infectious period, 1/ =14 days under BNP method. The plots show MCMC trace of the reporting rate, , the initial number of susceptibles, S0, the infection rate for the rst observation period, 0, the infection rate for the 11thobservation period, 10, the initial number of infectives, I0and the .. . 126 4.14 Posterior mean (solid line) and true value (dashed line ) of the infection rates over 1 year for the SIR epidemic simulated wi th mean infectious period, 1/ =14 days under BNP method us- ing a squared exponential function for the Gaussian process . A strong prior, (50, 4.15 Posterior mean (solid line) and true value (dashed line ) of the infection rates over 1 year for the SIR epidemic simulated wi th mean infectious period, 1/ =14 days under BNP method us- ing a squared exponential covariance function for the Gauss ian process. A strong prior, (100, 1)is put on the haperparameter, .127 4.16 10 years simulation data analysed by the BNP method with dif- ferent covariance functions. Posterior mean (solid line fo rr=1 and dashed line r=2) of the infection rates over 1 year for the SIR epidemic simulated with mean infectious period, 1/ =14 days. The infection rates vary every two weeks with a period o f 1 of the infection rates over 1 year for the CF method (dashed line) and BNP method (solid line) using the squared e x- ponential covariance function for the Gaussian process for of the infection rates over 10 years for t he CF method (dashed line) and BNP method (solid line) using the pe - riodic covariance function for the Gaussian process number of infectives over 10 years for the CF method (dot) and BNP method using the squared exponential covariance function for the Gaussian process (solid line) f or the 10 number of infectives over 10 years for the CF method (dot) and BNP method using the periodic covariance function for the Gaussian process (solid line) for the the density plots of the reporting rate, , for the CF method (dashed line), BNP method using the squared expo- nential covariance function for the Gaussian process (dott ed line) and BNP method using the periodic covariance function for th e Gaussian process (solid line) for the 10 years measles data. . . . . 133 xxvLIST OF FIGURES 4.22 The gure shows the density plots of the initial number o f sus- ceptibles, S0, for the CF method (dashed line), BNP method us- ing the squared exponential covariance function for the Gau ssian process (dotted line) and BNP method using the periodic cova ri- ance function for the Gaussian process (solid line) for the 1 0 removal rates, , initial number of suscepti- bles, N, and initial number of infectives, a, for 3 of the data sets. Such parameter settings are used to generate 3 different epi demic process from the SIR model, i.e. 3 simulated epidemic data se t named as SE-Data 1, SE-Data of the removal rate, , the hyper- parameter, , the upper bound hand rate, , initial number of suscepti- bles, N, and initial number of infectives, a, for the new data set. The parameter setting is used to generate an epidemic proces s from the SIR model, i.e. the simulated epidemic data set name d as , initial number of susceptibles, N, and initial number of infectives, a, for the new 3-group data set. The parameter setting is used to generate an epidemic pr o- cess from the multi-group SIR model, i.e. the simulated epid emic data Mean and standard deviation of the infection rate in each group for the real multi-group data (Hayakawa et al., 2003). The re - sults are obtained from Hayakawa et al. (2003) where the init ial number of susceptibles in each group is assumed to be known. . . 97 4.1 Infection rates for each observation period under level of 107.. . 114 xxviiLIST OF TABLES 4.2 Posterior mean, 95% CI, standard deviation for the repor ting , initial number rates. CF, BNP1 and BNP2 represent respectively the CF method, the BNP method using the squared exponential covari - ance function for the Gaussian process assuming the infecti on rates are seasonal and the BNP method using the periodic co- variance function for the Gaussian process without assumin g the infection rates are seasonal. in London 1948-1957. . . . . 131 xxviiiCHAPTER 1 Introduction 1.1 Motivation Understanding the spread of communicable infectious disea ses is of great im- portance in order to prevent major future outbreaks and ther efore it remains high on the global scientic agenda. Mathematical and stati stical modelling has become a valuable tool and has been widely used in the analysi s of infectious disease dynamics. It is of interest to make statistical infe rence for the parame- ters of stochastic epidemic models given observed data. Thi s is not a standard problem due to the fact that, in general, the underlying tran smission process is partially observed (e.g. infection times are not observe d). To date, almost all of the literature concerning statistical inference for epidemic models adopts an approach based on a parametric framework, in which a model is a family of distributions that can be described using a nite number of p arameters. O'Neill & Roberts (1999) and Gibson & Renshaw (1998) present the rst Bayesian ap- proach using Markov Chain Monte Carlo (MCMC) methods for the so-called SIR (susceptible-infective-removed) stochastic epidemi c model, given tempo- ral data on case diagnosis times, in which infection times ar e not observed and are treated as unknown model parameters. O'Neill & Becke r (2001) ex- tend the techniques and develop an MCMC algorithm for perfor ming Bayesian inference for a non-Markovian SIR model where the infectiou s period follows a Gamma distribution. O'Neill et al. (2000) develop MCMC alg orithms to anal- yse both temporal and nal size data from household outbreak s. Numerous other papers have utilised MCMC algorithms to analyse infec tious disease data, 1CHAPTER 1: INTRODUCTION including Neal & Roberts, (2005), Lekone & Finkenst \u00a8adt, (2006), Cauchemez & Ferguson (2008), Jewell et al., (2009) and McKinley et al., (2009). In gen- eral terms, inference for stochastic epidemic models has be neted considerably from the use of MCMC methods. Despite the enormous attention given to the development of m ethods for ef- cient parameter estimation, there has been relatively litt le activity in the area of nonparametric inference for epidemics. Becker & Yip (1989) and Becker (1989) consider nonparametric estimation of the infection rate in an SIR model, specif- ically allowing the infection rate to depend on time. They ap plied martingale approaches to temporal epidemic data where the initial stat e and nal state of the epidemic are assumed to be known. Chen et al. (2008) use cl assical nonpara- metric methods to estimate the infection rate of an epidemic model over time. They use local polynomial methods and martingale estimatin g equations to de- velop a closed-form estimator of the intensity function and its derivatives for multiplicative counting process models. They also apply th e proposed estima- tors to analyse the infection rate of the 2003 SARS epidemic i n Beijing, China. Cauchemez & Ferguson (2008) point out that the martingale ap proaches pro- vided simple but efcient ways to estimate key quantities an d approximate condence regions for the parameters. However, it would be d ifcult when more complex situations are considered such as (i) the initi al state of the epi- demic is unknown, (ii) observed data are further aggregated temporally, and (iii) under-reporting, seasonality in transmission rates are what one must ac- count for. Therefore, martingale approaches appear limite d in terms of their range of epidemic applications. Lau & Yip (2008) adopt a nonp arametric kernel estimator to reconstruct the infection process given that t he removal process is observed. Hence, they estimate the basic reproduction nu mber, R0, with an unknown initial number of susceptibles and the methods are i llustrated by an application to data from a smallpox epidemic. However, the p erson-to-person infection rate was assumed constant, which implied that the method may not be suitable if the infection rate varies throughout the epid emic. Recently, Dureau et al. to the determin- istic SEIR epidemic model and assigned integrated Brownian motion for the time-varying effective contact rate (where an SEIR model, a variant of the stan- dard SIR model, is characterised by four states: susceptibl e(S), exposed (E), 2CHAPTER 1: INTRODUCTION infected (I), removed (R)and it is assumed that there exists a latent period between time of infection and time of infectiousness during which individu- als are in the 'exposed' state). Under a Bayesian framework, they adopted a particle Markov Chain Monte Carlo algorithm to implement in ference (Pers- ing, 2014). The performance of the proposed computational m ethods was val- idated on simulated data and applied to the 2009 A/H1N1 pande mic in Eng- land. However, the approach they used is not fully nonparame tric as the time- varying infection rate is assumed to be governed by a diffusi on process and is estimated with a parametric approach. The motivation behind this thesis is to develop new methodol ogy which en- ables nonparametric estimation of the parameters which gov ern transmission within a Bayesian framework. In the following sections we re call some key concepts that will be relevant. 1.2 Bayesian inference In this section, we will review the fundamentals of Bayesian theory. For de- tailed discussions of the theory see Bernardo & Smith (1994) . 1.2.1 Bayes' theorem In a Bayesian framework, parameters are viewed as having pro bability distri- butions rather than xed values, as is the case in Frequentis t inference (Moy\u00e9, 2008). Bayesian inference is Xand model parameters is (|X) =(X|)() (X)(X|)(), (1.1) where (X) = (X|)()for the discrete case and the sum is all over pos- sible values of or(X) =/integraltext (X|)()in (1.1), (|X)is the posterior density of ,(X|)is the likelihood of X, and ()is the prior density of . In order to infer , we need to determine the posterior distribution, (|X), 3CHAPTER 1: INTRODUCTION which is the combination of the likelihood, (X|), and the prior, (). In Bayesian inference, it is essential to specify prior distri butions for model pa- rameters, , as poorly chosen prior distributions can signicantly aff ect the posterior estimates. We may choose certain prior distribut ions to reflect the existing knowledge about the parameters in question. Where as, uninformative prior distributions may be chosen due to lack of existing evi dence for parameter values, or a desire to derive estimates based solely on the ob served data. We aim to evaluate the posterior distribution of parameters ,. However, the integral, (X) =/integraltext (X|)(), is often intractable (Gilks et al., 1996). With the development of computer technology towards the end of last c entury, Markov Chain Monte Carlo (MCMC) methods are widely used to tackle th is problems. 1.2.2 Markov Chain Monte Carlo MCMC methods are used to draw samples while exploring the state space X using a Markov chain mechanism. This mechanism is construct ed so that the samples mimic samples drawn from the target distribution (|X). We use MCMC methods when we cannot draw samples from (|X)directly, but can evaluate (|X)up to a normalising constant (Andrieu et al., 2003). In this section we will review some well studied MCMC algorit hms. Detailed discussions about the theory and applications can be found i n Gilks et al. (1996), Tanner (1996) and Robert & Casella (1999). MCMC had its origi ns in the 1950s (Metropolis et al., 1953) and was then generalised by Hastin gs (Hastings, 1970) ples from a pos- terior density, (|X), in a way which does not require the computation of its normalisation constant. In each iteration t, the next state (t+1)is chosen as fol- lows. First, a candidate point, , is sampled from a proposal density, q(\u00b7|(t)). Then is accepted with probability ((t),)where 4CHAPTER 1: INTRODUCTION ((t),) =min/parenleftigg 1,(|X)q((t)|) ((t)|X)q(|(t))/parenrightigg . The next state becomes (t+1)=if the candidate point is accepted, otherwise (t+1)=(t)which implies that the chain does not move. The algorithm is implemented as follows: Algorithm The Metropolis Hastings Algorithm 1. Initialise (0) 2. Set t=0 3. Repeat the following steps: vector, , in the Metropolis-Hastings algorithm can be updated simultaneously, or repeated for individual elemen ts, or groups of el- ements. The Gibbs sampler, Geman & Geman spe- cial case of the Metropolis-Hastings algorithm where the pr oposed candidate is always accepted (Casella & George, 1992, Gelfand & Smith, 1990). Let = (1,2,\u00b7\u00b7\u00b7,n)be the current parameter vector consisting of nparameters. Let the vector, , with iremoved, each iteration of the Gibbs sampler, each iofis drawn conditional on the value of all the others. The functions i(i|i,X)are called the full conditional distributions of (|X). Therefore, for the Gibbs sampler, in each iteration t, we sample from the full conditional distributions, i(i|i,X). Each of the parameters, i, is conditional on the latest values of the elements of . The algorithm is implemented as follows: 5CHAPTER 1: Gibbs Sampler 1. Initialise (0) term burn-in is referred to as the practice of discarding the early iterations of MCMC diminish the effect of the initial distribution (Gel man et al., 2004). The length of the burn-in usually depends on the initial valu es and how fast the MCMC chain converges to the desired distribution. We can det ermine burn-in from MCMC trace plots (Gilks et al., 1996). 1.2.2.4 Thinning It is fairly common practice to \"thin\" the Markov chain when c omputer storage is a problem or if one wishes to reduce autocorrelation. We ca n keep only every kthsimulation draw from each sequence and discard the rest of th em. This practice is often termed thinning. we can set kto some value high enough that successive draws of parameter are approximately independent (Gilks et al., 1996). 1.2.2.5 Proposal distributions and convergence In the Metropolis-Hastings algorithm, the choice of propos al density q(\u00b7)is of great importance and affects the rate at which the Markov cha in converges to the desired distribution, as well as the rate at which the dis tribution is explored. 6CHAPTER 1: INTRODUCTION We commonly propose samples from a Gaussian distribution. T his proposal distribution is a Normal distribution at the current parame ter value and the only thing that needs to be specied is the variance 2. If2is too small, the proposal is likely to be very close to the current value. Then the acceptance rate is likely to be high but the Markov chain will take longer to co nverge to the desired distribution. Conversely, if 2is too large, the proposal will be rejected almost every time as the acceptance rate is likely to be low. T herefore, it is implied that a careful choice of 2is important for efcient sampling although the Metropolis-Hastings algorithm will converge for any pr oposal distribution. A general rule is to choose 2in a way such that the acceptance rate for each proposal is 0.234 (Roberts et al., 1997). It is important to ensure the MCMC algorithm has converged to the desired distribution. A simple test is to run several independent MC MC chains with different initial points, in order to ensure they appear to s ample from the same distribution after a burn-in period. Gelman & Rubin (1992) a nd Geweke (1992) proposed more formal methods to test if the chain converges. 1.3 Epidemic modelling Modelling of infectious diseases is a topic of enormous impo rtance and many governments now routinely use modelling as a way of helping t o formulate public health policy, e.g. how best to prepare for a possible influenza pan- demic; how best to design a programme of vaccination; how bes t to react to an emerging disease like SARS, etc (Tildesley & Ryan, 2012, B alatif, 2014). In general, mathematical and statistical modelling is playin g a fundamental role in the ght against the spread of disease. 1.3.1 Stochastic SIR model We now describe the most well studied stochastic model for th e transmission of infectious diseases (Bailey, 1975, Chapter 6, Andersson & B ritton, 2000, Chap- ter 2). Consider a closed, homogeneous and homogeneously mi xing popula- tion of individuals subdivided at any time t0 into three states: susceptible, infective and removed. Let Xt,Ytand Ztdenote respectively the number of 7CHAPTER 1: INTRODUCTION individuals who are susceptible, infective, and removed at time t, and let N and adenote the initial number of susceptible and infective indi viduals respec- tively. We assume that there are no removed individual initi ally. An individual makes contacts with each of the Nsusceptibles at times given by the points of a homogeneous Poisson process with rate . The infectious periods of different individuals are assumed to be independent and identically d istributed accord- ing to the distribution of a random variable which can have an y arbitrary but specied distribution. Susceptible individuals become in fective immediately after they contact an infective. In other words, at time t, new infections occur according to an inhomogeneous Poisson process with rate XtYt. In epidemics, we refer to the rate, XtYt, as the overall force of infection. It is assumed that there is no latent period (infected but not infectious) for t he newly infected in- dividual. The infectious individual is removed from the inf ection process once its infectious period ends. A removed individual can be dead , or recovered and immune to further infections and then would not play any furt her part in the epidemic. The epidemic will die out as soon as there are no inf ective individu- als present in the population. Epidemic models like this are often called SIR epidemic mode ls. The Marko- vian case where the infectious period follows an exponentia l distribution is the- so-called general stochastic epidemic (GSE). Lloyd (2001) pointed out that this as- sumption is equivalent to assuming that it is constant for th e chance of recovery within a given time interval, regardless of the time since in fection and it is un- realistic epidemiologically as the chance of recovery in a g iven time interval is initially small but increases over time, corresponding to t he infectious period distribution. In this thesis, we always assume that the SIR m odel is Markovian for simplicity and comparison with other methods. However, our methods can also be applied to general infectious period distributions . The epidemic can be dened according to the following transi tion probabilities, where the rst two transitions correspond respectively to a n infection and a removal: P[Xt+t=Xt1,Yt+t=Yt+1|Ht] , a constant, is referred to as the infection rate, , a constant, is referred to as the removal rate and Htis the sigma-algebra generated by the history of the process up to time t, i.e.Ht={(Xu,Yu): 0st}, withH0={(X0= N,Y0=a): 0st}specifying the initial conditions. 1.3.2 Bayesian inference for the SIR model from partially ob - served data As mentioned in Section 1.1, O'Neill & Roberts (1999) presen t the rst Bayesian approach using MCMC methods for the SIR model given the remov al times. We now give a brief description of the algorithms they develo ped for sampling the infection rate, , removal rate, and other parameters from the desired posterior distribution. We assume that the epidemic is know n to have ceased, i.e. the number of infection times equals to the number of rem oval times. We rst give a list of notation that we use: Xtand Yt: the number of susceptibles popu- lation at time t0 = (1=0,2,\u00b7\u00b7\u00b7,n): the observed (ordered) removal times where 1 2 \u00b7\u00b7\u00b7 n I1: the rst infection time I= (I2,I3,\u00b7\u00b7\u00b7,In): the unobserved (ordered) infection times excluding the r st infection time during (I1,T], where Tnand I2I3 \u00b7\u00b7\u00b7 In. Suppose that, a priori, Gamma distributions with shape and r ate parameters, and and and are put on and respectively. Specically, the prior densities of and are given by ()forx0 and ,>0, that I1has prior density given by exp(y)I(y0), where >0, and where I(\u00b7)is the indicator function. Conditionally on ,I,and , 9CHAPTER 1: INTRODUCTION the density of I1is as follows: (y|,I,,) =exp{(I2y)},y(,I2), where =++N. According to O'Neill & Roberts MCMC algorithm Gibbs step and drawing from (|,I,I1,)/parenleftig n1+,+/integraltextT I1XtYtdt/parenrightig 3. Sample by using a Gibbs step and drawing from (|,I,I1,)/parenleftig n+,+/integraltextT I1Ytdt/parenrightig 4. Sample I1by using a Gibbs step and drawing from (I1|,I,,)Exp(N++) 5. Move an infection time by using a orithm with repeat step 2-5 More precisely for step 5, we choose one of the existing infec tion times, s, uni- formly at random and then obtain a replacement infection tim e,t, by sampling uniformly on (I1,T). It is shown that MCMC methods are used to carry out Bayesian in ference for the stochastic SIR models given partially observed data. Th e approach is not only robust but very flexible and can be extended to more compl ex models. We will take advantage of this approach throughout the whole th esis. 1.4 Bayesian nonparametric model Nonparametric models are increasingly used in preference t o parametric mod- els, due to the latter's lack of sufcient flexibility to repr esent a wide variety of data. Nonparametric models constitute an approach to mod el selection and adaptation, where the sizes of models are allowed to grow wit h data size (Or- banz & Teh, 2010). This is as opposed to parametric models whi ch use a xed number of parameters. Bayesian nonparametric methods prov ide a Bayesian 10CHAPTER 1: INTRODUCTION framework for model selection and adaptation using nonpara metric models. A Bayesian formulation of nonparametric problems is nontriv ial, since a Bayesian model denes prior and posterior distributions on a single xed parameter space, but the dimension of the parameter space in a nonparam etric approach should change with sample size. The Bayesian nonparametric solution to this problem is to use an innite-dimensional parameter space, a nd to invoke only a nite subset of the available parameters on any given nite data set. This subset generally grows with the data set. In the context of Ba yesian nonpara- metric models, \"innite-dimensional\" can therefore be int erpreted as \"of nite but unbounded dimension\". More precisely, a Bayesian nonpa rametric model is a model that (i) constitutes a Bayesian model on an innite -dimensional pa- rameter space and (ii) can be evaluated on a nite sample in a m anner that uses only a nite subset of the available parameters to explain th e sample. There- fore, the Bayesian nonparametric model has an innite numbe r of dimensions a priori. The word \"nonparametric\" is misleading. It is not t hat there are no pa- rameters, it is in fact that there are an innite number of par ameters. One of the most popular tools for Bayesian nonparametric modelling of probability distri- butions is the Dirichlet process (DP) (Ferguson, 1973). How ever, the Dirichlet process is not suitable for modelling continuous random var iables that require probability density functions since samples from the Diric hlet process are dis- crete with probability one. To tackle this problem, the Diri chlet process is of- ten used to add a countably-innite number of parameters int o a continuous model. One of the most popular examples is the innite mixtur e of paramet- ric distributions (Escobar & West, 1995, Rasmussen, 2000, G ershman & Blei, 2011). Other approaches for using a Dirichlet process to con struct a prior that assigns mass to continuous densities include kernel convol ution (Lo, 1984) and the Dirichlet diffusion tree (Neal, 2001, 2003). For more di scussion of topics related to Bayesian nonparametric models, see Walker et al. (1999) or Ghosh & Romamoorthi (2003). Another popular and well studied tool for specify- ing prior beliefs about probability densities is the Gaussi an process (O'Hagan, 1978). We will use the Gaussian process as a main tool through out the whole thesis. Bayesian nonparametric inference, rst developed in the st atistics community, has become more attractive after the development of computa tional methods, 11CHAPTER 1: INTRODUCTION such as MCMC. It has led to the development of a variety of mode ls and appli- cations of these models in disciplines such as computer visi on, computational biology, cognitive science, signal processing, etc. Howev er, there is little lit- erature concerning Bayesian nonparametric estimation for epidemics, which further motivates our work. 1.5 Gaussian process 1.5.1 Introduction Given some observations of a dependent variable at certain v alues of the inde- pendent variable, x, one might want to nd the best estimate of the dependent variable at a new value, x. We may expect the relationship between the ob- servations and the variable x, denoted by f(x), to be linear, quadratic, cubic, or even non-polynomial. Then we can use the principles of mod el selection to choose among the various possibilities. Rather than assumi ngf(x)relates to some specic models, e.g. f(x) = ax+b, a Gaussian process can represent f(x)rigorously and precisely by letting the data describe the st ory for them- selves (Ebden, 2008). In other words, a Gaussian process pro vides an approach to give a prior density to every possible function, where hig her density values are given to functions that we consider to be more likely. 1.5.2 Denition We now give the denition of a Gaussian process below (Rasmus sen & Williams, 2006): Denition. A Gaussian process (GP) is a collection of random variables, any nite number of which have a joint Gaussian distribution. In other words, a GP can be considered as a probability distri bution over a (possibly innite) number of elements of a set X, such that the distribution over any nite subset of them is a multi-variate Gaussian. Th e setXis chosen based on what sort of elements the Gaussian process should su pport, but the range is always the real line. Denote by \u00b5(\u00b7)and K(\u00b7,\u00b7)respectively the mean 12CHAPTER 1: INTRODUCTION function and the positive semidenite covariance function of the GP , denoted byf(x), where x= (x1,x2,\u00b7\u00b7\u00b7,xn). For n a GP species a distribution over functions and i s completely speci- ed by its mean and covariance function. More precisely, the Gaussian process provides a nonparametric distribution over functions of th e form g:X /CA, where /CArefers to the extended real numbers. In this thesis, we will i nvesti- gate the epidemic models with the Gaussian process in time sp ace. Therefore, it can be assumed that the domain Xis the 1-dimensional time space /CA. Adams (2009) points out that from the function-space view, the mai n idea of the Gaus- sian process is that if we condition on a nite set of input val ues in the domain Xwith size N, denoted {xn X}N n=1, we obtain a joint Gaussian distribu- tion over the corresponding output values in the range /CAN. The dimensions of this Gaussian distribution can be considered as correspond ing to the outputs {f(xn)}N n=1of a random function f(x). The N-dimensional Gaussian distribu- is specied by an N\u00d7Ncovariance matrix KN, where[\u00b5N]n=m(xn)and[KN]n,n=K(xn,xn). 1.5.3 Covariance function In this thesis, we will take the mean function to be zero, i.e. m(x) = 0,x X . Hence, to specify a Gaussian process, we only need to choose a n appropriate covariance function which determines what kind of function s we can sample from the Gaussian process. The choice of an appropriate cova riance function for a Gaussian process largely depends on the problem under c onsideration and sometimes, it can be difcult to choose one. We will place Gaussian pro- cess priors on the key quantities of interest (e.g. infectio n rate, in epidemics) 13CHAPTER 1: INTRODUCTION with different well-studied covariance functions and comp are the results. For detailed discussions of covariance function selection see , Paciorek (2003) and Kronberger & Kommenda (2013). Below is a list of the covarian ce functions we will use (Rasmussen & Williams, (1.5) Here and refer to the hyperparameters which respectively control th e ver- tical scale and horizontal length-scale of the Gaussian pro cess. More precisely, the larger is, the larger vertical range the function will reach and the larger is, the more slowly varying the function generated will be. F igure 1.1 (a), (b) and (c) show samples drawn from the Gaussian process priors w ith the squared exponential covariance function with different hyperpara meters settings. The increase in the horizontal length-scale from (a) to (b) prod uces more slowly fluc- tuating functions and the increase in the vertical scale fro m (a) to (c) produces functions that have larger deviation from zero. Figure 1.2 ( a) and (b) show sam- ples drawn from the process priors with the tial and Mat\u00e9rn covariance function respectively with same hyperparamete r settings, i.e. =1 and =1. Note that, the functions in Figure 1.1 (a) are also sampled with the same hyperparameter settings. One can see that the function s in Figure 1.2 (a) are more rough than the ones in Figure 1.2 (b) and the function s in Figure 1.1 (a) are the smoothest among the three gures. The squared exp onential and exponential covariance functions both belong to the Mat\u00e9rn class of covariance functions shown below (Stein, 1999, Rasmussen & Williams, 2 Kis a modied Bessel function (Abramowitz & Stegun, 1965, Section, 9.6). As , we obtain the smoothest covari- ance function in the class, the squared exponential covaria nce function (1.2). By setting =1/2, we obtain the exponential covariance function (1.3) wh ich generates a very rough process. Figure 1.2 (c) shows samples drawn from the Gaussian process priors with the periodic covariance funct ion and the periodic properties of the covariance function in Figure 1.2 (c) can c learly be seen. 15CHAPTER 1: INTRODUCTION 3 2 1 0 1 2 31.510.500.511.522.5 xf(x) (a) Squared exponential covariance function with =1 and (xx)2 2(1)2/parenrightbigg3 2 0 1 30.200.20.40.60.811.21.41.6 covariance function with =1 and =3: exp/parenleftbigg (xx)2 2(3)2/parenrightbigg 3 2 1 0 1 2 34321012345 xf(x) (c) Squared exponential covariance function with =3 and 32exp/parenleftbigg (xx)2 2(1)2/parenrightbigg Samples drawn from Gaussian process priors. The gure shows two functions (solid and dotted) drawn from each of three Gau s- sian process priors with the squared exponential covarianc e func- tion. The sample functions are obtained using a discretizat ion of thex-axis of 60 equally spaced points. The corresponding covari - ance function is given below each plot. 16CHAPTER 1: INTRODUCTION 3 2 1 0 1 2 31.510.500.511.52 xf(x) (a) Exponential covariance function with =1 and xf(x) (c) Periodic covariance function with =1 and =3. Period is 3: exp/parenleftig 2 sin2((xx)/3) 32/parenrightig Figure 1.2: Samples drawn from Gaussian process priors. The gure shows two functions (solid and dotted) drawn from each of six Gaus- sian process priors with different covariance functions. T he func- tions are obtained using a discretization of the x-axis of 60 and 100 equally spaced points for plots (a) and (b) and plot (f) respe ctively. The corresponding covariance function is given below each p lot. 1.5.4 Gaussian process prediction In this section, we describe how one could draw samples from t he Gaussian process prior as well as predict function values at new point s given observa- tions. 17CHAPTER 1: INTRODUCTION Given a set of inputs x1,x2,\u00b7\u00b7\u00b7,xn, we can draw samples f(x1),f(x2),\u00b7\u00b7\u00b7,f(xn) from the Gaussian process prior distribution: fN(0,K(\u00b7,\u00b7)), where f= {f(xn)}N n=1. For example, Figure 1.3 shows 5 samples drawn from the GP pri or distribution. 3 2 1 0 1 2 32.521.510.500.511.52 input, xoutput, f(x)Prior Figure 1.3: 5 random samples are generated from the GP with the same covar i- ance function, the squared exponential covariance functio n, where the hyperparameters =1 and =1. The samples are obtained using a discretization of the x-axis of 60 equally spaced points. We are not only interested in drawing samples from the prior, but also we want to incorporate the knowledge that the new Gaussian inputs pr ovide about the function. Given a set of observed data D={xn,f(xn)|n=1, 2,\u00b7\u00b7\u00b7,N}= {X,f}, atNnew points X, the predictive distribution of fhas the posterior density, (f|X,X,f). According to the GP prior distribution, the covariances calculated at all pairs of Xand X, and similarly for the other entries K(X,X),K(X,X)and K(X,X). Then, conditioned on the GP prior distribution on the observ ations, the GP posterior density (f|X,X,f)can following expression: f|X,X,fN/parenleftig K(X,X)K(X,X)1f,K(X,X)K(X,X)K(X,X)1K(X,X)/parenrightig . 18CHAPTER 1: INTRODUCTION The derivation of the mean and covariance function is in Rasm ussen and Williams (2006), section A.2. Note that conditional distribution us es standard results on multi-variate Normal distributions. Figure 1.4 shows 5 sam ples drawn from the GP posterior distribution. 3 2 1 0 1 2 32.521.510.500.511.522.5 input, xoutput, f(x)Posterior (3 observations) (0.15,-1), random sam- ples are generated from the Gaussian process with the same co vari- ance function, the squared exponential covariance functio n, where the hyperparameters =1 and =1. The samples are obtained using a discretization of the x-axis of 60 equally spaced points. Figure 1.3 and Figure 1.4 show that given the observations, t he function adjusts itself to pass through the given points and the posterior unc ertainty would re- duce close to the observations. 1.6 Overview In this chapter, we presented some background information a bout parametric and nonparametric inference for stochastic epidemic model s. We also gave the fundamentals of Bayesian inference and MCMC methods. We the n discussed Bayesian nonaprametric models and gave a description of Gau ssian processes that we will use in the following chapters. The rest of this thesis develops Bayesian nonparametric met hods for the SIR 19CHAPTER 1: INTRODUCTION epidemic models in small populations and large populations respectively. In Chapter 2, we explore the behaviour of the overall force of infection in a Bayesian nonparametric framework. We draw inference for th e overall force of infection without making specic assumptions on its para metric functional form and place a Gaussian process prior on the overall force o f infection. Our methods are illustrated with simulated datasets as well as t he real outbreak data. We also compare our ndings with results obtained from other parametric methods. In Chapter 3, we develop Bayesian nonparametric methods for the infection rate in small-scale epidemics. We relax the usual assumptio n that the infection rate is constant throughout the whole epidemic and treat it a s a function which only depends on time. We place a Gaussian process prior on the infection rate and apply the methods to simulated datasets and real outbrea k data. Finally, we compare our results with ones obtained from other paramet ric methods. In Chapter 4, we apply our methods to large-scale epidemics. Epidemic time- series data are used which consist of number of observed infe ction cases each day or weeks, etc. For large epidemics in large populations, there is no op- tion but to approximate the epidemic model since the number o f infectives is usually so large that it is not possible to augment the data wi th the times of infection/removal of each case. We adapt an approximation m ethod due to Cauchemez & Ferguson (2008) to develop a Bayesian nonparame tric method of inference for epidemics in large populations. We place a Gau ssian process prior on the infection rates for each observation period and estim ate them on the log scale. Our methods are illustrated with a simulated dataset and real outbreak data. Finally, we compare the results with ones obtained fro m Cauchemez & Ferguson. In Chapter 5, we review the thesis and any model limitations. 20CHAPTER 2 Bayesian nonparametric estimation for the overall force of infection in small-scale epidemics 2.1 Introduction It has been widely recognised that mathematical and statist ical modelling has become a valuable tool in the analysis of infectious disease dynamics by sup- porting the development of control strategies, informing p olicy-making at the highest levels, and in general playing a fundamental role in the ght against the spread of disease. However, many standard modelling and data analysis methods use underlying assumptions (e.g. concerning the ra te at which new cases of disease will occur) which are rarely challenged or t ested in practice. Our aim is to relax these assumptions by using ideas from Baye sian Nonpara- metric Statistics. This allows us to analyse data from disea se outbreaks without making underlying assumptions which may not be appropriate , and in turn it means that the conclusions taken from the analysis are more r eliable. There has been considerable research activity devoted to th e development of Bayesian nonparametric methods. Particularly, the method s have been fre- quently applied in survival analysis. Nieto-Barajas & Walk er (2004) investigate a new class of nonparametric priors for modelling a cumulati ve distribution function and hence model an unknown survival function in a Ba yesian non- parametric framework. Kottas (2006) develops a computatio nal method to ob- 21CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS tain the posterior distribution of general functionals of a Dirichlet process mix- ture and model the survival distribution via a flexible Diric hlet process mixture, with a Weibull kernel. Lorio et al. (2009) develop a Dependen t Dirichlet Process model for survival analysis data without conducting surviv al curve estimates to satisfy the ubiquitous proportional hazards assumption . Recently, Palacios & Minin (2013) inference Poisson processes (Adams et al ., (2009)) and devel- oped a method for estimating population size dynamics under the coalescent in a Bayesian nonparametric framework. However, to the best of our knowledge, there is no literature concerning Bayesian nonparametric estimation for epidemics. In the SIR model, during its infectious period, an individua l makes contacts with each of the Nsusceptibles at times given by the points of a homogeneous Poisson process with rate , a constant value. This implies that at time t, infec- tion times are generated by an inhomogeneous Poisson proces with rate XtYt, the number of susceptibles and infecti ves at time t. Such a rate is usually termed the overall force of infection in epidemic modelling. In this chapter, we will address the question of estimating t he overall force of infection in a Bayesian nonparametric framework given eith er complete obser- vation of an epidemic (i.e. both infection and removal times ) or partial obser- vation, with just removals observed. Specically, we relax the assumption of the overall force of infection being of the form, XtYt, and treat it as a function which only depends on time, denoted by h(t). Inferring h(t)is equivalent to in- ferring a function in a Bayesian framework, i.e. a prior is ne eded. As discussed in Chapter 1, Section 1.5.2, Gaussian processes are used to d escribe a distribu- tion over functions, we will take advantage of this and place Gaussian process priors on h(t). We will rst introduce Bayesian nonparametric methods for i nhomogeneous Poisson processes introduced by Adams et al. (2009) in the r st half of Section 2.2. In the second half of Section 2.2, we will adapt the metho ds from Adams et al. to simulated Poisson datasets by using a Gaussian proces s to place a prior on the inhomogeneous Poisson process intensity. We will then d evelop methods 22CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS for the epidemic model estimation problem in section 3 and il lustrate them as applied to both articial and real data. We will also carry ou t sensitivity analysis by placing different Gaussian process priors on the overall force of infection of an epidemic in Section 2.4. Finally, we nish with conclusio ns in Section 2.5. 2.2 Estimation for inhomogeneous Poisson process 2.2.1 Introduction The Poisson process is one of the most widely studied and used models for point data in time and space. The inhomogeneous Poisson proc ess, a variant of the Poisson process, allows the intensity to vary across its domain, e.g. time. In inference problems, the functional form for the variation i s usually unknown in advance. In this setting, another stochastic process lik e a Gaussian process (Rathbun & Cressie, 1994, M\u00f8ller et al., 1998), Dirichlet pr ocess (Kottas & Sans\u00f3, 2007), etc. is usually introduced to describe nonparametri cally the variation in the Poisson intensity function. This construction is calle d a Cox process (Cox, 1955). A stochastic process is called a Gaussian Cox process if the intensity function is a transformation of a random realization of a Gau ssian process. By placing a Gaussian process prior distribution on the intens ity function, it is not necessary to have a preconceived idea of the particular func tional form. Un- fortunately, however, for likelihood inference, we will ha ve a problem when integrating an innite-dimensional random function. The p roblem will be dis- cussed in detail in Section 2.2.4.1. 2.2.2 Sigmoidal Gaussian Cox process model We aim to use a Gaussian process prior for the inhomogeneous P oisson pro- cess intensity which is positive all the time. However, the o utput space for the Gaussian process is the real line. Therefore, we need a trans formation. Adams et al. (2009) modied the Gaussian Cox process model in order to carry out fully nonparametric Bayesian inference via MCMC. The model is called moidal Gaussian Cox Process (SGCP) since a sigmoid function is introduced to transform random function values into a random intensity fu nction (t)via the 23CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS relationship (t) =(g(t)), (2.1) where is an upper bound on (t),(\u00b7)is the logistic function, (z) = ( 1+ ez)1, and g(\u00b7)is a random function which has a Gaussian process prior. Given a mean function m(\u00b7)and a positive denite covariance function K(\u00b7) parameterised by hyperparameters, and , g(t)can be drawn from a multivariate Gaussian distribution. 2.2.3 Generating exact Poisson data Lewis & Shedler (1979) present an algorithm for generating a n inhomogeneous Poisson process with intensity, (t), via thinning of a homogeneous Poisson process. The main idea is to consider a realisation of points from a homoge- neous Poisson process with intensity, , and accept or reject each point with acceptance probability, (t)/, where (t). Then the collection of accepted points constructs a realisation of the inhomogeneous Poiss on process with in- tensity, (t). We now describe the algorithm in detail for generating exact data from a time- inhomogeneous Poisson process with intensity given by (2.1 ) via a thinning method (Lewis & Shedler 1979, Adams et al. 2009). The \"exact\" means samples generated are not biased, for instance, by the initial state of a Markov chain. 1. We simulate a set of event times {sj}J j=1from a homogeneous Poisson pro- cess with rate within a time region [0,T]. To achieve this, we sample J, the number of events by drawing it from a Poisson distribution wi th parameter T. Then we distribute the Jevents{sj}J j=1uniformly into [0,T](Pasupathy, 2011). 2. We consider these events {sj}J j=1as input points for a Gaussian process and draw samples {g(sj)}J j=1at the locations {sj}J Specically, where denotes the hyperparameter in the covariance function. 3. We generate Juniform random variates on (0, 1), denoted by {rj}J j=1and only accept the events for which rj<(g(sj)). Then the accepted events form the exact Poisson data which are drawn from an inhomogeneous Poisson pro- 24CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS cess with an intensity function . Note that is the result of applying (2.1) to a random function gdrawn from a Gaussian process. The algorithm is also applicable if the in tensity is known. Given a particular intensity function , when simulating data, the probability of accepting the events is (sj)/instead of (g(sj)). Examples can be found in Adams et al. (2009). Figure 2.1 shows the procedure for gen erating exact Poisson data via a thinning method. 2.2.4 Inference We now investigate the posterior distribution of given a set of observed data, denoted by {sk}K k=1, using the SGCP model as the prior. Here, skis assumed to be a time within a region [0,T]. 2.2.4.1 Doubly intractable problem In terms of Bayes' Theorem, the posterior density for to g(t)andGP denotes a Gaussian process prior on g. It is notable that (2.2) is intractable due to the presence of an intractable integral over [0,T]in the numerator and an in- tractable integral over possible values of gin the denominator. Particularly, the value of the integral over gis a function of the parameters, g, the variables being sampled. Such problem makes the posterior (2.2) doubly intr actable (Murray, 2007). Therefore, performing MCMC inference directly via t he posterior den- sity for is an intractable problem. 25CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS 00.5 11.5 22.5 33.5 44.5 500.511.522.533.54 t Figure 2.1: Procedure for generating exact Poisson data via a thinning m ethod. A Poisson time series, {sj}J j=1(+andmarks), is generated from a homogeneous Poisson process with rate, . At each point of the time series, a sample, g(sj), is drawn from the Gaussian process. Then the function value is transformed through the sigmoid f unc- tion so that it is in form of (g(sj))(marks) and is positive and bounded above by . Variates, {rj}J j=1(\u00d7marks), are drawn uniformly on (0,)in the vertical coordinate. If the variates are greater than the transformed function values, the correspo nding events are discarded ( +marks). The remaining events, {sj}J j=1( marks), are the Poisson events generated from the inho moge- neous Poisson process corresponding to the random function ,(s). 26CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS 2.2.5 Data augmentation To solve the problem above, Adams et al. (2009) adopt a data-a ugmentation approach to make the Markov chain tractable, as follows. Spe cically, con- sider augmenting the observed data with the following varia bles: the number of thinned events, M, the locations of thinned events, {sm}M m=1, the function values at the observed data, gK= (g(s1),g(s2),\u00b7\u00b7\u00b7,g(sK))and the function values at the thinned events, gM= (g(s1),g(s2),\u00b7\u00b7\u00b7,g(sM)). We can sample the above parameters from the joint distribution with densi specically, we can sample ,M,{sm}M m=1,gM+Kas well as respectively from the full condi- tional distributions (2.4), (2.5), (2.6), (2.7) and (2.8). We have that (|M,T,{sk}K k=1)()K+M1exp{T}\u00d7(), AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION here describe in detail a procedure of updating parameter s via an MCMC algorithm for inference of the inhomogeneous Poisson proce ss The algorithm for updating the upper bound parameter, , the number of thinned events, M, and the locations of thinned events, {sm}M m=1, is the same in Adams et al. (2009). However, the algorithm for updating function values, gM+K, and the hyperparameters, and , is different. Adams et al. adopted Hamiltonian Monte Carlo methods for inference of the function values and the hyperpa- rameters and obtained good mixing of the Markov chain. We use d a standard MCMC algorithm which is much easier to implement. 1. Updating the upper bound parameter, We use a Gibbs step to update . As the locations of the observed data and the thinned events are drawn from a homogeneous Poisson proc ess on time region[0,T]with rate , the mean of isK+M T, where Kis the number of ob- served data and Mis the number of thinned events. According to (2.4), with the gamma prior (,)put on , we can sample from the full conditional distribution, (+K+M,+T). 2. Updating the number of thinned events, M We use a Metropolis-Hastings step to sample from the full con ditional dis- tribution of the number of thinned events, see (2.5). We choo se an insertion move or a deletion move each with probability1 2. For the insertion move, we propose a new location lwhich is uniformly sampled from [0,T]and then draw a corresponding function value g(l)from the conditioned multivariate Gaussian distribution at l. Specically, we sample g(l)from the given by (g(l)|l,gM+K,{sk}K k=1,{sm}M m=1,), where K(l,S)K(S,S)1gM+K K(l,l)K(l,S)K(S,S)1K(S,l)are (s1,s2,\u00b7\u00b7\u00b7,sK,s 1,s 2,\u00b7\u00b7\u00b7,s M)denotes locations of observed data and thinned events. The new value can be seen as a predict ion of the Gaus- 28CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS sian process. For the deletion move, a thinned event l, is uniformly selected and removed from the current Mevents. We note that the set of {sm}M m=1and gM are updated correspondingly when updating the number of thi nned events, M. Below is the derivation of the probability of acceptance for the insertion and deletion move. Insertion move: The toT\u00d7\u00d7(g(l)) M+1. If the move is accepted, the proposal land the corresponding function value g(l)will be added to the set of {sm}M m=1and gMrespectively. Deletion Move: The 2\u00d71 M, 29CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION EPIDEMICS q(MM) =1 simplied toM T\u00d7\u00d7(g(l)). If the move is accepted, the chosen thinned event land the corresponding func- tion value g(l)will be discarded from the set of {sm}M m=1and gMrespectively. 3. Updating locations of thinned events, {sm}M m=1 We use a Metropolis-Hastings step to sample from the full con ditional distri- bution, (2.6). We rst uniformly draw a new location lfrom[0,T]and then draw a new function value g(l)from the Gaussian process, conditioned on the current gM+K. the conditional m=1,), and and variance of this distribution are K(l,S)K(S,S)1gM+Kand K(l,l)K(l,S)K(S,S)1K(S,l) respectively. Then one of the existing thinned events is sel ected uniformly at random and replaced by the proposed new values. The forward a nd backward densities for ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS The acceptance to(g(l)) (g(l)). If the move is accepted, the old value land g(l)will be replaced by the pro- posal land the corresponding value g(l), respectively. 4. Updating function values, g M+K Given the observed data {sk}K k=1, the thinned events {sm}M m=1and the current hyperparameter , we wish to sample from the distribution on the function values gM+K, see (2.7). We propose new function values g M+Kby a proposal of the form g M+K=gM+K+ 12hM+K, where hM+Kis drawn from the This mechanism is an underrelaxed MCMC method discussed by Adams et al.(200 9). Such a method is used to keep the contribution of the current functi on values on some level when making proposals. One needs to choose a large (which is near one) to obtain a good acceptance ratio when the number of the p arameters is large. If we obtain the candidate function values g M+Kby simply drawing sam- ples from the Gaussian process, we may have a very low accepta nce ratio of the proposal as the Gaussian process typically denes a narrow m ass (Adams et al., 2009) and it will become worse with increase of the number of t he parameters. 31CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS To calculate the acceptance probability, rst note that (gM+K|M,{sk}K Acceptance ratios generally simplify as we propose from the GP conditional density which appears in the likelihood so that cancellatio n occurs. 5. Updating the hyperparameter, As we set the hyperparameter to a certain value for our case, we only need to sample from the posterior distribution on the hyperparam eter in the co- variance function. The full conditional distribution is gi ven in (2.8). We assign an exponential prior on , i.e. Exp(). Then we propose a new from a normal distribution with mean, the current value of and variance, 2. Let denotes the covariance matrix with the hyperparameter . The Metropolis- Hastings acceptance ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS 2.2.7 Simulated Poisson data study We rst apply our methods to simulated Poisson datasets gene rated from an inhomogeneous Poisson process with random intensity (t). We choose the squared exponential covariance function for the Gaussian p rocess prior and x the hyperparameter, , to the truth, =1, i.e. we only update the hyperpa- rameter, , in the covariance function. We have applied the methods to s everal different data sets. We here choose 3 of our results to show th at our approach works fairly well. Figures 2.2 (a), 2.3 (a) and 2.4 (a) give th e posterior mean of (t)for different data sets. It is notable that the true (t)values in 2.2 (a) and 2.3 (a) are generated from the transformed Gaussian process wit h the same param- eter setting. However, they are different due to the random G aussian process. For the computer implementation of the algorithm, the run ti mes of 30000 it- erations were around 3 hours and 1.2 hours for the rst 2 resul ts and the last one respectively. The MCMC trace plot of the hyperparameter is shown in Figures 2.2 (b), 2.3 (b) and 2.4 (b). We also apply our methods to simulated Poisson datasets generated from a constant intensity funct ion(t) = b, where bis a constant. Such Poisson data are homogeneous as there are no rejections during the procedure of generating the inhomogeneous Poiss on data from the initial homogeneous Poisson data. We shall expect that the e stimated intensity is quite flat. Figure 2.5 and 2.6 show posterior means of the es timated intensity (t)with 95% credible intervals. The \" |\" marks give locations of the Poisson events. From the results obtained, we can see that our method s work fairly well. Specically, the estimated intensities appear to rec over the truth and are covered by the 95% credible intervals. 33CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS 0 1 2 3 4 5 6 701020304050607080 t(t) (a)0 0.5 1 1.5 2 2.5 3 x 104012345678 (b) Figure 2.2: Plot (a) shows posterior mean of the inhomogeneous Poisson p ro- cess intensity (t)at each Poisson point compared with the true (t)generated from a transformed Gaussian process (see (2.1)) given by =60,T=7 and a zero mean and a value of hyper- parameter, =1.5, for the Gaussian process. The Poisson data are shown by \" |\" marks. The 95% credible intervals are shown as well. Plot (b) shows the MCMC trace plot of the hyperparameter compared with the true (dotted line) for the rst Poisson data set. 0 1 2 3 4 5 6 70102030405060 t(t) (a)0 0.5 1 1.5 2 2.5 3 x 1040246810121416 (b) Figure 2.3: Plot (a) shows posterior mean of the inhomogeneous Poisson p ro- cess intensity (t)at each Poisson point compared with the true (t)generated from a transformed Gaussian process given by =60,T=7 and a zero mean and a value of hyperparameter, =1.5, for the Gaussian process. The Poisson data are shown by \"|\" marks. The 95% credible intervals are shown as well. Plot 2. 3 (b) shows the MCMC trace plot of the hyperparameter compared with the true (dotted line) for the second Poisson data set. 34CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS 0 1 2 3 4 50510152025303540455055 t(t) (a)0 0.5 1 1.5 2 2.5 3 x 1040246810121416 (b) Figure 2.4: Plot (a) shows posterior mean of the inhomogeneous Poisson p ro- cess intensity (t)at each Poisson point compared with the true (t)generated from a transformed Gaussian process given by = 40,T=5 and a zero mean and a value of hyperparameter, =1.5, for the Gaussian process. The Poisson data are shown by \" |\" marks. The 95% credible intervals are shown as well. Plot 2.4 (b) shows the MCMC trace plot the hyperparameter compared with the true (dotted line) for the third Poisson data set. 0 2 4 6 8 10051015 t(t) Figure 2.5: Posterior mean intens ity (t)at each Poisson point compared with the truth (t) =10 (dot- ted line). The Poisson data (\" |\" marks) are generated from the intensity (t) =10 within a time region [0, 10]. 35CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS 0 2 4 6 8 1002468101214161820 t(t) Figure 2.6: mean intens ity (t)at each Poisson point compared with the truth (t) =10 (dot- ted line). The Poisson data, different from the one in Figure 2.5, (\" |\" marks) are generated with the same parameter setting, i.e. from the intensity (t) =10 within a time region [0, 10]. 2.3 Estimation for epidemic models For real life epidemics, data concerning the process of infe ction are seldom available, i.e. only removal times are observed. We have dis cussed Bayesian inference for the SIR model in Chapter 1 by assuming infectio ns occur accord- ing to an inhomogeneous Poisson process with rate XtYt, at time t, where Xt and Ytrefer to the number of susceptibles and infectives respecti vely at time t. Recall that XtYtis termed the overall force of infection in epidemic modelli ng. We now investigate the overall force of infection of the SIR m odel nonparamet- rically in a Bayesian framework. We relax the assumption of t he overall force of infection being XtYtand treat it as a function which only depends on time, denoted by h(t). Then the epidemic can be described according ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS Let the observed (ordered) successive removal times be = (1=0,2,\u00b7\u00b7\u00b7,K), these being the times of all the removals during [0,T]where 12 \u00b7\u00b7\u00b7 Kand T>0. Let I1be the unobserved time of the rst infection and let I= (I2,I3,\u00b7\u00b7\u00b7,IK)denote the remaining unobserved successive infection time s during[I1,T], where I1I2 \u00b7\u00b7\u00b7 IK. As we assume the epidemic is known to have ceased, the number of infection times and removal tim es are equal. If the initial infective does not manage to infect any other sus ceptible by the rst removal time, 1, the epidemic is ceased. Therefore, in order to obtain epi- demics with n2, the following constrains are imposed: Ii<Ii+1<i, for i=2, 3,\u00b7\u00b7\u00b7,K1. Conditionally on the overall force of infection, h(t), the re- moval rate, , and the rst infection time, I1, we can write the density of prior on h(t)via the SGCP model, i.e. h(t) =h(g(t)), where hrefers to an upper bound on h(t),(\u00b7)refers to the logistic function, (z) = ( 1+ez)1and g(\u00b7)refers to a random function which has a Gaus- sian process prior with mean function 0and covariance function hyper- parameter, , and we assume the hyperparameter, , is xed to 2 for this case. According to Bayes' Theorem, we corresponding to h(t) and g(t). We now have a similar problem, i.e. doubly-intractable, as we had for the case discussed in Section 2.2. To tackle this, we augm ent the posterior distribution shown in (2.10) considering the overall force of infection, h(t), as 37CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS an inhomogeneous Poisson process intensity. More precisel y, we consider aug- menting the observed data with the following variables: the number of thinned events, M, the locations of thinned events, {Is}M s=1, the function values at the infection times, gK= (g(I2),g(I3),\u00b7\u00b7\u00b7,g(IK))and the function values at the thinned events, gM= (g(I1),g(I2),\u00b7\u00b7\u00b7,g(IM)). We then can sample the parameters as well as the additional latent variables from t he joint distribution gK. It is notable that we only have K1 elements in the vector gKsince we do not model the function value at the rst infection time. 2.3.1 MCMC algorithms 1. Sampling Considering (2.11), we have the full conditional density of (|,I,I1,h(t))K i=1Yiexp/braceleftbigg /integraldisplayT I1Ysds/bracerightbigg (), (2.12) where ()denotes a prior on . According to the algorithms developed by O'Neill & Roberts (1999), we use a Gibbs step to sample from th e distribution (2.12). With a conjugate gamma prior (,)put on , we have (|,I,I1,h(t)) /parenleftbigg I1Ysds/parenrightbigg . 2. Sampling I1 We use a Gibbs step to sample from the desired distribution. S uppose that I1has prior density given by exp(y)I(y<0), where >0, and I(\u00b7)is the indicator function. Following from (2.11) and the fact that I1<I2, conditionally 38CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS on,I,h(t)and , the density of I1is as where =++h(I2)N. 3. Sampling I Considering (2.11), we write the full conditional density o the method presented by O'Neill & Roberts (1999 ), we sample from the distribution (2.13) using a Metropolis-Hastings a lgorithm. We rst uniformly draw a new location I jfrom[I1,T]and then draw a new function value g(I j)from the Gaussian distribution, conditioned on the the distribution is (g(I tion times and thinned events. Then one of the existing infec tion times, Ij, is selected uniformly at random and replaced by the proposed ne w values. We shall write Ito denote the set of infection times Iwith the selected Ijexcluded and with the proposed I jincluded, i.e. I=I{Ij}+{I j}. The forward AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS the acceptance ratio Sampling h According to (2.11), we have the full conditional density of h (h|M,I1,T,I)(h)K+M1exp{h(TI1)}(h), where (h)is a prior on h. We use a Gibbs step to sample h. With a conditionally-conjugate gamma prior (h,h)put on h, we can sample from the full conditional distribution, (h+K+M1,h+TI1). 5. Sampling M Similar to the algorithm discussed in Section 2.2.5, we use a Metropolis-Hastings step to sample from the full conditional distribution of the number of thinned events below (M,{Is}M s=1,gM|h,gK,I,,I1,T) (h)MM s=1(g(Is))\u00d7(gM+K|I,{Is}M s=1,). There are insertion move and move each with probabi lity1 2. For the insertion move, we propose a new location I swhich is uniformly sampled from 40CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS [I1,T]and then draw a corresponding function value g(I s)from condi- tioned multivariate Gaussian s)|I s,gM+K,{Ij}K j=2,{Is}M s,X)K(X,X)1K(X,I s) respectively. The new value can be seen as a prediction of Gau ssian process. For the deletion move, a thinned event Is, is uniformly selected and removed from the current Mevents. The Metropolis-Hastings acceptance ratio for the insertion and deletion move is respectively: (TI1)\u00d7h\u00d7(g(I s)) M+1, and M (TI1)\u00d7\u00d7(g(Is)). The derivation of the acceptance ratio for both moves is simi lar to the case dis- cussed in Section 2.2.5 and will not be given here. 6. Sampling {Is}M s=1 We use a Metropolis-Hastings step to perform sampling from t he full condi- distribution of {Is}M s=1below. ({Is}M s=1,gM|h,gK,I,M,,I1,T) M s=1(g(Is))\u00d7(gM+K|I,{Is}M We rst uniformly draw a new location I sfrom[I1,T]. Conditioned on the current gM+K, we then draw a new function value g(I s)from multivariate Gaussian distribution, given s)K(I s,X)K(X,X)1K(X,I s) respectively. Then one of the existing thinned events is sel ected uniformly at random and replaced by the proposed new values. The Metropol is-Hastings acceptance ratio is(g(I s)) (g(Is)). 7. Sampling g M+K Given the infection times, I, the locations of thinned events, {Is}M s=1, and the current hyperparameter, , we wish to sample from the full conditional distri- 41CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS bution of function values, gM+K, below. s=1,). We use to sample gM+K. By using the underrelaxed MCMC method discussed in Section 2.2.5, we propose new funct ion values g M+Kby a proposal of the form g M+K=gM+K+ 12hM+K, where hM+K is drawn from the s=1and is in[0, sample hM+Kfrom the distribution (hM+K|I,{Is}M s=1,). The new function values are 1,K j=2(g(Ij))M s=1(g(Is)) K j=2(g(Ij))M s=1(g(Is))/parenrightigg . 8. Sampling As we x the hyperparameter for our case, we only need to sample from the full conditional distribution of the hyperparameter, , given below. (|M,gM+K,I,{Is}M s=1)(gM+K|I,{Is}M s=1,)\u00d7(), where ()is a prior on . We assign an exponential prior on , i.e. Exp(). Then we propose a new from a normal distribution with mean, the current value of and variance, 2. The Metropolis-Hastings acceptance ratio for this proposal is =||1 2\u00d7exp(gM+KT1gM+K/2) ||1 2\u00d7exp(gM+KT1gM+K/2). For the MCMC algorithms discussed above, the standard devia tions of the pro- posals were tuned to obtain an acceptance rate of 20-30%. 2.3.2 Simulated complete data We now simulate a general stochastic epidemic with paramete rs infection rate, removal rate (in the SIR model, removals occur at rate Xt, where is removal rate), initial number of susceptibles and initial number of infective individuals. 42CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS We rst assume that we obtain a set of infection times. Then we can derive the duration of the process, V, i.e. V=last removal time - rst infection time. We shall use these data to consider a scenario that the epidem ic is known to be completed, i.e. infection times are known. We choose the squ ared exponential covariance function for the Gaussian process prior and the h yperparameter is xed to 2 in order to obtain efcient mixing of the MCMC algori thms and the topic of the choice of was not explored. The prior of the hyperparameter, , was set to be Exp(0.1). We also used Gamma distribution with mean 104and variance 108providing conjugate priors for the upper bound, h(t). We applied our approach to 3 different simulated epidemic datasets whi ch are generated from the SIR model with 3 different parameter settings. Tabl e 2.1 gives infec- tion rates, removal rates, initial number of susceptibles a nd initial number of infectives for generating the data. Figures 2.7, 2.8 and 2.9 show the posterior means of force of infection at each infection time for SE-Dat a 1, SE-Data 2 and SE-Data 3 respectively. From the gures, we can see that the m odel ts SE-Data 1 not as well as SE-Data 2 and SE-Data 3, i.e. for SE-Data 1, the estimated inten- sity struggles to capture the feature of the data XtYtin the middle period of the epidemic. One explanation is that there is a total of 87 infec tions within a time region[0, 11.6]for the rst data set whereas there are 130 and 189 infections within time regions [0, 8.1]and[0, 10.3]respectively for the second and third data sets. One might think there will be a relationship betwe en the size of the population and the covariance structure of the Gaussian pro cess, i.e. weaker correlation in small populations. For the computer impleme ntation of the algo- rithm, the run times of 200000 iterations were around 4.5 hou rs, 10 hours and 13 hours respectively. Table 2.1: Infection rates, , removal rates, , initial number of susceptibles, N, and initial number of infectives, a, for 3 of the data sets. Such parameter settings are used to generate 3 different epidemi c process from the SIR model, i.e. 3 simulated epidemic data set named a s SE-Data 1, SE-Data 2 and SE-Data 3. N a parameter setting 1 0.025 1 100 1 parameter setting 2 0.015 1 150 1 parameter setting 3 0.015 1 200 1 43CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS 0 2 4 6 8 10051015202530354045 th(t) Figure 2.7: Posterior mean of the overall force of infection h(t)(solid line) at each infection time compared with the original data XtYt(dotted line) generated from the general stochastic epidemic with p aram- eters infection rate =0.025, removal =1, number of infective individuals a=1. The 95% credible intervals are shown as well. There is a total of 87 infections during the whole epidemic and all the i nfec- tion times are assumed to be known. The \" |\" marks in the plot represent the observed data, i.e. the infection times. The s quared exponential covariance function is used for the Gaussian pr ocess prior and the hyperparameter of the covariance function, , is set to 2. 0 1 2 3 4 5 6 7010203040506070 th(t) Figure 2.8: Posterior mean of the overall force of infection h(t)(solid line) at each infection time compared with the original data XtYt(dotted line) generated from the general stochastic epidemic with p aram- eters infection rate =0.015, removal =1, number of infective individuals a=1. The 95% credible intervals are shown as well. There is a total of 130 infections during the whole epidemic and all the infec- tion times are assumed to be known. The \" |\" marks in the plot represent the observed data, i.e. the infection times. The s quared exponential covariance function is used for the Gaussian pr ocess44CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS 01234567801020304050607080 th(t) Figure 2.9: Posterior mean of the overall force of infection h(t)(solid line) at each infection time compared with the original data XtYt(dotted line) generated from the general stochastic epidemic with p aram- eters infection rate =0.015, removal =1, number of infective individuals a=1. The 95% credible intervals are shown as well. There is a total of 189 infections during the whole epidemic and all the infec- tion times are assumed to be known. The \" |\" marks in the plot represent the observed data, i.e. the infection times. The s quared exponential covariance function is used for the Gaussian pr ocess prior and the hyperparameter of the covariance function, , is set to 2. 2.3.3 Simulated partial data We now assume the epidemic data are partially observed, i.e. only removal times are known. Based on the results given in Section 2.3.2 w here complete data are assumed to be observed, we apply our methods to SE-Da ta 2 and SE- Data 3 to perform inference for the overall force of infectio n,h(t). We rst assume the removal rate, , is known and then we relax this assumption and use the Gibbs step method (discussed in Chapter 1, Section 1. 2.2.2) to perform inference for . We used Gamma distribution with mean 104and variance 108 providing conjugate priors for the removal rate, . In Figure 2.10, we show the estimation results for SE-Data 2 under different assump tions. For the case where we only observe incomplete data, we plot the posterior mean of h(t)at each estimated infection times. Figure 2.10 (b) is under the assumption that we 45CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS observe removal times and the removal rate is also known and F igure 2.10 (c) is under the assumption that we only observe removal times. F or comparison, we give the estimation results (shown in Figure 2.10 (a)) whe re we observe complete data. Compared to the case where we observe the comp lete data, the estimated intensities in Figure 2.10 (b) and (c) recover the truth but with larger uncertainties. The estimated intensities appear to struggle to recover the truth between the time interval, [2.5, 3], but covered by the 95% credible intervals. The larger uncertainties in the case where only r emoval times are observed can be considered as a consequence of having the inf erred infection times. Between Figure 2.10 (b) and (c), we nd that the estima ted intensity in (c) has much larger uncertainty than in (b) where the removal rate is known, although it appears to roughly capture the feature of the dat a,XtYt, at each infection time. One explanation could be that the estimatio n of the removal rate makes the uncertainty even larger. Figure 2.11 shows MC MC trace plot of the hyperparameter, , the overall force of infection at time t=1.52 and t=2.03 respectively. In Figure 2.12, we have the estimation re sults for SE-Data 3 under the same assumption settings as for SE-Data 2 and the r esults recover the truth with different uncertainties. 46CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS 0 1 2 3 4 5 6 7010203040506070 th(t) th(t) (b) 01234567801020304050607080 th(t) (c) SE-Data 2 recovered by placing the Gaussian process prior. Three plots show posterior mean of the overall force o f infection h(t)(solid line) at each infection time compared with the original data XtYt(dotted line) generated from the general stochastic epidemic with parameters =0.015, =1,N=150 and a=1. Plot (a) corresponds to the case where complete data are observed. Plot (b) corresponds to the case where removal times are known as well as the removal rate. Plot (c) correspo nds to the case where only removal times are known. The 95% cred- ible intervals are shown for each of the plot. The \" |\" marks in each plot represent the observed data, i.e. the infection ti mes for plot (a) and the removal times for plot (b) and (c). There is a t otal of 130 infections during the whole epidemic. The squared exp o- nential covariance function is used for the Gaussian proces s prior and the hyperparameter of the covariance function, , is set to 2. 47CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS 0 1 2 3 4 5 x 1040.511.522.533.544.55 (a)0 1 2 3 4 5 x 10405101520253035404550h(t= 1.52) (b) 0 1 2 3 4 5 x 1040102030405060708090h(t= 2.03) (c) Figure 2.11: Dataset SE-Data 2 recovered by placing the Gaussian process prior where only removal times are known. Plot (a) shows MCMC trace plot of the hyperparameter, . Plot (b) and (c) show MCMC trace plot of the overall force of infection at time t=1.52 and t=2.03 respectively. The squared exponential covariance functio n is used for the Gaussian process prior and the hyperparameter of the co- variance function, , is set to 2. 2.3.4 Smallpox data We now apply our methods to real life data, Smallpox data obta ined from Bai- ley (1975, p.125). There is a total of 30 cases in a community o f 120 individuals at risk. The data are summarised by the 29 time intervals betw een the detec- tion of cases. O'Neill & Roberts (1999), Eichner & Dietz (200 3) and Becker & Yip (1989) have analysed the data and Becker & Yip used a martinga le approach un- 48CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS 01234567801020304050607080 th(t) (a)0 2 4 6 8 1001020304050607080 th(t) (b) 0 2 4 6 8 1001020304050607080 th(t) (c) Figure 2.12: Dataset SE-Data 3 recovered by placing the Gaussian process prior. Three plots show posterior mean of the overall force o f infection h(t)(solid line) at each infection time compared with the original data XtYt(dotted line) generated from the general stochastic epidemic with parameters =0.015, =1,N=200 and a=1. Plot (a) corresponds to the case where infection times are known. Plot (b) corresponds to the case where removal tim es are known as well as the removal rate. Plot (c) corresponds to the case where only removal times are known. The 95% credible in- tervals are shown for each of the plot. The \" |\" marks in each plot represent the observed data, i.e. the infection times f or plot (a) and the removal times for plot (b) and (c). There is a total of 189 infections during the whole epidemic. The squared expon en- tial covariance function is used for the Gaussian process pr ior and the hyperparameter of the covariance function, , is set to 2. 49CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS der a nonparametric framework where infection times are ass umed to be xed. However, no one has applied Bayesian nonparametric methods to the Small- pox data. We assume only removal times are known. All the infe ction times for each individual and the removal rate are inferred by the MCMC methods. We then apply our methods to the data and place a Gaussian proces s prior using the squared exponential covariance function on the overall force of infection, h(t), at each infection time. Figure 2.15 gives the estimated int ensity with 95% credible intervals. In Figure 2.15, we show densities of 4 ke y quantities of in- terest including the removal rate, , the hyperparameter, , the upper bound of the intensity, h, and the number of thinned events, M. Table 2.2 gives sta- tistical summaries for these parameters. O'Neill & Roberts (1999) estimated the infection rate, , and the removal rate, in a Bayesian framework under the assumption that only removal times are observed and is constant. They obtained posterior summaries as follows: (1) : mean 0.0009, standard devia- tion 0.00019; (2) : mean 0.098, standard deviation 0.021. From Table 2.2, we nd that for the removal rate, the mean values are similar, an d the standard deviations a little larger. In order to compare the estimate s of , we estimate (t) =h(t) XtYtusing our Bayesian nonparametric methods. Figure 2.15 show s the posterior mean of the infection rate, (t). Compared to the estimates of from O'Neill & Roberts, we nd a larger mean of the infection rates at each infection time and the estimated functions are not smooth. The latter p resumably is due to that the estimator (t)is constructed by smooth functions divided by very rough functions which give rough functions. Specically, his expected to be a smooth function as we place a Gaussian process prior on it, e ven if a rough covariance function is used. Whereas, XtYtis a very rough function. Therefore, is not a function as smooth as a constant. From Table 2.2 and Figure 2.13 and 2.15, we conclude that the v ariability shows that the standard SIR model, with infection rate constant ov er time, is not ap- propriate for the data. 50CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS 010203040506070809000.10.20.30.40.50.60.70.80.91 th(t) Figure 2.13: Posterior mean of force of infection h(t)(solid line) at each esti- mated infection time. The 95% credible intervals are shown a s well. There is a total of 30 infections during the whole epide mic and all the infection times and the removal rate are assumed t o be unknown. Only removal times are known. The \" |\" marks in the plot represent the observed data, i.e. the removal times . The squared exponential covariance function is used for the Gau ssian process prior and the hyperparameter of the covariance func tion, , is set to 2. 51CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS 00.05 0.1 0.15 0.2 0.25 0.3 0.3502468101214 Density 010203040506070809000.010.020.030.040.050.06 Density 0 0.5 1 1.5 2 2.5 300.20.40.60.811.21.41.61.8 hDensity 2002040608010012014016018000.0050.010.0150.020.025 MDensity Figure 2.14: Densities of hyperparameter, , upper bound h and number of thinned events, M, for the Smallpox data analysis. 52CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS 01020304050607080900123456x 103 t(t) Figure 2.15: Posterior mean of the infection rate, (t)at each estimated infec- tion time for the Smallpox data. The 95% credible intervals a re shown as well. There is a total of 30 infections during the who le epidemic and all the infection times and the removal rate are as- sumed to be unknown. Only removal times are known. The \" | \" marks in the plot represent the observed data, i.e. the remo val times. The squared exponential covariance function is used for the Gaussian process prior and the hyperparameter of the covari ance function, , is set to 2. Table 2.2: Mean and standard deviation of the removal rate, , the hyperpa- rameter, , the upper bound hand the number of thinned events, M. hM mean (std) 0.10 (0.03) 20.90 (11.04) 0.77 (0.31) 35.80 (25.2 3) 2.4 Sensitivity to the Gaussian process prior for the SIR epidemic model In this section, we are concerned with investigation of how d ifferent covariance functions for the Gaussian process prior affect the perform ance of the inference ofh(t). We choose 3 different covariance functions, i.e. squared e xponential co- variance function, exponential covariance function and Ma t\u00e9rn class covariance function with set to 3/2. As discussed in Chapter 1, the squared exponentia l 53CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS covariance function ( ) and exponential covariance ( =1/2) can be con- sidered as two special cases in the Mat\u00e9rn class covariance f unctions and the bigger the value of is the smoother the Gaussian process will be. We now apply our methods to SE-Data 2 using the covariance fun ctions dis- cussed above for the Gaussian process prior and perform infe rence for the over- all force of infection, h(t), by assuming we observe the complete data. Figure 2.16 shows the estimated intensities using squared exponen tial function for the Gaussian process prior respectively for SE-Data 2. Comp ared to the esti- mated intensity in Figure 2.16 (a) where the squared exponen tial covariance function is used, the estimated intensity in Figure 2.16 (b) is quite rough and behaves less smoothly than the one in (a). Compared to the est imated inten- sity in Figure 2.16 (b), the one in Figure 2.16 (c) behaves muc h more smoothly. In terms of smoothness, the plots in (a) and (c) are similar. F rom all of the 3 different estimated intensities, we can conclude that they all recover the truth although they seem not able to capture the dramatic changes i n the data, for instance, the change at around time point 1.5 and the bimodal feature in time interval[2, 3]. It is notable that the posterior means naturally look smoot her than any posterior sample from the Gaussian process. Figure 2.17 (a), (b) and (c) show posterior samples of the overall force of infection on the actual process in the simulation. We also evaluate our methods for the three different Gaussia n process priors for the Smallpox. Figure 2.18 (a), (b) and (c) show the recovered trajectories for the squared exponential covariance function, exponential cov ariance function and Mat\u00e9rn class covariance function respectively. The plot (a ) is much smoother than (b) and (c). We nd that different Gaussian process prio rs produce esti- mates with different level of smoothness. Apart from this, t hey do not make much difference. 54CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS 0 1 2 3 4 5 6 7010203040506070 th(t) (a)0 1 2 3 4 5 6 7010203040506070 th(t) (b) 0 1 2 3 4 5 6 7010203040506070 th(t) (c) Figure 2.16: Dataset SE-Data 2 recovered by placing three different Gaus sian process priors. Three plots show posterior mean of the overa ll force of infection h(t)(solid line) at each infection time compared with the original data XtYt(dotted line) generated from the gen- eral stochastic epidemic with parameters infection rate =0.015, removal =1, initial number of susceptibles N=200 and initial number of infective individuals a=1. Plot (a) corresponds to the squared exponential covariance function see, (1.2). Plot (b) corresponds to the exponential covariance function see, (1 .3). Plot (c) corresponds to the Mat\u00e9rn covariance function with set to 3/2 see, (1.4). The 95% credible intervals are shown for each of the plot. The \" |\" marks in each plot represent the observed data, i.e. the infection times. There is a total of 130 infections d uring the whole epidemic and all the infection times are assumed to be known. The hyperparameter of the three covariance function s,, is set to 2. 55CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS 0 1 2 3 4 5 6 70102030405060 th(t) (a)0 1 2 3 4 5 6 70102030405060 th(t) (b) 0 1 2 3 4 5 6 70102030405060 th(t) (c) Figure 2.17: Dataset SE-Data 2 recovered by placing three different Gaus sian process priors. Three plots show posterior samples of the ov erall force of infection h(t)(solid line) at each infection time. Plot (a) corresponds to the squared exponential covariance functio n see, (1.2). Plot (b) corresponds to the exponential covariance f unction see, (1.3). Plot (c) corresponds to the Mat\u00e9rn covariance fun ction with set to 3/2 see, (1.4). The hyperparameter of the three co- variance functions, , is set to 2. 56CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN -SCALE EPIDEMICS 010203040506070809000.10.20.30.40.50.60.70.80.91 th(t) (a)010203040506070809000.20.40.60.811.2 th(t) (b) 010203040506070809000.20.40.60.811.2 th(t) by placing three different Gaussian pro cess priors. Plot (a) corresponds to the squared exponential cov ari- ance function see, (1.2). Plot (b) corresponds to the expone ntial covariance function see, (1.3). Plot (c) corresponds to the Mat\u00e9rn covariance function with set to 3/2 see, (1.4). The 95% credible intervals are shown for each of the plot. The \" |\" marks in each plot represent the observed data, i.e. the removal times. Th ere is a total of 30 infections during the whole epidemic and only re- moval times are known. The hyperparameter of the three covar i- ance functions, , is set to 2. 2.5 Conclusion This Chapter rstly described Bayesian nonparametric meth ods for inhomoge- neous Poisson processes introduced by Adams et al. (2009). T hen we adapted 57CHAPTER 2: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE OVERALL FORCE OF INFECTION IN SMALL -SCALE EPIDEMICS the methods and applied our methods to the epidemic data incl uding the sim- ulated data generated from the SIR epidemic model as well as t he real out- break data, the Smallpox data. We found that our methods work fairly well for epidemic models in small populations from the simulated epidemic data al- though some dramatic changes within a small time period in th e data may not be captured since the Gaussian process prior generally prod uces smooth esti- mate. For the Smallpox data, we compared our results with the ones obtained from O'Neill & Roberts (1999). We have similar mean and a slig htly larger stan- dard deviation in terms of the estimate of the removal rate. I n order to com- pare the estimate of the infection rate, we introduced an est imator, (t) =h(t) XtYt. We found that the posterior mean of (t)is larger than O'Neill & Roberts' es- timate at each estimated infection time although the estima ted infection rate from O'Neill & Roberts is fully covered in our 95% credible in tervals. The large uncertainty of the estimated infection rate and the large st andard deviation of the estimated parameters such as the estimated removal rate etc. indicate that the standard SIR model is not appropriate for the data. Final ly, we explored the effects of placing a Gaussian process prior with different c ovariance functions on the overall force of infection, h(t)at each infection time. We have successfully developed Bayesian nonparametric met hods for the over- all force of infection in small-scale epidemics where we ass ume the overall force of infection has the form, h(t)which does not consider the information of the number of susceptible and infectives. In the standard SIR mo del, the overall force of infection is often assumed to be of the form XtYt. Simulated data are generated based on such parametric assumptions. In the n ear future, one could further investigate our methods with simulated data w hich are generated with a modied overall force of infection, e.g. which has a fo rm,XtYt, where >0. 58CHAPTER 3 Bayesian nonparametric estimation for the infection rate in small-scale epidemics 3.1 Introduction In Chapter 2, we investigated the behaviour of the overall fo rce of infection in the SIR epidemic model by assuming it is of the form h(t), i.e. the overall force of infection is assumed to be a function of time without any pa rticular form on it. We adopted a Bayesian framework to estimate h(t)and therefore we placed a Gaussian process prior on it. The promising estimat ion results give us motivation to further explore the behaviour of the overal l force of infection using Bayesian nonparametric methods. It is known that in the SIR model, during its infectious perio d, an individual makes contacts with each of the Nsusceptibles at times given by the points of a homogeneous Poisson process with rate , a constant value. Although the assumption that the infection rate, , is constant over time is a common one in epidemic modelling, this is not always realistic (Fang et al., 2004). Speci- cally, could vary over time as a result of factors such as behaviour c hange in response to the epidemic, the introduction of control or mit igation measures, greater public awareness of the epidemic, and so on. From a mo delling per- spective, one could also introduce a time-dependent infect ion rate as a proxy for population homogeneity. For instance the idea that indi viduals who avoid 59CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS infection by a given time tmay be less likely to become infected thereafter, could be modelled by letting =(t)be decreasing over time. There has been many studies on estimating time-dependent infection rate o f various infectious diseases where epidemic models are tted using parametric f unctions for (t) see, (Becker, 1989, p.137, Pollicott et al., 2009, Pollicot t et al., 2012, Smirnova & Tuncer, 2014). However, no literature is concerned with the estimation of the infection rate in a Bayesian nonparametric work which furth er motivates us. Previously, we used h(t)to represent the overall force of infection and ignored the number of susceptibles and infectives in the population . In this Chapter, we will address the question of estimating =(t)in a Bayesian nonpara- metric framework and we will consider both the case of comple te observations (i.e. both infection and removal times) and partial observa tions (i.e. just re- movals observed). In other words, the overall force of infec tion will have a form, (t)XtYt. We will also introduce extended multi-group SIR models and estimate key quantities of interest such as infection rate o f the epidemic for the models from multi-group epidemic data via Bayesian nonpara metric methods and then illustrate our methods with simulated and real life data. Compared to the multi-group model, the single group SIR model is in fac t an extreme case that there is only one type of susceptible in the whole popula tion. The datasets SE-Data 1, SE-Data 2, SE-Data 3 and the Smallpox data we studi ed in Chapter 2 are all single group data. In Section 3.2, we will apply our m ethods to sin- gle group epidemic data. We will then investigate effect of d ifferent Gaussian process priors placed on the infection rate in Section 3.3. I n Section 3.4, we will describe the multi-group SIR model and apply our methods to t he multi-group data. In Section 3.5, we will compare the approaches discuss ed in Chapter 2 and Chapter 3. Finally, we will give conclusions in Section 3 .6. 3.2 Estimation for epidemic models from single group data In this section, we apply our Bayesian nonparametric method s to single group epidemic data and place a Gaussian process prior on the infec tion rate, (t). In terms of the observed data, we again perform inference from t he complete data 60CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS rst (i.e. infection and removal times) and then from the par tially observed data (i.e. only removal times). We assume that the initial number of susceptibles, N, and the initial number of infectives, a, are available. Before we discuss the inference, let us rst dene the model where the infection ra te is assumed to be a function of time, i.e. (t). According to Chapter 1, Section 1.3.1, The epidemic can be described according to the following Bayesian nonparametric method to infer the infection rate, (t), given the observed data which consist of a set of removal tim es. The un- observed infection times are treated as unknown parameters of the model. We assume the epidemic is known to have ceased. Therefore, the n umber of infec- tions equals to denote by {Ij}K j=1and{i}K i=1the ordered infection and removal times of the epidemic respect ively. Condition- ally on the infection rate, (t), the removal rate, , and the rst infection time, I1, we have the limit, so for example XIj=lim sIj(Xs). We now sample the removal rate, , from the desired posterior distribution. According to the algorithms developed by O'Neill & Roberts ( 1999), we use a Gibbs step to sample from the distribution (|,I,I1,(t)). With a gamma prior(,)put AYESIAN FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS We can also use a Gibbs step to sample I1from the distribution with an Expo- nential prior, i.e. I1has prior density given by exp(y)I(y<0), where >0, and I(\u00b7)is the indicator function. (y|,I,(t),) =exp{(I2y)},y(,I2), =++(I2)N. posterior distribu- tion. We use the SGCP model to describe the infection rate, (t). Specically, let (t) = (g(t)), : an upper bound on (t), (\u00b7): the logistic function, (z) = ( 1+ez)1, g(\u00b7): a random function which has a Gaussian process prior. For random innite-dimensional (t)such as the SGCP the integral/integraltextT I1(s)XsYsdsis not to Bayes' we p os- terior distribution g(t). The inte- gral over [I1,T]in the numerator and the integral over gin the denominator are both intractable. In particular, the value of the integral o vergin fact depends ongand is no longer a constant. In other words, standard MCMC met hods are unable to tackle this problem. We now augment the posterior distribution (3.2) considerin g the infection rate, (t), as an inhomogeneous Poisson process intensity. Specical ly, consider- 62CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS ing augmenting the observed data with the following variabl es: the number of thinned events, M, the locations of thinned events, {Is}M s=1, the function values at the infection times, gK= (g(I2),g(I3),\u00b7\u00b7\u00b7,g(IK))and the function val- ues at the thinned events, gM= (g(I1),g(I2),\u00b7\u00b7\u00b7,g(IM)), we can sample the above from the joint gMand gK. As the rst infection time, I1, is not modelled in the SIR epidemic model, we have in fact K1 function values at the infection times. 3.2.1.1 MCMC algorithms 1. Sampling I We now impute the rest of the infection times, I, using a Metropolis-Hastings algorithm and sample from uniformly draw a new location I jfrom[I1,T]and then draw a new function value g(I B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS variance of the distribution respectively, where X= (I2,I3,\u00b7\u00b7\u00b7,IK,I1,I2,\u00b7\u00b7\u00b7,IM) denotes locations of infection times and thinned events. Th en one of the exist- ing infection times is selected uniformly at random and repl aced by the pro- posed new values. The forward and backward densities hyperparameter, , respectively from their conditional posterior distributions. 2. Sampling According to the full conditional density for (|M,T,{Ij}K j=1)()K+M1exp{/integraldisplayT I1XsYsds}(), 64CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS where ()is a prior on . With a conditionally-conjugate gamma prior, (,), put on , we use a Gibbs step to update . We can sample from the full conditional distribution, (+K+M1,+/integraltextT I1XsYsds). 3. Sampling M We use a Metropolis-Hastings step to sample from the full con ditional distribu- tion of the number ()MM s=1XIsYIsM s=1(g(Is))\u00d7(gM+K|I,{Is}M s=1,). First, select either an or a deletion move, ea ch with probabil- ity1 2. For the insertion move, we propose a new location I swhich is uniformly sampled from [I1,T]and then draw a corresponding function value g(I s)from the conditioned multivariate Gaussian distribution s)|I s,gM+K,I,{Is}M s=1,), K(I s,X)K(X,X)1gM+Kand K(I s,I s)K(I s,I)K(I,X)1K(X,I s) respectively. The new value can be seen as a prediction of the Gaussian process. For the deletion move, a thinned event Is, is uniformly selected and removed from the current Mevents. Below is the derivation of the probability of accep- tance for the insertion and deletion move. Insertion FOR THE INFECTION RATE IN SMALL 4. Sampling {Is}M s=1 We use a Metropolis-Hastings step to perform sampling from t he full condi- tional distribution of locations of the thinned AYESIAN ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS We rst uniformly draw a new location I sfrom[I1,T]and then draw a new function value g(I s)from the Gaussian distribution, conditioned on the cur- rent More precisely, the distribution is (g(I s)|I s,gM+K,I,{Is}M s=1,), and the mean s,X)K(X,X)1gM+Kand K(I s,I s)K(I s,I)K(X,X)1K(X,I s)respectively. One of the existing thinned events is then selected uniformly at random and replaced by t he proposed new values. The forward and backward densities s)) XIsYIs\u00d7(g(Is)). 5. Sampling g M+K Given the infection times I, the locations of thinned events {Is}M s=1and the cur- rent hyperparameter , we wish to sample from the full conditional distribution of function values, gM+K, below. (gM+K|M,I,{Is}M AYESIAN ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS By using the underrelaxed MCMC method discussed in Chapter 2 , Section 2.2.5, we propose new function values g M+Kby a proposal of the form g M+K= gM+K+ 12hM+K, where hM+Kis drawn from the Gaussian process Sampling As we x the hyperparameter to 1 for our case, we only need to sample from the full conditional distribution of the hyperparameter shown below. (|M,gM+K,I,{Is}M s=1) (gM+K|I,{Is}M s=1,)\u00d7() We assign an exponential prior on , i.e. Exp(). Then we propose a new from a normal distribution with mean, the current value of and variance, 2. 68CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS The Metropolis-Hastings acceptance ratio for this the standard devia tions of the pro- posals were tuned to obtain an acceptance rate of 20-30%. 3.2.2 Simulated complete single group data 3.2.2.1 Constant infection rate We rst apply our methods to SE-Data 1, SE-Data 2 and SE-Data 3 which we simulated in Chapter 2 and assume that a set of infection time s are available. We choose the squared exponential covariance function for t he Gaussian pro- cess prior and assume that the hyperparameter, , is xed to 1. It is known that datasets SE-Data 1, SE-Data 2 and SE-Data 3 are all generated with a constant infection rate. We shall expect that the posterior means of (t)are fairly flat. Figure 3.1, 3.2 and 3.3 show the posterior means of infection rate at each in- fection time for SE-Data 1, SE-Data 2 and SE-Data 3 respectiv ely. As expected, the estimated infection rates, (t), at each infection time are close to the truth and appear to be quite smooth and flat. It is notable that in Fig ure 3.2, the 95% credible intervals become wider from time point 4. One expla nation could be that we have far fewer observations between [4, 7]than the one between [2, 4]. The same reason also applies to the estimate in Figure 3.3. 69CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 0 2 4 6 8 1000.010.020.030.040.050.06 t(t) Figure 3.1: Posterior mean of the infection rate (t)(solid line) at each infection time for SE-Data 1. The 95% credible intervals are shown as we ll. True infection rate (dotted line), =0.025. There is a total of 87 infections during the whole epidemic and all the infection t imes are assumed to be known. The \" |\" marks in the plot represent the observed data, i.e. the infection times. The squared exp onential covariance function is used for the Gaussian process prior a nd the hyperparameter of the covariance function, , is xed to 1. 70CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 0 1 2 3 4 5 6 700.0050.010.0150.020.0250.030.035 t(t) Figure 3.2: Posterior mean of the infection rate (t)(solid line) at each infection time for SE-Data 2. The 95% credible intervals are shown as we ll. True infection rate (dotted line), =0.015. There is a total of 130 infections during the whole epidemic and all the infection t imes are assumed to be known. The \" |\" marks in the plot represent the observed data, i.e. the infection times. The squared exp onential covariance function is used for the Gaussian process prior a nd the hyperparameter of the covariance function, , is xed to 1. 71CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 01234567800.0050.010.0150.020.0250.030.0350.04 t(t) Figure 3.3: Posterior mean of the infection rate (t)(solid line) at each infection time for SE-Data 3. The 95% credible intervals are shown as we ll. True infection rate (dotted line), =0.015. There is a total of 189 infections during the whole epidemic and all the infection t imes are assumed to be known. The \" |\" marks in the plot represent the observed data, i.e. the infection times. The squared exp onential covariance function is used for the Gaussian process prior a nd the hyperparameter of the covariance function, , is xed to 1. 3.2.2.2 Infection rate varies throughout the epidemic We now simulate a new epidemic data set (SE-Data 4) from the SI R model as- suming that the infection rate varies throughout the whole e pidemic. Table 3.1 gives infection rate, removal rate, initial number of su sceptibles and initial number of infectives for generating the data. We then apply o ur methods to SE- Data 4 and assume that a set of infection times. We again choos e the squared exponential covariance function for the Gaussian process p rior and the hyper- parameter, , is xed to 1. Figure 3.4 shows the posterior mean of the infec tion rate at each infection time for SE-Data 4. From Figure 3.4, we see the estimated infection rate recovers the truth fairly well which implies that our methods ap- pear to be working reasonably well not only for the case where the simulated data are generated with a constant infection rate, but also f or the case where the simulated data are generated with varying infection rat e throughout the 72CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS epidemic. Table 3.1: Infection rate, (t), removal rate, , initial number of susceptibles, N, and initial number of infectives, a, for the new data set. The parameter setting is used to generate an epidemic process fr om the SIR model, i.e. the simulated epidemic data set named as SE-D ata 4. (t) N a parameter setting exp (t/10)/150 0.7 300 1 12345678910012345678x 103 t(t) Figure 3.4: Posterior mean of the infection rate (t)(solid line) at each infection time compared with true infection rate (dotted line). The 95 % cred- ible intervals are shown as well. There is a total of 222 infec tions during the whole epidemic and all the infection times are ass umed to be known. The \" |\" marks in the plot represent the observed data, i.e. the infection times. The squared exponential cov ariance function is used for the Gaussian process prior and the hyper pa- rameter of the covariance function, , is xed to 1. 73CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 3.2.3 Simulated partially observed single group data 3.2.3.1 Constant infection rate We now assume we only observe removal times, i.e. we do not kno w infection times and removal rate of the epidemic. We rst apply our meth ods to SE-Data 1, SE-Data 2 and SE-Data 3 which are generated with a constant infection rate. The squared exponential covariance function for the Gaussi an process prior is adopted and the hyperparameter is xed to 1. Figure 3.5, 3.6 and 3.8 show the estimation results for SE-Data 1, SE-Data 2 and SE-Data 3 under different assumptions, i.e. complete data observed and only removal t imes observed. Each Figure gives the posterior mean of the infection rate. D ensity of the re- moval rate is also given in Figure 3.5 (c), 3.6 (c) and 3.8 (c) f or the case where data are partially observed. From Figure 3.5 (b), 3.6 (b) and 3.8 (b), we can see that the estimated results of (t)recover the truth fairly well and it turns out that there is little difference between the case where the co mplete data are ob- served (shown in Figure 3.5 (a), 3.6 (a) and 3.8 (a)) and the ca se where we only observe incomplete data. From the density plots, we have goo d estimations of for all of the three dataset and it also appears that we have th e least deviation from the posterior mean of the removal rate, for SE-Data 3. One explanation could be that there are larger numbers of people infected in S E-Data 3 than the other two data sets which leads to more accurate estimation o f the removal rate. However, this is just one dataset only so it could be just due t o chance. Figure 3.7 shows MCMC trace plot of the hyperparameter, , the infection rate at time t=2.42 and t=3.42 respectively for SE-Data 2. 3.2.3.2 Infection rate varies throughout the epidemic We now apply our methods to SE-Data 4 which are generated with varying infection rate throughout the whole epidemic. We also assum e we only observe removal times. The squared exponential covariance functio n for the Gaussian process prior is adopted and the hyperparameter, , is xed to 1. Figure 3.9 shows the posterior mean of the infection rate, (t), and density of the removal rate, . Compared to the results for the completed epidemic case sho wn in Figure 3.9 (a), the estimation shown in Figure 3.9 (b) is not a s good. However, 74CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 0 2 4 6 8 1000.010.020.030.040.050.06 t(t) (a)0 2 4 6 8 1000.0050.010.0150.020.0250.030.0350.040.0450.05 t(t) (b) 0 0.5 1 1.5 2 2.5 300.20.40.60.811.21.41.6Density (c) Figure 3.5: Posterior mean of the infection rate (t)(solid line) at each esti- mated infection time for SE-Data 1 (plot (a) and plot(b)). Tr ue in- fection rate (dotted line), =0.025 and true removal rate, =1. The 95% credible intervals are shown in (a) and (b). Plot (a) i s the case where complete data are observed. Plot (b) is the case wh ere only removal times are observed. The \" |\" marks in each plot represent the observed data, i.e. the infection times in (a) and re- moval times in (b). Plot (c) shows density of the removal rate for the second case. There is a total of 87 infections during the w hole epidemic. The squared exponential covariance function is u sed for the Gaussian process prior and the hyperparameter of the cov ari- ance function, , is xed to 1. 75CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 0 1 2 3 4 5 6 700.0050.010.0150.020.0250.030.035 t(t) (a)01234567800.0050.010.0150.020.0250.030.035 t(t) (b) 0 0.5 1 1.5 2 2.5 300.20.40.60.811.21.41.61.8 Density (c) Figure 3.6: Posterior mean of the infection rate (t)(solid line) at each esti- mated infection time for SE-Data 2 (plot (a) and plot(b)). Tr ue in- fection rate (dotted line), =0.015 and true removal rate, =1. The 95% credible intervals are shown in (a) and (b). Plot (a) i s the case where complete data are observed. Plot (b) is the case wh ere only removal times are observed. The \" |\" marks in each plot rep- resent the observed data, i.e. the infection times in (a) and removal times in (b). Plot (c) shows density of the removal rate for th e sec- ond case. There is a total of 130 infections during the whole e pi- demic. The squared exponential covariance function is used for the Gaussian process prior and the hyperparameter of the covari ance function, , is xed to 1. 76CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 0 2000 4000 6000 8000 100000102030405060708090100 (a)0 2000 4000 6000 8000 6000 8000 1000000.0050.010.0150.020.0250.030.0350.040.0450.05(t= 3.42) (c) Figure 3.7: Dataset SE-Data 2 recovered by placing the Gaussian process prior where only removal times are known. Plot (a) shows MCMC trace plot of the hyperparameter, . Plot (b) and (c) show MCMC trace plot of the infection rate at time t=2.42 and t=3.42 respectively. The squared exponential covariance function is used for the Gaus- sian process prior and the hyperparameter of the covariance func- tion, , is xed to 1. 77CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 01234567800.0050.010.0150.020.0250.030.0350.04 t(t) (a)0 200.511.522.53 Density (c) Figure 3.8: Posterior mean of the infection rate (t)(solid line) at each esti- mated infection time for SE-Data 3 (plot (a) and plot(b)). Tr ue in- fection rate (dotted line), =0.015 and true removal rate, =1. The 95% credible intervals are shown in (a) and (b). Plot (a) i s the case where complete data are observed. Plot (b) is the case wh ere only removal times are observed. The \" |\" marks in each plot rep- resent the observed data, i.e. the infection times in (a) and removal times in (b). Plot (c) shows density of the removal rate for th e sec- ond case. There is a total of 189 infections during the whole e pi- demic. The squared exponential covariance function is used for the Gaussian process prior and the hyperparameter of the covari ance function, , is xed to 1. 78CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS the truth totally lies within the 95% credible intervals. Th e density plot shows we have fairly good estimation of . 12345678910012345678x 103 t(t) (a)0 2 4 6 8 t(t) (b) 0.40.50.60.70.80.911.11.21.300.511.522.533.54 Density (c) Figure 3.9: Posterior mean of the infection rate (t)(solid line) at each esti- mated infection time for SE-Data 4 (plot (a) and plot (b)). Tr ue re- moval rate, =0.7. The 95% credible intervals are shown in (a) and (b). Plot (a) is the case where complete data are observed . Plot (b) is the case where only removal times are observed. The \" |\" marks in each plot represent the observed data, i.e. the infe ction times in (a) and removal times in (b). Plot (c) shows density o f the removal rate for the second case. There is a total of 222 infec tions during the whole epidemic. The squared exponential covaria nce function is used for the Gaussian process prior and the hyper pa- rameter of the covariance function, , is xed to 1. 79CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 3.2.4 Smallpox data We now apply our methods to real life data, namely Smallpox da ta as described in Chapter 2, Section 2.3.4. We assume only removal times are known. All the infection times for each individual and the removal rate are inferred by the MCMC methods. We then apply our methods to the data and place a Gaus- sian process prior using the squared exponential covarianc e function on the infection rate, (t). The hyperparameter, , is xed to 1. Figure 3.10 (a) shows the posterior mean of the infection rate. For comparison, we give two estima- tion results of the infection rate from Becker (1989), p.137 , shown in Figure 3.10 (b). The author assumed the infection rate is decreasing ove r time, hence an exponential function was used to model the infection rate. A lthough our re- sults show some differences that the infection rate keeps in creasing for nearly 30 days from the beginning of the epidemic, the decreasing pa rt of our results is similar to Becker's results. Figure 3.11 shows the density o f the removal rate, , the hyperparameter, , the upper bound, and the number of thinned events, Mrespectively. For the estimation of , our results appear to be close to the ones obtained by O'Neill & Roberts (1999). 80CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 010203040506070809000.511.522.53x 103 t(t) (a) (b) Figure 3.10: Smallpox data recovered by placing the Gaussian process pri or. The plot (a) shows posterior mean of the infection rate, (t), at each estimated infection time using our Bayesian nonparame tric methods where the squared exponential covariance function is adopted. The \" |\" marks in the plot represent the observed data, i.e. the removal times. The plot (b), obtained from Becker (1 989), p.137, shows two estimation results of the infection rate fo r small- pox data from Becker's methods. The infection rate is assume d to be a decreasing function of time in the two models. 81CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 00.05 0.1 0.15 0.2 0.25 0.3 0.350246810121416 Density (a)0 20 40 60 80 100 120 14000.010.020.030.040.050.06 Density (b) 0 0.002 0.004 0.006 0.008 150 20000.0050.010.0150.020.025 MDensity (d) Figure 3.11: Smallpox data recovered by placing the Gaussian process pri or on(t). Four plots show densities of the removal rate, , the hy- perparameter, , the upper bound and the number of thinned events, Mrespectively. The squared exponential covariance func- tion for the Gaussian process prior is adopted. 3.3 Sensitivity to the Gaussian process prior for the SIR epidemic model Similar to Section 2.4, we investigate the effect of the choi ce of covariance func- tion on the inferences in this section. We choose 3 different covariance func- tions, i.e. squared 3/2. 82CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS We now apply our methods to SE-Data 2 and perform inference fo r the infection rate, (t), by assuming we observe the complete data. Figure 3.12 shows the es- timated intensities using squared exponential covariance function, exponential covariance function and Mat\u00e9rn class covariance function f or the Gaussian pro- cess prior respectively for SE-Data 2. Compared to the estim ated intensity in Figure 3.12 (a) where the squared exponential covariance fu nction is used, the estimated intensity in Figure 3.12 (b) is quite rough and has larger uncertainty. One explanation could be that a rough covariance function is chosen for the Gaussian process prior which is expected to produce a rough p rocess. The esti- mated intensity in Figure 3.12 (c), has similar mean and unce rtainty to the one in (a). In terms of smoothness, the plots in (a) and (c) are sim ilar. We also evaluate our methods for the three different Gaussia n process priors for the Smallpox. Figure 3.13 shows the recovered trajector ies for the squared exponential covariance function, exponential covariance function and Mat\u00e9rn class covariance function respectively. The plot (a) is sli ghtly smoother than (b) and (c) and the results in (b) are very similar to the ones in (c ). In general, we nd that inferences are insensitive to the choice of Gaussia n process priors for the Smallpox data. 83CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 0 1 2 3 4 5 6 700.0050.010.0150.020.0250.030.035 t(t) (a)0 1 2 3 4 5 6 700.0050.010.0150.020.0250.030.0350.04 t(t) (b) 0 1 2 3 4 5 6 700.0050.010.0150.020.0250.03 t(t) (c) Figure 3.12: Dataset SE-Data 2 recovered by placing three different Gaus sian process priors. Three plots show posterior mean of the infec tion rate, (t)(solid line) at each infection time compared with the true (dotted line). The data are generated from the general stoch astic epidemic with parameters infection rate =0.015, removal rate =1, initial number of susceptibles N=150 and initial number of infective individuals a=1. Plot (a) corresponds to the squared exponential covariance function see, (1.2). Plot (b) corre sponds to the exponential covariance function see, (1.3). Plot (c) co rresponds to the Mat\u00e9rn covariance function with set to 3/2 see, (1.4). The 95% credible intervals are shown for each of the plot. The \" |\" marks in each plot represent the observed data, i.e. the infe ction times. There is a total of 130 infections during the whole epi demic and all the infection times are assumed to be known. The hyper - parameter of the three covariance functions, , is set to 1. 84CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 010203040506070809000.511.522.53x 103 t(t) (a)010203040506070809000.511.522.53x 103 t(t) (b) 010203040506070809000.511.522.53x 103 t(t) (c) Figure 3.13: Smallpox recovered by placing three different Gaussian pro cess priors. Three plots show posterior mean of the infection rat e,(t) (solid line) at each estimated infection time. Plot (a) corr esponds to the squared exponential covariance function see, (1.2). Plot (b) corresponds to the exponential covariance function see, (1 .3). Plot (c) corresponds to the Mat\u00e9rn covariance function with set to 3/2 see, (1.4). The 95% credible intervals are shown for each of the plot. The \" |\" marks in each plot represent the observed data, i.e. the removal times. There is a total of 30 infections duri ng the whole epidemic and only removal times are known. The hyper- parameter of the three covariance functions, , is set to 1. 85CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 3.4 Estimation for epidemic models from multi-group epidemic data In Section 3.2, we demonstrated that our Bayesian nonparame tric methods ap- pear to be working fairly well for epidemic models from singl e group epidemic data which motivated us to investigate more complex cases wi th our methods. For example, the population can be no longer homogeneous, bu t partitioned into groups according to level of susceptibility. Hayakawa et al. (2003) devel- oped Bayesian methods for SIR epidemic models with several k inds of suscep- tibles. In this Section, we will rst introduce the multi-gr oup model discussed in Hayakawa et al. (2003) and then apply our Bayesian nonpara metric methods to multi-group epidemic data (simulated data and real life d ata). 3.4.1 Multi-group epidemic model We now describe the extended multi-group SIR model discusse d in Hayakawa et al. (2003). Consider a population consisting initially o fkgroups of suscep- tibles, where the groups are labelled 1, \u00b7\u00b7\u00b7,k, and group icontains Nisuscep- tibles, i=1,\u00b7\u00b7\u00b7,k. An epidemic is initiated in the population by one of the susceptibles becoming infected and this infection is assum ed to occur via some process external to the population. For t0 and i=1,\u00b7\u00b7\u00b7,k, denote by Xi(t) and Yi(t)the numbers of susceptibles and infectives, respectively, in group i at time t. Let Y(t) = k i=1Yi(t)denote the total number of infectives in the population at time t. The epidemic is then dened according to the following transition probabilities, the transitions themselves cor responding respectively to an infection and a removal: P((Xi(t+t),Y(t+t))= (x1,y+1)|(Xi(t),Y(t))= (x,y))=ixyt+o(t), P((Xi(t+t),Y(t+t))= (x,y1)|(Xi(t),Y(t))= (x,y))=yt+o(t), all other transitions having probability o(t). A removed individual does not take part in the epidemic any longer. The epidemic ceases if t here are no more infectives left in the population. The assumptions imply th at each susceptible 86CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS of type iis affected equally by any infectives irrespective of the in fective's type, and that the durations of the infectious periods are indepen dent and identically distributed Exponential random variables with rate . Under the assumption that the infection rate for each group i s no longer a con- stant but a function of time the transition probabilities list of notation that we use. i= (i1,i1,\u00b7\u00b7\u00b7,ini): the vector of ordered removal times of type i Ii= (Ii1,Ii1,\u00b7\u00b7\u00b7,Iimi): the vector of ordered infection times of type i I=(I1,I2,\u00b7\u00b7\u00b7,Ik) =(1,2,\u00b7\u00b7\u00b7,k) (t)=(1(t),2(t),\u00b7\u00b7\u00b7,k(t)) N=(N1,N2,\u00b7\u00b7\u00b7,Nk) Ii1: the time of the rst infection in group i Imin=min(I11,I21,\u00b7\u00b7\u00b7,Ik1): the time of the rst infection in the total popula- tion imin: type ifor which Ii1=Imin ni: number of removals of type i mi: the unobserved total number of infections of type i N=k i=1Ni: the initial number of susceptibles in the total population I /tildewide:{I\\Imin} As our interest focuses on the infection rate in each group, i t is assumed that we know the initial number of susceptibles in each group, N, and the type of 87CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS the time of the rst infection in the total population, imin. According to the augmentation methods in Hayakawa et al. (2003), we can write the joint distri- bution over the infection rate in each group, (t), the removal rate, , the time of the rst infection in the total population. Iminby Bayes' Theorem prior density of (t),and Imin. Considering the removal part in (3.3), we can write the full c onditional distri- bution the algorithms described in Hayakawa et al. (20 03), with a gamma prior(,)put on , we can sample we use the similar method discussed in Section 3.2.1 to upda te Imin. By using a Gibbs sampling approach, with a non-informative exponential prior put on, we can sample from the distribution if the rst i nfection time is in group i (y|i,I /tildewide,i,) =exp{(I2y)},y(,I2), where I2=min(Ii2,{Ij1}k j=1,j/\\e}atio\\slash=i)and =+(I2)N. It now only to nd a way of sampling (t)and I /tildewide. The main problem here is to make the infection part in (3.3) tractable. Simila r to the methods used 88CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS for the single group case, we use the SGCP model to describe th e infection rate for group i,i(t). i(t) = i(g(t)), where i: an upper bound on i(t). To tackle the intractable problem, we again augment the post erior distribution like we did for the single group case. For group iand if Ii1=Imin, the addi- tional latent variables are: the number of thinned events, Mi, the locations of thinned events, Ii= (Ii1,Ii2,\u00b7\u00b7\u00b7,IiMi), the function values at the infection times, gmi= (g(Ii2),g(Ii3),\u00b7\u00b7\u00b7,g(Iimi))and the function values at the locations of thinned events, gMi= (g(Ii2),g(Ii3),\u00b7\u00b7\u00b7,g(IiMi)). If Ii1/\\e}atio\\slash=Imin, we need to consider the rst infection time, Ii1, in group i. Therefore, g(Ii1)should be added to gmi. We can now write the augmented likelihood we require below. (I ifi=iminand 0 otherwise. Considering (3.4), we can now write the full conditional density of each parameter. For group i, the parameters above for each grou p is similar to the single group case in Section 3.2.1 and will not be discuss ed here. 3.4.3 Simulated partially observed multi-group data We now simulate a set of multi-group data with a parameter set ting given in Table 3.2. The total population of 254 is partitioned into th ree groups. The groups' initial population size are reported as N1=25,N2=36 and N3= 192. The total number of cases in each of the three groups are 1 0, 12 and 30 respectively. We assume that only removal times of each grou p are observed. We apply our methods to the data and place the Gaussian proces s prior on 1, 2and 3respectively. The prior distributions for the Gaussian pro cess in each group are assumed to be independent. The squared exponentia l covariance function is used for the Gaussian process prior and the hyper parameter of the covariance function, , is xed to 1. Figure 3.14 (a), (b) and Figure 3.15 (a) show 90CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS estimation results for the infection rate of each group. Com pared to the truth, the posterior means of the infection rate of all three groups are smooth and flat and all close to the true values. In addition, the true values are all lie in the 95% credible intervals which although show large uncertain ties. Figure 3.15 (b) shows the density of the estimated removal rate which implie s that we have a good estimation for the removal rate. Table 3.2: Infection rate, , removal rate, , initial number of susceptibles, N, and initial number of infectives, a, for the new 3-group data set. The parameter setting is used to generate an epidemic process fr om the multi-group SIR model, i.e. the simulated epidemic data set named as SE-Data 5. N a group 1 0.005 25 0 0.5group 2 0.005 36 0 group 3 0.002 192 1 91CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 0 5 10 15 20 2500.0050.010.015 t1(t) (a) 0 5 10 15 20 2500.0050.010.015 t2(t) (b) Figure 3.14: (a), posterior mean of the infection rate 1(t)(solid line) at each estimated infection time for SE-Data 5. True infection rate ,1= 0.005. The 95% credible intervals are shown as well. (b), pos te- rior mean of the infection rate 2(t)(solid line) at each estimated infection time for SE-Data 5. True infection rate, 2=0.005. The 95% credible intervals are shown as well. Only removal times of each group are known. The \" |\" marks in each plot represent the observed data, i.e. the removal times. The squared exponent ial covariance function is used for the Gaussian process prior a nd the hyperparameter, , is xed to 1. 92CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 3.4.4 Respiratory disease multi-group data We also apply our methods to the real multi-group data discus sed in Becker & Hopper (1983) and Hayakawa et al. (2003). The dataset corre sponds to re- moval times of individuals with a respiratory disease which occurred between October and November of 1967 on the island of Tristan da Cunha in the South Atlantic. The total population of the island of 255 was parti tioned into three groups by age: infants, children and adults. As there was one unidentied case, we suppose N=254. The groups' initial number of susceptibles are N1=25, N2=36 and N3=192. It is notable that we assume the initial number of susceptibles for adults group is 192 instead of 193 given in ( Hayakawa et al., 2003) since it is assumed that the group type for the rst infe ction time in the total population is known, i.e. we know that ainfants=0,achildren=0and aadults=1, where airepresents the initial number of infectives in group i. The total number of cases in each group was 9, 6 and 25 respectively. We apply ou r methods to the data and place the Gaussian process prior on infants=0,children=0and adults=1 respectively. Figure 3.16 (a), (b) and Figure 3.17 (a) show t he estimation re- sults for the infection rate of each group. Table 3.3 gives es timation results of the infection rate and removal rate from Hayakawa et al. (200 3) for the real multi-group data, i.e. mean and standard deviation of the in fection rate and removal rate are given in Table 3.3. For the groups of infants and children, the results are fairly close to the ones given in Hayakawa et al. ( 2003). However, the result for the adults group starts from 0.001 and then kee ps increasing until nearly 0.0015. One explanation could be that there is signi cantly more infor- mation given from the adults group, i.e. total population of 192 and 25 cases from adults group compared to total population of 25 and 9 cas es from infants group and total population of 36 and 6 cases, the Gaussian pro cess prior put on the infection rate may capture features that causes an incre asing change on the infection rate from the observed data and tell a different st ory on the infection rate of the epidemic in the adults group. Figure 3.17 (b) give s the density of the removal rate which implies that we have a good estimation for the removal rate. 93CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 0 5 10 15 20 2500.511.522.533.544.55x 103 t3(t) (a) 0 0.2 0.4 0.6 0.8 1 1.2 1.400.511.522.53 Density (b) Figure 3.15: (a), posterior mean of the infection rate 3(t)(solid line) at each es- timated infection time for SE-Data 5. True infection rate, =0.002 and true removal rate, =0.5. The 95% credible intervals are shown as well. (b), density of the removal rate. Only removal times of each group are known. The \" |\" marks in the plot repre- sent the observed data, i.e. the removal times. The squared e xpo- nential covariance function is used for the Gaussian proces s prior and the hyperparameter of the covariance function, , is xed to 1. 94CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 6 8 10 12 14 16 1800.0050.010.015 t1(t)-infants (a) 8 10 12 14 16 1800.511.522.533.544.55x 103 t2(t)-children (b) Figure 3.16: (a), posterior mean of the infection rate infants(t)(solid line) at each estimated infection time for the respiratory disease d ata (Hayakawa et al., 2003). The 95% credible intervals are show n as well. (b), posterior mean of the infection rate children(t)(solid line) at each estimated infection time for the respiratory d isease data. The 95% credible intervals are shown as well. Only remo val times of each group are known. The \" |\" marks in each plot repre- sent the observed data, i.e. the removal times. The squared e xpo- nential covariance function is used for the Gaussian proces s prior and the hyperparameter of the covariance function, , is xed to 1. 95CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 0 5 10 15 20 25 3000.511.522.533.544.55x 103 t3(t)-adults (a) 0.10.20.30.40.50.60.70.80.9100.511.522.533.54 Density (b) Figure 3.17: (a), posterior mean of the infection rate adults(t)(solid line) at each estimated infection time for the respiratory disease d ata (Hayakawa et al., 2003). The 95% credible intervals are show n as well. (b), density of the removal rate. Only removal times in each group are known. The \" |\" marks in the plot represent the observed data, i.e. the removal times. The squared exponent ial covariance function is used for the Gaussian process prior a nd the hyperparameter of the covariance function, , is xed to 1. 96CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS Table 3.3: Mean and standard deviation of the infection rate in each grou p for the real multi-group data (Hayakawa et al., 2003). The resul ts are obtained from Hayakawa et al. (2003) where the initial numbe r of susceptibles in each group is assumed to be known. 1 2 3 mean 0.00451 0.00181 0.00131 with h(t)approach In this section we compare the approaches discussed in this c hapter and in Chapter 2. Recall that in Chapter 2, it is assumed that the ove rall force of in- fection is of the form, h(t). Conversely in this chapter, we assume it is of the form, (t)XtYt. In Chapter 2, Section, 2.3.4, we introduced an estimator of the infection rate which is (t) =h(t) XtYt. We now compare estimates of (t)with (t)using the simulated datasets SE-Data 2 and SE-Data 3 as well a s the real outbreak data, the Smallpox data. We assume only removal tim es are observed. Figure 3.18 (a) and (b) show posterior mean of (t)and (t)respectively for the dataset SE-Data 2. From Figure 3.18, the result in plot (a) st ruggles to recover the truth, although most part of the truth is covered in the 95 % credible inter- vals. Compared to the estimate of (t)in plot (a), the estimate of (t)is much more rough. The reason could be that the function, , is expected to produce a very rough process as discussed in Chapter 2, Section 2.3.4. Figure 3.19, for an- other dataset SE-Data 3, also illustrates this point. Figur e 3.20 shows posterior mean of (t)and (t)respectively for the Smallpox data. From Figure 3.20, we nd that the estimate of (t)at each infection time is over 0.001, whereas the estimate of (t)is around 0.001 all the time. Compared to the results in O'Nei ll & Roberts (1999), (i.e. the mean of is 0.0009 and the standard deviation is 0.00019), we conclude that our approached discussed in Chap ter 3 is a better way to estimate the infection rate for the SIR epidemic model . 97CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE IN SMALL -SCALE 01234567800.010.020.030.040.050.060.07 t(t) (a)01234567800.0050.010.0150.020.0250.030.035 t(t) (b) Figure 3.18: Dataset SE-Data 2 recovered by placing the Gaussian process prior with different Bayesian nonparametric methods. Two plots s how posterior mean of the infection rate, (t)and (t)(solid line) at each infection time respectively. The original data XtYt(dotted line) are generated from the general stochastic epidemic wi th pa- rameters infection rate infective indi- viduals a=1. Only removal times are observed for both cases. Plot (a) corresponds to the case where the approach discusse d in Chapter 2 is used. Plot (b) corresponds to the case where the a p- proach discussed in Chapter 3 is used. The 95% credible inter vals are shown for each of the plot. The \" |\" marks in each plot repre- sent the observed data, i.e. the removal times. The squared e xpo- nential covariance function is used for the Gaussian proces s prior and the hyperparameter of the covariance function, , is set to 2 and 1 for (t)and (t)respectively. 98CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS 0 2 4 6 8 1000.010.020.030.040.050.06 t(t) (a)0 2 4 6 8 1000.0050.010.0150.020.0250.03 t(t) (b) Figure 3.19: Dataset SE-Data 3 recovered by placing the Gaussian process prior with different Bayesian nonparametric methods. Two plots s how posterior mean of the infection rate, (t)and (t)(solid line) at each infection time respectively. The original data XtYt(dotted line) are generated from the general stochastic epidemic wi th pa- rameters infection rate infective indi- viduals a=1. Only removal times are observed for both cases. Plot (a) corresponds to the case where the approach discusse d in Chapter 2 is used. Plot (b) corresponds to the case where the a p- proach discussed in Chapter 3 is used. The 95% credible inter vals are shown for each of the plot. The \" |\" marks in each plot repre- sent the observed data, i.e. the removal times. The squared e xpo- nential covariance function is used for the Gaussian proces s prior and the hyperparameter of the covariance function, , is set to 2 and 1 for (t)and (t)respectively. 99CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE RATE IN SMALL -SCALE EPIDEMICS 01020304050607080900123456x 103 t(t) (a)010203040506070809000.511.522.53x 103 t(t) (b) Figure 3.20: Smallpox data recovered by placing the Gaussian process pri or with different Bayesian nonparametric methods. Two plots s how posterior mean of the infection rate, (t)and (t)(solid line) at each infection time respectively. Only removal times are ob served for both cases. Plot (a) corresponds to the case where the app roach discussed in Chapter 2 is used. Plot (b) corresponds to the ca se where the approach discussed in Chapter 3 is used. The 95% cre d- ible intervals are shown for each of the plot. The \" |\" marks in each plot represent the observed data, i.e. the removal time s. The squared exponential covariance function is used for the Gau ssian process prior and the hyperparameter of the covariance func tion, , is set to 2 and 1 for (t)and (t)respectively. 3.6 Conclusion In this Chapter, we investigated the behaviour of the overal l force of infection in the SIR epidemic model by assuming it has the form (t)XtYt, i.e. the infection rate is assumed to be a function of time. We developed a Bayesi an nonpara- metric method for estimating such SIR epidemic model and obt ained reason- ably well estimation results from analysing the single grou p data including the simulated and the real life data. We also investigated the ef fect of different Gaussian process priors placed on (t)for the simulated and the real life data. We found that they do not make much difference apart from smoo thness. We also described an extended SIR epidemic model with several k inds of suscep- tibles. We applied our methods to the simulated and real life multi-group data 100CHAPTER 3: B AYESIAN NONPARAMETRIC ESTIMATION FOR THE INFECTION RATE IN SMALL -SCALE EPIDEMICS and good estimation results indicated that our methods work fairly well for the multi-group model as well. Finally, we compared the approac h with the one developed in Chapter 2 where we assume the overall force of in fection is of the form, h(t), which does not depend on the number of susceptibles and infe ctives but time. Specically, we compared the estimate of infec tion rate in two dif- ferent Bayesian nonparametric methods, i.e. (t)and (t). We showed that the approach which considering the information of the number of susceptibles and infectives is a better way to estimate the infection rate, al though it took longer to run the MCMC algorithms due to the extra computation of the number of susceptibles and infectives. The approaches developed in Chapter 2 and Chapter 3 both have a limitation, i.e. the computational complexity. It is known that Gaussia n processes have heavy computational demands, i.e. O(n3)time complexity for ninput points. As both our approaches are concerned with Gaussian process p riors which in- volve heavy matrix computation, e.g. inverse of the matrix, computation times would become prohibitive when dealing with large datasets, for example, the number of cases exceeds a thousand. An approximation of the m odel may be considered to tackle this problem. We have successfully applied Bayesian nonparametric metho ds to estimate the standard SIR model in small populations where we assume the i nfectious pe- riod follows an exponential distribution. A natural extens ion of the methods is the relax of the assumption of the infectious period. Spec ically, one could apply our methods for the SIR model with non-exponential inf ectious period in the small-scale epidemics. Another extension could be that one may estimate the SEIR model using our methods where a latent period is cons idered. 101CHAPTER 4 Bayesian nonparametric estimation for epidemic models in large populations from time-series data 4.1 Introduction In previous chapters, we have developed methods for Bayesia n nonparametric inference which involve data augmentation MCMC methods. Al though such methods are powerful, they struggle to perform adequately a s the dimension- ality increases, i.e. as the number of unknown infection tim es becomes large. In this chapter, we adapt an approximation method due to Cauc hemez & Fer- guson (2008) to produce method of i nference for epi- demics in large populations. Specically, this chapter is c oncerned with meth- ods to parameterise epidemic models from time-series data, e.g. number of observed cases each day or week, etc. In practice, an epidemic process is only partially observed , and observations are often aggregated in time. Surveillance data typically p rovide counts of new infection cases occurring during observation periods of le ngth Ton a local or national basis and in some situations, the number of new infe ction cases is likely to be under-reported. We refer to such data as epidemic time- series data. Standard MCMC uses data augmentation to tackle the missing d ata problem. However, for large epidemics in large populations, the numb er of infectives is normally so large that it is infeasible to augment the data wi th the times of in- 102CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA fection/removal of each case. In other words, if the infecti on times for each individual are all imputed and considered as additional par ameters as well as the number of susceptibles and infectives at each infection time, it will take an unacceptably long time for the MCMC algorithm to converge wi th current com- puting techniques. Therefore, tractable approximations o f the epidemic model, such as the SIR model, need to be adopted. Cauchemez & Ferguso n (2008) pro- posed statistical methods in a Bayesian framework to estima te the continuous- time SIR model from time-series data, when large population s are considered. We rst introduce the methods designed by Cauchemez & Fergus on (2008) and then apply our methods, Bayesian nonparametrics, to estima te key quantities of the SIR model, infection rates, from time-series data. In this chapter, we will rst introduce a method to approxima te the SIR model when dealing with large-scale epidemics in Section 4.2 and t hen we will de- scribe a method for inference using an MCMC algorithm in Sect ion 4.3. The two sections together are a brief explanation of Cauchemez & Fer guson's method (2008). We will then describe a simulation study using Cauch emez & Fergu- son's method in Section 4.4. In Section 4.5, we will describe our method using a Bayesian nonparametric framework and apply the method to s imulated data. We will also explore the method further under different assu mptions and pa- rameter settings in this section. Finally, we apply Cauchem ez & Ferguson's method and our method to the real data, i.e. a time series of in cidence of measles in London (1948-1957) and compare the results of est imation using the two methods. 4.2 Approximation to the SIR epidemic model 4.2.1 Introduction As described in the previous chapter, the SIR epidemic model is a continuous- time Markovian model which describes the spread of an infect ious disease in a population. Below is a mathematical denition of the model with the addi- tion of births into the susceptible population considered i n terms of Markovian transition rates: 103CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS the -algebra generated by the history {Su,Iu,Ru; 0ut}. In the equations, the mortality due to disease is as- sumed to be neglected and the number of individuals who leave the susceptible population due to death or immigration is assumed to be negle cted as well. In reality, the epidemic process for infectious diseases li ke measles is partially observed. Consider data consisting of the number of new infe ctions,{Uk}K k=0, and the number {Bk}K of length Tlabelled k= 0, 1, 2,\u00b7\u00b7\u00b7,K, where Tcould be a number of weeks or months. We consider Uk as the number of times in interval [kT,(k+1)T]when Itincreases by +1. The among I(k+1)T are respectively the number of infectives at the beginning o f the(k+1)thand (k+2)thperiod. As Rkis always non-negative, then there is a constraint that UkI(k+1)TIkT. Figures 4.1 and 4.2 show two possible trajectories for the number of infectives Itwith ve new infections occurring during the (k+1)th period, i.e. Uk=5. It is shown that, although the same number of new in- fections is observed in Figures 4.1 and 4.2, the infection an d removal processes between the two cases are very different. As a result of stoch astic fluctuations, important differences could be observed between trajector ies, even if the infec- tion rate and removal rate were the same. 104CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA 0 1 2 3 4 5 of infectives Itwith Uk=5, where Ukis infections occurring during the(k+1)thperiod from kTto(k+1)Tand IkT=3,I(k+1)T=3. 0 1 2 3 of infectives Itwith Uk=5, where Ukis infections the(k+1)thperiod from kTto(k+1)Tand IkT=3,I(k+1)T=5. Suppose we observe IkTand SkT, the number of infectives and susceptibles at the beginning of each observation period (these are conside red as parameters of the inference framework since they are unknown in practice) . Then, the main issue for inference is to determine the joint probability P(I(k+1)T,Uk|IkT,SkT) which also can be expressed as P(I(k+1)T,Uk|IkT,SkT) =P(I(k+1)T|IkT,SkT)P(Uk|I(k+1)T,IkT,SkT) (Cauchemez & Ferguson 2008). Without loss of generality, si nce the epidemic 105CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA process is time-homogeneous, we only look at the rst observ ation period, i.e. setk=0. Therefore, the equation above can be written as P(IT,U0|I0,S0) =P(IT|I0,S0)P(U0|IT,I0,S0). (4.1) The probability of ITgiven I0,S0and the probability of U0given IT,I0,S0in (4.1) are intractable in a large population, hence we use an approx imation to tackle this problem. Specically, the Cox-Ingersoll-Ross diffus ion process is adopted to work out the aforementioned probabilities. 4.2.2 The Cox-Ingersoll-Ross diffusion process The Cox-Ingersoll-Ross process, a diffusion process, is co mmonly used in - nancial markets to model interest rates (Cox et al. 1985). He re, we use this diffusion process to approximate the Markovian SIR process under the follow- ing assumptions: (i) Changes in the number of susceptibles Stwithin an observation period can be neglected and so St\u00afS0,t[0,T]. This assumption is reasonable if Stis sufciently large. (ii) The infection rate is constant during an observation pe riod and so (t) 0,t[0,T], where (t)is infection rate at time twhich depends on time. The estimation of \u00afS0is given in appendix C in Cauchemez & Ferguson (2008). Under assumptions (i) and (ii), {It: 0tT}can be considered as a birth and death process over time [0,T], with birth rate 0\u00afS0Itand death rate It. Assum- ingItis continuous, we then have a stochastic differential dIt=r0Itdt+0 ItdWt, (4.2) where r0=0\u00afS0,2 Wtis motion. The equation (4.2) represents the Cox-Ingersoll-Ross diffusion proces s and fortunately, the exact solution of (4.2) is available and has a non-central 2distribution with zero degrees of freedom (Cox et al. 1985, siegel 1979). Given I0and S0, the probability density function of Itis c0(u0/(c0It))0.5exp((u0+c0It))I1(/radicalbig 2u0c0It), where c0=2r0/[(exp(r0T)1)2], 106CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA u0=c0exp(r0T)I0 and I1is the modied Bessel function of the rst kind. The derivati on of the p.d.f. of Itis described below. As I0>0, the rst part of (4.1) is P(IT|I0,S0) =2c0f2u0(2c0IT) and f(\u00b7)is dened below. Siegel (1979) stated that (2c0IT|I0,S0)follows a non-central 2distribution with zero degrees of freedom and with non-centrality parameter 2 u0. The non-central 2distribution with zero degrees of freedom has a mass at 0, whi ch corresponds to the probability of extinction of the outbreak. Suppose X2 0()where is the non-centrality parameter, then we have P(X=0) = exp(/2). The positive part of the distribution has 0()and 0a<b, I1( x)may become extremely large when is large which can cause a numerical problem. In the application discussed lat er, the value of I1( x)may reach 10308which is beyond the range of double precision num- ber storage in C++. Therefore, a Normal distribution with th e same mean, , and same variance, 4 , i.e. N(, 4)can be used to approximate the non-central 2distribution when is large. Rather than using the method above mentioned in Cauchemez & Ferguson (2008), we adopt a different method w hich approxi- mates the modied Bessel function, and hence approximates t he non-central 2 distribution. Abramowitz & Stegun (1970 p.377) developed a expan- sions for large arguments for the modied Bessel function an d the method is adopted for our case to approximate 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA In order to evaluate the second part of (4.1), the probabilit y of U0given IT, I0and S0, Cauchemez & Ferguson (2008) adopted a negative Binomial di stri- bution to approximate the variable U0|IT,I0,S0. In fact, the number of new infection cases, U0, occurring in [0,T]is Poisson distributed with mean E0= 0\u00afS0/integraltextT 0Itdt. If we approximate E0|IT,I0,S0using a Gamma distribution, then a negative Binomial distribution is constructed. In other w ords, a negative Bi- nomial can be considered as a Poisson distribution with mean , say , where is itself a random variable, distributed as a Gamma distribu tion. Formally, the probability mass function of the negative Binomial distrib ution, f(k;r,p), can be derived through of failures and prepresents the probability of success in a sequence of independent Bernoulli trials. Supposing that the Gamma distribution used to approximate E0|IT,I0,S0has mean M0and variance V0, =/integraldisplay 0P(U0|E0)P(E0|IT,I0,S0)dE0, which the negative Binomial distribution with mean M0and variance M0+V0. To determine the mean M0and the variance V0ofE0|IT,I0,S0, a linear model suggested by Cauchemez & Ferguson (2008) is used to der iveM0and V0 with the Laplace transform method shown below: E0=x0+y0IT+0, 0is the error. If we values M0and 108CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA the variance V0can be approximated by x0+y0ITand 0respectively. Detailed analysis of the Laplace transform and the estimated x0,y0and 0are given below (Cauchemez & Ferguson, 2008). and z, where FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA Then scalars {x0,y0,v0}can be consider the situation that observations are only the tim e series{U k}K k=0, the number of births and Kis the number of observation periods and the removal rate, is as- sumed to be known. Then the data can be augmented with {Uk}K k=0,{IkT}K+1 k=0 and{S0}considered as parameters. Note that given S0and{Uk,Bk}K1 calculated Assume{U k}follows a Binomial distribution U k|UkBin(Uk,), where is the proportion of the reported cases. Note that, the propo rtion, , is a constant value throughout the whole epidemic, i.e. the p roportion of the reported cases in each observation period is the same. Finke nst\u00a8adt & Gren- fell (2000) adopted local regressions, leading to the estim ation of a sequence of reporting rates {k}K k=0in order to tackle a problem caused by changes in the structure of the population (through changes in birth rates ). However, we do not explore this topic as the structure of the population is n ot modelled explic- itly in our case. Denote by kthe infection rate for the (k+1)thobservation period. The joint distribution of the observations, augmen ted data and param- NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA The last term in the formulation (4.3) is the prior density fo r the parameters and{k}K k=0. The posterior distribution of augmented data and paramete rs then can be written down easily and explored by MCMC sampling , as demon- strated in the following section. 4.3.1 MCMC sampling We now describe an MCMC algorithm for sampling the reporting rate, , the infection rates, {k}K k=0, the total number of infections, {Uk}K of infectives, {IkT}K+1 k=0. We use the same method for sampling all the parameters as described in Cauchemez & Ferguson (2008) except sampling the reporting rate, . 4.3.1.1 Sampling the reporting rate As the reporting rate, only depends on U kand Uk, considering the joint dis- tribution above, the full conditional density for is (|{U k,Uk}K k=0)K k=0P(U k|Uk,)\u00d7(). Based on the posterior distribution of , we could assume the prior of the re- porting rate follows a Beta distribution, e.g. Beta(1, 1), in which case the pos- terior distribution of the reporting rate hence follows a Be ta distribution too, i.e.Beta(1+K k=0(U k), 1+K k=0(UkU k)). We then use a Gibbs step to up- date the reporting rate, as opposed to using a Metropolis-Ha stings algorithm and updating by a random walk on the real line, as adopted by Cauchemez & Ferguson (2008). 4.3.1.2 Sampling the infection rates We adopt a reparametrisation technique to reduce correlati on between the in- fection rates and the initial number of susceptibles, S0, by assuming k=S0k. Therefore, we update { k}K U[0, 10000]on k. The Jacobian term must be calculated when the posterior distribution is computed as the transformed parameter is up dated. In particu- lar, we assume k=S0kand S 0=S0and transform from ,S0to,S 0, then 111CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA we have ,S 0(,S 0) =,S0(/S 0,S0)/vextendsingle/vextendsingle/vextendsingle(,S0) S 0S0 S 0/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle. the Jacobian term for this case is 1/ S0. Considering the joint distri- bution, the for kis (k|{I(k)T,I(k+1)T,S0,{Ui,Bi}k1 i=0}) P(I(k+1)T,Uk|I(k)T,S0,{Ui,Bi}k1 i=0, k)\u00d7( k). We use a the transfo rmed infection rates,{ k}K k=0. We iterate over each of the K+1 transformed infection rates for each observation period and propose a candidate value by a ra ndom walk on the real line. 4.3.1.3 Sampling the total number of new infections We obtain a full conditional density for Ukby considering the joint distribution in the formulation i=k+1) P(U k|,Uk)P(Uk|I(k+1)T,IkT,S0,{Ui,Bi}k1 used by Cauchemez & Ferguson (2008), we update the total number of new infections, {U k}K k=0, using an independence sampler (Brooks 1998). As discussed in Section 4.2.2, Uk|U kis assumed to follow the negative Binomial distribution, so we propose a new candidate Ukas follows: Uk= U k+Xk, where Xkis drawn a,((+b)/(1+a)))with xed a=b=105. 112CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA 4.3.1.4 Sampling the initial number of susceptibles We assign a prior distribution U[0, 107]onS0. We then have a full conditional density for S0by considering the joint distribution in the formulation (4 .3), giv- ing P(S0|I(K+1)T,{IkT,Uk,Bk,k}K k=1) K k=1P(I(k+1)T,Uk|IkT,S0,{Ui,Bi}k1 i=0,k)\u00d7P(S0). As we adopt the reparametrisation technique and assume k=S0k, accord- ing to the equation of the Jacobian term given in Section 4.3. 1.2, we need to add log(S0/S 0)for this case, to the acceptance ratio on the log scale, where S 0 is the proposed initial number of susceptibles. We also wish to sample from the posterior distribution on the initial number of suscept ibles, S0and we use a Metropolis-Hastings step to perform this sampling and upd ateS0with a ran- dom walk proposed on the real line. 4.3.1.5 Sampling the number of infectives We put a prior distribution U[0, 107]onI0which is the same as for S0. We then derive the full conditional density for IkTby considering the joint distribution in the formulation (4.3), yielding P(IkT|I(k1)T,I(k+1)T,S0,{Ui,Bi}k1 i=0,k,k1) P(I(k+1)T,Uk|IkT,S0,{Ui,Bi}k1 {IkT}K+1 k=0, with a random walk proposed on the log scale, e.g. I 0=elogI0+Z, where ZN(0,2). Supposing that the probability density function of Zis, then we have I 0(I 0) =/parenleftbig log(I 0. Therefore, log(I kT/IkT)needs to be added to the acceptance ratio on the log scale. For the MCMC algorithms discussed above, the standard devia tions of the pro- posals were tuned to obtain an acceptance rate of 20-30%. 113CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA 4.4 Simulation study using Cauchemez & Ferguson's method The epidemic process is simulated for 10 years from the true S IR model with a parameter setting below: initial I0=900, birth rate: 2152 births per two weeks which is the average bir th rate in London between 1944 and 1964, reporting rate: =45%, mean infectious period: 1/ =14, infection rates: {k}25 k=0, shown in Table 4.1, are set under level of 107 with a similar shape in simulation study section in Caucheme z & Fergu- son's paper (2008). Table 4.1: Infection rates for each observation period under level of 1 07. 012345678 5.5 4.4 5.5 5.6 5.1 4.9 5.0 4.6 3.9 91011121314151617 4.0 4.4 4.6 4.1 3.9 3.7 3.2 2.6 2.9 1819202122232425 3.7 5.5 5.6 5.1 4.6 5.0 5.1 4.6 We consider the situation where observed data are collected every two weeks, and where infection rates vary every two weeks with a period o f 1 year, i.e. the infection rates are seasonal (1 calendar year per season) an d mathematically, k=k+(T2/T1)p, for p=0, 1, 2, ..., 9, where T1(=2)represents length of the observation period in weeks, T2(=52)shows there are 52 weeks a season and pgives season number, e.g. it is the second season if p=1. Therefore, for this case, we have 26 infection rates to estimate. 114CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA By using the existing method proposed by Cauchemez & Ferguso n (2008), esti- mation results are shown in Figures 4.3, 4.4, 4.5 and 4.6. We c an see, from Figure 4.6, the MCMC chain converges to the truth rapidly and from Fi gures 4.3, 4.4, 4.5, the reasonable estimation results indicate that we suc cessfully reproduced Cauchemez & Ferguson's method for the 10 years simulation da ta generated from the SIR model. 0 5 10 15 20 252.533.544.555.56x 107 biweeks Figure 4.3: 10 years simulation data analysed by Cauchemez & Ferguson's method. Posterior mean (solid line) and true value (dashed l ine) of the infection rates over 1 year for the SIR epidemic simula ted with mean infectious period, 1/ =14 days. The infection rates vary every two weeks with a period of 1 year. 0 50 100 150 200 250020004000600080001000012000 biweeksIkT Figure 4.4: 10 years simulation data analysed by Cauchemez & Ferguson's method. Posterior mean (solid line) and true value (dot) of t he number of infectives over 10 years for the SIR epidemic simul ated with mean infectious period, 1/ =14 days. 115CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA 0 50 100 150 200 25002000400060008000100001200014000 biweeksUk Figure 4.5: 10 years simulation data analysed by Cauchemez & Ferguson's method. Posterior mean (solid line) and true value (dot) of t he to- tal number of new infections over 10 years for the SIR epidemi c simulated with mean infectious period, 1/ =14 days. 4.5 Bayesian nonparametric estimation on infection rates We now estimate infection rates, {k}K k=0, under a Bayesian nonparametric framework. For the convenience, we shall abbreviate Cauche mez & Ferguson's method by the CF method and our Bayesian nonparametric metho d by the BNP method. The key difference between the CF method and the BNP m ethod is that in CF method, the infection rate for the (k+1)th,k, is estimated independently, i.e. the model does not impose any constraints on k1,k,k+1despite the fact that, in reality, they should be related. But our method, the BNP method, does enable us to add such constraints. In the previous chapter, w e analysed small- scale epidemics under the Bayesian nonparametric framewor k by considering the epidemic process as an inhomogeneous Poisson process. F unction values for the Gaussian process can be drawn from a multivariate Gau ssian distri- bution corresponding to the Gaussian inputs, i.e. the infec tion times for each individual. However, in the present problem, it is infeasib le to place a Gaussian process prior on the infection rates corresponding to the in fection times for each individual in the population since if the infection times fo r each individual are all augmented, the covariance matrix will be extremely larg e and the computa- tion of the matrix inverse will take too long. Fortunately, w ith the help of the 116CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA 0100020003000400050006000700080000.40.450.50.550.60.650.70.75 0100020003000400050006000700080001234567x 105 S0 Figure 4.6: Convergence of the MCMC algorithm for the SIR epidemic sim- ulated with mean infectious period, 1/ =14 days under Cauchemez & Ferguson's method. The plots show MCMC trace of the reporting rate, , the initial number of susceptibles, S0, the infection rate for the rst observation period, 0, the infection rate for the 11thobservation period, 10, the initial number of infectives, I0and the total number of new infections for the rst observatio n period. 117CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA method that approximates the SIR model for large-scale epid emics, we are able to place a Gaussian prior on the infection rates correspondi ng to some times points of each observation period, e.g. the middle time poin ts of each obser- vation period can be chosen as Gaussian process inputs. Then we can perform inference for the infection rates by implementing the MCMC a lgorithm. Note that the number of the Gaussian process inputs is xed. For th e CF method, the seasonal infection rates are assumed independent from e ach other and are given independent uniform prior distributions and updated separately. For the BNP method, however, we put a Gaussian process prior on the jo int distribu- tion of all infection rates. Hence, the infection rates depe nd on each other and are updated together simultaneously. 4.5.1 Seasonal assumption on infection rates We again put a seasonal assumption on the infection rates as f or the CF method, i.e.k=k+26p. The reparametrisation technique is used again to reduce co r- relation between the infection rates and the initial number of susceptibles, S0 by assuming k=S0k. We denote the middle time points of each observation period within a season, i.e. the Gaussian process inputs, by {sj}J j=1and denote the transformed infection rates, by { k}K k=0, within a season, the Gaussian pro- cess function values, by gJ, where Jis 26 and Kis 25 in this case. We also denote by respectively and the hyperparameters in the covariance function of the Gaussian process. We now place a Gaussian process prior with a squared expo- nential covariance function on the transformed infection r ates,{ k}K k=0, within a season, where the squared functio n is K(x,x) =2exp/parenleftbigg 1 22(xx)2/parenrightbigg . The GP prior can be written as (gJ|{sj}J j=1,,). As we put a prior on all the infection rates throughout the whole season, we have the pos terior density B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA The value of pis chosen from 0 to 9 in the formulation (4.4) since 10 years of time series data are assumed to be observed. 4.5.1.1 Sampling the function values Given the GP inputs {sj}J j=1and the current hyperparameters and , we wish to sample from the distribution on the function values gJ. We propose new function values g Jby a proposal of the form g J=gJ+ 12hJ, where hJis drawn from the Gaussian process at {sj}J j=1and is in[0, 1). We set to 0.99 for our case to obtain a good acceptance ratio. We dene the distributions U[0, 107]on the hyperparameters and . We then have respectively the full conditional densities of and ,(|gJ,{sj}J j=1,) and (|gJ,{sj}J j=1,). Given the GP function values, we use a Metropolis- Hastings step and update and by random walks on the real line. Denote by ,the Gaussian process covariance matrix with current value o f hyperparam- eters and . The 119CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA and |,|1 2\u00d7exp(gJT,1gJ/2) |,|1 2\u00d7exp(gJT,1gJ/2). 4.5.1.3 Results To compare with the CF method, we apply the BNP method to the sa me data simulated in Section 4.4. Estimation results for the BNP met hod are shown in Figures 4.7, 4.8, 4.9 and 4.10. Compared to the CF method, the BNP method also provides reasonable estimations of infection rates of the epidemic as well as all the other parameters which motivates us to explore the method more. 0 5 10 15 20 252.533.544.555.56x 107 biweeks Figure 4.7: Posterior mean (solid line) and true value (dashed line) of t he in- fection rates over 1 year for the SIR epidemic simulated with mean infectious period 1/ =14 days under the BNP method. The in- fection rates vary every two weeks with a period of 1 year. 4.5.2 Seasonal assumption on infection rates relaxed We now relax the seasonal assumption on infection rates. In o ther words, we no longer assume that k=k+26p. Thus the number of the infection rates in- creases to 260 from 26 given 10 years data, i.e. the infection rates are represented as{k}259 k=0for this case. Under this assumption, we applied the CF metho d to the data generated in Section 4.4 but the MCMC chain failed to converge to the true values which implied that the method is no longer workin g if the seasonal 120CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA 0 50 100 150 200 250020004000600080001000012000 biweeksIkT Figure 4.8: Posterior mean (solid line) and true value (dot) of the numbe r of infectives over 10 years for the SIR epidemic simulated with mean infectious period 1/ =14 days under the BNP method. 0 50 100 150 200 25002000400060008000100001200014000 biweeksUk Figure 4.9: Posterior mean (solid line) and true value (dot) of the total number of new infections over 10 years for the SIR epidemic simulate d with mean infectious period 1/ =14 days under the BNP method. 121CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA 0 1000 2000 3000 4000 5000 60000.4460.4480.450.4520.4540.4560.458 0 1000 2000 3000 4000 5000 60001.41.451.51.551.61.651.71.75x 105 S0 0 1000 2000 3000 4000 5000 600055.25.45.65.866.26.4x 107 0 0 1000 2000 3000 4000 5000 600044.24.44.64.855.25.4x 107 10 0 1000 2000 3000 4000 5000 600070075080085090095010001050I0 0 1000 2000 3000 4000 5000 60001050110011501200125013001350U0 0 1000 2000 3000 4000 5000 6000024681012 0 1000 2000 3000 4000 5000 60002030405060708090100 Figure 4.10: Convergence of the MCMC algorithm for the SIR epidemic simu- lated with mean infectious period, 1/ =14 days under the BNP method. The plots show MCMC trace of the reporting rate, , the initial number of susceptibles, S0, the infection rate for the rst observation period, 0, the infection rate for the 11thobservation period, 10, the initial number of infectives, I0, the total number of new infections for the rst observation period and the hyperp a- rameters and . 122CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA assumption is relaxed. For instance, the estimated reporti ng rate converged to 1. We then applied the BNP method used in Section 4.5.1 and pla ced a Gaussian process prior with the squared exponential covariance func tion on the infection rate throughout the whole epidemic. The posterior density o f{k}259 k=0is \u00d7(gJ|{sj}J j=1,,), where Jis equal to 260 in this case which is different from what it is i n Section 4.5.1. The MCMC chain again failed to converge to the true val ues. The failure of the convergence indicates that methods which do not captu re the seasonal feature on infection rates lead to bad estimations of key qua ntities of interest. We now take advantage of the Gaussian process and place a Gaus sian process prior with a different covariance function to address what w e need, specically a periodic covariance function. Mathematically, our where is the length of a single season in the time series and is assumed to be positive. Chandola & Vatsavai (2011) pointed out that for periodic time se- ries, the observables at time tare strongly correlated with observables at t1 as well as with the observables at time t. Such periodic dependency cannot be modelled using the squared exponential covariance functio n for any value of . As it is assumed that there are 7 days a week, 52 weeks a year and the infection rates keep a similar pattern for each year, we set 364(days) t ofor our case. Figure 4.11 and 4.12 show the posterior mean of all of the infe ction rates and the posterior mean of the number of infectives throughout th e whole epidemic compared with the truth and Figure 4.13 gives convergence of the MCMC al- gorithm for the SIR epidemic under BNP method using a periodi c covariance function for the Gaussian process. We can see the MCMC chain c onverges to the truth rapidly from Figure 4.13 and Figure 4.11 and 4.12 gi ve reasonable es- timations of the infection rates and the number of infective s which implies that 123CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA 0 50 100 150 200 2502.533.544.555.56x 107 biweeks Figure 4.11: Posterior mean (solid line) and true value (dashed line) of t he in- fection rates over 10 years for the SIR epidemic simulated wi th mean infectious period, 1/ =14 days under BNP method using a periodic covariance function for the Gaussian process. our BNP method using a periodic covariance function for the G aussian process works under the assumption that the seasonal assumption on i nfection rates is relaxed. 4.5.3 Different parameter settings for the Gaussian proces prior on hyperparameters for Gaussian proce sses As our BNP methods provided similar estimation results to th e CF method, we are encouraged to see how the Gaussian process behaves wit h different hy- perparameter settings. In order to explore how it affects th e estimation of the infection rates within a season if a strong prior is put on the hyperparameter, , in the Gaussian process covariance function, we study the s ame observed data simulated in Section 4.4. We compare the results betwee n the one ob- tained in Section 4.5.1 and the one where we put strong prior d istribution with a bigger mean value on . We assume the infection rates are seasonal with a period of 1 year and a squared exponential covariance functi on is used for the Gaussian process. From the MCMC trace of obtained in Section 4.5.1, the pos- terior mean of is around 24. As controls the characteristic length-scale of the process and the bigger is which implies that the more slowly varying the 124CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA 0 50 100 150 200 250020004000600080001000012000 biweeksIkT Figure 4.12: Posterior mean (solid line) and true value (dot) of the numbe r of infectives over 10 years for the SIR epidemic simulated with mean infectious period, 1/ =14 days under BNP method using a pe- riodic covariance function for the Gaussian process. function generated will be, we expect a much smoother curve o f the estimated mean infection rates in a season. We put two priors, (50, 1)and (100, 1), on respectively. Figure 4.14 and 4.15 give the estimation resu lts and show the effect of strong priors used on the hyperparameter, . As expected, the pattern of the infection rates is smoothed and the one is much smoother when the(100, 1) prior is put on . 4.5.3.2 Different covariance functions for Gaussian proce sses For the BNP method, we also use other covariance functions fo r the Gaussian processes to compare with the squared exponential covarian ce function under the seasonal assumption on the infection rates, i.e. we plac e Gaussian pro- cess prior with different covariance functions on the trans formed infection rates within a season. The covariance functions we use here are as f so-called the r-exponential covariance function (Rasmussen & Williams 2006). Actually, the squared exponen tial covariance function also belongs to the r-exponential family of the covariance functions when ris set to 2 and it is the smoothest one among the whole family. W e set r 125CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA 01000200030004000500060007000800090000.440.460.480.50.520.540.56 010002000300040005000600070008000900011.21.41.61.822.22.4x 105 4.13: Convergence MCMC algorithm for the SIR epidemic sim- ulated with mean infectious period, 1/ =14 days under BNP method. The plots show MCMC trace of the reporting rate, , the initial number of susceptibles, S0, the infection rate for the rst observation period, 0, the infection rate for the 11thobservation period, 10, the initial number of infectives, I0and the . 126CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA 0 5 10 15 20 252.533.544.555.56x 107 biweeks Figure 4.14: Posterior mean (solid line) and true value (dashed line) of t he infection rates over 1 year for the SIR epidemic simulated wi th mean infectious period, 1/ =14 days under BNP method using a squared exponential function for the Gaussian process. A s trong prior, (50, 1)is put on the haperparameter, . 0 5 10 15 20 252.533.544.555.56x 107 biweeks Figure 4.15: Posterior mean (solid line) and true value (dashed line) of t he infection rates over 1 year for the SIR epidemic simulated wi th mean infectious period, 1/ =14 days under BNP method using a squared exponential covariance function for the Gaussian pro- cess. A strong prior, (100, 1)is put on the haperparameter, . 127CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA to 1 and analysed the same SIR epidemic simulated in Section 4 .4 using the BNP method with the different covariance function for the Gauss ian process. Figure 4.16 shows posterior mean values of the infection rates with in a season using two different covariance functions with r=1 and r=2. We can not see much difference of the estimation results for both covariance fu nctions although the function values generated from the exponential covariance functions are sup- posed to be less smooth. One explanation could be that there i s only 26 obser- vation periods per season, hence we have only 26 Gaussian pro cess inputs as we chose the middle time points of each observation period wi thin a season as the inputs, so functions could not be generated quite differ ently with different covariance functions unless a strong prior is put on the hype rparameters in the covariance function which signicantly changes the model. 0 5 10 15 20 252.533.544.555.56x 107 biweeks Figure 4.16: 10 years simulation data analysed by the BNP method with dif- ferent covariance functions. Posterior mean (solid line fo rr=1 and dashed line r=2) of the infection rates over 1 year for the SIR epidemic simulated with mean infectious period, 1/ =14 days. The infection rates vary every two weeks with a period of 1 yea r. 4.6 Measles epidemics in london (1948-1957) We also analysed real life time series data, namely measles i n London between 1948 and 1957 ( http://www.zoo.cam.ac.uk/zoostaff/grenfell/measles. htm). Measles is caused by a highly infective single-stranded RNA virus belonging to the morbillivirus group and is mostly specialised on its h uman hosts. On 128CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA infection, the virus passes through a latent period of aroun d 6 to 9 days, fol- lowed by a 6 to 7 days infective period. Therefore, the charac teristic time scale of the transmission dynamics is around 14 days (Bj\u00f8rnstad et al. 2002, Gren- fell et al. 2002). Based on the information above, we assume t he infection pe- riod is known, i.e. 1/ =14. The measles data were collected bi-weekly and are under-reported as the reporting is not complete during t he period and the number of births is, on average, 2152 bi-weekly in London bet ween 1948 and 1957. We do not consider changes in the structure of the popul ation that modify transmission parameters themselves, see Cauchemez & Fergu son (2008). Given the observed data described above, we now apply the CF m ethod and BNP method to the 10 years measles data and estimate the repor ting rate, initial number of susceptibles, total number of the cases for each ob servation period, number of infectives at the beginning of each observation pe riod and the infec- tion rates for each observation period within a season, name ly, a year. For the BNP method, we use a squared exponential covariance functio n for the Gaus- sian process and placed a Gaussian process prior on the infec tion rates within a season, i.e. the infection rates are assumed to be seasonal . We also use the periodic covariance functions for the Gaussian process and placed a Gaussian process prior on all of the infection rates throughout the wh ole epidemic, i.e. the seasonal assumption is relaxed. Figures 4.17, 4.18, 4.19, 4 .20, 4.21 and 4.22 show estimation results of the parameters. The Figure 4.21 shows that the results of the posterior mean of for the CF method and the BNP method assuming the infection rates are seasonal are quite close. The Figure 4.2 2 also gives similar results for the initial number of susceptibles, S0for both methods discussed above. However, for the BNP method without assuming the infe ction rates are seasonal, the posterior mean of and S0is smaller and bigger respectively com- pared to the results of the methods assuming the infection ra tes are seasonal. One explanation is that methods assuming the infection rate s are seasonal or not may give different estimates for the reporting rate and t he initial number of susceptibles. Table 4.2 gives posterior mean, 95% CI and standard deviatio n for the param- eters ,S0,I0,0and 10. From the results, we found that under the seasonal assumption on the infection rates, the BNP method provided s imilar estimation for each parameter compared with the CF method. When such ass umption is 129CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA 0 5 10 15 20 252.533.544.555.566.57x 107 biweeks Figure 4.17: Posterior mean of the infection rates over 1 year for the CF me thod (dashed line) and BNP method (solid line) using the squared e x- ponential covariance function for the Gaussian process for the 10 years measles data. relaxed, the BNP method using appropriate covariance funct ion for the Gaus- sian process successfully estimated the infection rates th roughout the whole epidemic as well as all of the other parameters. 4.7 Conclusion We rstly applied the CF method to an SIR epidemic simulated w ith a simi- lar parameter setting used in Cauchemez and Ferguson's pape r (2008) and re- produced reasonable estimation results. Then we applied ou r BNP method to the same simulated data under the same assumption on the infe ction rates, i.e. k=k+26p. We also relaxed such seasonal assumption on the infection r ates and successfully estimated the infection rates throughout the whole epidemic under the BNP method using a periodic covariance function fo r the Gaussian process for the same simulated data. Under the seasonal assu mption, strong priors on the hyperparameters in the covariance function an d different covari- ance functions were conducted to explore the effect of the es timation of the infection rates as well as other parameters. At the end of the chapter, our meth- ods were illustrated using the real life data, measles in Lon don between 1948 and 1957 and the estimation results were compared with the on e obtained using the CF method. 130CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATATable 4.2: Posterior mean, 95% CI, standard deviation for , the initial number of susceptibles I0 and infection rates. CF, BNP1 and BNP2 represent respective ly the CF method, the BNP method using the squared expo- nential covariance function for the Gaussian process assum ing the infection rates are seasonal and the BNP method using the periodic covariance function for the Gaussian process w ithout assuming the infection rates are seasonal. Measles in FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA 0 50 100 150 200 25022.533.544.555.566.5x 107 biweeks Figure 4.18: Posterior mean of the infection rates over 10 years for the CF method (dashed line) and BNP method (solid line) using the pe ri- odic covariance function for the Gaussian process for the 10 years measles data. 0 50 100 150 200 250050001000015000 biweeksIkT Figure 4.19: Posterior mean of the number of infectives over 10 years for t he CF method (dot) and BNP method using the squared exponential covariance function for the Gaussian process (solid line) f or the 10 years measles data. 132CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA 0 50 100 150 200 250050001000015000 biweeksIkT Figure 4.20: Posterior mean of the number of infectives over 10 years for t he CF method (dot) and BNP method using the periodic covariance function for the Gaussian process (solid line) for the 10 yea rs measles data. 0.498 0.50.5020.5040.5060.508 0.510.5120.5140.516050100150200250300350400 Figure 4.21: The gure shows the density plots of the reporting rate, , for the CF method (dashed line), BNP method using the squared expo- nential covariance function for the Gaussian process (dott ed line) and BNP method using the periodic covariance function for th e Gaussian process (solid line) for the 10 years measles data. 133CHAPTER 4: B AYESIAN NONPARAMETRIC ESTIMATION FOR EPIDEMIC MODELS IN LARGE POPULATIONS FROM TIME -SERIES DATA 1.5 1.6 1.7 1.8 1.9 2 x 10500.20.40.60.811.21.41.61.8x 104 S0 Figure 4.22: The gure shows the density of the initial number of susc ep- tibles, S0, for the CF method (dashed line), BNP method using the squared exponential covariance function for the Gaussian p rocess (dotted line) and BNP method using the periodic covariance f unc- tion for the Gaussian process (solid line) for the 10 years me asles data. In this chapter, we successfully applied BNP methods to the C F model, and the BNP methods enabled us to (i) put a Gaussian process prior on t he infection rate as a function of time, as opposite to assuming independe ntkvalues; (ii) relax assumption of identical infection rates over the whol e epidemic period. 134CHAPTER 5 Conclusions In this thesis we successfully developed nonparametric met hods for the es- timation of the overall force of infection and the infection rate in small-scale epidemics in a Bayesian framework. We also investigated the large-scale epi- demics and developed Bayesian nonparametric methods for th e estimation of the infection rate from epidemic times-series data. The data we used to apply our methodology were simulated data generated from the SIR epidemic model and the real outbreak data. In Chapter 2, we rstly introduced a Gaussian process-based Bayesian non- parametric inference for the estimation of the inhomogeneo us Poisson process intensity which was presented by Adams et al. (2009). We then adapted the work of Adams et al. to the epidemics and developed our Bayesi an nonpara- metric methods for the stochastic SIR models. We explored th e overall force of infection of the epidemic process and assumed that it has the form, h(t), which is a function of time without considering any information of the number of sus- ceptibles and infectives. We inferred h(t)by placing Gaussian process priors on it. Standard MCMC methods were used to sample the overall for ce of infection as well as other parameters of interest from the desired post erior distributions. We applied our methods to several simulated datasets, i.e. S E-Data 1, SE-Data 2 and SE-Data 3. Our methods work fairly well although some dra matic changes within a small time period in the data were not captured due to the fact that Gaussian process priors generally produce smooth estimate s. We also analysed the Smallpox data obtained from Bailey (1975, p.125) and com pared results with ones obtained from O'Neill & Roberts (1999). It turned out th at the posterior 135CHAPTER 5: C ONCLUSIONS mean of the infection rate is larger than O'Neill & Roberts' e stimate at each estimated infection time although the estimated infection rate from O'Neill & Roberts is fully covered in our 95% credible intervals. In te rms of the estimate of the removal rate, we have similar results with ones from O'Ne ill & Roberts. At the end of the chapter, we carried out analysis of the effect o f different Gaussian process priors by using different covariance functions and we found that differ- ent Gaussian process priors produce different processes fr om level of smooth- ness point of view, otherwise they do not make much differenc es. In this chap- ter, we assumed that the hyperparameter, , of any covariance functions is xed to 2 in order to obtain efcient mixing of the MCMC algorithms and we did not explore the topic of the choice of . In Chapter 3, we further investigated our Bayesian nonparam etric methods for the SIR model in small-scale epidemics. We assumed that the o verall force of infection is of the form, (t)XtYt. In other words, the infection rate is assumed to be a function of time, and the information of the number of s usceptibles and infectives is considered for the overall force of infection . We placed a Gaussian process prior on (t)and treated it as an inhomogeneous Poisson process inten- sity. We applied our methods to simulated datasets SE-Data 2 , SE-Data 3 where the data were generated with a constant infection rate. We al so simulated data which were generated with infection rates varying during th e epidemics and analysed the dataset SE-Data 4 with our methods. We found tha t our methods successfully recovered the truth. The estimates of the infe ction rate in the case where we only observe incomplete data have larger uncertain ty than the case where complete data are observed. It is possibly because the estimation of the removal rate results the extra uncertainty. We also illustr ated our methods with the Smallpox data. In this chapter, we introduced an extende d multi-group SIR model discussed in Hayakawa et al. (2003). In the multi-grou p SIR model, the population is no longer homogeneous, but partitioned into g roups according to level of susceptibility. Hayakawa et al. (2003) develope d Bayesian meth- ods for SIR epidemic models with several kinds of susceptibl e. We applied our Bayesian nonparametric methods to multi-group epidemi c data (simulated data and real life data) and then compare the results with one s obtained from Hayakawa et al. It turned out that our methods also worked wel l for the multi- group SIR model. Finally, we compared the approach with the o ne developed 136CHAPTER 5: C ONCLUSIONS in Chapter 2. Specically, we compared the estimate of the in fection rate in two different Bayesian nonparametric methods, i.e. (t)and (t). We found that the approach discussed in Chapter 3, which considering the i nformation of the number of susceptibles and infectives, is a better way to est imate the infection rate. In Chapter 4, we adapted an approximation method due to Cauch emez & Fer- guson (2008) to produce a Bayesian nonparametric method of i nference for epidemics in large populations. We rstly applied a method d eveloped by Cauchemez and Ferguson (2008) to an SIR epidemic and reprodu ced reason- able estimation results. Then we applied our Bayesian nonpa rametric meth- ods to the same simulated dataset under the same assumption o n the infection rates. We also investigated the case where we relaxed season al assumptions on the infection rates and successfully estimated the infecti on rates throughout the whole epidemic using our methods with a periodic covariance function for the Gaussian process prior for the same simulated data. At the en d of the chapter, our methods were illustrated using the real life data, measl es in London be- tween 1948 and 1957 and we compared our results with the ones o btained us- ing the Cauchemez and Ferguson's method. In general, we deve loped Bayesian nonparameteric methods enabled us to (i) put a Gaussian proc ess prior on the infection rate as a function of time, as opposite to assuming independent val- ues; (ii) relax assumption of identical infection rates ove r the whole epidemic period. In the thesis, we performed inference for Gaussian process u sing standard MCMC algorithms. One might want to use Hamiltonian Monte Carlo (D uane et al., 1987) or slice sampling (Murray et al., 2010) to improve mixi ng and conver- gence speed. However, all the methods mentioned above may ha ve compu- tational difculties for large data sets. It is notable that given ninput points, Gaussian processes are very computationally demanding, i. e.O(n3)time com- plexity. Fortunately, enormous attention has been given to the development of efcient approaches to Gaussian process models. Snelson (2007) developed sparse approximation techniques to reduce the complexity t oO(nm2), where m is a user chosen number much smaller than n. Csat\u00f3 & Opper (2001) developed an approach for a sparse representation for Gaussian proces s models in order to gain a computational advantage when using large data sets . For more dis- 137CHAPTER 5: C ONCLUSIONS cussion of related to sparse approximations, see Csa t\u00f3 (2002), Keerthi & Chu (2008) or Seeger (2003). Overall, this thesis provides new methodology which enable s nonparametic es- timation of parameters governing transmissions under a Bay esian framework. We have successfully developed Bayesian nonparametric met hods for the es- timation of the stochastic SIR models in small-scale and lar ge-scale epidemics respectively. To our knowledge, there are not any other stud ies in the liter- ature that considered nonparametric methods under a Bayesi an framework. In general, taking a nonparamatric approach not only offers greater potential flexibility than parameterised models but also provides one a tool to assess the goodness of t of parametric epidemic models, and hence to qu antify the extent to which the underlying model assumptions are in line with ob served data. Epidemics are assumed to be complete throughtout the whole t hesis. However, our methods are also appropriate to ongoing disease outbrea ks analysis. In ad- dition, condition on the current function values, one can ob tain new time series that are drawn from the predictive distribution using our me thods. Therefore, in practice, epidemiologists can use our methods to answer q uestions about an ongoing disease outbreak. Using available information and observed data, they can make predictions about how fast an epidemic will move, ho w it is likely to spread, and how many people will be involved. This informati on can be used in an attempt to contain the epidemic and to stay one step ahea d of it. The Bayesian nonparameteric models can be constantly adjusted as new data rolls in. The Bayesian nonparameteric methods have potential limita tions and disad- vantages. Siegel & Castellan (1988) argued that nonparamet ric methods may lack power as compared with more parametric approaches, esp ecially if the sample size is small or if the assumptions for the correspond ing parametric method hold. Hoff (2013) pointed out that for most Bayesian n onparametric ap- proaches in practice, the prior does not represent actual pr ior beliefs, making it hard to interpret the corresponding posterior distributio ns as posterior beliefs. Standard Bayesian nonparametric priors include hyperpara meters that directly control things that we are unlikely to have prior informatio n about and only in- directly control things we might have information about (li ke means, variances and correlations). Therefore, it is not easy to imagine that such a prior repre- 138CHAPTER 5: C ONCLUSIONS sents actual prior information. He also commented that a pos terior distribution does not provide an honest assessment of uncertainty. Anoth er limitation of the nonparametric approaches is that appropriate computer sof tware packages for the approaches can be limited. 139References Abramowitz, M. and Stegun, I. A. (1965). Handbook of mathema tical functions. Dover, New York. Abramowitz, M. and Stegun, I. A. (1970). Handbook of mathema tical functions with formulas, graphs, and mathematical tables. National b ureau of standards - U.S. government printing ofce. Adams, R. P . (2009). Kernel methods for nonparametric Bayes ian inference of probability densities and point processes. PhD thesis, Uni versity of Cambridge. Adams, R. P ., Murray, I., and MacKay, D. J. C. (2009). Tractab nonparametric York: ACM Press. Adams, R. P ., Murray, I., and MacKay, D. J. C. (2009). The Gaus sian process density sampler. Advances in neural information processing systems , 21, 9-16. Andersson, H. and Britton, T. (2000). Stochastic epidemic m odels and their sta- tistical analysis, volume 151 of Lecture Notes in Statistic s. New York: Springer- Verlag. Andrieu, C., Freitas, N. D., Doucet, A. and Jordan, M. I. (200 3). An Introduction to MCMC for Machine Learning. Machine Learning , 50, 5-43. Bailey, N. T. J. (1975). The mathematical theory of infectio us diseases and its applications, 2nd ed. London: Grifn. Balatif, O., Elhia, M., Bouyaghroumni, J., Rachik, M. (2014 ). Optimal control strategy for a discrete SIR epidemic model. International Journal of Applied Math- ematics and Modeling , 2(2), 1-8. Becker, N. G. (1989). Analysis of infectious disease data. L ondon, UK: Chap- man and Hall. 140REFERENCES Becker, N. G. and Yip, P . S. F. (1989). Analysis of variation i n an infection rate. Australian Journal of Statistics , 31, 42-52. Becker, N. G. and Hopper, J. L. (1983). Assessing the heterog eneity of disease spread through a community. American Journal of Epidemiology , 117, 362-374. Bernardo, J. M. and Smith, A. F. M. (1994). Bayesian theory. W iley Series in Probability and Mathematical Statistics: Probability and Mathematical Statis- tics. John Wiley and Sons Ltd., Chichester. Bj\u00f8rnstad, O. N., Finkenst \u00a8adt, B. and Grenfell, B. T. (2002). Dynamics of measles epidemics: estimating scaling of transmission rates using a time series SIR model. Ecological Monographs , 72(2), 169-184. Brooks, S. P . (1998). Markov chain monte carlo method and its application. Journal of the Royal Statistical Society Series D , 47(1), 69-100. Casella, G. and George, E. I. (1992). Gibbs sa mpler. American Statistician , 46(3), 167-174. Cauchemez, S. and Ferguson, N. M. (2008). Likelihood-based estimation of continuous-time epidemic models from time-serires data: a pplication to measles transmission in London. Journal of the Royal Society Interface 2008 , 5(25), 885-897. Chandola, V . and Vatsavai, R. R. A Gaussian process b ased online change detection algorithm for monitoring periodic time series, p roceedings of SIAM international conference on data mining, SDM 2011. Chen, F., Huggins, R. M., Yip, P .S. and Lam, K. F. (2008). Nonp arametric estima- tion of multiplicative counting process intensity functio ns with an application to the Beijing SARS epidemic. Communications in Statistics: Theory and Methods , 37, 294-306. Cox, D. R. (1955). Some statistical methods connected with s eries of events. Journal of the Royal Statistical Society Series B , 17, 129-164. Cox, J. C., Ingersoll, J. E. and Ross, S. A. (1985). A theory of the term structure of interest rates. Econometrica , 53, 385-408. Csat\u00f3 L. (2002). Appr thesis, Neural Research University . Csat\u00f3 L. and M. (2001).Sparse representation for Gau ssian process mod- 141REFERENCES els. In T. K. Leen, T. G. Dietterich, and V . Tresp, editors, Advances in Neural Information Processing Systems 13 , Cambridge, MA. The MIT Press. Duane, S., Kennedy, A. D., Pendleton, B. J., and Roweth, D. (1 987). Hybrid Monte Carlo. Physics Letters B , 195, 216-222. Dureau, J., Kalogeropoulos, K. and Baguelin, M. (2013). Cap turing the time- varying drivers of http://www.robots.ox.ac.uk/ mebden/reports/GPtutorial.pdf M. and Dietz, K. (2003). Transmission potential of smallpox: estimates based on detailed data from an outbreak. American Journal of Epidemiology , 158, 110-117. Escobar, M. D. and West, M. (1995). Bayesian density estimat ion and inference using mixtures. Journal of the American Statistical Association , 90(430), 577-588. Fang, C.T., Hsu, H. M., Twu, S. J., Chen, M. Y., Hwang, J. S., Wa ng, J. D., Chuang, C. Y., and the Division of AIDS and STD, Center fo Disease Cont rol, Department of Health, Executive Yuan. (2004). Decreased HIV transmiss ion after a policy of providing free access to highly active antiretroviral ther apy in Taiwan. Journal of Infectious Diseases , 190(5), 879-885. Ferguson, T. S. (1973). A Bayesian analysis of some nonparam etric problems. The Annals of Statistics , 1(2), 209-230. Finkenst \u00a8adt, B., and Grenfell, B. T. (2000). Time series modelling of childhood diseases: a dynamical systems approach. Applied Statistics , 49, 187-205. Gelfand, A. E. and Smith, A. F. M. (1990). Sampling-based app roaches to calcu- lating marginal densities. Journal of the American Statistical Association , 85(410), 398-409. Gelman, A. and Rubin, D. B. (1992). Inference from iterative simulation using multiple sequences. Statistical Science , 7(4), 457-472. Gelman, A., Carlin, J. B., and Stern, H. S. (2004). Bayesian d ata analysis. CRC press. Geman, S. and Geman, D. (1984). Stochastic relaxation, Gibb s distributions, and 142REFERENCES the Bayesian restoration of images. Pattern Analysis and Machine Intelligence, IEEE Transactions on , 6, 721-741. Gershman, S. J., and Blei, D. M. (2012). A tutorial on Bayesia n nonparametric models. Journal of Mathematical Psychology , 56(1), 1-12. Geweke, J. (1992). Evaluating the accuracy of sampling-bas ed approaches to the calculation of posterior moments. In Bernardo, J. M., Be rger, J., Dawid, A. P . and Smith, A. F. M. editors, Bayesian Statistics , 4, 169-193. Oxford University Press, Oxford, UK. Ghosh, J. K. and Ramamoorthi, R. V . (2003). Bayesian Nonpara metrics. Springer- Verlag, Berlin. Gibson, G. and Renshaw, E. (1998). Estimating parameters in stochastic com- partmental models using Markov chain methods. IMA Journal of Mathematics Applied in Medicine and Biology , 15, 19-40. Gilks, W. R., Richardson, S. and Spiegelhalter, D. J. (1996) . Markov chain Monte Carlo in practice. Interdisciplinary Statistics. Chapman and Hall, London. Grenfell, B. T., Bj\u00f8rnstad, O. N. and Finkenst \u00a8adt, B. (2002). Dynamics of measles epidemics: scaling noise, determinism, and predictabilit Hayakawa, Y., . D., P . S. F. (2003 ). Bayesian infer- ence for a stochastic epidemic model with uncertain numbers of susceptibles of several types. Australian and New Zealand Journal of Statistics , 45, 491-502. Hoff, P . D. (2013). P ., Roberts, G. O. (2009). Bayesian analysis for emerging infectious diseases. Bayesian Analysis , 4(2), 191-222. Keerthi, S. S. and Chu, W. (2006). A matching pursuit approac h to sparse Gaus- sian process regression. In Advances in Neural Information Processing Systems 18 . Kottas, A. (2006). Nonparametric Bayesian survival analys is using mixtures of Weibull distributions. of Statistical Planning and Inference , 136(3), 578-596. Kottas, A. and Sans\u00f3, B. (2007). mixture modeling f or spatial Pois- son process intensities, with applications to extreme valu e analysis. Journal of 143REFERENCES Statistical Planning and Inference , 137, 3151-3163. Kronberger, G. and Kommenda, M. (2013). Evolution of covari ance functions for gaussian process regression using genetic programming . Arxiv preprint arXiv:1305.3794. Lau, E. H. Y. and Yip, P . S. F. (2008). Estimating the basic rep roductive number in the general epidemic model with an unknown initial number of susceptible individuals. Scandinavian Journal of Statistics , 35, 650-663. Lekone, E.P . and in a Stochastic Epidemic SEIR Model with Control Intervention: Ebola as a Ca se Study. Bio- metrics , 62(4), 1170-1177. Lewis, P . A. W. and Shedler, G. S. (1979). Simulation of a nonh omogeneous Poisson process by thinning. Naval Research Logistics Quarterly , 26, 403-413. Lloyd, A. L. (2001). Realistic Distributions of Infectious Periods in Epidemic Models: Changing Patterns of Persistence and Dynamics. Theoretical Population Biology , 60, 59-71. Lo, A. Y. (1984). On a class of Bayesian nonparametric estima tes: I. density estimates. The Annals of Statistics , 12(1), 351-357. Lorio, M. D., Johnson, W. O., M\u00fcller, and Rosner, G. L. C. (1998). Introduction to Gaussian Processes . In Bishop, C. M., editor, Neural Networks and Machine Learning . Springer-Verlag. McKinley, T., Cook, A. R., Deardon, R. (2009). Inference in e pidemic models without likelihoods. The International Journal of Biostatistics , 5(1), Article 24. M\u00f8ller, J., Syversveen, A. Waagepetersen, R. P . (1998 ). Log Gaussian Cox processes. Scandinavian Journal of Statistics , 25, 451-482. Moy\u00e9, L. A. (2008). Elementary Bayesian Biostatistics. Cha pman and Hall, New York, USA. Murray, I. (2007). Advances in Markov Chain Monte Carlo Meth ods. PhD thesis, Gatsby Computational Neuroscience Unit, Universi ty College London, London. 144REFERENCES Murray, I., Adams, R. P . and MacKay, D.J.C. (2010). Elliptic al slice sampling. Appeared in The Proceedings of the 13th International Conference on Art icial Intel- ligence and P . and Roberts, G.O. (2005). A case study in non-center ing for data aug- mentation: stochastic epidemics. Statistics and , 15, 315-327. Neal, R. M. (2001). Dening priors for distributions using D irichlet diffusion trees. Technical Report 0104, Department of Statistics, Un iversity of Toronto. Neal, R. M. (2003). Density modeling and clustering using Di richlet diffusion trees. Bayesian Statistics , 7, 619-629. Nieto-Barajas, L. E. and Walker, S. G. (2004). Bayesian nonp arametric survival analysis via 14, 1127-1146. tting and optimal design for pred iction. Journal of the Royal Statistical Society Series B , 40(1), 1-42. O'Neill, P . D., Balding, D. J., Becker, N. G., Eerola, M., and Mollison, D. (2000). Analyses of infectious disease data from household outbrea ks by Markov chain Monte Carlo methods. Journal of the Royal Statistical Society Series C , 49(4), 517- 542. O'Neill, P . D. and Becker, N. G. (2001). Inference for els. [online] Available: http://stat.columbia.edu/ porbanz/reports/OrbanzTeh2010.pdf. O'Neill, D. and Roberts, (1999). Bayesian inference for partially ob- served stochastic epidemics. Journal of the Royal Statistical Society Series A , 162, 121-129. Palacios, J. A. and sed Bayesian Science , 1-11, John Wiley and Sons, Inc. Persing, A. F. (2014). Some contributions to particle Marko v chain Monte Carlo 145REFERENCES algorithms. PhD thesis, Imperial College London. Pollicott, M. Wang, H. and Weiss, H. (2009). Recovering the t ime-dependent transmission rate from infection data. Arxiv preprint arXi v:0907.3529 and up- dates. Pollicott, M. Wang, H. and Weiss, H. (2012). Extracting the t ime-dependent transmission rate from infection data via solution of an inv erse ODE problem, Journal of Biological Dynamics , 6,509-523. Rasmussen, C. E. (2000). The innite Gaussian In Solla, K.R. in Neural Information Processing Systems , 12, 554-560. Rasmussen, C. E. and Williams, C. K. I. (2006). Gaussian proc esses for machine learning. Cambridge, MA: MIT Press. Rathbun, S. L. and Cressie, N. (1994) Asymptotic properties of estimators for the parameters of spatial inhomogeneous Poisson point proc esses. Advances in Applied Probability , 26, 122-154. Robert, C. P . and Casella, G. (1999). Monte Carlo statistica l methods. Springer Texts in Statistics. Springer-Verlag, New York. Sawyer, S. (2010). The Matropolitan-Hastings algorithm an d extensions. Wash- Error Bounds and Sparse Approximations. PhD thes is, Institute of Adaptive and Neural Computation, University of Edinburgh. Siegel, A. F. (1979). The noncentral chi-squared distribut ion with zero degrees of freedom and testing for uniformity. Biometrika , 66, 381-386. Siegel, S. and Castellan, N. J. (1988). Non-parametric Stat istics for the Behavioural Sciences, second edition. New York: McGraw-Hill. Smirnova, A. and Tuncer, N. (2014). Estimating time-depend ent transmission rate of avian influenza via stable numerical algorithm. Journal of Inverse and Ill-Posed Problems , 22(1), 31-62. Snelson, E. (2007). Flexible and efcient Gaussian models for machine learning. PhD thesis, Gatsby Computational Neuroscience U nit, University 146REFERENCES College London. Stein, M. L. (1999). Interpolation of Spatial Data. Springe r-Verlag, New York. Tanner, M. A. (1996). Tools for statistical inference. Meth ods for the exploration of posterior distributions and likelihood functions. Spri nger Series in Statistics. Springer-Verlag, New York, third edition. Tildesley, M. J., Ryan, S. J. (2012). Disease Prevention ver sus Data Privacy: Us- ing Landcover Maps to Inform Spatial Epidemic Models, PLoS Computational Biology , 8(11). Walker, S. G., Damien, P ., Laud, P . W. and Smith, A. F. M. (1999 ). Bayesian non- parametric inference for random distributions and related functions. Journal of the Royal Statistical Society Series B , 61(3), 485-527. 147 "}