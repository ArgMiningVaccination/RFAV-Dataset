{"title": "PDF", "author": "PDF", "url": "http://www.math.ualberta.ca/~hwang/Forecasting%20COVID-19%20Dynamics%20Under%20Imperfect%20Vaccination.pdf", "hostname": "PDF", "description": "PDF", "sitename": "PDF", "date": "PDF", "cleaned_text": "Bulletin of Mathematical Biology (2022) 84:90 https://doi.org/10.1007/s11538-022-01047-x ORIGINAL ARTICLE From Policy to Prediction: Forecasting \u00a9 The Author(s), under exclusive licence to Society for Mathematical Biology 2022 Abstract Understanding the joint impact of vaccination and non-pharmaceutical interventionson COVID-19 development is important for making public health decisions that con- trol the pandemic. Recently, we created a method in forecasting the daily number of conrmed cases of infectious diseases by combining a mechanistic ordinary differen-tial equation (ODE) model for infectious classes and a generalized boosting machine learning model (GBM) for predicting how public health policies and mobility data affect the transmission rate in the ODE model (Wang et al. in Bull Math Biol 84:57,2022). In this paper, we extend the method to the post-vaccination period, accord- ingly obtain a retrospective forecast of COVID-19 daily conrmed cases in the US, and identify the relative influence of the policies used as the predictor variables. Inparticular, our ODE model contains both partially and fully vaccinated compartments and accounts for the breakthrough cases, that is, vaccinated individuals can still get infected. Our results indicate that the inclusion of data on non-pharmaceutical inter-ventions can signicantly improve the accuracy of the predictions. With the use of policy data, the model predicts the number of daily infected cases up to 35 days in the future, with an average mean absolute percentage error of 20 .15%, which is fur- ther improved to 14 .88% if combined with human mobility data. Moreover, the most influential predictor variables are the policies of restrictions on gatherings, testing B Hao Wang hao8@ualberta.ca 1Department of Mathematical and Statistical Sciences, University of Alberta, Edmonton, AB T6G2G1, Canada 2Department of Mathematics, University of Tennessee at Chattanooga, Chattanooga, TN 37403, USA 3Department of Mathematics and Statistics, Brock University, St. Catharines, ON L2S 3A1, Canada 4National Institute for Mathematical Sciences, Daejeon 34047, Korea 5Department of Biological Sciences, University of Alberta, Edmonton, AB T6G 2G1, Canada 0123456789().: V,-vol 123 90 Page 2 of 19 X. Wang et al. and school closing. The modeling approach used in this work can help policymakers design control measures as variant strains threaten public health in the future. Keywords Inverse method \u00b7COVID-19 modeling \u00b7V accination \u00b7 Non-pharmaceutical interventions \u00b7Generalized boosting machine learning model 1 Introduction Since COVID-19 was characterized as a pandemic by World Health Organization (WHO) on March 11, 2020, it has spread to 224 countries and territories. The UnitedStates is the country most affected by COVID-19, with 20,629,998 conrmed cases and 369,897 deaths by the end of December 2020 ( https://www.worldometers.info/ coronavirus/country/us/ ). Mass vaccination against COVID-19 started on December 20, 2020, in the US. As of December 13, 2021, 72 .6% of the US population have received at least one dose of vaccine, 60 .9% have been fully vaccinated, and 16 .5% have been given a booster shot (Ritchie et al. 2020 ). Except another small peak in April, the weekly number of new cases kept decreasing nearly monotonically, since mid-January 2021 until June 2021 (Ritchie et al. 2020 ), which brought a faint hope that the COVID-19 pandemic might be brought under control soon, although thishope has been dashed by the emergence of new COVID-19 variants. Indeed, even when vaccines are available, control of COVID-19 indispensably relies on some non- pharmaceutical interventions (NPIs), such as testing, contact tracing, facial coverings,protection of elderly people, school closing, workplace closing, cancellation of public events, restrictions on gatherings, public transport closing, stay at home requirements (Ritchie et al. 2020 ). Thus, it is necessary and urgent to understand the joint impact of vaccination and NPIs on COVID-19 spread in order to provide guidance for poli- cymakers to control the pandemic. Transmission dynamics is a useful tool to serve this purpose, as it can assess both the direct and indirect impact of vaccinations on the disease spread (Eichner et al. 2017 ; Halloran et al. 1991 ). Dynamical models have been used in studying COVID- 19 vaccine prioritization, hypothetical vaccination strategies or the resource allocation, such as the intensity of NPIs needed to balance with a restricted number of vaccines available (Bubar et al. 2021 ; Brett and Rohani 2020 ; Buckner et al. 2021 ; Saad-Roy et al. 2020 ; MacIntyre et al. 2021 ; Matrajt et al. 2021 ; Han et al. 2021 ;L ie ta l . 2020 ). In terms of the future projection, the majority of studies provide only qualitative insights rather than quantitative estimates. Quantitative forecasting of the future transmissionin the post-vaccination era can be realized only if we predict the number of COVID-19 conrmed cases based on vaccination and NPI policy data. In our recent pre-vaccination modeling work (Wang et al. 2022 ), we employed a hypothesis-free machine-learning algorithm to estimate the transmission rate based on NPI data, and in turn forecast the daily number of conrmed cases in the US for the pre-vaccination period using a mechanistic disease model. We also investigated theimpact of different types of policy and mobility data on the predictions and found that restrictions on gatherings is the most influential variable (Wang et al. 2022 ). In this paper, we use the same method as in Wang et al. ( 2022 ) to make a retrospective forecast 123From Policy to Prediction: Forecasting COVID-19 Dynamics... Page 3 of 19 90 of the daily number of conrmed cases in the US for the post-vaccination period and investigate the joint impact of vaccination and NPIs. More specically, we build a hybrid model consisting of a mechanistic ordinary differential equation (ODE) and ageneralized boosting machine learning model (GBM). The ODE model contains two vaccinated compartments: partially vaccinated and fully vaccinated, and it accounts for the case that vaccinated individuals can still get infected. Then, the impact ofvaccination is reflected implicitly when the ODE model gives simulation results. The NPIs serve as predictor variables of the GBM to predict the transmission rate. Before we run GBM to make predictions, we use the inverse method that we created in Wanget al. ( 2022 ) to obtain a time series of daily transmission rates which are fed into GBM as the response variable. The GBM is trained based on these predictor and response variable data and produces predictions of future transmission rates given future NPIs.Using the predicted transmission rates from the GBM, the ODE model gives the predicted number of daily conrmed cases. In Wang et al. ( 2022 ), we have shown that including NPI policy data can greatly improve the accuracy of the predictions.We were curious to see whether this is also the case for the post-vaccination period. To this end, in addition to the scenario where only policies are used as the predictors of the GBM, we have considered two other scenarios where human mobility is also used. This forecasting approach capturing the joint impact of vaccination and NPIs can hopefully be applied to other countries that are suffering terrible situations causedby SARS-CoV-2 and its variant strains as well as other infectious diseases. The remaining paper is organized as follows. In Sect. 2, we present data collection, model formulation, parameter estimation, and prediction methodology. In Sect. 3,w e present the results. In Sect. 4, we provide concluding remarks and propose possible future work. 2 Methods 2.1 Data Collection In this study, we collected daily data from April 4, 2020, to April 5, 2021, that cover part of both pre-vaccination and post-vaccination periods in the US. We obtained the number of conrmed cases of COVID-19, the number of partially vaccinated andfully vaccinated individuals in the US and policy indices in each state of the US from the website of Our W orld in Data (Ritchie et al. 2020 )(https://ourworldindata.org/ coronavirus ), the six categories of human mobility data in the US from the ofcial web- site of Google ( https://www.google.com/covid19/mobility/ ), and deaths, recovered and active cases in the US from the worldometer website ( https://www.worldometers. info/coronavirus/country/us/ ). All data used in this study are metric. In order to mit- igate the inaccuracy induced by under-reporting, etc. (for example, during weekends the number of daily conrmed cases is usually under-reported), we used the 7-day averaged epidemiological data (i.e., the average of the current day and the last 6 days) in the simulation. We derived the nationwide time-series index data for containment policies (begin- ning with \"C\") and health policies (beginning with \"H\") by taking an average of 123 90 Page 4 of 19 X. Wang et al. Fig. 1 Policy and mobility data in the US from April 4, 2020, to April 5, 2021 the corresponding policy indices over all the 50 US states as well as Washington D.C., weighted by their populations. The containment policies included school clos- ing (denoted by C1), workplace closing (C2), cancel public events (C3), restrictions ongatherings (C4), close public transport (C5), stay at home requirements (C6), restric- tions on internal movement (C7), and international travel controls (C8). The health policies included public information campaigns (H1), testing policies (H2), contacttracing (H3), facial coverings (H6), vaccination delivery policy (H7), and protection of elderly people (H8). The labels H4 and H5 represent emergency investment in health- care and investment in vaccines, respectively, which are not available (Ritchie et al.2020 ). Note that in addition to those policy data in our pre-vaccination work (Wang et al. 2022 ), here we take into account the vaccination delivery policy (H7) as well since we focus on the post-vaccination case in the current paper. Human mobility dataincluded changes of mobility trends (%), compared to the baseline level 0, in retail and recreation (M1), grocery and pharmacy (M2), parks (M3), transit stations (M4), workplaces (M5), and residential (M6). The time series of these 14 policy indices and human mobility data are shown in Fig. 1. 2.2 Model Formulation Our model extends the SEIAR (Susceptibles, Exposed, symptomatic Infected, Asymp- tomatic infected, Removed) model in Wang et al. ( 2022 ) by incorporating two new compartments: the individuals who are partially vaccinated (denoted by V 1), and the individuals who are fully vaccinated ( V2)( s e eF i g . 2). The susceptible individuals getting their rst dose of vaccines will enter the V1com- partment, and the individuals in the V1compartment will enter the V2compartment if they are fully vaccinated. According to CDC statistics, a small part of vaccinatedindividuals can still get infected, which is the so-called breakthrough cases ( https:// www.cdc.gov/vaccines/covid-19/health-departments/breakthrough-cases.html ). We describe such breakthrough cases by incorporating incidence terms in the equationsofV 1and V2, with relative risks of infection being /epsilon11and/epsilon12, respectively, for partially vaccinated and fully vaccinated individuals, due to imperfect vaccination protection. Therefore, the susceptible individuals ( S), the partially vaccinated individuals ( V1), 123From Policy to Prediction: Forecasting COVID-19 Dynamics... Page 5 of 19 90 Fig. 2 Flowchart of the transmission dynamics with vaccination and the fully vaccinated individuals ( V2) will all enter the exposed compartment (E) if they are infected by symptomatic infected individuals (I), asymptomatic infected individuals (A), or the exposed individuals (E). The transmission rate is (t), and the relative transmissibility of asymptomatic infected and exposed individuals compared to symptomatic infected individuals are AandE, respectively. The average incuba- tion period is 1 /days. Once the incubation period ends, a proportion pof the exposed individuals become asymptomatic infected and the rest proportion 1 pbecome symp- tomatic infected. The disease induced death rate is (t). It takes an average of 1 /rI days and 1 /rAdays for symptomatic and asymptomatic infected individuals to recover, respectively. The model is given by the following system of Parameter Estimation The constant parameter values are taken from the literature. The total US population Nis expected to be 331 ,449,281 by US Census Bureau on April 1, 2020 (US Census Bureau 2021 ). Since the incubation period ranges from 2 to 14 days and has a mean of about 5 days (Linton et al. 2020 ), we assume that =1/5 per day. According to Byrne et al. ( 2020 ), asymptomatic individuals has an approximate median infectious period 123 90 Page 6 of 19 X. Wang et al. of 6.5t o9.5 days, and the average duration from symptom onset to clearance is about 13.4 days based on a meta-analysis of serial testing. Then it is reasonable to assume that rI=1/13.4 per day and rA=1/8 per day. Gao et al. ( 2021 ) discovered that 76% of seropositive infections were accompanied by no symptoms based on a study among 34857 participants in China. In addition, they found that the relative transmissibility varied from 0 .35 to 0 .58 for asymptomatic cases and was 0 .63 for pre-symptomatic cases. Thus, we assume that p=0.76,E=0.63,A=0.47. The two new constant parameters /epsilon11and/epsilon12were estimated according to vaccine efcacy, which is generally reported as a relative risk reduction (RRR). Our method used the relative risk (RR), i.e.,the ratio of attack rates with and without vaccination to get RRR, which equals 1-RR (Olliaro et of the Pzer-BioNTech BNT162b2 mRNA vaccine beginning 7 days after the rst dose to before the second dose is 68 .5%, and the RRR of Pzer after 7 days of the second dose is 94 .8% (Skowronski and De Serres 2021 ). Since most people in the US take the Pzer and Moderna vaccines which have similar efcacy (Olliaro et al. 2021 we use the RRR of rst- and second-dose Pzer vaccine to approximate the values of 1and/epsilon12, which leads to /epsilon11=10.685 =0.315 and /epsilon12=10.948 =0.052. The death rate on day i(denoted by [i]) is estimated using the following formula: [i]=#new deaths on day i #currently infected individuals on day i. The rst-dose vaccination rate on day i(denoted by [i]) is estimated by the fol- lowing formula: [i]=#individuals who received their rst dose vaccine on day i #susceptible individuals on day i, where the number of susceptible individuals on day iequals the total population N minus the number of all infected individuals on and before day i(regardless of whether recovered or not) and then minus the number of individuals who have been vaccinated before day i. The second-dose vaccination rate on day i(denoted by [i])i sg i v e nb y [i]=#individuals who received their second dose vaccine on day i #individuals who are partially vaccinated on day i1. To estimate the time-varying transmission rate, we used the inverse method that we created in Wang et al. ( 2022 ) which is motivated by Kong et al. ( 2015 ) and Pollicott et al. ( 2012 ). We started by obtaining the time series of E(t)from the term (1p)E(t) which can be approximated by the notication data. We use S[k],E[k],I[k],A[k], R[k],V1[k],V2[k]to represent the values of variables in model ( 1),D[k]to represent the cumulative deaths, and y[k]to be the notication data, on the k-th day of study. Then we have E[k]=y[k] (1p),k=1,2,3,..., K, 123From Policy to Prediction: Forecasting COVID-19 Dynamics... Page 7 of 19 90 Table 1 Parameter interpretation and values Parameter Interpretation V alue (t) Transmission rate See Fig. 4 N Total population of US 331,449,281 E Relative transmissibility of exposed individuals 0.63 A Relative transmissibility of asymptomatic individuals 0.47 (t) First dose vaccination rate See Fig. 3(a) (t) Second dose vaccination rate See Fig. 3(b) 1/ Incubation period 5 days p Proportion of asymptomatic infections 0.76 (t) Death rate of symptomatic infected individuals See Fig. 5 rI Recovery rate of symptomatic infected individuals 1/13.4 day1 rA Recovery rate of asymptomatic infected individuals 1/8 day1 /epsilon11 Relative risk of infection for partially vaccinated individuals 0 .315 /epsilon12 Relative risk of infection for fully vaccinated individuals 0 .052 where Kis the length of the vector of notication data. We can obtain the time series data of V1[k]and V2[k],k=1,2,3,..., K, and the initial values S[1], I[1],R[1],D[1]from reporting (Ritchie et al. 2020 )(https://www.worldometers. info/coronavirus/country/us/ ). We assume that A[1]= 0.76I[1]/0.24 according to S-equation, V1-equation and V2-equation to obtain d(S(t)+V1(t)+V2(t)) dt=(t)(S(t)+/epsilon11V1(t)+/epsilon12V2(t))(I(t)+EE(t)+AA(t)) N. Substituting the time series of S(t),V1(t),V2(t),I(t),E(t)and A(t)into the above equation, we approximate [K]by the value of [K1]. The interpretations and values of all the parameters are given in Table 1. 123 90 Page 8 of 19 X. Wang et al. 2.4 Prediction We implemented three GBMs with different predictor variables to explore the relation- ship between the transmission rate and policy and/or mobility variables, and determine which factors mostly affect the transmission rate (t)according to their relative impor- tance. Our main interest was in the GBM with all the 14 types of policy data (C1-C8,H1-H3, H6-H8) as predictor variables since the model with policy only has the power of prediction. The second GBM involves the mobility variables (M1-M6) only and it is used to explore the direct impact of human mobility on the prediction of the trans-mission rate. The last GBM incorporates all the mobility variables (M1-M6) together with four policy variables (H2, H3, H6, H7), aiming to investigate the joint impact of human mobility and policy on the prediction. Note that for the last GBM, we did notinclude the other policies since they are considered to have direct impact on human mobility and hence it may be unreasonable to put them together with the mobility as predictor variables when we want to change some of the policies, whereas we do not know how the mobility varies accordingly. By comparing the simulation results of these different GBMs, we were also able to see whether better predictions occur whenmobility data are included. Thegbm package and predict function in Rwere used in the implementation of the gradient boosting machine learning. To evaluate model performance in makingfuture predictions, we divided the dataset into a training and test dataset , where the model is calibrated using the training dataset and is then evaluated based on its pre- dictions over the test dataset. As this is a time-series prediction task, the division wasdone temporally , where the beginning \"chunk\" of the data is taken as the training and the remaining chunk as the test dataset (Ramazi et al. 2021b ,a). Moreover, to increase evaluation reliability, several training and test durations were considered. Focusingon the effect of vaccination on the COVID-19 dynamics, we needed all the test dura- tions to cover a part of post-vaccination period. To this end, we xed the start data of training at April 4, 2020, and let the training duration vary from 231 days to 329days by an increment of 7 days, and meanwhile x each test duration at 35 days. Then the earliest test duration was from November 21, 2020, to December 25, 2020, which covers 6 days of the post-vaccination period, and the latest test duration consists of post-vaccination days from February 27, 2021, to April 2, 2021, as shown in Table 2. The training dataset consisted of the transmission rate on each day obtained by the inverse method as the response variable and policy and/or mobility daily data as the predictor variables. For the rst GBM, all the 14 types of policy data (C1- C8, H1-H3, H6-H8) on each day were provided as the predictor variables. For thesecond GBM, all the 6 types of mobility daily data (M1-M6) acted as the predictor variables. The training dataset of the third GBM contained all the mobility data (M1- M6) and the policy data H2, H3, H6, H7 as the predictor variables. For the testingdataset, we provided the trained GBMs with policy and/or mobility data to get the predicted transmission rate on each day of the test duration. Using the trained and tested transmission rate time series, we plotted the curve (1p)E(t)of the SEIARVV model ( 1) and compared the simulated results with notication data of daily COVID-19 conrmed cases. 123From Policy to Prediction: Forecasting COVID-19 Dynamics... Page 9 of 19 90 Table 2 Training and testing durations Train length (days) Train duration Test duration 231 April 4, 2020, to November 20, 2020 November 21, 2020, to December 25, 2020 238 April 4, 2020, to November 27, 2020 November 28, 2020, to January 1, 2021 245 April 4, 2020, to December 4, 2020 December 5, 2020, to January 8, 2021 252 April 4, 2020, to December 11, 2020 December 12, 2020, to January 15, 2021 259 April 4, 2020, to December 18, 2020 December 19, 2020, to January 22, 2021 266 April 4, 2020, to December 25, 2020 December 26, 2020, to January 29, 2021 273 April 4, 2020, to January 1, 2021 January 2, 2021, to February 5, 2021 280 April 4, 2020, to January 8, 2021 January 9, 2021, to February 12, 2021 287 April 4, 2020, to January 15, 2021 January 16, 2021, to February 19, 2021 294 April 4, 2020, to January 22, 2021 January 23, 2021, to February 26, 2021 301 April 4, 2020, to January 29, 2021 January 30, 2021, to March 5, 2021 308 April 4, 2020, to February 5, 2021 February 6, 2021, to March 12, 2021 315 April 4, 2020, to February 12, 2021 February 13, 2021, to March 19, 2021 322 April 4, 2020, to February 19, 2021 February 20, 2021, to March 26, 2021 329 April 4, 2020, to February 26, 2021 February 27, 2021, to April 2, 2021 The performance evaluation measures MAE (i.e., mean absolute error) and MAPE (i.e., mean absolute percentage error) were utilized to evaluate the differences between the predicted and actual numbers of conrmed cases, and the differences between the transmission rates predicted by GBMs and those derived from the inverse method. The formulas of MAE and MAPE are given by MAE =1 nn/summationdisplay i=1|zixi|,MAPE =1 nn/summationdisplay i=1/vextendsingle/vextendsingle/vextendsingle/vextendsinglez ixi xi/vextendsingle/vextendsingle/vextendsingle/vextendsingle, where x iis the ith component of the vector of actual values, ziis the i-th component of the vector of prediction values, and nis the total number of data instances. To obtain smaller MAE and MAPE, the GBMs were tuned with the number of trees, the distribution of response variable, the stochastic gradient descent, the depth of 123 90 Page 10 of 19 X. Wang et al. Fig. 3 First and second dose vaccination rates from April 4, 2020, to April 5, 2021 Fig. 4 Transmission rate obtained by inverse method and the tting with notication data from April 4, 2020, to April 5, 2021 interaction, the learning rate, and the minimum number of observations allowed in the trees' terminal nodes. It is intriguing and important to know which predictors are more influential in training the GBM. We explored this by using the summary function in Rwhich produces a bar plot showing the values and ranking of the relative influence of each predictor variable. 3 Results The curves for the time-varying vaccination rates, the transmission rate obtained bythe inverse method, and the death rate are shown in Figs. 3,4, and 5, respectively. The GBMs based on the training and testing datasets perform better (i.e., lower MAE and MAPE) when the number of trees is 1000, the stochastic gradient descent parameteris 0.9, the depth of interaction is 30, the learning rate is 0 .01, the minimum number of observations allowed in the trees' terminal nodes is 10, and the response variable has a Gaussian distribution. 123From Policy to Prediction: Forecasting COVID-19 Dynamics... Page 11 of 19 90 Fig. 5 Death rate of symptomatic infected individuals from April 4, 2020, to April 5, 2021 Table 3 Averaged MAE and MAPE of the ttings with notication data Data used in GBM Averaged MAE Averaged MAPE Policy data C1-C8, .85% Mobility data M1-M6 and policy data H2,H3,H6,H7 21200 .27 14 .88% The averaged MAE and MAPE for the predictions of daily conrmed cases corre- sponding to the three GBMs across all different training durations are given in Table 3. The MAE and MAPE corresponding to different training durations are presented in Table 4. The averaged MAE and MAPE of GBM with mobility only are higher than the other two GBMs involving policies as predictor variables. The lowest averaged MAE and MAPE are obtained for the GBM which has both mobility and some of thepolicies as predictors. However, as shown in Table 4, the MAE and MAPE for the model with mobility only are not always the largest, and the MAE and MAPE for the model with both mobility and policy variables are not always the smallest for some specic training duration. The best prediction result based on each GBM is shown in Fig. 6(MAPE=5 Fig. 10(MAPE=4 .99%), respec- tively. Some other selected training and testing results about the transmission rates as well as the ttings with notication data of daily conrmed cases corresponding to the training durations are presented in supplementary Figs. 12 and 14 for the modelwith policy as the only predictors, in supplementary Figs. 16 and 18 for the model with mobility as the only predictors, and in supplementary Figs. 20, 22 and 24 for the model with both mobility and policy as predictors (see Appendix). We can see 123 90 Page 12 of 19 X. Wang et al. Table 4 MAE and MAPE of predictions of notication data based on model ( 1) and the three GBMs corresponding to different training durations. Predictors of GBM policy data C1-C8, (2) predictors of GBM (3) are M1-M6 and policy data H2, H3, H6, H7 Train length MAE MAPE (%) MAE MAPE MAE MAPE (%) (days) (GBM (GBM (1)) Prediction: Forecasting COVID-19 Dynamics... Page 13 of 19 90 Fig. 6 Using policy data C1-C8, H1-H3, H6-H8, train 245 days from April 4, 2020, to December 4, 2020; test 35 days from December 5, 2020, to January 8, 2021 Fig. 7 Relative influence of policy variables C1-C8, H1-H3, H6-H8 when trained for 245 days from April 4, 2020, to December 4, 2020 that the ttings with the transmission rate and the notication data of daily conrmed cases for the training part (orange curves in these gures) are almost perfect including the tting with peaks and troughs. Although the MAPEs for the predictions of the transmission rates are not very small (greater than 10%), the MAPEs are quite small (smaller than 6 .5% ) for some predictions of notication data (see the yellow curves in Figs. 6,8,10and supplementary Figs. 16, 18, 20). In Figs. 6,8and supplementary Figs. 16, 18, 20, even if the training is based on pre-vaccination data, the predictions for post-vaccination conrmed cases have very small MAPEs: 5 .20%, 3 .86%, 3 .88%, 5.76%, 6 .34%, respectively. Besides, the yellow curves in the right panels of Fig. 6and supplementary Figs. 16, 18, 20 replicate the trend of increasing to a local maximum and decreasing from the local maximum to a local minimum. 123 90 Page 14 of 19 X. Wang et al. Fig. 8 Using mobility data M1-M6, train 231 days from April 4, 2020, to November 20, 2020; test 35 days from November 21, 2020, to December 25, 2020 Fig. 9 Relative influence of mobility variables M1-M6 when trained for 231 days from April 4, 2020, to November 20, 2020 Fig. 10 Using mobility data M1-M6 and policy data H2, H3, H6, H7, train 315 days from April 4, 2020, to February 12, 2021; test 35 days from February 13, 2021, to March 19, 2021 The relative influence of each policy variable in training the rst GBM is shown in Fig. 7, supplementary Figs. 13, 15 when the model is trained for 245 days, 273 days, 308 days, respectively. From these gures we can see that restrictions on gatherings is the most influential policy when the model is trained for 245 days, which is consistent with the nding of our pre-vaccination paper (Wang et al. 2022 ). However, the most 123From Policy to Prediction: Forecasting COVID-19 Dynamics... Page 15 of 19 90 Fig. 11 Relative influence of mobility variables M1-M6 and policy variables H2, H3, H6, H7 when trained for 315 days from April 4, 2020, to February 12, 2021 influential predictor variable is school closing when the model is trained for 273 days and becomes testing policies when the model is trained for 308 days. Note that in both these two cases, post-vaccination data are involved in the training and restrictionson gatherings is the second most influential predictor variable. When the model is trained for 245 days, the relative influence of the vaccination delivery policy H7 is 0 as the training set involves only pre-vaccination data in this case. The vaccinationdelivery policy H7 becomes increasingly important as the training involves more post- vaccination data, with the relative influence increasing from 0 .62% when trained for 273 days to 1 .24% when trained for 308 days (see supplementary Figs. 13, 15). The relative influence of the mobility variables in training the second GBM for 231 days, 238 days, and 245 days is given in Fig. 9, supplementary Figs. 17, 19, respectively. For all these training sets, human mobility in parks is always the most important variable,followed by retail and recreation and workplaces, whereas residential mobility has the least influence on training the model. The relative influence of the mobility variables M1-M6 and the policies H2, H3, H6, H7 in training the third GBM, correspondingto training durations of 315 days, 245 days, 294 days, 308 days, are presented in Fig. 11, supplementary Figs. 21, 23, 25, respectively. When mobility data and part of the policy data are put together for training, the leading influential variable is always testing policy H2 with a weight of around 50% in relative influence when the GBM is trained for 315 days. Similar to the GBM with policy predictors only, the rankingof vaccination delivery policy H7 increases when more post-vaccination days are included in the training dataset. The rankings of the mobility variables also change when the model is trained for different lengths of days. 123 90 Page 16 of 19 X. Wang et al. 4 Discussion In this paper, we constructed a hybrid model by combining an ODE model with a vari- able transmission rate, motivated by the mechanisms of COVID-19 transmission and vaccination dynamics, coupled to a GBM, which provides a machine learning algo- rithm to forecast the transmission rate based on policy and/or mobility data. In ourmechanistic model, we considered both partially vaccinated and fully vaccinated com- partments in addition to the susceptible, exposed, symptomatic infected, asymptomatic infected and recovered compartments. In particular, we incorporated incidence termsin the vaccinated compartment equations to directly model the fact that vaccinated individuals can still get infected, which has rarely been studied by previous mathe- matical models with vaccination (Brett and Rohani 2020 ; MacIntyre et al. 2021 ;L i et al. 2020 ). The key step to link the ODE and GBM models is to obtain the time- varying transmission rate by the inverse method that we created in Wang et al. ( 2022 ). This time-varying transmission rate can produce an almost perfect t with the notica-tion data of conrmed cases, which increases the chance of a good tting using GBM. We trained the GBMs to t the transmission rate obtained by the inverse method with policy and/or mobility data and predicted future transmission rate based on future pol- icy and/or mobility data as well as the training experience. Then we used the trained and predicted transmission rate to plot solution curves of the mechanistic model tomake predictions of the number of daily conrmed cases. The prediction performance was evaluated by mean absolute error (MAE) and mean absolute percentage error (MAPE) measures. We found that the GBM trained on dataon both mobility and some of the policies (testing, contact tracing, facial coverings, and vaccination delivery) is more efcient in establishing an association between the transmission rate and predictor variables than the GBM trained based on policy ormobility data only. The performance of the GBM with only mobility data performs the worst. Therefore, to model the impact of the preventive policies on the disease spread, mobility data appears to be insufcient. Other factors, such as facial covering,must be included. We also investigated the importance of the predictor variables and found that restric- tions on gatherings, testing policies and school closing are the most influential ontraining the GBM compared to other NPIs, which is consistent with their leading roles in training the pre-vaccination model (Wang et al. 2022 ). This further emphasizes the importance of these NPIs even under vaccination. For the GBM with both policyand mobility as predictors, the rankings of the relative influence of the three policy variables testing, facial coverings and contact tracing are the same for both pre- and post-vaccination cases (Wang et al. 2022 ) except when trained for 294 days where contact tracing is a little more important than facial coverings. For the GBM with mobility as the only predictors, mobility trend in parks is always the most influentialfactor regardless of the vaccination situation (Wang et al. 2022 ). For the pre-vaccination case, the second most influential variable is workplaces (Wang et al. 2022 ). For the post-vaccination case, the second most influential variable becomes retail and recre-ation. The conclusions on the predictors are at the country scale. For example, mobility trend in parks may not be the most influential factor in every state of the US; however, 123From Policy to Prediction: Forecasting COVID-19 Dynamics... Page 17 of 19 90 when making predictions for the whole country\u2014as in our model\u2014the mean of the mobility trend in parks over all states becomes most influential. Indeed, different states have adopted different mitigation policies (Haratian et al. 2021 ), and this heterogeneity must be taken into account for state or even county-level analysis. Since predictions are made based on the training experience, investigation of rel- ative influence of predictor variables in training the model can help us get closer tothe mechanisms behind predictions. Although our machine-learning compartment is correlation based, which prevents causal statements on the relationship between gath- erings restrictions and the transmission rate, our nding highlights the possibility ofsuch causal relationship and motivates future work in this direction. Indeed, some research works have already tried to estimate the effects of different control measures or mobility on COVID-19 transmission dynamics (see Badr et al. 2020 ; Chinazzi et al. 2020 ; Xue et al. 2021 ; Lai et al. 2020 ; Koo et al. 2020 ) and the references therein). Our relative influence results indicate that the vaccine delivery policy is not so important in training the model. However, there is no disparity regarding the importance of incor-porating vaccination in a model (see, e.g., MacIntyre et al. 2021 ; Patel et al. 2021 ) because the vaccine delivery policy only describes the availability of vaccines such as to what extent or scale the vaccines are distributed or donated to a region (Ritchie et al. 2020 ). It may not represent how many people are actually getting vaccinated so it has no relation to either vaccination rate or cumulative vaccinated proportion. For future work, it would be interesting to consider different infected compart- ments representing individuals infected with different strains of the virus. One can also study immunity waning cases where recovered and vaccinated individuals returnto the susceptible compartment after a period of time. This aspect should be impor- tant in long-term forecasting. In addition to susceptible individuals, exposed and asymptomatic infected individuals who are unaware of their infections and recov-ered individuals can all get vaccinated, which will result in a new post-vaccination mechanistic model. Moreover, it is informative to compare the COVID-19 dynam- ics in different states of the US using ne-scale datasets (Haratian et al. 2021 )o ri n other countries in the world. Parameter uncertainty and identiability are also worth investigating for this novel inverse method plus machine learning approach. The meth- ods used in this work could be applied in the study of some other infectious diseasetransmission dynamics as well, especially when vaccination is implemented. Supplementary Information The online version contains supplementary material available at https://doi. org/10.1007/s11538-022-01047-x . Acknowledgements This work was funded Pzer via project number RES0052027. XW gratefully acknowledges support from Research and Creative Activity (RCA) Grant awarded by College of Arts and Sciences at the University of Tennessee at Chattanooga. HW gratefully acknowledges support from Natural Sciences and Engineering Research Council of Canada (NSERC)Discovery Grant RGPIN-2020-03911 and NSERC Accelerator Grant RGPAS-2020-00090. KN grate- fully acknowledges support from National Institute for Mathematical Sciences (NIMS) grant funded by the Korean Government (NIMS-B22910000). MAL gratefully acknowledges a Canada Research Chair in Mathematical Biology and support from an NSERC Discovery Grant. 123 90 Page 18 of 19 X. Wang et al. References Badr HS, Du H, Marshall M, Dong E, Squire MM, Gardner LM (2020) Association between mobility patterns and COVID-19 transmission in the USA: a mathematical modelling study. Lancet Infect Dis 20(11):1247-1254 Brett TS, Rohani P (2020) Transmission dynamics reveal the impracticality of COVID-19 herd immunity strategies. Proc Natl G, Springborn MR (2021) Dynamic prioritization of COVID-19 vaccines when social distancing is limited for essential workers. Proc Natl Acad Sci 118(16):e2025786118 Byrne AW, McEvoy D, Collins AB et al (2020) Inferred duration of infectious period of SARS-CoV-2: rapid scoping review and analysis of available evidence for asymptomatic and symptomatic COVID-19 cases. BMJ Open 10:e039856 Chinazzi M, Davis JT, Ajelli M et al (2020) The effect of travel restrictions on the spread of the 2019 novel coronavirus (COVID-19) outbreak. Science 368(6489):395-400 Eichner M, Schwehm M, Eichner L, Gerlier L (2017) Direct and indirect effects of influenza vaccination. BMC Infect Dis 17(1):1-8 Gao W, Lv J, Pang Y , Li L-M (2021) Role of asymptomatic and pre-symptomatic infections in Covid-19 pandemic. BMJ 375:n2342 Google Team (2021) Google COVID-19 community mobility reports. https://www.google.com/covid19/ mobility/ . Last Accessed 1 May 2021 Halloran ME, Haber M, Longini IM Jr, Struchiner CJ (1991) Direct and indirect effects in vaccine efcacy and effectiveness. Am J Epidemiol 133(4):323-331 Han S, Cai J, Yang J, Zhang J, Wu Q, Zheng W, Shi H, Ajelli M, Zhou X-H, Y u H (2021) Time-varying optimization of COVID-19 vaccine prioritization in the context of limited vaccination capacity. Nat Commun 12(1):1-10 Haratian A, Fazelinia H, Maleki Z, H, Lewis MA, Greiner R, Wishart D (2021) Dataset of COVID-19 outbreak and potential predictive features in the USA. Data Brief 38:107360 Kong JD, Jin C, Wang H (2015) The inverse method for a childhood infectious disease model with its application to pre-vaccination and post-vaccination measles data. Bull Math Biol 77:2231-2263 Koo JR, Cook AR, Park M (2020) Interventions to mitigate early spread of SARS-CoV-2 in Singapore: a modelling study. Lancet Infect Dis 20(6):678-688 Lai S, Ruktanonchai NW, Zhou L, Prosper O, Luo W, Floyd JR, Wesolowski A, Santillana M, Zhang C, Xiangjun D, Hongjie Y u, Tatem AJ (2020) Effect of non-pharmaceutical interventions to contain COVID-19 in China. Nature 585(7825):410-413 Li Q, Tang B, Bragazzi NL, Xiao Y , Wu J (2020) Modeling the impact of mass influenza vaccination and public health interventions on COVID-19 epidemics with limited detection capability. Math Biosci 325:108378 Linton NM, Kobayashi T, Yang Y et al (2020) Incubation period and other epidemiological characteristics of 2019 novel coronavirus infections with right truncation: A statistical analysis of publicly available case data. J Clin Med 9(2):538 MacIntyre CR, Costantino V , Trent M (2021) Modelling of COVID-19 vaccination strategies and herd immunity, in scenarios of limited and full vaccine supply in NSW, Australia. V accine Matrajt L, Eaton J, Leung T, Brown ER (2021) V accine optimization for COVID-19: COVID-19 vaccine efcacy and effectiveness-the elephant (not) in the room. Lancet Microbe Patel MD, Rosenstrom E, Ivy JS et al (2021) Association of simulated COVID-19 vaccination and non- pharmaceutical interventions with infections, hospitalizations, and mortality. JAMA Netw Open4(6):e2110782 Pollicott M, Wang H, Weiss H (2012) Extracting the time-dependent transmission rate from infection data via solution of an inverse ODE problem. J Biol Dyn 6(2):509-523 Ramazi P AM, Lewis MA, Maleki Z, V ega R, Wang H, Wishart DS, Greiner R (2021) Accurate long-range forecasting of COVID-19 mortality in the USA. Sci Rep11(1):1-11 123From Policy to Prediction: Forecasting COVID-19 Dynamics... Page 19 of 19 90 Ramazi P , Kunegel-Lion M, Greiner R, Lewis MA (2021) Predicting insect outbreaks using machine learning: a mountain pine beetle case study. Ecol Evol 11(19):13014-13028 Ritchie H, Ortiz-Ospina E, Beltekian D, Mathieu Hasell J, Macdonald B, Giattino C, Appel C, Rod\u00e9s-Guirao L, Roser M (2020) Coronavirus pandemic (COVID-19). Our world in data. https:// ourworldindata.org/coronavirus . Accessed 5 June 2021 Saad-Roy CM, Wagner CE, Baker RE, Morris SE, Farrar J, Graham AL, Levin SA, Mina MJ, Jessica C, Metcalf E, Grenfell BT (2020) Immune life history, vaccination, and the dynamics of SARS-CoV-2 over the next 5 years. Science 370(6518):811-818 Skowronski DM, De Serres G (2021) Safety and efcacy of the BNT162b2 mRNA COVID-19 vaccine. N Engl J Med 384:1576-1578 US Census Bureau (2021) Quick facts United States. https://www.census.gov/quickfacts/fact/table/US/ PST045219 . Accessed 15 May 2021 Wang X, Wang H, Ramazi P , Nah K, Lewis M (2022) A hypothesis-free bridging of disease dynamics and non-pharmaceutical policies. Bull Math Biol 84:57 Worldometers.info . Accessed 12 April 2022 Xue L, Jing S, Wang H (2021) Evaluating the impacts of non-pharmaceutical interventions on the trans- mission dynamics of COVID-19 in Canada based on mobile network. PLoS ONE 16(12):e0261424 Publisher's Note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional afliations. 123 "}