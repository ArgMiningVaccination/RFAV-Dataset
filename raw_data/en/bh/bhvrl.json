{"title": "PDF", "author": "PDF", "url": "https://core.ac.uk/download/pdf/144149665.pdf", "hostname": "PDF", "description": "PDF", "sitename": "PDF", "date": "PDF", "cleaned_text": "Early Warning Signals of Vaccine Scares by A. Demetri Pananos A thesis presented to the University of Waterloo in ful llment of the thesis requirement for the degree of Master of Mathematics in Applied Mathematics Waterloo, Ontario, Canada, 2016 c A. Demetri Pananos 2016I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required nal revisions, as accepted by my examiners. I understand that my thesis may be made electronically available to the public. iiiAbstract There exists strong evidence that vaccines are extremely e ective in the prevention of pediatric infectious disease, yet despite this evidence, vaccine refusal is still popular amongst some parents. Existing mathematical models of disease and vaccinating dynam- ics are parsimonious with post scare empirical data, yet lack the ability to predict when a scare will occur. This thesis frames the problem of predicting when a vaccine scare is imminent as a problem in bifurcation theory and critical transitions theory. As a system of di erential equations nears a bifurcation point, the system experiences critical slowing down, a loss in resilience to small perturbations from equilibrium. This loss in resilience manifests itself as an increase in the variance and lag-1 autocorrelation of the time series. Using an existing model for vaccinating dynamics, I demonstrate this critical slowing as the system bifurcates from a state of high vaccine coverage to a state of suboptimal vaccine coverage. I also demonstrate that critical slowing can be detected in the population by using the social media site Twitter and Google Trends data. It will be shown that lead- ing to the 2014 measles outbreak in Disneyland, a statistically signi cant increase in the lag-1 autocorrelation in the time series of tweets with anti-vaccine sentiment is detected. Post outbreak, a statistically signi cant decrease in the lag-1 autocorrelation is detected, suggesting that population comes su\u000eciently close to a vaccine scare to elicit outbreaks in those individuals who ceased vaccinating. The results of this thesis provide new tools to monitor vaccine sentiment and maintain vaccine coverage. vAcknowledgements Special thank you to Chris Bauch for his guidance and supervision. Graduate school would have been very di erent without you. Thank you to my collaborators for their contributions to any resulting publications. Thank you to Rob Corless for helping shape my mathematical writing. Rob, I still use the Lambert W Function wherever I can. Thank you to my lab members for sitting with me and reading thousands of tweets to create the training set. Also, thank you for entertaining my mathematical ramblings, as well as enduring my outbursts after a game of chess went south on me. Last but certainly not least, thank you to all my friends for their endless support. I don't have siblings, but you are the closest thing I will ever have to brothers and sisters. vii\\Don't be an engineer. You will never get a job.\" { My Mother ixTable of Contents List of Tables xv List of Figures xvii 1 Introduction 1 77 A Supplementary Figures 79 B Code 107 B.1 Evolution of the relative risk as a function of Achieved . . . 13 1.5 Bifurcation Tweets, Google Searches for MMR and Measles, Infections in 2.3 Early Warning Behaviour Disease Model . . . . . . 58 xvii2.4 Lag-1 Class Leading To Disneyland Outbreak . . . 59 2.5 Lag-1 AC for Google Searches at the State and National . and Lag-1 AC for Anti-Vaccine Tweets 85 A.7 Sensitivity Analysis of Window Width and Lag-1 AC for Pro-Vaccine Tweets 86 A.8 Sensitivity Analysis of Window Width for all Tweets . . . . 87 and Variance for Anti-Vaccine Tweets 88 A.10 Sensitivity Analysis of Window Width and Variance for Pro-Vaccine Tweets 89 A.11 Sensitivity Analysis of All Tweets . . . . 90 A.12 Width and Lag-1 Autocorrelation Approach- ing and Window Width and Lag-1 AC for Measles Google Window Width and Lag-1 AC for Measles Google Searches in Window Width and Variance for Measles Window Width and Variance for Measles Google Searches in Window Width and Lag-1 AC for MMR Google Window Width and Lag-1 AC for MMR Google Searches in Window Width and variance for MMR Google Searches in Window Width and Variance for MMR Warning Signals in Pre and Post Peak in Risk Introduction 11.1 Mathematical Epidemiology Mathematical epidemiology is the application of tools in dynamical systems and applied mathematics to the study of how diseases spread. In this section, I motivate the study of epidemiology through a mathematical lens. I then go on to formulate a mathemati- cal model of epidemics, describing the details of the formulation. I then discuss disease transmissibility and how disease transmissibility can be used to determine the size of the epidemic, demonstrating that in the absence of numerical solvers, the model still provides a wealth of inference. 1.1.1 An Advantage Over Traditional Methods Mathematical epidemiology di ers from most sciences in that it does not lend itself to experimental validation of models. Experiments would be costly, impossible to replicate, and would above all else be completely unethical. On the other hand, computational ex- periments can be run orders of magnitude faster than any physical experiment, and can be repeated multiple times for a variety of conditions. The inability to perform tradi- tional experiments, coupled with the speed and exibility of computation, underscores the importance of mathematical and computational models of disease dynamics. The rst mathematical model of disease dynamics was introduced by Kermack & McKendrick in their seminal paper A contribution to the mathematical theory of epidemics [1]. 1.1.2 The SIR Model Models of disease dynamics are often illustrated using compartmental diagrams . These illustrations divide the population into compartments and make assumptions about the nature and time rate of transfer between them. Shown in gure 1.1 is the compartmental 3SIRIFigure 1.1: The for Kermack & McKendrick's model. Indi- viduals move from compartment to compartment in the direction of the arrows. diagram for the Kermack-McKendrick model, known commonly as the SIR model [1]. In the SIR model, individuals are classi ed as either: \u000fSusceptible : These individuals are presently not infected and do not have immunity to the disease. They may become infected if they come in contact with an infected individual. \u000fInfected : These individuals are presently infected and infectious (i.e they are able to spread the disease through contact with an individual in the susceptible compartment, but not with contact with an individual from the recovered compartment). \u000fRecovered : These individuals have no e ect on transmission dynamics. They have left the infected compartment through recovery and are immune to new infections. Several assumptions about the population and time rate of transfer between compartments are made: a) The size of the population remains constant throughout the epidemic. Let the size of the population be N, the number of susceptible individuals in the population be S, the number of infected individuals in the population be I, and the number of recovered individuals be R. Therefore, since the population is partitioned into the three compart- ments,S+I+R=N. Often, it will be the case that N= 1 so that the size of the compartments are understood to be proportions of the population. 4b) An average member of the population makes contact su\u000ecient to transmit infection with Nother members of the population. This assumption is known as mass action mixing [2, 3]. The parameter is called the infectious contact rate (i.e the rate of infection per susceptible an per infective) [3]. c) Members of the infected compartment recover at a rate of I. Here, is the rate of recovery [3]. Assumption (a) asserts that the timescale of the epidemic is much smaller than the timescale for births and deaths. This is especially applicable to epidemics like in uenza, which may only last a few months. Assumption (b) implies that the rate of new infections is the product of the probability of an infected individual encountering a susceptible ( S=N), the number of new infections per unit time ( N), and the number of infected individuals in the population ( I). Thus, the rate of new infections is ( N)(S=N)I= SI. Assumption (c) requires more mathematical nesse. Consider those members of the population who were all infected at one time, and let y(t) denote the number of these individuals who are still infected after ttime units after having been infected. If a proportion of these individuals leave in unit time, then y0=\u0000 y; which is a separable di erential equation with solution y(t) =y(0)e\u0000 t. The function y(t) is the proportion of individuals infected at the same time who remain infectious at time t. Hence, the time to recovery from infection is exponentially distributed. The mean of this distribution is thus 1 = , and hence the mean length of the infectious period is 1 = [2]. 51.1.3 SIR as a Di erential Equation Model With the rates of infection and recovery in hand, as well as the ow between compartments from the compartmental diagram, a system of di erential equations describing the density as a function of time for each compartment can be created. S0=\u0000 SI; (1.1) I0= SI\u0000 I; (1.2) R0= I: (1.3) Here, the primes indicate derivatives with respect to time, t. Closed form solutions for S, I, andRas functions of time cannot be found, and so to gain insight into the dynamics as functions of time, numerical methods can be used. See gure 1.2b for numerical solutions to the SIR model. Though no closed form solutions can be found, several inferences can be made directly from the system. 1.1.3.1 The Basic Reproductive Ratio It has been shown that the expected length of the infectious period is 1 = , and that N possible disease transferring contacts are made by an average member of the population. Thus, N= new infections are produced by an index case in a population su\u000eciently dense in susceptible individuals. This dimensionless quantity is of utmost importance in mathematical epidemiology, so important that it is given a formal name: the basic reproductive ratio, R01. The size ofR0determines if the disease becomes epidemic in the population. Let N= 1, and consider the non-dimensionalization of equations (1.1) to (1.3) 1R0is pronounced R-nought and is much less of a mouthful than the basic reproductive ratio 6by letting = t. The non-dimensionalized system is then S0=\u0000R 0SI; (1.4) I0=R0SI\u0000I; (1.5) R0=I: (1.6) Here, the primes indicate derivatives with respect to the non-dimensional time . Fixed point analysis shows that the disease free equilibrium ( S\u0003;I\u0003;R\u0003) = (1;0;0) is unstable only whenR0>1. In other words, a disease will become epidemic in a population su\u000eciently dense in susceptible when an index case of the disease causes more than one new infection. 1.1.3.2 Solutions in Phase Space Clever manipulation of equations (1.4) to (1.6) yields solutions in the S\u0000Iplane. Note rst that the di erential equation for Rcan be decoupled from the system, as Ris determined whenSandIare known, reducing the dimension of the system from 3 \u00023 to 2\u00022. By leveraging the chain rule, it can be shown that dI dS=\u00001 +1 R0S; (1.7) which can be integrated to obtain in the the initial conditions must be positive for physical reasons, there are no domain issues with the logarithm in the de nition of C. See gure gure 1.2a for level curves of I(S) for varyingR0. With some determination, the nal size of the epidemic as a function of R0can be obtained. Let Sfin, andRfinbe the nal sizes of the compartments SandRonce the epidemic nishes. At the end of 7the epidemic, note that Sfin+Rfin= 1. The nal size of the epidemic is achieved once I(S) = 0. Massaging I(S) = 0 into \u0000R 0Sfinexp(\u0000R 0Sfin) =\u0000R 0exp(\u0000R 0C): The equation in the form of f(Sfin) exp(f(Sfin)) =z: The inverse of this function is f(Sfin) =W(z), whereWis the Lambert W function [4]. Applying the W function yields R0: Note that the argument of the Lambert W function in the above expression tends to 0 from below asR0becomes arbitrarily large, and that W(x)!0\u0000asx!0\u0000[4]. It is now clear to see that as R0!1 ,Rfin!1\u0000, indicating that the nal size of the epidemic will approach the size of the population as R0increases in magnitude. In the absence of closed form expressions for S,I, andR, the model equations allow for inferences to be made about the size of the infection, and the number of expected new infections. The SIR model can be altered so as to account for other epidemiological and biological phenomena, including but not limited to: Exposure to a disease, quarantine, vector-borne diseases, spatial dynamics, and meta-populations. In the following sections, the SIR model will be altered so as to account for births, deaths, and vaccination. 80.0 0.2 0.4 0.6 0.8 1.0 Proportion Susceptible (S)0.00.20.40.60.81.0Proportion Infected (I) 24816(a) Curves of I(S) for varyingR0. AsR0increases, each infection causes more secondary infections, thus in- creasing the nal size of the epidemic. These level curves correspond to C= 1. TheR0for each curve is indicated. 0 1 2 3 4 5 6 Non-dimensional Time ()0.00.20.40.60.81.0Proportion of Population(b) Approximate solutions to the SIR model withR0= 4:5 obtained via fourth order Runge-Kutta methods as implemented by MATLAB 2015b. In solid black is S(t), in solid red is I(t), in dashed black is R(t). Initial con- ditions are S(0) = 0:99,I(0) = 0:01, R(0) = 0 Figure 1.2: Evolution of the relative risk as a function of time. 91.2 Vaccination In this section, I demonstrate the value of vaccination in reducing infectious disease in- cidence and sometimes eliminating infectious disease altogether. I will motivate an SIR model of endemic infection and investigate how vaccination e ects disease prevalence. I will conclude with the phenomena known as herd immunity, demonstrating that herd immunity can not only prevent a disease from becoming endemic, but can prevent an epidemic as well. 1.2.1 An Endemic Model with Vaccination Endemics di er from epidemics insofar as disease prevalence is sustained through time. In the SIR model, disease prevalence tends to zero as time becomes su\u000eciently large. In endemic models, the density of infectives at equilibrium will be non-zero and positive. To demonstrate the di erence between endemics and epidemics, consider an SIR model with births, deaths, and vaccination. To simplify the analysis, suppose the following: a) The per capita birth rate is equal to the per capita death rate. This will assumption will allow the population size to remain constant, allowing S+I+R= 1. b) There is no natural immunity to the disease, and no vertical transmission. This means that newborns only enter the Scompartment c) A fraction 0 < p < 1 of newborns are vaccinated, and thus are moved to the Rcom- partment. d) The vaccine is perfectly e ective. Once vaccinated, immunity is guaranteed, and there is no possibility of vaccine related morbidity. 10SIR(1-\u00adp)pIFigure 1.3: The compartmental diagram for the SIR model with births, deaths, and vac- cination. The compartmental diagram for this system is shown in gure 1.3, and the model equations (1.11) Here, the primes indicate derivatives with respect to time, t. As before, Ris determined whenSandIare known, so Rcan be decoupled from the system. Using arguments from the previous section, it can be shown that R0= =( +\u0016). Fixed point analysis yields two equilibria: A disease free equilibrium ( S\u0003;I\u0003) = (1\u0000p;0) stable only when R0(1\u0000p)<1 Stability Criterion [3], the endemic equilibrium is stable when the following two 0 < p < 1 is a proportion, the rst inequality is always satis ed. The second inequality is satis ed when 1 <R0(1\u0000p), or equivalently, when p<1\u00001 R0=pcrit: 1.2.2 Herd Immunity Whenp=pcrit, the disease free equilibrium and the endemic equilibrium collide, and whenpcrit<p\u00141, the endemic equilibrium leaves the feasible space and destabilizes The collision of equilibra and subsequent exchange of stability happens for p<1, demonstrating that in order to prevent a disease from becoming endemic, only su\u000eciently many people need be vaccinated, and not the entire population . The phenomenon whereby disease spread can be limited if individuals are mostly immune is called herd immunity [5, 6]. When herd immunity is achieved, the population is so dense in members immune (or recovered, in the context of the SIR model) to the disease, that an index case has a di\u000ecult time nding individuals to infect. Thus, the spread of a disease is curbed by the immunity that the herd provides for those unable or unwilling to vaccinate. See gure gure 1.4 for a visualization of the threshold for herd immunity as a function of the basic reproductive ratio. Consider now a case where there is no disease present in the population but individuals continue to vaccinate at rate p. The introduction of an index case will cause an epidemic, and ifp < 1\u00001=R0the disease may remain endemic. Under what circumstances can an epidemic be prevented due to vaccination? Prevention of an epidemic will occur on a short time scale, and so to examine this question, consider the SIR model once more. The di erential equation governing the density of infectives is dI dt= SI\u0000 I: 120 5 10 15 20 R00.00.20.40.60.81.0pFigure 1.4: In blue is the region in the R0\u0000pplane where herd immunity is achieved. In red is the region where a disease will remain endemic In order to prevent an epidemic dI=dt< 0 for all 0\u0014t. Equivalently, SI\u0000 I < 0 I(R0S\u00001)<0 R0S\u00001<0 S <1 R0 In order for vaccination to prevent an epidemic, the density of susceptible at the time the index case is introduced to the population must be less that 1 =R0. SinceSis a decreasing function in the SIR model, if S(0)<1=R0thenS(t)<1=R0for all 0< t. This means that the density of removed individuals must be greater than or equal to 1 \u00001=R0, which was shown to be the threshold for herd immunity. Thus, vaccination can prevent a disease from becoming endemic in the population, and can also prevent an epidemic. Vaccination presents tremendous value in disease prevention and public health, but the model given 13by equations (1.9) to (1.11) ignores an important aspect of vaccination; risk. In North America, parents are not required to immunize their children They may choose to refuse vaccination for religious or personal reasons, or may choose not to vaccinate because of rumours of vaccine related morbidity. It can be shown through a game theoretical analysis that if a non-zero risk is associated with vaccination, it is impossible for the vaccination rate,p, to meet the required threshold for herd immunity [7]. Thus, a model accounting for vaccinating choices must be developed. Before such a model is put forth, the reasons why a parent may forgo or postpone vaccination must be examined. In the following section, vaccine scares and their motivators are discussed. 141.3 Vaccine Scares A vaccine scare is a sudden drop in the vaccine coverage due to an increase in risk (actual or perceived) associated with vaccination. Most recently, the Measles, Mumps, and Rubella vaccine (henceforth referred to as the MMR vaccine) has undergone a vaccine scare in the United Kingdom as rumours of an association with autism have surfaced [8, 9]. In this section, I deconstruct vaccine scares, examining how they are caused and how they a ect disease incidence. At the end of this section, I present a formalization of vaccinating dynamics via game theory and a di erential equation model. 1.3.1 Salient Factors in Determining Vaccinating Habits Vaccine refusal begins with a lack of con dence in the safety or e ectiveness of a vaccine. Though decisions regarding vaccination are multifactorial with high variability from indi- vidual to individual, factors a ecting vaccination habits can be broadly placed into one of three categories: perceived disease risk, perceived vaccine risk, and social norms. Vaccines have become victims of their own success. Control over once common pediatric infectious diseases has lead to an unfamiliarity with these diseases, an underestimation of the risks of the disease, and a lack of con dence in the e\u000ecacy and safety of vaccines [10, 11, 12, 13]. As seen in section 1.2.2, a population su\u000eciently dense in immune individuals can eradicate a disease via herd immunity. This poses a paradox between optimal vaccinating habits in order to eradicate a disease and optimal vaccinating habits for the individual. As vaccine coverage climbs, the incentive to vaccinate drops, as the bene ts of immunization can be achieved via herd immunity without any of the costs or risks. These acts of self preservation make eradication of a disease di\u000ecult under compulsory vaccination [7, 14, 15]. Similarly, an increase in disease prevalence can cause a redoubling e ort of vaccination, as 15individuals are reminded of the dangers of the disease [7]. Leading up to 1874, Stockholm Sweden saw vaccine coverage drop as low as 40% until a smallpox epidemic shocked the city into widespread vaccination [16]. After rumours surfaced in the 1970s that the whole cell pertussis vaccine caused neurological damage, Wales and Great Britain saw a decrease in vaccine coverage until disease incidence spiked in unvaccinated individuals [14, 17]. Hence, ceteris paribus , disease incidence is a salient factor in determining vaccinating habits. Risks associated with vaccination are also salient factors when determining vaccinating habits. The most notable and visible example is the association of the MMR vaccine with autism and gastrointestinal problems [14, 10, 13]. Parents have noticed a population level increase in autism diagnosis as the number of vaccine administrations and recommended vaccinations has coincidently and simultaneously increased. As parents see diagnosis of infants with autism after vaccination, they form a causal relationship of \\vaccines cause autism\". However, this causal inference is in fact fallacious, and readers will recognize this rhetoric as post hoc ergo propter hoc . There exists a con uence of other factors relating to perceived risks of vaccines: The unpredictability of adverse reactions to vaccinations, waning trust in corporations, public health agencies, and the pharmaceutical-industrial complex (i.e Big Pharma), and a demand for a more \\natural\" lifestyle all contribute to perceived vaccine risk [10]. Despite these concerns, there exists no evidence of a relationship between autism and the MMR vaccine [18, 19, 20]. Finally, the interactions between individuals, especially peers, has a high impact on vaccinating habits. Vaccine refusal is the exception and not the rule in most developed countries. Polio eradication has been maintained for decades in European countries with voluntary vaccination [21], and vaccine coverage for MCV1 (the rst dose of the measles containing vaccine) has been well over 93% for the last ten years in countries like Portugal, Sweden, Germany, and The Netherlands [22]. Though vaccine refusal can be problematic 16during times of low disease incidence, local elimination can be maintained, suggesting that perceived disease risk and perceived vaccine risk are not the only salient factors in deter- mining vaccinating habits. The Health Belief Model posits that social factors, speci cally social norms, play an important role in determining vaccinating habits [23, 24]. Social norms are behaviours considered \\normal\" that are enforced by some form of social pun- ishment [25]. With respect to vaccination, punishments may include being type cast with others violating the norm as an irresponsible or a bad parent [26]. It is evident from the literature that childhood vaccination is a social norm. Participants in one particular study thought of childhood vaccination as \\normal\", \\the right thing to do\", and \\natural [...] you're just supposed to do it\" [25]. Hence, pressure from social norms may outweigh any risks or costs of vaccination, causing conscientious objectors to follow the norm and vaccinate themselves or their children 1.3.2 Modelling Vaccine Scares Previous models of vaccinating dynamics did not account for social norms [14, 7]. These models often predicted oscillations in vaccine coverage, which was not observed in vaccine coverage data. Oraby, Thampi, and Bauch have extended an imitation dynamic model of vaccination to account for social norms [15]. For the imitation dynamic, it is assumed that each individual in the population plays one of two strategies: vaccinating or non-vaccinating. The members sample one another at some constant rate and compare payo s for their strategy. If two members playing di erent strategies sample one another, then the member with lower payo will change strategies with probability proportional to the di erence in payo s [27, 28, 29]. The payo to vaccinate is given by ev=\u0000rv+\u000e0x: 17Here,rvis the perceived risk associated with vaccinating, xis the proportion of the popu- lation who chooses to vaccinate, and \u000e0is the strength of the social norms. The payo not to vaccinate is given by en=\u0000cI(t) +\u000e0(1\u0000x): Here,cis the product of cost of infection, reporting probability, and a proportionality constant governing perceived probability of becoming infected. The function I(t) is the density of infective individuals in the population at time t. The di erence in payo s for both strategies is then \u0001E=ev\u0000en=\u0000rv+cI(t) +\u000e0(2x\u00001); which after some rescaling can be written as \u0001E=\u0000w+I(t) +\u000e(2x\u00001): Here,w=rv=cis a rescaled measure of how risky the vaccine is in comparison to infection. Since perceived vaccine risk is dynamic in time, wis usually a function of time (i.e w= w(t)). When \u0001 E > 0 non-vaccinators will switch strategies to become vaccinators, and when \u0001E < 0 vaccinators will switch strategies to become non-vaccinators. The imitation dynamic has vaccinators ( x) sampling non-vaccinators (1 \u0000x) at some constant rate ( k) with the sign of \u0001 Edetermining if vaccinators increase or decrease. Hence, the di erential equation for the rate change in vaccinators with respect to time can then be written as x0=kx(1\u0000x)(\u0000w+I(t) +\u000e(2x\u00001)): Here, the prime indicates a derivative with respect to time, t, andkis the rate at which individuals sample one another. This equation is formally equivalent to those in evolution- ary game theory [29], except that the payo s are functions of time. Using a di erential 18equation model similar to the one found in section 1.2.1, I(t) can be determined. Thus, the entire model is S0=\u0016(1\u0000x)\u0000 SI\u0000\u0016S; (1.12) I0= SI\u0000( +\u0016)I; (1.13) x0=kx(1\u0000x)(\u0000w+I+\u000e(2x\u00001)): (1.14) When relative risk is constant (i.e w(t) =m), model equilibria can be computed. There exist ve feasible equlibria. Three of the ve have zero disease incidence, corre- sponding to full susceptibility and no disease incidence #1:= (S\u0003;I\u0003;x\u0003) = (1;0;0); full vaccine coverage with no susceptibility, #2:= (S\u0003;I\u0003;x\u0003) = and partial vaccine coverage 2\u000e\u0013 : The remaining two 191.3.3 Stability & Bifurcations of the Oraby et al. Model The stability of each equilibria is shown in table 1.1. See gure 1.5 for forx(t). Equilibrium Stability Condition #1 \u0016+ Table 1.1: The stability criteria for the Oraby et al. model. Note that as usual, the disease free equilibrium #1is unstable when 1 <R0. The full vaccine coverage equilibrium #2is stable when the relative risk of the vaccine, m, is strictly less than the strength of the social norms, \u000e. When#3exists, it is always unstable. This is because when disease incidence is 0, the social norms will force vaccine coverage to 0 or 1. Note that when #5is stable, there exists a region of bistability between #5and #2. In this region, partial coverage and full coverage are stable, and the behaviour of the system ast!1 will depend on the initial conditions. Endemic infection with no vaccine coverage stabilizes when mbecomes su\u000eciently large, eventually becoming the only stable equilibrium. Physically, when vaccination is exceedingly risky, not even social norms can force parents to accept the risk and vaccinate. 2For those unfamiliar with bifurcations, a small review in section 1.5.2 200.0 0.00025 0.0005 0.00075 0.001 Relative (x) 2 3 45(a) Here\u000e= 5\u000210\u00004, which violates the stability condition under this parametrization Hence, #5is unstable. 0.0 0.00025 0.0005 0.00075 0.001 Relative 2 3 45(b) Here,\u000e= 2:5\u000210\u00004which satis es the stability condition. Hence, the endemic par- tial vaccine coverage equilibrium is stable Figure 1.5: Bifurcation Diagrams of the Oraby et al years. Stable equilibria in black, unstable equilibria in dashed grey. Not pictured here is the the disease free equilibrium #1as it is always unstable when R0>1, which is the case for measles. In either case, the system demonstrates how a vaccine scare results when the relative risk of vaccination increases. Consider gure 1.5b when m= 0. The full coverage equilibrium is the only stable equilibrium (no risk associated with vaccinating always beats a non-zero risk associated with the chance of infection.). As mincreases further, the system runs the possibility of dropping o the #2branch when m=\u000eonto the#5branch. This drop into suboptimal vaccine coverage due to an increase in the relative risk of vaccination is a vaccine scare in the context of bifurcation. It can be shown that the maximum of the #5 branch is 1\u0000( +\u0016) \u00161 R0<pcrit; 21thus explaining why the disease remains endemic on #5. Ifmcontinues to increase, then the vaccine is perceived to be too risky and eventually no parents will vaccinate. Suppose that mincreases to m=\u000e+\u000fwhere 0<\u000f 1, forcing the system onto the #5 branch. Decreasing the relative risk to m=\u000e\u0000\u000fwill not force the system back onto the full vaccine coverage branch due to bistability of #5and#2. This demonstrates a hidden obstacle to recovering from a vaccine scare. Returning perceived risk to pre-scare levels will not guarantee that a population will achieve herd immunity. The relative risk must be decreased su\u000eciently so that #2is the only stable equilibrium. Physically, this could be expensive, time consuming, or not possible given the available resources. The bistability of this system echoes the importance of maintaining vaccine coverage and preventing an increase in the relative risk of vaccination. 221.4 Machine Learning & Text Classi cation With the emergence of \\big data\", machine learning has become an indispensable tool for deriving insights from a proverbial sea of information. Machine learning has been described as the application of induction algorithms and other algorithms that can be said to \\learn\" from data [30]. That is to say, the application of those algorithms which may make inferences based on data. The foundations of machine learning lay in computer science and statistics, though applications are far reaching, and can be found in elds as diverse as biology, epidemiology, marketing, and nance [31, 32, 33, 34]. This section is by no means a thorough review of the expansive and ever expanding topic of machine learning3, but instead will serve as a primer to understand later applications of machine learning in the context of classi cation. In this section, I discuss: problems machine learning can be applied to, an example of a probabilistic classi er, and common metrics for algorithm performance. 1.4.1 Supervised Learning & Classi cation Consider the following problems: \u000fPredict whether a patient, whom has su ered a heart attack, will su er a second heart attack based on the patient's clinical measurements, demographic, and diet. \u000fPredict the selling price of a house based on the house's location, square footage, and number of bedrooms. \u000fPredict the price of a stock 6 months into the future given the company's performance and other economic indicators. 3For if it were, this book would be just one volume of many. Consequently, please excuse the excessive use of the phrases \\...not examined here\" and \\...beyond the scope of this thesis.\" 23In each of these problems, there exists a qualitative/categorical outcome measurement (e.g price of a stock, occurrence of a second heart attack, etc.), that is to be predicted based on a set of features (e.g company performance, clinical measurements, etc.). There exists a training set which includes previous outcome measurements and the associated features for those outcomes. The problems listed above are all examples of supervised learning problems. The avail- ability of an outcome measurement (e.g data on patients who have su ered heart attacks, prices of houses which have been sold in the recent past, etc.) to guide the learning process is what makes these problems supervised learning problems [35, 36]. Problems where no outcomes are previously observed are called unsupervised learning problems, and usually focus on relating, or clustering , the data to reveal hidden relationships. The above problems can be categorized into regression and classi cation problems. Regression problems seek to predict a continuous outcome (e.g the selling price of a house, the price of a stock, etc.), while classi cation problems seek to predict a categorical outcome (e.g heart attack or no heart attack) from a nite set of possible classes [35, 36]. Mathematically, there exists a set of observations and outcomes ( x1;y1), (x2;y2),:::, (xn;yn), wherexi2Rpandyi2Rm. Each outcome yi=f(xi) +\u000f: Here,\u000f\u0018N(0;Im), whereImis them\u0002midentity matrix. Thus, \u000frepresents white noise inherent in the observations,and is thus independent of the observations xi. The function f:Rp!Rmis an unknown function. Since fis unknown, it must be estimated. This is the essence of machine learning. In many problems, a set of features, x, is readily available, but the outcome yis not easily obtained. Using the an estimate of the unknown function, ^f, an estimated outcome can be obtained using ^ y=^f(x). 24In the following sections, Xwill be ann\u0002pmatrix, where the ithrow is observation xi. Denote the outcome matrix (or outcome vector if m= 1) as y, where the ithrow isyi. As stated previously, ywill be used to guide the learning process in supervised problems. 1.4.2 Supervised Classi cation of Natural Language Text analysis is a major eld of machine learning, but the raw text itself can not be fed into learning algorithms, as the algorithms expect numerical feature vectors with xed size and not raw text documents with variable length [37]. The goal is to somehow map the raw text to a numerical representation so as to obtain an Xcapable of being used by learning algorithms. The process by which a document is converted to a numerical feature vector is called feature extraction [37]. LetCbe a corpus housing documents, which can be as long or as short as needed. Each document is composed of words, separated by punctuation or white space. By counting the number of occurrences of each word in the corpus with respect to each document, a corpus can be turned into numerical matrix, where entry ( i;j) is the number of occurrences of wordjin document i. This particular strategy is dubbed bag of words [37, 38]. Consider this process of feature extraction by means of example. Let D1= \\My dog has eas\",D2= \\All dogs go to dog in heaven has eas\", and D4= \\It is a dog eat dog world\". Thus, C=fD1;D2;D3;D4g. There are 15 unique words inCand 4 documents, so the numerical representation of the corpus, gure 1.6, will be 4\u000215. The result is a numerical representation of a corpus capable of being fed into various algorithms. 250 BBB@all dog dogs eat eas go has heaven in is it my no to world D10 1 0 0 1 0 1 0 0 0 0 1 0 0 0 D21 0 1 0 0 1 0 1 0 0 0 0 0 1 0 D30 1 0 0 1 0 1 1 1 0 0 0 1 0 0 D40 2 0 1 0 0 0 0 0 1 1 0 0 0 11 CCCA Figure 1.6: The feature matrix for the corpus C. The rows of the matrix represent a document from the corpus, and the entries indicate the occurrence of each indicated word. Thus,D1has one occurrence of the word \\dog\", one occurrence of the word \\ eas\", no occurrences of the word \\eat\", and so on. This approach is named \\bag of words\" because it is akin to breaking the document into words, and jumbling them in a bag. This particular representation ignores syntactical relationships between words, and so some information is lost. 1.4.3 Classifying with Naive Bayes Classi er When performing classi cation of any type, creating a decision boundary (a partition of the feature space indicating the separation between elements of di erent classes) is often the nal goal [35, 36]. Some algorithms seek to directly partition Rpso that elements in a common set belong to a like class, while probabilistic methods may classify by classifying according to whichever class leads to maximum posterior probabilities. In this section, a common probabilistic method is illustrated by means of example with a toy text corpus. This method is known as The Naive Bayes Classi er . 1.4.3.1 Naive Bayes Classi feature vector, x2Rp, the Naive Bayes Classi er assigns probabilities that the feature vector belongs to class CkforKclasses by computing Pr(Ckjx) = Pr(Ckjx1;:::;xp): 26Using Bayes' Rule, Pr(Ckjx) =Pr (Ck) Pr (xjCk) Pr (x)(1.15) The numerator of equation (1.15) is equivalent to a conditional distribution Pr ( Ck;x), thus repeated application of the chain rule allows for the numerator to be written as Pr (Ck)\u0001pY j=1Pr (xjjxj;xj+1;:::;xp;Ck): The \\naive\" part of the Naive Bayes Classi er is that the algorithm assumes that feature xjis independent of xiforj6=i, and so the numerator collapses to Pr (Ck)pY j=1Pr (xjjCk): In the context of text classi cation, Pr ( xjjCk) has easy interpretation. It is the prob- ability of nding word xjin classCk. Since the denominator is the same for all Ck, it can be neglected, yielding that Pr (Ckjx)/Pr (Ck)pY j=1Pr (xjjCk): (1.16) The classi er then will predict that a given feature vector xbelongs to the class that maximizes Pr ( Ckjx). cation in Action Suppose that a corpus contains the following documents about either breakfast or dessert: easy eggs is over scrumptious yum D10 0 0 0 1 1 0 1 0 0 D21 0 0 1 0 0 0 0 0 0 D30 0 1 0 0 0 1 0 1 0 D40 1 1 0 0 0 0 0 0 11 CCCA: Figure 1.7: The numerical representation of the breakfast/dessert corpus. As in section 1.4.2, the feature extraction can be done on the corpus to obtain a numerical representation, shown in section 1.4.3.2. Let y= [B;B;D;D ], whereBindicates a document is about breakfast, and Dindicates a document is about dessert. Suppose the new document \\Eggs over bacon\" is to be classi ed. The predicted class will be that which maximizes the posterior probability. To de- termine which class does this, Pr ( B), Pr (D), and the prior probabilities will need to be calculated. An easy interpretation for determining Pr ( Ck) is either to: determine proba- bility based on prevalence in the training data, or make each class equiprobable. In either case, the example has Pr ( D) = 0:5 = Pr (B). The likelihood is calculated by examining the relative frequencies of words in a partic- ular class. Thus, Pr (xijCk) =count(xj;Ck) + 1 jVj+P x2Vcount(x;Ck): Here,Vis the vocabulary, or the set of all words unique words in the corpus, count( xj;Ck) is a function that returns how many times xjoccurs in class Ck. Adding 1 in the numerator andjVjin the denominator prevents multiplying by 0 or 0/0 in the case that a word not found in the corpus is found in a new document. This technique is called \\Laplace Smoothing\". 28The document \"Eggs over bacon\" is now ready to be classi ed. The calculations are as follow: ^y=B. 1.4.4 Performance Metrics Suppose that some corpus, C, has been mapped to a numerical representation X, through feature extraction. If each document in Chas been assigned to a class ck, then supervised learning can be performed on Xusing y= [ck1;::: ckn] to guide the learning. Before using a learning algorithm on new data, the algorithm's performance must rst be examined, to ensure that the algorithm is not producing dubious classi cations. 1.4.4.1 Estimating Test Error Rate Through a Test/Train Split No classi er is a perfect classi er, and so a given classi er may produce incorrect classi - cations. A good classi er is one which produces correct classi cations for new data (that is to say, observations not in X). De ne the test error rate as E [I(y06= ^y0)]: Here, I is an indicator function, y0is the true class for observation x0which is not in X, and ^y0is the predicted class obtained from the classi er. Hence, a good classi er is one with small test error rate. 29Measuring the test error rate can be di\u000ecult, because true classi cations for a given observation may not be readily available. The test/train split approach leverages the availability of elements of y, which are true classi cations for observations in X, to estimate the test error rate. The test/train split approach divides the training data into two unequal parts: an r\u0002p matrix [35, 36, 37]. The vector, y, is split accordingly into ytrainandytest. The classi er is trained on Xtrainandytrainand the test error is estimated by using the data in Xtestto produce classi cations ^ytest. Hence, an estimation of cter =1 n\u0000rn\u0000rX k=1I(ytesti6= ^ytesti): classier is misclassifying can give important insight into algorithm selection. For instance, the physician in section 1.4.1 may prefer a classi er which more often incorrectly predicts a patient will have a heart attack over one that more often predicts a patient will not have a heart attack. The occurrence of true/false positives/negatives can be visualized by a confusion matrix . By means of example, suppose the physician has trained a classi er using the test/train split method, and has obtained following predicted classi TN Total 1.8: A typical confusion matrix for binary classi cation. Entries in the matrix indicate the classi er's performance with respect to each class. Totals are calculated by summing along rows and columns. Here,cHhas been coded to represent the occurrence of a heart attack, and cNhas been coded to represent the absence of a heart attack. The chosen classi er has correctly clas- si ed in some instances, and has misclassi ed in other instances.Using the layout found in gure 1.8, a confusion matrix can be constructed for the physician's classi er. From the the confusion matrix in gure 1.9, a number of conclusions can be made: \u000fThe classi er correctly predicts the occurrence of a heart attack twice. This measure is called True Positive (TPin gure 1.8). Similarly, the classi er correctly predicts a heart attack will not occur four times. This measure is called True Negative (TN in gure 1.8) [35, 36]. \u000fMisclassi cations are found on the anti diagonal The classi er predicts the occurrence of a heart attack when none occur three times, and predicts no heart attack will occur, when in reality it does, only once. These measures are called False Negative andFalse Positive (FNandFPin gure 1.8) respectively [35, 36]. \u000fThe accuracy of the classi er is the number of times the classi er correctly classi es. In terms of confusion matrix entries, this is ( TP+TN)=n, wherenis the total number of classi cations made. physician's classi er =10, [35, 36]. 31True Label cHcN Total Predicted LabelcH 2 3 5 cN 1 4 5 Total 3 7 10 Figure 1.9: The physician's confusion matrix for ytestand^ytest. \u000fThe classi er's sensitivity is the proportion of the time the classi er predicts a heart attack will occur when when a heart attack actually does occur. In terms of the confusion matrix, the sensitivity is the ratio of TPand the sum of the rst column. The physician's classi er has a sensitivity of 2 =3 or 66.66%. Thus, when a heart attack will occur, the classi er will correctly classify 2 =3 of the time [35, 36]. \u000fSimilar to sensitivity is speci city . A classi er's speci city is the proportion of time the classi er will correctly classify that a heart attack will not occur when no heart attack occurs. The speci city is the ratio of TNand the sum of the second column. The physician's classi er has a speci city of 4 =7 or approximately 57%. Thus, when no heart attack occurs, the classi er will correctly classify 57% of the time [35, 36]. 321.5 Critical Transitions & Early Warning Signals Changes in external conditions usually result in a smooth response of a state variable. Such responses are gradual and reversible. For instance, stretching an elastic band and then slowly releasing the band results in a deformation and an eventual restoration of the band's original shape. In other cases, small changes in external conditions result in disproportionally strong changes in the state variable. Such responses may still be continuous and reversible. There exist systems where minute changes in the external conditions result in catas- trophic, discontinuous changes in the state variable, that while theoretically reversible, may be extremely di\u000ecult to reverse in practice Such dramatic shifts in a state variable due to changes in external conditions are called critical transitions [39] . Mathematically, critical transitions are bifurcations of a dynamical system to a contrasting alternate stable steady state. Such bifurcations are observed in physiological phenomena [39] ,ecological systems [40], and most importantly to this thesis, in vaccine coverage. Since critical transitions may lead to undesirable system states, predicting these transitions has become an active area of interest in the literature. This section discusses critical transitions and bifurcations in general. I review how and when bifurcations occur and discuss their physical interpre- tation and consequences. I also examine tools for detecting so called early warning signals , evidence of an impending critical transition. 1.5.1 A Brief Review of Local Asymptotic Stability The following proof can be found in many elementary books on dynamical systems. It is a brief review of the conditions for local asymptotic stability. Let x(t)2Cnbe a solution 33to the di erential equation _x=F(x): (1.17) Here, F:Cn!Cnis smooth in x. Suppose that F(x\u0003) =0. Consider now small perturbations \u000f(t)2Cn;k\u000f(t)k 1 from k\u000f(t)k2\u0001 ; _\u000f(t)\u0019DF(x\u0003)\u000f(t): (1.18) Here, DF(x\u0003) is the Jacobian of F. Equation 1.18 determines how the perturbations change over time. Of particular interest are the conditions on DFunder which x\u0003is a locally asymptotically stable equilibrium (i.e the conditions under which k\u000f(t)k! 0 as t!1 ). Note that DF(x\u0003)2Mn\u0002n(C), and so let DF(x\u0003) =A, a constant matrix. Therefore, equation (1.18) is a linear system of di erential equations with constant coe\u000ecients _\u000f(t) =A\u000f(t); =eAt\u000f0 (1.19) Here, \u000f(0) = \u000f0. In the case where Ais diagonalizable, equation (1.19) can be understood in a simpler way. Let T2Mn\u0002n(C) be the matrix consisting of column eigenvectors of 34A. Then, since the eigenvectors of Aare linearly independent, Thas an inverse, and \u0003 =T\u00001ATis a diagonal matrix with eigenvalues of A. It follows that A=T\u0003T\u00001, and so \u000f(t) =e(T\u0003T\u00001)t\u000f0; which by properties of the matrix exponential is equivalent to _\u000f(t) =Te\u0003tT\u00001\u000f0: Left multiply by T\u00001and let z=T\u00001\u000f(t). Then, equation (1.19) is equivalent to see from equation (1.21) that k\u000f(t)kvanishes ast!1 if and only if the real parts of the eigenvalues of Aare less than 0. Thus, x\u0003 is locally asymptotically stable if and only if the real parts of all the eigenvalues of the Jacobian evaluated at x\u0003are less than 0. 1.5.2 Bifurcations of a Dynamical System Di erential equations are used to study a wide variety of physical phenomena from nan- cial markets to theoretical physics. Consequently, understanding dynamic regimes under di erent parameterizations is a crucial part of understanding the phenomena as a whole 35since di erent parameterizations may produce qualitatively di erent orbits in phase space. A dynamical system is said to undergo bifurcation if the system experiences a qualitative change in its behaviour when a parameter crosses some threshold value [41]. Consider the system _x=F(x;\u0012): (1.22) Here,\u00122Ris a parameter of the system. It can be the case that the eigenvalues of DF(x\u0003;\u0012) are functions of \u0012(i.e\u0015j=\u0015j(\u0012)). Suppose that when \u0012<\u0012 0, then all eigenvalues have real part less than 0, and that as \u0012!\u00120the real part of at least one eigenvalue approaches zero from below. If when \u00120< \u0012 the real part of at least one eigenvalue changes sign and becomes positive, then x\u0003will destabilize, and the system will undergo a qualitative change in behaviour. 1.5.3 Critical Slowing Down As the real part of an eigenvalue of DFapproaches zero from below due to variation in a control parameter \u0012, the system experiences a loss in resilience to perturbations from equilibrium. This loss in resilience is experienced by all systems approaching bifurcation [?, 42] and is known as critical slowing down [39, 40, 43]. In the system described by equations (1.12) to (1.14), critical slowing should be observed as w!\u000e\u0000. Indeed, shown in gure 1.10 is a numerical solution to the stochastically forced version of equation (1.14). This numerical experiment con rms that the system experiences critical slowing when equation (1.14) is parameterized close to the bifurcation value. In section 1.5.1, it was shown that near equilibrium zj(t)\u0018e\u0015jt: With this in mind, it is clear to see why systems experience critical slowing down. Assume that the real part all eigenvalues of DFare negative. Since zj(t) behaves approximately 360 10 20 30 40 50 Time0.750.800.850.900.951.00Vaccinators x(t) w= 0 w= 0.9Figure 1.10: Numerical slowing down. Here, \u000e= 5\u000210\u00004,andw is parameterized as indicated. As can be seen, the system parameterized such that wis closer to the bifurcation value returns to equilibrium slower than the system where wis parameterized far from the bifurcation. exponentially, the orbits of zj(t) will return to equilibrium faster if 1 <j<(\u0015j)jas compared to when 0 <j<(\u0015j)j 1. Since near a bifurcation 0 <j<(\u0015j)j 1 for at least one 1\u0014j\u0014n, the system is expected to experience critical slowing down. 1.5.4 Critical Transitions & Early Warning Signals In some systems, a small smooth change in a control parameter will result in a smooth change in the state variable. This will be the case if the state variable is continuous in the control parameter. The bifurcation diagram shown in gure 1.11a demonstrates such a system. A small change in the control parameter will result in a small change in the state variable. Some systems will undergo an abrupt bifurcation to an alternative steady state under 37Control ParameterState Variable(a) Any change in the state variable can be undone by returning the control parameter to it's original value. Control ParameterState Variable A B(b) An example of a critical transition. Smooth variation of the control parame- ter may lead to a discontinuous, irreversible change in the state variable. Such a bifur- cation is an example of a critical transition [39]. Stable equilibria shown in solid black, unstable shown in dashed black. Figure 1.11: Bifurcation diagrams for two di erent systems. The system on the right will undergo a critical transition. Examples taken from [43] a smooth change in the control parameter. These bifurcations can be sudden, violent, and may come without any noticeable change in the state variable. Such bifurcations are called critical transitions [39, 40]. See gure 1.11b for an example of a system which undergoes a critical transition. If the control parameter is close to, but less than, A, then the system remains on the upper stable branch. Smoothly increasing the control parameter for this system will force the state variable o the top branch onto the bottom branch. If the state variable is the health of an ecosystem, such a bifurcation would send the ecosystem into an unfavourable state. Furthermore, the bifurcation would not be reversible, as simply 38changing the value of the control parameter back to its original value would result in the system remaining on the lower branch due to bistability. Hence, to return the system to its original state, the control parameter would have to be moved an area where bistability ceases to exist. Physically, this could di\u000ecult, expensive, time consuming, or impossible given the interpretation of the control parameter. Though the state variable may show no signs of an impending critical transition, there do exist other generic early warning signals of critical transitions [44, 39, 40]. As a con- sequence of critical slowing, an increase in the lag-1 autocorrelation and variance of the stochastically forced dynamical system should be observed [44, 40, 39, 43, 45, 42]. The increases in these statistics appear in all systems approaching a critical transition, and are said to be early warning signals of an impending critical transition [46, 39]. 391.6 Objectives & Direction Thus far, this thesis has discussed: mathematical modelling of infectious diseases (sec- tion 1.1), the e ects of vaccination on disease dynamics (section 1.2), salient factors for vaccinating habits (section 1.3), machine learning practices and metrics (section 1.4), and critical transitions (section 1.5). The remainder of this thesis will examine vaccine scares through the lens of critical transitions theory. It was shown in section 1.3 that the system of di erential equations described by equations (1.12) irreversible bifurcation whenw(t) =\u000e. Bifurcations of this type are called critical transitions. As the the system draws closer to the bifurcation point due to a slow variation in a control parameter, the system becomes less resilient to small perturbations. This results in an increase in the variance and lag-1 autocorrelation in the stochastically forced system. Increases in these statistics are called early warning signals, and may indicate that a critical transition is imminent. By monitoring the early warning signals as equations (1.12) to (1.14) approach a critical transition, the occurrence of a vaccine scare may be predicted well before it happens. Equations (1.12) to (1.14) will be turned into a system of stochastic di erential equations (SDEs) and the early warning signals will be examined as w(t)!\u000e\u0000. December 2014 saw an epidemic of measles after unvaccinated individuals were exposed to an infected individual [47]. This presents an ideal instance to study the early warning signals (if they exist) leading up to, and immediately after, an epidemic. Temporally dense data is required in order to detect early warning signals, and so for this study, traditional vaccine coverage data is not appropriate as it is calculated annually. Research demonstrates that the sentiment on the social media site Twitter is a good proxy for the 40sentiment in the population[48, 49], and that the sentiment on twitter regarding vaccines correlates well with population vaccine coverage [33]. Researchers have investigated how sentiment surrounding the H1N1 vaccine had evolved over time and found that the pro- vaccine sentiment on twitter correlated strongly with CDC vaccine coverage estimates [33]. Tweets are su\u000eciently temporally dense, and so early warning signals may manifest in tweets made about measles and vaccination. Machine learning algorithms will be used to classify each tweet based on the sentiment the tweet displays toward vaccines. An attempt to extract early warning signals from the time series of tweets will be made. Vaccines are vital for infectious disease prevention, but vaccine scares can cause renewed disease outbreaks, or even delay global eradication by years. The ability to anticipate which populations are at highest risk of vaccine scares is therefore valuable. Through the methods presented in the following chapter, it could be possible to identify populations at risk for undergoing a vaccine scare. Public health o\u000ecials may then target their trust building e orts to these populations in hopes of mitigating risk and preventing the scare from occurring The objective of this thesis is to investigate vaccine scares through the lens of critical transitions. Since early warning signals precede a critical transition, detecting early warn- ing signals of vaccine scares could provide a way to predict when the scare is imminent. Readily available data from the Twitter, along with Google search data, will be analysed in hopes of detecting early warning signals in the population. The chapter that follows is the draft of a manuscript being developed for submission to a peer-reviewed journal. This is followed by a discussion chapter. Because the chapter is formatted as a paper, please note that it includes supplementary gures that appear in an appendix instead of the main text of the paper. 41Chapter 2 Early Warning Signals of Vaccine Scares Manuscript, in preparation A. Demetri Pananos1, Thomas Bury1, Brendan Nyhan2, Marcel Salath\u0013 e3, Chris T. Bauch1 1. Department of Applied Mathematics, University of Waterloo. 2. Department of Government, Dartmouth College. 3. School of Life Sciences, \u0013Ecole Polytechnique F\u0013 ed\u0013 erale de Lausanne. 432.1 Introduction By 2003, polio had been eradicated from all parts of the world except for northern Nigeria, where unsubstantiated rumours that the oral polio vaccine contained HIV and caused infertility resulted in a vaccination ban [50]. As a result, polio resurged in Nigeria and sparked epidemics in other countries where polio had been eliminated [50, 51]. Vaccine scares have also occurred for the Measles-Mumps-Rubella (MMR) and whole cell pertussis vaccines, causing a return to endemic transmission [12, 19, 50, 51, 52]. The theory of critical transitions and their associated early warning signals may provide the ability to tell which populations are most susceptible to a widespread vaccine scare. A critical transition occurs when a system shifts abruptly from its current state to a strongly contrasting state. These shifts provide little or no obvious warning signs. However, they may exhibit characteristic early warning signals as a consequence of critical slowing down; as the system approaches the critical transition, the dominant eigenvalue becomes smaller, causing the system to lose its ability to recover from disturbances [39, 53, 40, 54]. This loss in resiliency is detectable and manifests as an increase in measures such as the lag-1 autocorrelation and variance of the time series of the state variables [40, 54, 39]. In order to detect these early warning signals, high resolution data is required. Like the recent polio outbreaks, the 2014-15 Disneyland, California measles outbreak was driven largely by vaccine refusal, often originating in the unfounded perception that the MMR vaccine causes autism and irritable bowel syndrome [12, 19]. It attracted signi cant national attention in both mainstream media and online social media, causing an enormous spike in both United States geocoded tweets for \\MMR\" for \\measles\"( gure 2.1B). This data provides an opportunity to look for early warning signals in high resolution time series concerning vaccine refusal. 452012 2013 2014 2015 Date0200400600800TweetsA 2012 2013 2014 2015 Date020406080100120Google searchesB MMR Measles 2010 2011 2012 2013 2014 2015 2016 Date020406080100Cases of measlesC 2010 2011 2012 2013 2014 2015 2016 Date92.593.093.594.094.5Mmr coverageD Figure 2.1: A: Time series of tweets mentioning \\measles\" or \\MMR\". The spike in early 2015 is in reaction to the news of the Disneyland outbreak. B: Time series of google searches for \\measles\" and \\MMR\". C: Cases of Measles in California. It is estimated that the Disneyland outbreak occurred sometime in December 2014, and so many cases are classi ed as having happed in 2015. D: Pictured is kindergarten vaccine coverage for the MMR vaccine over time. A clear decrease in vaccine coverage in the years leading up to the outbreak is observed. As the CDC releases a public health advisory notice in early February 2016, a resurgence of vaccinators can be observed. The Disneyland outbreak was preceded by signi cant outbreaks in previous years ( g- ure 2.1C). In fact, the number of US measles cases in 2013 dwarfed the number in the Disneyland outbreak, but the 2013 outbreak was localized in Amish populations and there- fore went relatively unnoticed by online social or mainstream media. The MMR vaccine coverage in California kindergartens declined from 93.6% in 2010 to 92.3% statewide in 2013-14, and even lower in certain populations [55]. Following the Disneyland outbreak, the MMR vaccine coverage in California kindergartens rebounded to 94.5% by 2015 [55] 46( gure 2.1D) dynamics [15]. 472.2 Methods 2.2.1 Model We build on a model of coupled behaviour-disease dynamics [15]. The model posits that members of the population play one of two strategies (vaccinator or non-vaccinator), and that members sample one another at some constant rate. If two individuals playing dif- ferent strategies sample one another, the individual with lower expected payo will switch strategies with probability proportional to the di erence in payo s. The payo to vaccinate is given by ev=\u0000rv+\u000e0x: (2.1) Here,\u0000rvis the perceived risk associated with vaccinating, xis proportion of the population playing the vaccinate strategy, and \u000e0is the e ect of injunctive social norms. The payo not to vaccinate is en=\u0000cI(t) +\u000e0(1\u0000x): (2.2) Here,cis the multiplicative product of the cost of infection, reporting probability, and a proportionality constant governing the perceived probability of becoming infected. The proportion of the population infected with the disease is given by I(t). The di erential equation governing the density of vaccinators is then dx dt=kx(1\u0000x)(\u0000w+I(t) +\u000e(2x\u00001)) (2.3) Here,kis a rescaled social learning rate, \u000eis a rescaled e ect of injunctive social norms, and w=w(t) is a rescaled measure of how risky the vaccine is compared with infection. The following mathematical model of coupled behaviour-disease dynamics describes a popula- tion where measles transmission occurs due to contact between susceptible and infectious 48individuals, and where individuals talk to other individuals and change their vaccine sen- timent according to a perceived health gain that depends on perceived vaccine risk, the perceived risk of infection and infection complications, and injunctive social norms in the population: dS dt=\u0016(1\u0000x)\u0000\u0016S\u0000 SI (2.4) dI dy= SI\u0000(\u0016+ )I (2.5) dx dt=kx(1\u0000x)(\u0000w+I+\u000e(2x\u00001)) (2.6) Here,Sis the proportion of susceptible individuals, Iis the proportion of infectious individuals, xis the proportion of individuals who vaccinate their children, \u0016is the per capita birth and death rate, is the transmission rate, is the rate of recovery from infection. Note that the proportion of recovered individuals, R, is determined when Sand Iare known since R= 1\u0000S\u0000I, and thus need not appear in the model equations. The system is studied as it approaches a bifurcation point from high vaccine coverage to low vaccine coverage which happens when w(t) =\u000e. To study the dynamics leading to the bifurcation, w(t) is written as a piecewise monotonic function, increasing linearly from a baseline value until the bifurcation value is reached. To study the e ects of critical slowing down, the system developed by Oraby et al. was converted into a stochastic di erential equation with additive noise dy=F(t;y;w;\u000e )dt+\u001bdW: (2.7) Here,dWis a Wiener process, and \u001b2R3is a vector housing the taken from a previous investigation of the coupled behaviour- disease model [15], with \u0016= 0:02 per year, = 365=13 per year,R0= 16, and = R0(\u0016+ ) per year. The sampling rate was calibrated to k= 500 per year, similar to that found in the previous investigation[15], so as to obtain a rate of time evolution of vaccine uptake similar to that observed in the Disneyland, California outbreak ( gure 2.1). The e ect of social norms, \u000e, was set to 5\u000210\u00004. This value of the strength of the injunctive norms was selected so as to investigate the worst case scenario; the critical transition would drop from full vaccine coverage to no vaccine coverage. Under this parameterization, the endemic branch is unstable, and so the system will bifurcate from a state of full vaccine coverage to no vaccine coverage. 2.2.3 Simulations Equation (2.7) was simulated in Matlab 2015b using the SDETools Library by Andrew Horchler[56]. The SDE was solved using the sde_euler() function, which implements the Euler-Maruyama Method for numerically solving stochastic di erential equations[57]. Stochastic noise may force the solutions out of physical phase space, and so to ensure numerical solutions remained in physical space (i.e in [0 ;1]), an additional line of code was inserted in line 486. The inserted code read % Force solution to be <=1 if NonNegative Yi = min(Yi,1); end Random seeds were controlled using the RandSeed option for the solver to ensure repro- ducibility. The simulation in gure 2.3B was run for 30 years with a step size of 5 \u000210\u00004. 500 5 10 15 20 25 30 t0.00000.00020.00040.00060.00080.0010w(t)(a) Visualization of the evolution of the rela- tive risk in equation (2.8). The grey dashed line indicates where the relative risk reaches the critical transition. 0 20 40 60 80 100 t0.00000.00010.00020.00030.00040.0005w(t)(b) Visualization of the evolution of the rela- tive risk in equation (2.9). The grey dashed line indicates where the relative risk reaches the critical transition. Figure 2.2: Evolution of the relative risk for gures gure 2.3B and gure 2.3D The relative risk took a functional form of w(t) =\u000eH(t\u000010)\u0012t 10\u00001\u0013 (2.8) Here, H is the Heaviside function, as implemented by Matlab 2015b. Under this functional form, the bifurcation value is reached when t= 20 (i.ew(20) =\u000e). The simulation for gure 2.3D was run for 100 years. The relative risk in gure 2.3D took a functional form of sow(t)\u0014\u000efor all time. Additive noise was used in the model to account for case importations. Noise was applied directly to each compartment, with \u001b= [10\u00002;10\u00006;10\u00002]. 51In each simulation, the initial conditions were S(0) = 0:016,I(0) = 0, and x(0) = 0:9903. To obtain these initial conditions, the system was simulated for 100 years with w(t) = 0 from a random physically real initial condition. This was done so as to obtain a state of the system without any transient dynamics. The state of the system at t= 100 was used to as the initial conditions for further simulations. Detection of Early Warning Signals The Kendall tau rank correlation coe\u000ecient[58] is used to measure the increase in the lag- 1 autocorrelation and variance as the critical transition is approached. A pair of points (xi;yi) and (xj;yj) are said to be concordant if xj< xiandyj< yiand are said to be discordant if xj<xiandyi<yj. Ifxj=xioryj=yithen the pair is neither discordant or concordant. The Kendall tau rank correlation coe\u000ecient for npoints is then = 2Number of Concordant Pairs \u0000Number of Discordant Pairs n(n\u00001): The Kendall tau calculation was performed using Python's scipy.statistics.kendalltau function[59, 60]. as a discrete array, the autocorrelation lag kcan be written series were generated so that an epidemic occurred in the support of w(t). For the detection of the early warning signals, the earlywarnings R library [62] was utilized. The function qda_ews() was used to detect increases in variance and autocorrelation. used the stochastic time series. Here, Kis a Gaussian function, and his the bandwidth for the Gaussian function K. The bandwidth was selected using Silverman's rule of thumb [63], which asserts that the bandwidth should be chosen as h= 0:9N\u00000:2minf^\u001b;IQR=1:34g so as to minimize the mean integrated square error. Python was used to calculate the rolling statistics. Residuals were converted to pandas.Series objects, which have a rolling routine, allowing for various functions to be computed for a speci ed rolling window. Lag- 1 autocorrelation calculated using Res.rolling(window_length).apply( lambda x: pd.Series(x).autocorr(1) ) while variance was using Res.rolling(window_length).apply(lambda x: pd.Series(x).std() ) See [64] for further information on the pandas library. The rolling statistics for gure 2.3C were calculated using a window width of 10 years, while the rolling statistics in gure 2.3E were calculated using a window width of 20 years. 53Since it is not clear when (if at all) the relative risk is equal to the strength of the injunctive norms in the population, pre and post maximum risk sections are determined by splitting the rolling statistic at its maximum value. Hence, to calculate the pre or post Kendall tau coe\u000ecient, the rolling statistic curve was split into two halves at the point where it attains its maximum value, and the Kendall tau coe\u000ecient was computed accordingly for each half. 2.2.4 Machine Learning The Twitter API [65] was used to collect tweets which mentioned keywords related to measles and vaccination. A total of 29,727 tweets from March 2nd, 2011 to May 3rd, 2016 were collected. Tweets were collected if they contained speci c key words or key phrases related to measles and if their location was within the continental United States. Keywords/phrases included: ((vaccine* OR immuni*) AND (ingredient* disease* OR exemption* OR safe* OR unsafe OR killing* OR conspiracy OR scandal* OR whistleblower* OR pharmaceutical OR CDC OR documentary OR truth* OR theory OR health OR infant* OR baby OR babies OR newborn* OR school* OR aluminum OR death* OR dead OR children OR kid* OR child* OR poison* OR toxic OR mercury OR injur* OR harm* OR brain OR paraly* OR scare* OR fear* OR autism OR IBS OR autistic or \"irritable bowel syndrome\")) OR measles OR mmr OR \"andrew wake eld\" Hence, if the above logical was returned as True, the tweet was collected into the database. The machine learning was done using Python's sci-kit learn library [37]. Classi - cation was performed using a supervised learning algorithm, and so a training set of 3667 54(roughly split equally among the negative sentiment, positive sentiment, and no sentiment classes) was created. A tweet was classi ed as \\anti-vaccine\" if it clearly demonstrated an anti-vaccine sentiment or underestimated the risk associated with infection. Tweets like \\Have measles? Eat an orange 3 times a day\" and \\Diarrhoea kills more people than HIV/AIDS, TB and put were classi A tweet was classi ed as \\pro-vaccine\" if it clearly demonstrated a pro-vaccine sentiment, warned of the dangers of not vaccinating, or warned of the dangers of the disease. Tweets like \\That is terrifying: Measles infects 90% of come into contact with it\" and \\oh no..not ever. BS. I bet you wouldn't willingly let your child hang out with a measles patient? \" were classi ed as pro-vaccine. A tweet was classi ed \\neutral\" if it was factual or did not display a sentiment. Tweets like \\Nationalism is an infantile disease. It is the measles of mankind\" and \\I feel the measles, it came on strong lmao okay calm down\" were classi ed as neutral. A support vector classi er with linear kernel, which aims to construct a maximum- margin hyperplane between training examples of di erent classes [66, 67], was trained on the tweets. A support vector classi er was chosen because it is e ective in high dimensional problems, and is robust to over tting [37]. To estimate prediction accuracy, 3-fold cross validation [36] was used. To improve prediction accuracy, a grid search cross validation [36] was performed to ensure the classi er's hyperparameters were appropriately chosen. Cross validation shows that the classi er predicts classes with 77% accuracy. 2.2.5 Sensitivity Analysis To ensure results were robust, sensitivity analysis was performed on the coupled behaviour- disease model. For each risk evolution curve (linear and triangular), the system was sim- ulated 500 times with a di erent gures A.2, A.3, A.12 and A.13, 55epidemiological parameters, as well as the sampling rate k, were drawn from a triangular distribution ranging from half the baseline value to three halves times the baseline value. The onset of the risk evolution curve was also sampled from a triangular distribution. For the linear case, the onset was drawn from a triangular distribution ranging from 8 to 12 years. Likewise, the onset of the triangular curve was drawn from a triangular distribution ranging from 20 to 40 years. The triangular curve remained symmetric about the t= 50 line, attaining a value of \u000ewhent= 50. Each of the 500 realizations was smoothed using R's ksmooth , which implements Nadaraya Watson kernel regression with a Gaussian kernel [68]. The bandwidth was chosen using R's implementation of the Silverman rule of thumb [63], nrd0 . When estimating uni- variate data with a Gaussian kernel, Silverman's rule of thumb will produce a bandwidth that minimizes the mean integrated squared error. Residuals were obtained by taking the di erence of the simulated data and the kernel regression. The rolling statistics were com- puted on the residuals. In the linear case, a rolling window size of 10 years was used, while a rolling window of length 20 years was used in the triangular case. The element-wise mean was computed for each statistic, and a 95% con dence interval was constructed. To test the robustness of results over varying window length, 9 di erent window lengths were chosen with which to compute the rolling statistics. In the linear case, 9 evenly spaced window lengths were chosen ranging from 2 years to 10 years. In the triangular case, 9 evenly spaced window lengths were chosen ranging from 2 years to 20 years. The rolling statistics were computed for each of the 500 simulations, and the element-wise mean was plotted along with a 95% con dence interval. 562.3 Results In its deterministic version with \u001b= 0 and xed vaccine risk w(t) =m, the model described by equations (2.4) to (2.6) has multiple stable equilibria (see section 1.3.2). Of particular interest is the stable equilibrium ( S;I;x ) = (0;0;1) corresponding to a disease-free state of full vaccine coverage. This is stable so long as the strength of the social norms, \u000e, exceeds the perceived vaccine risk w(t). But, ifw(t) exceeds\u000edue to rising perceived vaccine risk, a transcritical bifurcation occurs: the state of full vaccine coverage loses stability and the system shifts to a state of endemic infection and zero vaccine coverage ( gure 2.3A). At other parameter values, a drop to endemic infection and intermediate vaccine coverage is also possible ( gure A.1). Notably, once the system has passed the w=\u000ebifurcation, a decrease in the perceived riskwto pre-transition levels is not su\u000ecient to move the system back to a state of full vaccine coverage; this would require that the relative risk be decreased su\u000eciently so that the full vaccine coverage becomes the only stable equilibrium. This may not be feasible, so the population may remain at a suboptimal vaccine coverage for years. Avoiding such a catastrophic transition is clearly desirable. Unlike the deterministic version of the model with \u001b= 0, real populations are subject to random perturbations (stochasticity). When \u001b >0, and the risk perception parameter w(t) is gradually increased over time, the system again exceeds the transcritical bifurcation and collapses to zero vaccine coverage ( gure 2.3B). But before this happens, the system exhibits critical slowing down as the transition is approached: The lag-1 autocorrelation and gure A.3). The pattern occurs broad range of parameter values ( gure A.2) and other window widths ( gure A.4). Applying descriptive statistics to predict future trends in vaccine coverage would work 570.0 0.2 0.4 0.6 0.8 1.0 1.2 1.4 w/0.00.20.40.60.81.0Vaccinators x(t) A 0 5 10 15 20 25 30 Time (Years)0.850.900.951.00Vaccinators x(t) B 0 5 10 15 20 25 30 Time (Years)0.840.860.880.900.92Lag-1 ACC = 0.640 20 40 60 80 100 Time (Years)0.900.920.940.960.981.00Vaccinators x(t) D 0 20 40 60 80 100 Time (Years)0.800.850.900.951.00Lag-1 acE pre = 0.64 post = -0.730123 Infection 0.00.51.01.5 Infection Figure 10\u00005. Stable equilibira in solid black, unstable equilibria in dashed grey. Under this parameterization, no partial vaccine coverage is possible. B: Simulation of the coupled- behaviour disease model. Relative risk wevolves linearly from t= 10. Indicated in the grey dashed line is the point where the critical transition occurs. Post critical transition, vaccine coverage drops steeply. C: Lag-1 autocorrelation leading up to the critical transition, indicated by the grey dashed line. The length of the rolling window used to calculate the statistic is represented by the black arrow. The Kendall rank correlation coe\u000ecient measures the increase in the lag-1 autocorrelation. D: Simulation of the coupled behaviour- disease model. Risk evolves linearly from t= 20 tot= 50 at which point w(50) =\u000e, then decreases linearly to 0. As relative risk increases, vaccine coverage drops allowing for epidemics to occur. As relative risk decreases, vaccine coverage recovers. E: Lag-1 autocorrelation for panel D. The length of the rolling window is indicated by the black arrow. Lag-1 autocorrelation increases and decreases due to change in the modulus of the dominant eigenvalue. Pre Kendall coe\u000ecient measures the increase in the autocorrelation before the critical transition is reached, and the post Kendall coe\u000ecient measures the decrease once the relative risk rebounds from the critical transition. A positive and negative pre and post Kendall con rms that the parameter responsible for the critical transition increases towards the threshold and then decreases away from the threshold. 582012 2013 2014 2015 2016 Date0.00.20.40.60.81.0 Lag-1 AC (Anti)A pre =0.47 post =-0.67 2012 2016 Date0.00.20.40.60.81.0 Lag-1 AC (Pro)B pre =0.67 post =-0.74 2012 class (anti-vaccine senti- ment in A, pro-vaccine sentiment in B, and all tweets in C) from mid 2011 to mid 2016. The length of the rolling window is given by the black arrow. well away from the critical transition, but would fail close to it: Extrapolating future vaccine coverage based on linear regression to recent vaccine coverage at w=\u000e = 1 would fail to detect the vaccine scare ( gure 2.3B). Thexvariable in equation equation (2.6) corresponds to the proportion of the popula- tion with pro-vaccine sentiment. Sentiment expressed in tweets is known to be indicative of the sentiment in the general population [49], and machine learning algorithms have been successfully used to evaluate sentiment content for in uenza vaccines [33] . Using machine learning algorithms (see Methods), the sentiment of all US geo-coded tweets from March 2nd, 2011 to May 3rd, 2016 were classi ed as either pro-vaccine, anti-vaccine, or neutral ( gure The sentiment classi ed tweets show a similar spike due to the Disneyland outbreak. To help adjust for non stationarity, the time series was smoothed using Nadaraya Wat- son Kernel Regression with Gaussian kernel. The rolling lag-1 autocorrelation and variance 59were performed on the residuals (i.e the di erence between the time series and the ker- nel regression). The lag-1 autocorrelation of sentiment-classi ed tweets was computed over this time period (see Methods). The lag-1 autocorrelation of the residual increases steadily in the years preceding the Disneyland outbreak as vaccine coverage steadily decreased, for negative tweets ( tably, this increase begins even before the rolling window reaches the large spike in tweets corresponding to reaction on social media to news of the Disneyland outbreak. Hence, the analysis reveals a long-term trend toward increasingly autocorrelated sentiment through- out this time period that is not driven solely by the Disneyland spike. This is robust to rolling window width and also appears when computing variance ( gures A.6 to A.11). Uncoupled systems are simply conceived of as exceeding the critical transition when a parameter is changed su\u000eciently. However, the Disneyland outbreak resulted in signi cant media coverage and concern about infections among parents, thereby boosting the vaccine coverage to levels not seen since before 2002. Thus suggests coupled human-and-natural dynamics. As a result, the population appears to pull back from the brink of a critical transition. We observe that the lag-1 autocorrelation rst plateaus immediately after the outbreak (as the rolling window moves past the peak), and then declines in the months after the outbreak. We call this e ect \\critical rebound\", and it occurs lag-1 autocorrelation after the outbreak is statistically signi cant for a broad range of other rolling window widths, as well as for tweets with negative sentiment, positive sentiment, and all tweets ( gures A.6 to A.8). The plateau and decline in the lag-1 autocorrelation is also observed in the mathematical model when perceived vaccine risk , w, increase to \u000e and then falls back down to baseline values ( gure 2.3E), and this too is robust to gure A.14) and other parameterizations ( gure A.12). The observed in the variance ( gure A.13). We note that such a decline and fall is not observed in regular pre and post outbreak dynamics away from the critical point, suggesting that the dynamics observed in Disneyland are not explicable in terms of ordinary transient dynamics near a xed point away from the bifurcation ( gure A.16). The pattern is repeated for Google search data at the state and national levels over the same time period ( gure 2.5), and the results are also robust to window widths ( gures A.17 to A.24). However, the trend is not as strong for measles searches. There seem to be spurious modes in the lag-1 autocorrelation even at larger window lengths. The possibility of critical rebound in coupled systems suggests that the understanding of critical transitions and their inevitability a coupled human-and-natural systems should be reframed. A full endogenization of the risk perception parameter in future work would clarify why some populations respond to an outbreak by boosting vaccine coverage to prevent endemic transmission while others, such as Japan and the United Kingdom, went past the critical transition into endemic transmission and widespread vaccine refusal before starting to recover [69]. The mathematical model in equations equations (2.4) to (2.6) is relatively simple and does not capture relevant features of vaccinating behaviour. However, detecting early warning signals only relies on the dominant eigenvalue approaching zero from below, which occurs in a broad range of dynamical systems. Hence, we expect more sophisticated models to show similar results (although exceptions do occur). Additionally, early warning signals cannot predict a particular critical transition in a speci c system with complete accuracy due to stochasticity, making accurate prediction of an upcoming climate shift, for instance, di\u000ecult. However, for vaccine scares, many replicates in the form of statistics from very many countries are accessible. National and international health authorities could use these methods to rank populations based on their lag-1 autocorrelation to determine which ACB 2011 2013 2014 2015 Date0.00.20.40.60.81.0Lag-1 ACC pre =0.16 post =0.01 2011 2012 2013 =0.54 =-0.88Figure Searches of \\MMR\" and \\measles\" at the state and national level. Length of the rolling window given by the black arrow. A: National searches for \\measles\". B: National Searches for \\MMR\". C: State searches for \\measles\". D: State searches for \\MMR\". countries are most susceptible to an episode of widespread vaccine refusal, and thus in most need of targeted e orts to build trust and disseminate accurate information about vaccines. This may help prevent some vaccine scares and accelerate the global eradication of some vaccine preventable infections. 62Chapter 3 Conclusions & Future Work 633.1 Conclusions When the perceived risk of a vaccine becomes su\u000eciently high, a vaccine scare may occur which may push vaccine coverage levels below those required to achieve herd immunity. Detecting when a vaccine scare is imminent is therefore valuable. Examining vaccine scares as critical transitions of a coupled behaviour-disease model allows for detection of early warning signals of an impending vaccine scare. As the critical transition is approached, the system experiences critical slowing down. This results in a detectable increase in the variance and lag-1 autocorrelation of the stochastically forced time series. The 2014 Disneyland measles outbreak presents an opportunity to study these early warning signals through social media. In the years leading up to the Disneyland outbreak, increases in both the lag-1 autocorrelation and variance are detectable in tweets related to measles as well as Google searches for \\measles\" and \\MMR\". These methods present public health o\u000ecials with tools for monitoring, and possibly intervening in, vaccine scares. 3.2 Limitations The coupled behaviour-disease model is a simplistic model, and does not capture all of the complex interactions that exist in the population. The model assumes homogeneous mixing between members of the population, which is not realistic for populations of this nature. Furthermore, the process by which members of the population make their vaccinating decisions is extremely simpli ed and does not capture all factors that one may consider. The size of the Disneyland outbreak is far smaller than what the model predicts, and so other methods (such as network models) may be more appropriate. It is important to note 64that critical transitions are quite common, and thusly, early warning signals are relatively generic [70]. There are important exceptions, but these relate more to model mechanisms, and so a more complex model is expected to display early warning signals. The largest area for improvement is in the machine learning. Since tweets are so small relative to other text corpora (140 characters vs. what could potentially be tens of thousands of characters), the syntactical relationships amongst words becomes increasingly important. Phrases like \\ Are vaccines bad? \" and \\ Vaccines are bad. \" clearly display di erent sentiments but use the same words. Since the bag of words model examines only the words used in the sentence, and ignores their order, each of these two phrases are mapped to the same feature vector. This means the classi er will assign both sentences to the same class, leading to an erroneous classi cation. Attempts to pre-process the data (such as removing common words like \\ is\", \\or\", \\and\" etc.) may make classi cation even more di\u000ecult, as tweets like \\ Vaccines are not bad! \" may be truncated to \\ Vaccines bad \" after pre processing. The sentiment is completely lost from this tweet, making classi cation prone to error, especially if the remaining words are used commonly between two or more classes. More advanced techniques that incorporate syntactical relationships are needed. Since early warning signals are detectable in all tweets relating to measles and vaccines, is not expected that a change in classi cation accuracy will drastically change the results of the analysis, so long as the classi cation is not purposefully erroneous. The time evolution of the relative risk wpresented in the results is ad hoc and represents one possible scenario. In reality, the time evolution may not be symmetric, or may be discontinuous and highly non-linear. 653.3 Future Work More advanced text analytics and machine learning algorithms will allow for the syntactical relationships of words to be learned, hence leading to better classi cation accuracy. More sophisticated algorithms have been examined but not yet implemented [71, 72]. One such model that shows promise is Word2Vec [71], which maps words used in the text corpus to a low dimensional vector space. Once mapped, computation is able to be done on the elements in the vector space. This allows for practitioners to ask questions like \\Man is to Woman as King is to \" to which the algorithm will correctly respond with \\Queen\". This demonstrates a much more in depth \\learning\" of the language used in the corpora, and may lead to better classi cation. The endoginization of the relative risk wwould present a step forward. The relative risk is itself dynamic in time and depends many complex interactions such as, but not limited to: The time since the last outbreak, the current disease prevalence, trust in authority, etc. Thus, a di erential equation for wmust be developed and incorporated into the coupled behaviour-model. A theory of what should be observed in social media may also be bene cial. From the analysis, it seems that activity spikes when an outbreak occurs but else is relatively dormant. If a di erential equation for the activity in social media could be developed, investigators may have a better idea of what kinds of trends should be observed in times leading to a vaccine scare. Investigations into slow-fast time scale dynamics may prove fruitful in theoretical applications, as the change in the relative risk wmay increase over years while the outbreak happens on a much faster timescale. Network models would be a bene cial extension. It may be the case that the population is not homogeneously mixed (as is assumed by ODE models), and that those whom share similar views group together. This may cause an echo chamber e ect, whereby anti- 66vaccinator's and pro-vaccinator's beliefs are reinforced not through injunctive norms but for fear of being rejected from their existing social group. Data from social media would be extremely useful in modelling vaccinating dynamics in this fashion. Examining who follows whom is essentially an examination of a social network whereby individuals are nodes and their follows are edges. On top of the social network is a physical network, which represents which individuals come in su\u000ecient contact with one another to transmit a disease. This suggests that a multilayer network model may be fruitful. 67References [1] William O Kermack and Anderson G McKendrick. A contribution to the mathematical theory of epidemics. In Proceedings of the Royal Society of London A: mathematical, physical and engineering sciences , volume 115, pages 700{721. The Royal Society, 1927. [2] Linda JS Allen, Fred Brauer, Pauline Van den Driessche, and Jianhong Wu. Mathe- matical Epidemiology . Springer, 2008. [3] Nicholas Britton. Essential Mathematical Biology . Springer Science & Business Media, 2012. [4] Robert M Corless et al. On the lambertw function. Advances in Computational mathematics , 5(1):329{359, 2016-05-17. [6] Ray M Merrill. Introduction to epidemiology . Jones & Bartlett Publishers, 2015. [7] Chris T Bauch and David JD Earn. Vaccination and the theory of games. Proceedings of the National Academy of Sciences of the United States of America , 101(36):13391{ 13394, 2004. 69[8] Simon Murch. Separating in ammation speculation in autism. The Lancet , 362(9394):1498{1499, 2003. [9] Peter McIntyre and Julie Leask. Improving uptake of mmr vaccine. British Medical Journal , 7647:729, 2008. [10] Daniel A Salmon et al. Vaccine hesitancy: Causes, consequences, and a call to action. Vaccine , 33:D66{D71, 2015. [11] Heidi J Larson et al. Understanding vaccine hesitancy around vaccines and vaccination from a global perspective: a systematic review of published literature, 2007{2012. Vaccine , 32(19):2150{2159, 2014. [12] Saad B Omer et al. Vaccine refusal, mandatory immunization, and the risks of vaccine- preventable diseases. New England Journal of Medicine , 360(19):1981{1988, 2009. [13] Daniel A Salmon et al. Factors associated with refusal of childhood vaccines among parents of school-aged children: a case-control study. Archives of pediatrics & adoles- cent medicine , 159(5):470{476, 2005. [14] Chris T Bauch. Imitation dynamics predict vaccinating behaviour. Proceedings of the Royal Society of London B: Biological Sciences , 272(1573):1669{1675, 2005. [15] Tamer Oraby et al. The in uence of social norms on the dynamics of vaccinating behaviour for paediatric infectious diseases. Proceedings of the Royal Society of London B: Biological Sciences , 281(1780):20133172, 2014. [16] Robert M Wolfe and Lisa K Sharp. Anti-vaccinationists past and present. BMJ: British Medical Journal , 325(7361):430, 2002. 70[17] Je rey P Baker. The pertussis vaccine controversy in Great Britain, 1974{1986. Vac- cine, 21(25):4003{4010, 2003. [18] Anjali Jain et al. Autism occurrence by mmr vaccine status among US children with older siblings with and without autism. JAMA , 313(15):1534{1540, 2015. [19] of measles, mumps, and rubella vaccination and autism. New England Journal of Medicine , 347(19):1477{1482, 2002. [20] C Paddy Farrington et al. Mmr and autism: further evidence against a associ- ation. Vaccine , 19(27):3632{3635, 2001. [21] M Haverkate et al. Mandatory and recommended vaccination in the EU, Iceland and Norway: results of the VENICE 2010 survey on the ways of implementing national vaccination programmes. 2012. [22] World Health Organization. Vaccine coverage time series. http://www.who.int/ immunization/monitoring_surveillance/data/en/ . Accessed: 2016-05-10. [23] Philip J Smith, Sharon Humiston, Edgar K Marcuse, Zhen Zhao, Christina G Dorell, Cynthia Howes, and Beth Hibbs. Parental delay or refusal of vaccine doses, childhood vaccination coverage at 24 months of age, and the health belief model. Public health reports , pages 135{146, 2011. [24] Lyndal Bond and Terry Nolan. Making sense of perceptions of risk of diseases and vaccinations: a qualitative study combining models of health beliefs, decision-making and risk perception. BMC Public Health , 11(1):1, 2011. 71[25] Emily K Brunson. How parents make about their children's vaccinations. Vaccine , 31(46):5466{5470, 2013. [26] Julie Leask et al. What maintains parental support for vaccination when challenged by anti-vaccination messages? a qualitative study. Vaccine , 24(49):7238{7245, 2006. [27] Dirk Helbing. A mathematical model for behavioral changes by pair interactions and its relation to game theory. Angewandte Weibull, et al. Nash equilibrium and evolution by imitation. Technical report, 1994. [29] Josef Hofbauer and Karl Sigmund. Evolutionary games and population dynamics . Cambridge University Press, 1998. [30] Ron Kohavi and Foster Provost. Glossary of terms. Machine Learning , 30(2-3):271{ 274, 1998. [31] Adi L Tarca, Vincent J Carey, Xue-wen Chen, Roberto Romero, and Sorin Dr\u0015 aghici. Machine learning its Biol , 3(6):e116, 2007. [32] Li-Juan Cao and Francis EH Tay. Support vector machine with adaptive parameters in nancial time series forecasting. Neural Networks, IEEE Transactions on Salath\u0013 e and Shashank Khandelwal. Assessing vaccination sentiments with online social media: implications for infectious disease dynamics and control. PLoS Comput Biol , 7(10):e1002199, 2011. [34] Geng Cui et al. Machine learning for direct marketing response models: Bayesian networks with evolutionary programming. Management Science , 52(4):597{612, 2006. 72[35] Jerome Friedman, Trevor Hastie, and Robert Tibshirani. The Elements of Statistical Learning , volume 1. Springer series in statistics Springer, Berlin, 2001. [36] Gareth James, Daniela Witten, Trevor Hastie, and Robert Tibshirani. An Introduction to Statistical Learning , volume 112. Springer, 2013. [37] F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel, B. Thirion, O. Grisel, M. Blon- del, P. Prettenhofer, R. Weiss, Dubourg, Vanderplas, A. Passos, M. Brucher, M. Perrot, and E. Duchesnay. Scikit-learn: Machine learning in Python. Journal of Machine Learning Research , 12:2825{2830, 2011. [38] Zellig S 1954. [39] Marten Sche er et al. Early-warning signals for critical transitions. Nature , 461(7260):53{59, 2009. [40] V. Dakos et al. Slowing down as an early warning signal for abrupt climate change. Proceedings of the National Academy of Sciences , 105(38):14308{14312, 2008. [41] Yuri A Kuznetsov. Elements of Applied Bifurcation Theory , volume 112. Springer Science & Business Media, 2013. [42] C Wissel. A universal law of the characteristic return time near thresholds. Oecologia , al. Methods for detecting early warnings of critical transitions in time series illustrated using simulated ecological data. PloS one , 7(7):e41010, 2012. 73[45] Anthony R Ecological Monographs , 65(2):217{233, 1995. [46] Marten Sche er. Critical transitions in nature and society . Princeton University Press, 2009. [47] Measles html O'Connor et al. From tweets to polls: Linking text sentiment to public opinion time series. ICWSM , 11(122-129):1{2, 2010. [49] Saad M Darwish et al. From public polls to tweets: Developing an algorithm for classifying sentiment from twitter based on computing with words. [50] Ayodele Samuel Jegede. What led to the Nigerian boycott of the polio vaccination campaign? PLoS Med , 4(3):e73, 2007. [51] Mary Jane Friedrich. WHO declares polio an international health emergency. JAMA , 311(23):2372{2372, 2014. [52] Felix Greaves and Liam Donaldson. Measles in the uk: a test of public health com- petency in a crisis. BMJ , 346:f2793, 2013. [53] Marten Sche er et in ecosystems. Nature , 413(6856):591{596, 2001. [54] Marten Sche er et al. Anticipating critical transitions. science , 338(6105):344{348, 2012. 74[55] California strong numerical schemes for stochastic di erential equations. Journal of statistical physics , 66(1-2):283{314, 1992. [58] Maurice G Kendall. A new measure of rank correlation. Biometrika , 30(1/2):81{93, 1938. [59] Eric Jones, Travis Oliphant, Pearu Peterson, et al. SciPy: Open source scienti c tools for Python, 2001{. [Online; accessed 2016-08-21]. [60] William R Knight. A computer method for calculating kendall's tau with ungrouped data. Journal of the American Statistical Association , 61(314):436{439, 1966. [61] Patrick F Dunn. Measurement and Data Analysis for Engineering and Science . CRC press, 2014. [62] . Accessed: 2016-08-12. [63] Bernard W Silverman. Density Estimation for Statistics and Data Analysis , vol- ume 26. CRC press, 1986. 75[64] Wes McKinney. Data structures for statistical computing in python. In St\u0013 efan van der Walt and Jarrod Millman, editors, Proceedings of the 9th Python in Science Confer- ence, pages 51 { Chih-Jen al. A practical guide to support vector classi cation. 2003. [67] Bernhard E Boser, Isabelle M N Vapnik. A training algorithm for optimal margin classi ers. In Proceedings of the Fifth Annual Workshop on Com- putational Learning Theory , pages 144{152. ACM, 1992. [68] Elizbar A Nadaraya. On Applica- , 9(1):141{142, in Japan? The Lancet , 364(9431):328{329, 2004. [70] et al. Boettiger. Early warning signals: charted and uncharted territories. Theo- retical Ecology , 6(3):255{264, 2013. [71] Tomas Mikolov et al. E\u000ecient estimation word representations in vector space. arXiv preprint arXiv:1301.3781 , 2013. [72] Je rey Pennington et al. Glove: Global vectors for word representation. In Empirical Methods in Natural Language Processing (EMNLP) , pages 1532{1543, 2014. 76Appendices 77Appendix A Supplementary Figures 790.0 0.4 0.8 1.2 1.6 2.0 2.4 Relative Risk (w/) 0.00.20.40.60.81.0Vaccinators coverage x(t) Figure A.1: Alternative bifurcation diagram for the coupled behaviour-disease incidence model represented by equations (2.4) to (2.6). Here, the strength of the injunctive norms \u000e is 2:5\u000210\u00004, allowing for partial vaccine coverage. Solid black lines are stable equilobria. Dashed grey lines are unstable equilibira . Not shown here is the disease free equilibria (S;I;x ) = (1;0;0), which is always unstable when =(\u0016+ )>1, which is the case for measles. 800 5 10 15 20 Time (Years)0.7550.7600.7650.7700.7750.7800.7850.790Lag-1 AC = 0.93Figure A.2: Sensitivity analysis of lag-1 autocorrelation as critical transition is approached. Here, epidemiological parameters are sampled from a triangular distribution ranging from 50% to 150% of their baseline values. The strength of the injunctive social norms is \u000e= 5\u000210\u00004. The relative risk evolves linearly from t= 10. The critical transition is achieved at t= 20. Length of the rolling window is indicated by the black arrow. 810 5 10 15 20 Time (Years)1.081.101.121.141.161.181.201.221.24Variance1e5 = 0.86Figure A.3: Sensitivity analysis of variance as critical transition is approached. Here, epidemiological parameters are sampled from a triangular distribution ranging from 50% to 150% of their baseline values. The strength of the injunctive social norms is \u000e= 5\u000210\u00004. The relative risk evolves linearly from t= 10. The critical transition is achieved at t= 20. Length of the rolling window is indicated by the black arrow. 820.660.680.700.720.740.760.780.80 = 0.64 = 0.76 = 0.86 0.660.680.700.720.740.760.780.80Lag-1 AC = = = 0.90 0 5 10 15 200.660.680.700.720.740.760.780.80 = 0.93 0 5 10 15 20 Time (Years) = 0.94 0 5 10 15 20 = 0.94Figure A.4: Sensitivity analysis of the rolling window width for coupled behaviour-disease model. Relative risk evolves linearly from t= 10 and undergoes a critical transition at t= 20. Length of the rolling window is indicated by the black arrow 830100200300 Tweets (Anti)A 050100150200250 in activity near the beginning of 2015 is in reaction to a CDC public health advisory notice about the Disneyland outbreak. 840.1 0.00.10.20.30.40.50.60.70.8 Pre = 0.45 Post = -0.65 A Pre = 0.52 Post = -0.50 B Pre = 0.62 Post = 0.03 C 0.1 0.00.10.20.30.40.50.60.70.8Lag-1 AC (Anti) Pre = 0.72 Post = 0.28 D Pre = 0.71 Post = 0.26 E Pre = 0.70 Post = 0.23 F 2012 2013 2014 2015 20160.1 0.00.10.20.30.40.50.60.70.8 Pre = 0.76 Post = 0.18 G 2012 2013 2014 2015 2016 DatePre = 0.77 Post = 0.15 H 2012 2013 2014 2015 2016Pre = 0.67 Post = 0.13 IFigure A.6: Sensitivity Analysis of window width and lag-1 autocorrelation for anti senti- mented tweets. Length of the moving window is indicated by the black arrow. 850.2 0.00.20.40.60.81.0 Pre = 0.65 Post = -0.69 A Pre = 0.72 Post = -0.68 B Pre = 0.79 Post = -0.09 C 0.2 0.00.20.40.60.81.0Lag-1 AC (Pro) Pre = 0.70 Post = 0.88 D Pre = 0.89 Post = nan E Pre = 0.82 Post = 0.80 F 2012 2013 2014 2015 20160.2 0.00.20.40.60.81.0 Pre = 0.80 Post = 0.70 G 2012 2013 2014 2015 2016 DatePre = 0.75 Post = 0.59 H 2012 2013 2014 2015 2016Pre = 0.68 Post = 0.49 IFigure A.7: Sensitivity Analysis and lag-1 autocorrelation for pro senti- mented tweets. Length of the moving window is indicated by the black arrow. 860.00.20.40.60.81.0 Pre = 0.65 Post = -0.59 A Pre = 0.69 Post = -0.62 B Pre = 0.76 Post = -0.88 C 0.00.20.40.60.81.0Lag-1 AC (All) Pre = 0.75 Post = 0.18 D Pre = 0.74 Post = 0.34 E Pre = 0.72 Post = 0.40 F 2012 2013 2014 2015 20160.00.20.40.60.81.0 Pre = 0.73 Post = 0.25 G 2012 2013 2014 2015 2016 DatePre = 0.75 Post = -0.02 H 2012 2013 2014 2015 2016Pre = 0.68 Post = -0.03 IFigure A.8: Sensitivity Analysis of window width and lag-1 autocorrelation for all tweets. Length of the moving window is indicated by the black arrow. 87051015202530 Pre = 0.72 Post = -0.65 A Pre = 0.76 Post = -0.92 B Pre = 0.85 Post = -0.97 C 051015202530Variance (Anti)Pre = 0.93 Post = -0.87 D Pre = 0.84 Post = -0.97 E Pre = 0.84 Post = -0.90 F 2012 2013 2014 2015 2016051015202530 Pre = 0.87 Post = -0.95 G 2012 2013 2014 2015 2016 DatePre = 0.89 Post = -0.62 H 2012 2013 2014 2015 2016Pre = 0.87 Post = -0.79 IFigure A.9: Sensitivity Analysis of window width and variance for anti sentimented tweets. Length of the moving window is indicated by the black arrow. 880510152025 Pre = 0.83 Post = -0.97 A Pre = 0.93 Post = -1.00 B Pre = 0.93 Post = -0.96 C 0510152025Variance (Pro)Pre = 0.97 Post = -1.00 D Pre = 0.99 Post = -1.00 E Pre = 0.99 Post = -1.00 F 2012 2013 2014 2015 20160510152025 Pre = 1.00 Post = -1.00 G 2012 2013 2014 2015 2016 DatePre = 1.00 Post = -1.00 H 2012 2013 2014 2015 2016Pre = 1.00 Post = -0.98 IFigure A.10: Sensitivity Analysis of window width and variance for pro sentimented tweets. Length of the moving window is indicated by the black arrow. 89020406080100 Pre = 0.82 Post = -0.75 A Pre = 0.89 Post = -0.96 B Pre = 0.93 Post = -0.99 C 020406080100Variance (All)Pre = 0.97 Post = -0.99 D Pre = 0.98 Post = -0.90 E Pre = 0.99 Post = -0.90 F 2012 2013 2014 2015 2016020406080100 Pre = 0.99 Post = -0.73 G 2012 2013 2014 2015 2016 DatePre = 0.99 Post = -0.49 H 2012 2013 2014 2015 2016Pre = 0.84 Post = -0.97 IFigure A.11: Sensitivity Analysis of window width and variance for all tweets. Length of the moving window is indicated by the black arrow. 900 20 40 60 80 100 Time (Years)0.9050.9100.9150.9200.9250.9300.935Lag-1 AC pre = 0.91 post = -0.95Figure A.12: Sensitivity analysis of lag-1 autocorrelation approaching and rebounding from the critical transition. Epidemiological parameters are sampled from a triangular distribution ranging from 50% to 150% of their baseline values. The relative risk evolves triangularly, reaching a maximum value of \u000eatt= 50. The risk begins to increase at t= 30 and returns to the baseline value at t= 70. The lag-1 autocorrelation can be seen to increase and decrease as the relative risk increases and decreases.Grey shaded region represents a 95% con dence interval constructed from 500 independent simulations. Length of the rolling window is indicated by the black arrow. 910 20 40 60 80 100 Time (years)2.53.03.54.04.55.0Variance1e5 pre = 0.94 post = -0.95Figure A.13: Sensitivity analysis of variance approaching and rebounding from the critical transition. Epidemiological parameters are sampled from a triangular distribution ranging from 50% to 150% of their baseline values. The relative risk evolves triangularly, reaching a maximum value of \u000eatt= 50. The risk begins to increase at t= 30 and returns to the baseline value at t= 70. The variance can be seen to increase and decrease as the relative risk increases and decreases. Grey shaded region represents a 95% con dence interval constructed from 500 independent simulations. Length of the rolling window is indicated by the black arrow. 920.700.750.800.850.900.95 pre = 0.55 post = -0.41pre = 0.62 post = -0.53pre = 0.66 post = -0.59 0.700.750.800.850.900.95Lag-1 AC pre = 0.67 post = -0.61pre = 0.73 post = -0.59pre = 0.77 post = -0.59 0 5 10 15 200.700.750.800.850.900.95 pre = 0.83 post = -0.63 0 5 10 15 20 Time (Years)pre = 0.89 post = -0.68 0 5 10 15 20pre = 0.96 post = -0.74Figure A.14: Sensitivity Analysis of window width and lag-1 autocorrelation approaching and rebounding from the critical transition. Grey shaded regions are 95% con dence intervals constructed from 500 simulations with di erent random seeds. Epidemiological parameters are xed in this instance. The length of the rolling window is di erent in each panel, and is indicated by the black arrow. 930 50 100 150 200 250 3000.50.60.70.80.91Vaccine Uptake 0 50 100 150 200 250 300 time (years)01234Prop. Infected#10-3 Figure A.15: Transient dynamics of system far from the critical transition. The relative risk is constant throughout the simulation. As can be seen, the variance (bottom left) and lag-1 autocorrelation (bottom right) do not change. This is corroborating evidence that the observed increases in the variance and lag-1 autocorrelation observed in previous gures is due to the variation of the relative risk. 940 10 20 30 40 50 60 70 80 90 1000.60.81Vaccine Uptake 0 10 20 30 40 50 60 70 80 90 1000246Prop. Infected#10-4 0 10 20 30 40 50 60 70 80 90 100 t (years)0246w(t)#10-4 w(t) wcrit Figure A.16: Dynamics of the coupled behaviour-disease system as wis brought near the critical transition. The top three panels are vaccine coverage x(t), infection prevalence I(t), and relative risk w(t). The red line in panel three is where the critical transition occurs. Variance and lag-1 autocorrelation (bottom left and right panels) increase and decrease as relative risk approaches and rebounds from the critical transition. 950.4 0.2 0.00.20.40.60.81.0 Pre = 0.15 Post = -0.09 A Pre = -0.04 Post = 0.48 B Pre = 0.24 Post = -0.93 C 0.4 0.2 0.00.20.40.60.81.0Lag-1 AC (Measles) Pre = 0.42 Post = -0.53 D Pre = 0.54 Post = nan E Pre = 0.52 Post = nan F 2011 2012 2013 2014 20150.4 0.2 0.00.20.40.60.81.0 Pre = 0.37 Post = -0.80 G 2011 2012 2013 2014 2015 DatePre = 0.35 Post = -0.45 H 2011 2012 2013 2014 2015Pre = 0.44 Post = -0.95 IFigure A.17: Sensitivity analysis of window width and lag-1 autocorrelation for \\measles\" Google searches in California 960.10.20.30.40.50.60.70.80.91.0 Pre = -0.08 Post = -0.42 A Pre = 0.15 Post = -0.56 B Pre = 0.01 Post = -0.83 C 0.10.20.30.40.50.60.70.80.91.0Lag-1 AC (Measles) Pre = 0.22 Post = -0.63 D Pre = 0.31 Post = -1.00 E Pre = 0.29 Post = -1.00 F 2011 2012 2013 2014 20150.10.20.30.40.50.60.70.80.91.0 Pre = -0.08 Post = 0.65 G 2011 2012 2013 2014 2015 DatePre = -0.04 Post = 0.41 H 2011 2012 2013 2014 2015Pre = -0.03 Post = -0.17 IFigure A.18: Sensitivity analysis of window width and lag-1 autocorrelation for \\measles\" Google searches in The United States 97051015202530 Pre = 0.46 Post = -1.00 A Pre = 0.52 Post = -1.00 B Pre = 0.62 Post = -1.00 C 051015202530Variance (Measles)Pre = 0.61 Post = -0.90 D Pre = 0.72 Post = -0.98 E Pre = 0.80 Post = -0.98 F 2011 2012 2013 2014 2015051015202530 Pre = 0.85 Post = -0.58 G 2011 2012 2013 2014 2015 DatePre = 0.92 Post = -0.90 H 2011 2012 2013 2014 2015Pre = 0.95 Post = -0.67 IFigure A.19: Sensitivity analysis of window width and variance for \\measles\" Google searches in California 980510152025 Pre = 0.50 Post = -1.00 A Pre = 0.59 Post = -1.00 B Pre = 0.51 Post = -0.52 C 0510152025Variance (Measles)Pre = 0.61 Post = -0.91 D Pre = 0.70 Post = -0.99 E Pre = 0.74 Post = -0.30 F 2011 2012 2013 2014 20150510152025 Pre = 0.87 Post = -0.38 G 2011 2012 2013 2014 2015 DatePre = 0.94 Post = -0.70 H 2011 2012 2013 2014 2015Pre = 0.91 Post = -0.66 IFigure A.20: Sensitivity analysis of window width and variance for \\measles\" Google searches in The United States 990.00.20.40.60.81.0 Pre = 0.51 Post = -0.85 A Pre = 0.60 Post = -0.94 B Pre = 0.55 Post = -0.06 C 0.00.20.40.60.81.0Lag-1 AC (MMR)Pre = 0.58 Post = 0.22 D Pre = 0.66 Post = -0.53 E Pre = 0.66 Post = -0.58 F 2011 2012 2013 2014 20150.00.20.40.60.81.0 Pre = 0.78 Post = -0.67 G 2011 2012 2013 2014 2015 DatePre = 0.85 Post = -0.85 H 2011 2012 2013 2014 2015Pre = 0.83 Post = -0.69 IFigure A.21: Sensitivity analysis of window width and lag-1 autocorrelation for \\MMR\" Google searches in California 1000.30.40.50.60.70.80.91.0 Pre = 0.61 Post = -0.85 A Pre = 0.56 Post = -0.60 B Pre = 0.56 Post = -0.35 C 0.30.40.50.60.70.80.91.0Lag-1 AC (MMR)Pre = 0.69 Post = -0.51 D Pre = 0.81 Post = -0.57 E Pre = 0.86 Post = -0.80 F 2011 2012 2013 2014 20150.30.40.50.60.70.80.91.0 Pre = 0.87 Post = -0.84 G 2011 2012 2013 2014 2015 DatePre = 0.78 Post = 0.32 H 2011 2012 2013 2014 2015Pre = 0.80 Post = -0.50 IFigure A.22: Sensitivity analysis of window width and lag-1 autocorrelation for \\MMR\" Google searches in The United States 101024681012 Pre = 0.44 Post = -0.96 A Pre = 0.45 Post = -0.74 B Pre = 0.58 Post = -0.48 C 024681012Variance (MMR)Pre = 0.66 Post = 0.17 D Pre = 0.77 Post = -0.53 E Pre = 0.84 Post = -0.80 F 2011 2012 2013 2014 2015024681012 Pre = 0.91 Post = -0.90 G 2011 2012 2013 2014 2015 DatePre = 0.96 Post = -0.88 H 2011 2012 2013 2014 2015Pre = 0.95 Post = -0.08 IFigure A.23: Sensitivity analysis of window width and variance for \\MMR\" Google searches in The United States 102024681012 Pre = 0.52 Post = -0.96 A Pre = 0.54 Post = -0.75 B Pre = 0.64 Post = -0.59 C 024681012Variance (MMR)Pre = 0.69 Post = -0.64 D Pre = 0.75 Post = -0.81 E Pre = 0.82 Post = -0.71 F 2011 2012 2013 2014 2015024681012 Pre = 0.94 Post = -0.66 G 2011 2012 2013 2014 2015 DatePre = 0.97 Post = -0.54 H 2011 2012 2013 2014 2015Pre = 0.97 Post = -0.40 IFigure A.24: Sensitivity analysis of window width and variance for \\MMR\" Google searches in California 1030 20 40 60 80 100 Time8.08.28.48.68.89.09.29.4Lag-1 AC1e1 pre = -0.12 post = -0.49Figure A.25: The lag-1 autocorrelation in the times leading up to, and immediately after, the peak in relative risk for the stochastic coupled behaviour-disease model. The data within a one year radius has been removed and the lag-1 autocorrelation is calculated for each half of the remaining data. Length of the rolling window is 20 years, indicated by the length of the black arrows. Though the pre peak Kendall coe\u000ecient is negative, there is still a clear increase in the lag-1 autocorrelation as the peak in relative risk draws nearer, which is parsimonious with theory. 1042012 2013 2014 2015 2016 Date0.00.20.40.60.81.0 Lag-1 AC (Anti)A pre =0.62 post =-0.45 2012 2016 Date0.00.20.40.60.81.0 Lag-1 AC (Pro)B pre =0.76 post =-0.55 2012 Lag-1 AC (All)C pre =0.69 post =-0.47Figure A.26: An analysis of the early warning data for Aanti-vaccine sentimented tweets, Bpro-vaccine sentimented tweets, and Call tweets. The data within a 5 day radius of the spike in twitter activity is removed and the lag-1 autocorrelation is calculated for each half accordingly. Anti-vaccine, pro-vaccine, and all tweets show a positive Kendall leading to the spike in activity and a negative Kendall after the activity. This suggests that the relative risk increased up until the CDC reported on the outbreak, and then the coupled nature of the system forced the relative risk to decrease due to disease incidence. 105Anti Neutral Pro Predicted labelAnti Neutral ProTrue labelConfusion Matrix 0.00.10.20.30.40.50.60.70.80.91.0Figure A.27: A visualization of the confusion matrix for the classi er used to classify tweets as either anti-vaccine, pro-vaccine, or neutral. A color closer to yellow shows the classi er performs well. From this visualization, it is clear that the classi er is often confusing pro-vaccine and anti-vaccine tweets as neutral This confusion leads to poorer performance. 106Appendix B Code 107B.1 Code for SDE Simulation 1Disease Parameters 3mu = 1/50; R = 4gamma = 365/13; b = R 5 5e\u00004; 10alpha = 1.0; %How are coming to the bif point. 11 12Time Parameters 13time = = '.') 8write me = smooth',sep = 9 me paste(write me,'csv', sep = '.') 11 15x 23 matrix(0,nrow = dim(x)[1],ncol = 1) 25 26residual matrix[,1] = res 27 28 29residual matrix = 30colnames(residual matrix) = c('smoothed') 31write.csv(residual matrix,write me, row.names = FALSE) 110B.3 Data Python 1 2import pandas as pd numpy 3 4#Test\u0000Train Split 5#Note that Test/Train splits tend to overestimate the error. 6 7#Read in Data 8import pandas as pd 9 10#Classiers and other MLA functions. These tend to be the best/most frequently used text classiers import classication report, matrix, accuracy score, precision score, recall score 18from sklearn.grid search import GridSearchCV numpy as np 28 29 30#I am going to visualize a confusion matrix. Here is some nice code to do that in MPL 31 32def plot 44#Close old plots set 48training set = testsize= 0.40, #Size of Split 56 random state = 1 57 ) 58 59#Now, we will build the pipeline for our classier 60# Training Data \u0000\u0000>Vectorizer\u0000\u0000>TfIdf\u0000\u0000>Feature Selection \u0000\u0000>Classier = SVC(kernel = 'linear') 67 68 69#Set up the pipe for the pipeline 70pipe = [ 71 72 ('TF IDFV',tf idfvectorizer), 73 ('features',selector), 74 ('classier',classier) 75 76 the pipe 78CLF Pipeline(pipe) 90 91#Perform the 92gridsearch = GridSearchCV( CLF, parameters, n verbose 0,cv = 3, scoring = 'accuracy') 93 94 95#Make the classier the best estimator 96CLF = grid search.t(X train,y train) % (param name, best parameters[param name]) 106 print s 107 108 109clf = CLF.best estimator 110 111 112 y matrix(cm, title = 'Confusion 131plt.show() 132 133 134 136with open('SVC.txt','w') as f: 137 138 s = pickle.dumps(clf) 139 f.write(s) 115 "}