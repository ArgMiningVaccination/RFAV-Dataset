{"title": "PDF", "author": "PDF", "url": "https://www.nccoe.nist.gov/sites/default/files/2021-09/mf-ics-nist-sp1800-10-draft.pdf", "hostname": "PDF", "description": "PDF", "sitename": "PDF", "date": "PDF", "cleaned_text": "1800 -10 Protecting Information and System Integrity in Industrial Control System Environments: Cybersecurity for the Manufacturing Sector I ncludes Executive Summary (A); Approach, Architecture, and Security Characteristics (B); and How -To Guides (C) Michael Powell National Cybersecurity Center of Excellence National Institute of Standards and Technology J oseph Brule * Cyber Security Directorate National Security Agency Michael Pease Keith Stouffer CheeYee Tang Timothy Zimmerman Engineering Laboratory National Institute of Standards and Technology Chelsea Deane John Hoyt Mary Raguso Aslam Sherule Kangmin Zheng The MITRE Corporation McLean, Virginia Matthew Zopf Strativia Largo, Maryland * Former employee; all work for this publication done while at employer. September 2021 DRAFT This publication is available free of charge from https://www.nccoe.nist.gov/projects/use -cases/manufacturing/integrity -ics NIST SPECIAL PUBLICATION 1800 -10 Protecting Information and System Integrity in Industrial Control System Environments: Cybersecurity for the Manufacturing Sector Includes Executive Summary (A); Approach, Architecture, and Security Characteristics (B) ; and How -To Guides (C) Michael Powell National Cybersecurity Center of Excellence National Institute of Standards and Technology Joseph Brule Cyber Security Directorate National Security Agency Michael Pease Keith Stouffer CheeYee Tang Timothy Zimmerman Engineering Laboratory National Institute of Standards and Technology Chelsea Deane John Hoyt Mary Raguso Aslam Sherule Kangmin Zheng The MITRE Corporation McLean, Virginia Matthew Zopf Strativia Largo, Maryland DRAFT September 2021 U.S. Department of Commerce Gina M. Raimondo, Secretary National Institute of Standards and Technology James K. Olthoff, Performing the Non-Exclusive Functions and Duties of the Under Secretary of Commerce for Standards and Technology & Director, National Institute of Standards and Technology DRAFT NIST SPECIAL PUBLICATION 1800-1 0A Protecting I nformation and S ystem Integrity i n Industrial C ontrol System Environments: Cybersecurity for the Manufacturing Sector Volume A: Executive Summary Michael P owell National Cybersecurity C enter of E xcellence National I nstitute of S tandards and Technology Joseph Brule* Cyber Security Directorate National Security Agency Michael P ease Keith Stouffer CheeYee Tang Timothy Zimmerman Engineering Laboratory National Institute of Standards and Technology Chelsea Deane John Hoyt Mary R aguso Aslam Sherule Kangmin Zheng The MITRE Matthew Zopf Strativia Largo, Maryland *Former employee; all work for this publication done while at employer. September 2021 DRAFT This publ ication is SP 1800- 10A: Protecting Information and System Integrity in Industria l Control System Environments 1 Executive Summary 1 Many manufacturing organizations rely on industrial control systems ( ICS) to monitor and control their 2 machinery, production lines, and other physical processes th at produce goods. To stay competitive, 3 manufacturing organizations are increasingly connecting their operational technology ( OT) systems to 4 their information technology ( IT) systems to enable and expand enterprise -wide connectivity and 5 remote access for enhanced business processes and capabilities . 6 Although t he integration of IT and OT networks is helping manufacturers boost productivity and gain 7 efficiencies, it has also provided malicious a ctors , including nation states , common criminals, and insider 8 threat s, a fertile landscape where they can exploit cybersecurity vulnerabilities to compromise the 9 integrity of ICS and ICS data to reach their end goal. The motivations behind these attacks can range 10 from degrad ing manufacturing capabilities to financial gain, to caus ing reputation al harm . 11 Once malicious actors gain access , they can harm an organization by compromis ing data or system 12 integrity, hold ICS and/ or OT systems ransom, damag e ICS machinery , or caus e physical injury to 13 workers. The statistics bear this out. The X -Force Threat Intelligence Index 2021 (ibm.com) stated that 14 manufacturing w as the second -most-attacked industry in 2020 , up from eighth place in 2019. 15 One particular case stud y illustrate s the long- lasting effects and damage a single cyber attack can inflict 16 on an organization. It was reported that a global pharmaceutical manufacturer suffered a cyber attack 17 that caused temporary production delays at a facility making a key vaccination. More than 30,000 laptop 18 and desktop computers , along with 7,5 00 servers , sat idle. Although the company claimed that its 19 operations were back to normal within six months of the incident, at this writing, news reports stated 20 that the organization is locked in a legal battle with its insurers and is looking to reclaim expenses that 21 include repairing its computer networks and the costs associated with interruptions to its operations. 22 They are seeking more than $1.3 billion in damages. 23 To address the cybersecurity challenges facing the manufacturing sector, the Na tional Institute of 24 Standards and Technology's ( Cybersecurity Center of Excellence ( ) launched this 25 project in partnership with NIST's Engineering Laboratory ( EL) and cybersecurity technology providers . 26 Together, we have built example solutions that manufacturing organizations can use to mitigate ICS 27 integrity risks , strengthen the cybersecurity of OT systems , and protect the data that these systems 28 process. 29 CHALLENGE 30 The manufacturing industry is critical to the economic well -being of our nation , and is constantly seeking 31 ways to modernize its systems, boost productivity, and raise efficiency. To meet these goals, 32 manufacturers are modernizing their OT systems by making them more interconnected and integrated 33 with other IT systems and introducing automated methods to strengthen their overall O T asset 34 management capabilities. 35 As OT and IT systems becom e increasingly interconnected , manufacturers have become a major target 36 of more widespread and sophisticated cybersecurity attacks , which can disrupt these p rocesses and 37 DRAFT NIST SP 1800- 10A: Protecting Information and System Integrity in Industria l Control System Environments 2 cause damage to equipment and/ or injuries to workers. Furthermore, these incidents could significantly 38 impact productivity and raise operating costs , depending on the extent of a cyber attack . 39 This practice guide can help your organization: detect and prevent unauthorized software installation protect ICS networks from potentially harmful applications determine changes made to a network using change management tools detect unauthorized use of systems continu ously monitor network traffic leverage malware tools SOLUTION 40 The NCCoE, in conjunction with the NIST E L, collaborated with cybersecurity technology providers to 41 develop and implement example solutions that demonstrate how manufacturing organizations can 42 protect the integrity of their data from destructive malware, insider threats, and unauthorized software 43 within manufacturing environments that rely on ICS. 44 The example solutions use technologies and security capabilities from the project collaborators listed in 45 the table below. These technologies were implemented in two distinct manufacturing lab environmen ts 46 that emulate discrete and continuous manufacturing systems . This project takes a modular approach in 47 demonstrating two unique builds in each of the lab environments. 48 The following is a list of the project's collaborators. 49 Collaborator Component Provides secure remote access with authentication and authorization support. Provides network and asset monitoring to detect behavior anomalies and modifications to h ardware, firmware , and software capabilities. Provides network and asset monitoring to detect behavior anomalies and modifications to h ardware, firmware , and software capabilities. Offers secure data storage on -prem. Provides network and asset monitoring to detect behavior anomalies and modifications to h ardware, firmware , and software capabilities. Real -time data management software that enables detection of behavior anomalies and modifications to hardware, firmware , and software capabilities. DRAFT NIST SP 1800- 10A: Protecting Information and System Integrity in Industria l Control System Environments 3 Collaborator Component Access control platform that secures connections and provides control mechanisms to enterprise systems for authorized users and devices; monitors activity down to the keystroke Provides network and asset monitoring to detect behavior anomalies and modifications to h ardware, firmware , and software capabilities. Provides host -based application allowlisting (the blocking of unauthorized activities that have the potential to pose a harmful attack) and file integrity monitoring. While the NCCoE used a suite of commercial products to address this ch allenge, this guide does not 50 endorse these particular products, nor does it guarantee compliance with any regulatory initiatives. Your 51 organization's information security experts should identify the products that will best integrate with 52 your existing tool s and IT system infrastructure. Your organization can adopt this solution or one that 53 adheres to these guidelines in whole, or you can use this guide as a starting point for tailoring and 54 implementing parts of a solution. 55 HOW TO USE THIS GUIDE 56 Depending on your role in your organization, you might use this guide in different ways: 57 Business decision makers, including chief information security and technology officers , can use this 58 part of the guide, NIST SP 1800 -10A: Executive Summary , to understand the drivers for the guide, the 59 cybersecurity challenge we address, our approach to solving this challenge, and how the solution could 60 benefit your organization. 61 Technology, security, and privacy program managers who are concerned with how to identify, 62 understand, assess, and mitigate risk can use NIST SP 1800 -10B: Approach, Architecture, and Security 63 Characteristics . It describ es what we built and why, including the risk analysis performed and the 64 security/privac y control map pings . 65 IT professionals who want to implement an approach like this can make use of NIST SP 1800- 10C: How - 66 To Guides . It provide s specific product installation, configuration, and integration instructions for 67 building the example implementation , allowing you to replicate all or parts of this project. 68 SHARE YOUR FEEDBACK 69 You can view or download the preliminary draft guide at https://www.nccoe.nist.gov/projects/use - 70 cases/manufacturing/integrity -ics. Help the NCCoE make this guide better by sharing your thoughts with 71 us. There will be at leas t 45 additional days for the comment period for this guide . 72 Once the example implementation is developed, you can adopt this solution for your own organization . 73 If you do, please share your experience and advice with us. We recognize that technical solutions alone 74 will not fully enable the benefits of our solution, so we encourage organizations to share lessons learned 75 and best practices for transforming the processes associated with implementing this guide . 76 DRAFT NIST SP 1800- 10A: Protecting Information and System Integrity in Industria l Control System Environments 4 To provide c omments , join the community of interest , or to learn more about the project and example 77 implementation , contact the NCCoE at manufacturing_nccoe@nist.gov . 78 COLLABORATORS 79 Collaborators participating in this project submitted their capabilities in response to an open call in the 80 Federal Register for all sources of relevant security capabilities from academia and industry (vendors 81 and integrators). Th ose respondents with relevant capabilities or product components signed a 82 Cooperative Research and Development Agreement (CRADA ) to collaborate with NIST in a consortium to 83 build this example solution . 84 Certain commercial entities, equipment, products, or materials may be identified by name or company 85 logo or other insignia in order to acknowledge their participation in this collaboration or to describe an 86 experimental procedure or concept adequately. Such identification is not intended to imply special 87 status or relationship with NIST or recom mendation or endorsement by NIST or NCCoE; neither is it 88 intended to imply that the entities, equipment, products, or materials are necessarily the best available 89 for the purpose. 90 DRAFT NIST SPECIAL PUBLICATION 1800 -10B _____________________________________________________________________________________ Protecting Information and System Integrity in Industrial Control System Environments: Cybersecurity for the Manufacturing Sector _____________________________________________________________________________________ Volume B: Approach, Architecture , and Security Characteristics Michael Powell National Cybersecurity Center of Excellence National Institute of Standards and Technology Joseph Brule * Cyber Security Directorate National Security Agency Michael Pease Keith Stouffer CheeYee Tang Timothy Zimmerman Engineering Laboratory National Institute of Standards and Technology Chelsea Deane John Hoyt Mary Raguso Aslam Sherule Kangmin Zheng The MITRE Virginia Matthew Zopf Strativia Largo, Maryland *Former employee; all work for this publication done while at employer. September 2021 DRAFT This publication is available free of charge from https://www.nccoe.nist.gov/projects/use -cases/manufacturing/integrity -ics DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments i DISCLAIMER 1 Certain commercial entities, equipment, products, or materials may be identified by name or company 2 logo or other insignia in order to acknowledge their participation in this collaboration or to describe an 3 experimental procedure or concept adequately. Such identification is not intended to imply special 4 status or relationship with NIST or recommendation or endorsement by NIST or NCCoE; neither is it 5 intended to imply that the entities, equipment, products, or materials are necessarily the best available 6 for the purpose. 7 While NIST and NCCoE address goals of improving the management of cybersecurity and privacy risk 8 through outrea ch and application of standards and best practices, it is the stakeholder's responsibility to 9 fully perform a risk assessment to include the current threat, vulnerabilities, likelihood of a compromise 10 and the impact should the threat be realized before ado pting cyber security measures such as this 11 recommendation. 12 Domain name and IP addresses shown in this guide represent an example domain and network 13 environment to demonstrate the NCCoE project use case scenarios and the security capabilities. 14 National Institute of Standards and Technology Special Publication 1800 -10B, Natl. Inst. Stand. Technol. 15 September 2021 ), CODEN: NSPUE2 16 FEEDBACK 17 You can improve this guide by contributing feedback. As you review and adopt this solution for your 18 own organization, we ask you and your colleagues to share your experience and advice with us. 19 Comments on this publication may be submitted to: manufacturing_nccoe@nist.gov . 20 Public comment period: September 2 3, 2021 t hrough November 07, 2021 21 All comments are subject to release under the Freedom of Information Act (FOIA). 22 National Cybersecurity Center of Excellence 23 National Institute of Standards and Technology 24 100 Bureau Drive 25 Mailstop 2002 26 Gaithersburg, MD 20899 27 Email: nccoe@nist.gov 28 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments ii NATIONAL CYBERSECURITY CENTER OF EXCELLENCE 29 The National Cybersecurity Center of Excellence ( NCCoE ), a part of the National Institute of Standards 30 and Technology ( NIST ), is a collaborative hub where industry organizations, government agencies, and 31 academic institutions work together to address businesses' most pressing cybersecurity is sues. This 32 public -private partnership enables the creation of practical cybersecurity solutions for specific 33 industries, as well as for broad, cross -sector technology challenges. Through consortia under 34 Cooperative Research and Development Agreements ( CRAD As), including technology partners \u2014from 35 Fortune 50 market leaders to smaller companies specializing in information technology security \u2014the 36 NCCoE applies standards and best practices to develop modular, easily adaptable example cybersecurity 37 solutions using commercially available technology. The NCCoE documents these example solutions in 38 the NIST Special Publication 1800 series, which maps capabilities to the NIST Cybersecurity Framework 39 and details the steps needed for another entity to re- create the exampl e solution. The NCCoE was 40 established in 2012 by NIST in partnership with the State of Maryland and Montgomery County, 41 Maryland. 42 To learn more about the NCCoE, visit https://www.nccoe.nist.gov/ . To learn more 44 NIST CYBERSECURITY PRACTICE GUIDES 45 NIST Cybersecurity Practice Guides (Special Publication 1800 series) target specific cybersecurity 46 challenges in the public and private sectors. They are practical, user- friendly guides that facilitate the 47 adoption of standards -based approaches to cybersec urity. They show members of the information 48 security community how to implement example solutions that help them align more easily with relevant 49 standards and best practices, and provide users with the materials lists, configuration files, and other 50 inform ation they need to implement a similar approach. 51 The documents in this series describe example implementations of cybersecurity practices that 52 businesses and other organizations may voluntarily adopt. These documents do not describe regulations 53 or mandato ry practices, nor do they carry statutory authority. 54 ABSTRACT 55 Today's manufacturing organizations rely on industrial control systems ( ICS) to conduct their operations. 56 Increasingly, ICS are facing more frequent, sophisticated cyber attacks \u2014making manufacturing the 57 second -most -targeted industry [1]. Cyber attacks against ICS threaten operations and worker safety , 58 resulting in financial loss and harm to the organization's reputation. 59 The architecture and solutions presented in this guide are built upon standards -based, commercially 60 available products, and represent some of the possible solutions. The solution s impleme nt standard 61 cybersecurity capabilities such as behavioral anomaly detection (BAD ), application allowlisting, file 62 integrity -checking, change control management, and user authentication and authorization. The 63 solution was tested in two distinct lab settings : a discrete manufacturing workcell, which represents an 64 assembly line production, and a continuous process control system, which represents chemical 65 manufacturing industries. 66 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments iii An o rganization that is interested in protecting the integrity of a manufacturing system and information 67 from destructive malware, insider threats, and unauthorized software should first conduct a risk 68 assessment and determine the appropriate security capabilities required to mitigate those risks. Once 69 the security capabilities are identified, the sample architecture and solution presented in this document 70 may be used . 71 The security capabilities of the example solution are mapped to the NIST Cybersecurity Framework , the 72 National Initiative for Cybersecurity Education Framework , and NIST Special Publication 800 -53. 73 KEYWORDS 74 Manufacturing; industrial control systems; application allowlisting ; file integrity checking; 75 anomaly software modification; 76 firmware modification. 77 ACKNOWLEDGEMENTS 78 We are grateful to the following individuals for their generous contributions of expertise and time. 79 Name Organization Dan Frechette Microsoft Ian Schmertzler Dispel Ben Burke Dispel Chris Jensen Tenable Bethany Brower VMWare Dennis Hui OSIsoft (now part of AVEVA) John OSIsoft (now part Petruzzo GreenTec Josh Carlson Dragos Alex Baretta Dragos T he Technology Partners/Collaborators who participated in this build submitted their capabilities in 80 response to a notice in the Federal Register. Respondents with relevant capabilities or product 81 components were invited to sign a Cooperative Research and Development Agreement (CRADA) with 82 NIST, allowing them to participate in a consortium to build this example solution. We worked with : 83 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments iv Technology Partner/Collaborator Product Carbon Black (VMware) Carbon Black App Control Microsoft Azure Defender for the internet of things ( IoT) (incorporating technology from the acquisition of CyberX) Dispel Dispel Wicket ESI Dispel Enclave Dispel VDI OSIsoft (now part of AVEVA) PI System (which comprises products such as PI Server, PI Vision and others) TDi Technologies Console Works Tenable Tenable.ot DOCUMENT CONVENTIONS 84 The terms \"shall\" and \"shall not\" indicate requirements to be followed strictly to conform to the 85 publication and from which no deviation is permitted. The terms \"should\" and \"should not\" indicate that 86 among several possibilities, one is recommended as particularly suitable without mentioning or 87 excluding others, or that a certain course of action is preferred but not necessarily required, or that (in 88 the negative form) a certain possibility or course of action is discouraged but not p rohibited. The terms 89 \"may\" and \"need not\" indicate a course of action permissible within the limits of the publication. The 90 terms \"can\" and \"cannot\" indicate a possibility and capability, whether material, physical, or causal. 91 CALL FOR PATENT CLAIMS 92 This p ublic review includes a call for information on essential patent claims (claims whose use would be 93 required for compliance with the guidance or requirements in this Information Technology Laboratory 94 (ITL) draft publication). Such guidance and/or requiremen ts may be directly stated in this ITL Publication 95 or by reference to another publication. This call also includes disclosure, where known, of the existence 96 of pending U.S. or foreign patent applications relating to this ITL draft publication and of any rel evant 97 unexpired U.S. or foreign patents. 98 ITL may require from the patent holder, or a party authorized to make assurances on its behalf, in 99 written or electronic form, either: 100 a) assurance in the form of a general disclaimer to the effect that such party d oes not hold and does not 101 currently intend holding any essential patent claim(s); or 102 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments v b) assurance that a license to such essential patent claim(s) will be made available to applicants desiring 103 to utilize the license for the purpose of complying with the gu idance or requirements in this ITL draft 104 publication either: 105 1. under reasonable terms and conditions that are demonstrably free of any unfair discrimination ; 106 or 107 2. without compensation and under reasonable terms and conditions that are demonstrably free 108 of any unfair discrimination 109 Such assurance shall indicate that the patent holder (or third party authorized to make assurances on its 110 behalf) will include in any documents transferring ownership of patents subject to the assurance, 111 provisions sufficient to ensur e that the commitments in the assurance are binding on the transferee, 112 and that the transferee will similarly include appropriate provisions in the event of future transfers with 113 the goal of binding each successor -in-interest. 114 The assurance shall also ind icate that it is intended to be binding on successors -in-interest regardless of 115 whether such provisions are included in the relevant transfer documents. 116 Such statements should be addressed to: manufactur ing_nccoe@nist.gov 117 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments vi Contents 118 1 Summary .............................................................................................. 1 119 1.1 Challenge ....................................................................................................................... 2 120 1.2 Solution .......................................................................................................................... 3 121 1.2.1 Relevant Standards and Guidance ................................................................................ 3 122 1.3 Benefits .......................................................................................................................... 4 123 2 How to Use This Guide ......................................................................... 4 124 2.1 Typographic Conventions .............................................................................................. 6 125 3 Approach ............................................................................................. 6 126 3.1 Audience ........................................................................................................................ 6 127 3.2 Scope ............................................................................................................................. 7 128 3.3 Assumptions .................................................................................................................. 7 129 3.4 Risk Assessment ............................................................................................................ 8 130 3.4.1 Threats .......................................................................................................................... 8 131 3.4.2 9 132 Risk .............................................................................................................................. 10 133 3.4.4 Security Control Map .................................................................................................. 10 134 3.5 Technologies ................................................................................................................ 13 135 4 Architecture ....................................................................................... 14 136 4.1 Manufacturing Process and Control System Description ........................................... 15 137 4.2 Cybersecurity for Smart Manufacturing Systems Architecture .................................. 15 138 4.3 Process Control System ............................................................................................... 16 139 4.4 Collaborative Robotics System (CRS) .......................................................................... 19 140 4.5 Logical Network and Security Architectures ............................................................... 21 141 4.5.1 Build 1 ......................................................................................................................... 21 142 4.5.2 Build 2 ......................................................................................................................... 25 143 4.5.3 Build 3 ......................................................................................................................... 28 144 4.5.4 Build 4 ......................................................................................................................... 30 145 5 Security Characteristic Analysis .......................................................... 32 146 5.1 Assumptions and Limitations ...................................................................................... 32 147 5.2 Example Solution Testing ............................................................................................ 32 148 5.2.1 Scenario 1: Protect Host from Malware Infection via USB ......................................... 33 149 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments vii 5.2.2 Scenario 2: Protect Host from Malware Infection via Network Vector ...................... 34 150 5.2.3 Scenario 3: Protect Host from Malware via Remote Access Connections ................. 35 151 5.2.4 Scenario 4: Protect Host from Unauthorized Application Installation ....................... 36 152 5.2.5 Scenario 5: Protect from Unauthorized Addition of a Device .................................... 38 153 5.2.6 Scenario 6: Detect Unauthorized Device -to-Device Communications ....................... 39 154 5.2.7 Scenario 7: Protect from Unauthorized Deletion of Files ........................................... 40 155 5.2.8 Scenario 8: Detect Unauthorized Modification of PLC Logic ...................................... 41 156 5.2.9 Scenario 9: Protect from Modification of Historian Data ........................................... 42 157 5.2.10 Scenario 10: Detect Sensor Data Manipulation .......................................................... 44 158 5.2.11 Scenario 11: Detect Unauthorized Firmware Modification ........................................ 44 159 5.3 Scenarios and Findings ................................................................................................ 46 160 5.3.1 PR.AC -1: Identities and credentials are issued, managed, verified, revoked, and 161 audited for authorized devices, users, and processes ................................................ 46 162 5.3.2 PR.AC -3: Remote access PR.AC -4: Access permissions and authorizations are managed, incorporating the 164 principles of least privilege and separation of duties ................................................. 46 165 5.3.4 PR.AC -7: Users, devices, and other assets are authenticated (e.g., single- factor, multi- 166 factor) commensurate with the risk of the transaction (e.g., individuals' security and 167 privacy risks and other organizational risks) ............................................................... 47 168 5.3.5 PR.DS -1: 47 169 5.3.6 PR.DS -6: Integrity checking mechanisms are used to verify software, firmware, and 170 information integrity ................................................................................................... 47 171 5.3.7 PR.IP -4: Backups of information are maintained, and tested ................. 47 172 5.3.8 PR.MA -1: Maintenance and repair of organizational assets are performed and logged, 173 with approved and controlled tools ........................................................................... 47 174 5.3.9 PR.MA -2: Remote maintenance of organizational assets is approved, logged, and 175 performed in a manner that prevents unauthorized access ...................................... 48 176 5.3.10 DE.AE -1: A baseline of network operations and expected data flows for users and 177 systems is established and managed .......................................................................... 48 178 5.3.11 DE.AE -2: Detected events are analyzed to understand attack targets and methods 48 179 5.3.12 DE.AE -3: Event data are collected and correlated from multiple sources and sensors . 180 ................................................................................................................................. 48 181 5.3.13 DE.CM -1: The network is monitored to detect ......... 49 182 5.3.14 DE.CM -3: Pe rsonnel activity is cybersecurity events 49 183 5.3.15 DE.CM -7: Monitoring for unauthorized personnel, connections, devices, and software 184 is performed ................................................................................................................ 49 185 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments viii 6 Future Build Considerations ............................................................... 50 186 Appendix A List of Acronyms .................................................................. 51 187 Appendix B Glossary .............................................................................. 53 188 Appendix C References .......................................................................... 57 189 Appendix D Scenario Execution Results .................................................. 59 190 D.1 Executing Scenario 1: Protect Host from Malware via USB ........................................ 59 191 D.1.1 Build 1 ......................................................................................................................... 59 192 D.1.2 Build 2 ......................................................................................................................... 61 193 D.1.3 Build 3 ......................................................................................................................... 61 194 D.1.4 Build 4 ......................................................................................................................... 62 195 D.2 Executing Scenario 2: Protect Host from Malware via Network Vector ..................... 63 196 D.2.1 Build 1 ......................................................................................................................... 64 197 D.2.2 Build 2 ......................................................................................................................... 67 198 D.2.3 Build 3 ......................................................................................................................... 73 199 D.2.4 Build 4 ......................................................................................................................... 77 200 D.3 Executing Scenario 3: Protect Host from Malware via Remote Access 201 Connections ................................................................................................................. 81 202 D.3.1 Build 1 ......................................................................................................................... 81 203 D.3.2 Build 2 ......................................................................................................................... 83 204 D.3.3 Build 3 ......................................................................................................................... 85 205 D.3.4 Build 4 ......................................................................................................................... 87 206 D.4 Executing Scenario 4: Protect Host from Unauthorized Application Installation ....... 89 207 D.4.1 Build 1 ......................................................................................................................... 89 208 D.4.2 Build 2 ......................................................................................................................... 91 209 D.4.3 Build 3 ......................................................................................................................... 93 210 D.4.4 Build 4 ......................................................................................................................... 96 211 D.5 Executing Scenario 5: Protect from Unauthorized Addition of a Device .................... 99 212 D.5.1 Build 1 ....................................................................................................................... 100 213 D.5.2 Build 2 ....................................................................................................................... 101 214 D.5.3 Build 3 ....................................................................................................................... 102 215 D.5.4 4 ....................................................................................................................... 106 216 D.6 Scen ario Detect Unauthorized -to-Device Communications ..... 108 217 D.6.1 Build 1 ....................................................................................................................... 108 218 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments ix D.6.2 Build 2 ....................................................................................................................... 109 219 D.6.3 Build 3 ....................................................................................................................... 110 220 D.6.4 Build 4 ....................................................................................................................... 111 221 D.7 Executing Scenario 7: Protect from Unauthorized Deletion of Files ........................ 112 222 D.7.1 Build 1 ....................................................................................................................... 112 223 D.7.2 Build 2 ....................................................................................................................... 113 224 D.7.3 Build 3 ....................................................................................................................... 114 225 D.7.4 Build 4 ....................................................................................................................... 115 226 D.8 Executing Scenario 8: Detect Unauthorized Modification of PLC Logic .................... 116 227 D.8.1 Build 1 ....................................................................................................................... 116 228 D.8.2 Build 2 ....................................................................................................................... 119 229 D.8.3 Build 3 ....................................................................................................................... 123 230 D.8.4 4 ....................................................................................................................... 126 231 D.9 Executing Scen ario 9: Protect from Modification of Historian Data ......................... 128 232 D.9.1 Build 1 ....................................................................................................................... 128 233 D.9.2 Build 2 ....................................................................................................................... 130 234 D.9.3 Build 3 132 235 D.9.4 Build 4 ....................................................................................................................... 134 236 D.10 Executing Scenario 10: Detect Sensor Data Manipulation ....................................... 136 237 D.10.1 All Builds .................................................................................................................... 136 238 D.11 Executing Scenario 11: Detect Unauthorized Firmware Modification ..................... 137 239 D.11.1 Build 1 ....................................................................................................................... 137 240 D.11.2 Build 2 ....................................................................................................................... 138 241 D.11.3 Build 3 ....................................................................................................................... 141 242 D.11.4 Build 4 ....................................................................................................................... 142 243 Appendix E Benefits of IoT Cybersecurity Capabilities ......................... 144 244 E.1 Device Capabilities Mapping ..................................................................................... 144 245 E.2 Device Capabilities Supporting Functional Test Scenarios ........................................ 155 246 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments x List of Figures 247 Figure 4- 1: CSMS Network Architecture ............................................................................................ 16 248 Figure 4- 2: Simplified Tennessee Eastman Process Model ................................................................. 17 249 Figure 4- 3: HMI Screenshot for the PCS Showing the Main Components in the Process ...................... 18 250 Figure 4- 4: PCS Network ................................................................................................................... 19 251 Figure 4- 5: The CRS Workcell ............................................................................................................ 20 252 Figu re 4-6: CRS Network ................................................................................................................... 21 253 Figure 4- 7: Build 1, PCS Complete Architecture with Security Components ........................................ 24 254 Figure 4- 8: Build 2, PCS Complete Architecture with Security Components ........................................ 27 255 Figure 4- 9: Build 3, CRS Complete Architecture with Security Components ........................................ 29 256 Figure 4- 10: Build 4, CRS Complete Architecture with Security Components ...................................... 31 257 Figure D -1: An Alert from Carbon Black Showing that Malware (1.exe) was Blocked from Executing .. 60 258 Figure D -2: Carbon Black's Server Provides Additional Details and Logs of the Event .......................... 60 259 Figure D -3: Carb on Black's Server Log of the Event ............................................................................ 61 260 Figure D -4: Windows 7 Alert as a Result of Windows SRP Blocking the Execution of 1.exe .................. 61 261 Figure D -5: Windows 10 Alert as a Result of Windows SRP Blocking the Execution of 1.exe ................ 62 262 Figure D -6: Carbon Black Blocks the Execution of 1.exe for Build 4 ..................................................... 63 263 Figure D -7: Tenable.ot Dashboard Showing the Events that were Detected ....................................... 64 264 Figure D -8: Detected RDP Session Activity from External System to DMZ System ............................... 65 265 Figure D -9: Event Detection Detail for the RDP Connection from the External System to the 266 Historian in the DMZ ........................................................................................................................ 65 267 Figure D -10: Tenable.ot Detected VNC Connection Between the DMZ and the Testbed LAN ............... 65 268 Figure D -11: Tenable.ot Event Detail for a Detected Port Scan from a DMZ System Targeting a 269 System in the Testbed LAN ............................................................................................................... 66 270 Figure D -12: Detected RDP from a DMZ system to a Testbed LAN system .......................................... 66 271 Figure D -13: Tenable.ot Event Detail Showing the RDP Connection Between the Historian in 272 the DMZ to a Workstation in the Testbed LAN .................................................................................. 66 273 Figure D -14: Attempt to Execute 1.exe Failed .................................................................................... 67 274 Figure D -15: Alert Dashboard Showing Detection of an RDP Session .................................................. 68 275 Figure D -16: Details of the Detected RDP Session Activity from an External System to DMZ System ... 69 276 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments xi Figure D -17: Detection of Scanning Traffic and RDP Connection into Manufacturing Environment ...... 70 277 Figure D -18: Details of One of the Port Scan Alerts ............................................................................ 71 278 Figure D -19: Details of Alert for RDP Connection into Manufacturing Environment ............................ 72 279 Figure D -20: Dialog Message Showing 1.exe was Blocked from Executing .......................................... 73 280 Figure D -21: Windows SRP blocked 1.exe From Executing ................................................................. 74 281 Figure D -22: Log of Alerts Detected by Dragos ................................................................................... 74 282 Figure D -23: Detail of RDP Session Activity Between an External System and a DMZ System .............. 75 283 Figure D -24: Detail for Network Scanning Alert ................................................................................. 76 284 Figure D -25: Detail of RDP Session Activity Between a DMZ System and a Testbed LAN System ......... 76 285 Figure D -26: Azure Defender for IoT \"info\" Event Identified the Remote Access Connection to 286 the DMZ .......................................................................................................................................... 77 287 Figure D -27: Alert for Scanning Activity ............................................................................................. 78 288 Figure D -28: Details for the Scanning Alert ........................................................................................ 79 289 Figure D -29: Detection of RDP Connection into the Manufacturing Environment ............................... 80 290 Figure D -30: Carbon Black Shows an Alert for Blocking File 1.exe ....................................................... 81 291 Figure D -31: Secured VPN Connection to Environment with Cisco AnyConnect .................................. 82 292 Figure D -32: Remote Access is Being Established Through ConsoleWorks .......................................... 83 293 Figure D -33: Dispel VDI with Interface for Connecting Through Dispel Enclave to Dispel Wicket ESI .... 84 294 Figure D -34: Nested RDP Session Showing Dispel Connection into the PCS Workstation ..................... 85 295 Figure D -35: VPN Connection to Manufacturing Environment ............................................................ 86 296 Figure D -36: Remote Access is Being Established Through ConsoleWorks .......................................... 87 297 Figure D -37: Dispel VDI Showing Interface for Connecting Through Dispel Enclave to Dispel Wicket ... 88 298 Figure D -38: Nested RDP Session Showing Dispel Connection into the CRS Workstation ..................... 88 299 Figure D -39: Carbon Black Blocks the Execution of putty.exe and Other Files ..................................... 90 300 Figure D -40: Tenable.ot alert Showing the SMB Connection Between the HMI and the GreenTec 301 Server .............................................................................................................................................. 91 302 Figure D -41: Tenable.ot Alert Details of the SMB Connection Between the HMI and the network file 303 system (NFS) Server in the DMZ ....................................................................................................... 91 304 Figure D -42: Putty.exe is Not Permitted to Run Based on the Windows SRP Configuration ................. 92 305 Figure D -43: putty -64bit -installer.msi is blocked 92 306 Figure D -44: Forescout Alert on the File Transfer Activity .................................................................. 93 307 Figure D -45: Forescout Alert Details for the File Transfer Activity ...................................................... 93 308 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments xii Figure D -46: Putty.exe is Not Permitted to Run Based on the Windows SRP Configuration ................. 94 309 Figure D -47: putty -64bit -0.74 -installer.msi is Blocked by Windows SRP ............................................. 94 310 Figure D -48: Dragos Alert on the File Transfer Activity ....................................................................... 95 311 Figure D -49: Dragos Alert Details of the File Transf er Alert ................................................................ 96 312 Figure D -50: Carbon Black Alert Showing that putty.exe is Blocked from Executing ............................ 97 313 Figure D -51: Carbon Black Alert Showing the Execution of putty -64bit -0.74 -installer.msi Being 314 Blocked ........................................................................................................................................... 98 315 Figure D -52: Azure Defender for IoT Alert Dashboard Showing Detection of a New Activity ............... 98 316 Figure D -53: Azure Defender for IoT Alert Details Showing RPC Connection Between the DMZ and 317 the Testbed LAN .............................................................................................................................. 99 318 Figure D -54: Azure Defender for IoT Event Alert Timeline Showing the File Transfer .......................... 99 319 Figure D -55: Tenable.ot Event Showing a New Asset has Been Discovered ....................................... 101 320 Figure D -56: Tenable.ot Event Showing Unauthorized SSH Activities ............................................... 101 321 Figure D -57: Forescout A lert on the DNS Request from the New Device ........................................... 102 322 Figure D -58: Forescout alert showing the SSH connection ............................................................... 102 323 Figure D -59: Detailed Forescout alert of the Unauthorized SSH Connection ..................................... 102 324 Figure D -60: Dragos Dashboard Showing Alerts Generated upon Detecting New Device and Network 325 Scanning ........................................................................................................................................ 104 326 Figure D -61: Details of Network Scanning Activity ........................................................................... 104 327 Figure D -62: Additional Details of Network Scanning Activity .......................................................... 105 328 Figure D -63: Alert for New Asset on the Network ............................................................................ 105 329 Figure D -64: Azure Defender for IoT Dashboard Showing the Alerts, Including for the New Asset ..... 106 330 Figure D -65: Azure Defender for IoT Detects New Asset in the Environment .................................... 107 331 Figure D -66: Azure Defender for IoT Alert Management Options ..................................................... 107 332 Figure D -67: Details for Network Scanning Alert .............................................................................. 108 333 Figure D -68: Tenable.ot Event Log Showing the Unapproved SSH Traffic .......................................... 109 334 Figure D -69: Forescout Alert Showing the Unapproved SSH Traffic .................................................. 110 335 Figure D -70: Dragos Alert Showing the Unapproved SSH Connection Between Devices .................... 111 336 Figure D -71: Azure Defender for IoT Event Identified the Unauthorized SSH Connection .................. 112 337 Figure D -72 Event Messages from Carbon Black Showing File Deletion Attempts ............................. 113 338 Figure D -73: Security Onion Wazuh Alert Showing a File Has Been Deleted ...................................... 114 339 Figure D -74: Alert from Security Onion for a File Deletion ............................................................... 115 340 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments xiii Figure D -75: Carbon Black Alerts Showing That a File Has Been Deleted .......................................... 116 341 Figure D -76: Remote Access to Systems in PCS Network is Being Established Through 342 ConsoleWorks ............................................................................................................................... 117 343 Figure D -77: Remote Session into Studio 5000 to Perform PLC File Operations ................................. 117 344 Figure D -78: Tenable.ot Detected the Transfer of PLC Logic File to the Rockwell PLC ........................ 118 345 Figure D -79: Tenable.ot PLC Stop alert details ................................................................................. 118 346 Figure D -80: Tenable.ot PLC Program Download Alert Details .......................................................... 119 347 Figure D -81: Remote Access to Systems in PCS Network is Being Established Through Dispel ........... 120 348 Figure D -82: Modifying the Parameters for the Allen- Bradley PLC Controller Using Studio 5000 ....... 121 349 Figure D -83: Forescout Alerts Showing It Detected the Traffic Between the Engineering Workstation 350 and the PLC .................................................................................................................................... 122 351 Figure D -84: Forescout Alert Details for the Stop Command Issued to the PLC ................................. 122 352 Figure D -85: Forescout Alert Details for the Configuration Download Command .............................. 123 353 Figure D -86: VPN Connection to the Manufacturing Environment .................................................... 124 354 Figure D -87: Remote Access is Being Established through ConsoleWorks ......................................... 124 355 Figure D -88: Dragos Notification Manager Showing Detection of the Transfer of PLC Logic File to the 356 Beckhoff PLC .................................................................................................................................. 125 357 Figure D -89: Dragos Alert Details for the PLC Lo gic File Download ................................................... 126 358 Figure D -90: Dispel VDI with Interface for Connecting Through Dispel Enclave to Dispel Wicket ....... 127 359 Figure D -91: Nested RDP Connections Showing Dispel Connection into the CRS Workstation ........... 127 360 Figure D -92: Azure Defender for IoT Alert for the Unauthorized PLC Programming ........................... 128 361 Figure D -93: Tenable.ot alert Showing SMB Connection from an External Workstation to the 362 Historian ........................................................................................................................................ 129 363 Figure D -94: GreenTec Denies Modification and Deletion File Operations in the Protected Drive ...... 130 364 Figu re D -95: Forescout Alert Showing Network Connection from the Corporate Network to the 365 Historian ........................................................................................................................................ 131 366 Figure D -96: GreenTec Denies Modification and Deletion File Operations in the Protected Drive ...... 132 367 Figure D -97: Dragos Detection of RDP Session from an Ext ernal Network to the Historian................ 133 368 Figure D -98: GreenTec Denies Modification and Deletion File Operations in the Protected Drive ...... 134 369 Figure D -99: Azure Defender for IoT Event Timeline Showing the Remote Access Connection to the 370 Historian ........................................................................................................................................ 135 371 Figure D -100: GreenTec Denies Modification and Deletion File Operations in the Protected Drive .... 136 372 Figure D -101: PI Server's Event Frames Showing Out -of-Range Sensor Readings for the Reactor 373 Pressure ........................................................................................................................................ 137 374 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments xiv Figure D -102: Tenable.ot Detects a Collection of Events Generated by a Firmware Change .............. 138 375 Figure D -103: Details for One of the Alerts Showing the Firmware Change ....................................... 138 376 Figure D -104: Forescout De tects a Collection of Alerts Associated with the Firmware Change .......... 139 377 Figure D -105: Alert Details Detected by Forescout for the Firmwa re Change .................................... 140 378 Figure D -106: ICS Patrol Scan Results Showing a Change Configuration was Made ........................... 141 379 Figure D -107: Dragos Dashboard Showing an Alert for Firmware Change ......................................... 142 380 Figure D -108: Details for Firmware Change Alert ............................................................................. 142 381 Figure D -109: Azure Defender for IoT Alert Showing a Version Mismatch in the Firmware Build ....... 143 382 List of Tables 383 Table 3 -1: Security Control Map ....................................................................................................... 11 384 Table 3 -2: Products and Technologies ............................................................................................... 13 385 Table 4 -1: Summary of What Products Were Used in Each Build ........................................................ 15 386 Table 4 -2: Build 1 Technology Stack to Capabilities Map .................................................................... 22 387 Table 4 -3: Build 2 Technology Stack to Capabilities Map .................................................................... 25 388 Table 4 -4: Build 3 Technology Stack to Capabilities Map .................................................................... 28 389 Table 4 -5: Build 4 Technology Stack to Capabilities Map .................................................................... 30 390 Tabl e E-1: Mapping of Device Cybersecurity Capabilities and Nontechnical Supporting Capabilities to 391 NIST Cybersecurity Framework Subcategories of the ICS Project ...................................................... 145 392 Table E -2 Device Cybersecurity Capabilities and Nontechnical Supporting Capabilities that Map to 393 Each of the Functional Test Scenarios ............................................................................................. 155 394 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 1 1 Summary 395 While availability is always a critical aspect of manufacturing system environments, manufacturers also 396 need to consider maintaining the integrity of their systems and information to ensure continued 397 operations. The integrity of information can be degraded or lost as a result of behaviors by authorized 398 users (e.g., failure to perform backups or record their actions) or malicious actors seeking to disrupt 399 manufacturing operations for illicit profits, political statements, or other reasons. 400 Manufacturers are unique because of their reliance on industrial control systems (ICS) to monitor and 401 control their manufacturing operations. ICS typically prioritize information availability and integrity over 402 confidentiality. As a res ult, cybersecurity solutions used in traditional information technology (IT) 403 settings are not optimized to protect ICS from cyber threats. 404 This guide, prepared by the National Cybersecurity Center of Excellence (NCCoE) and the NIST 405 Engineering Laboratory (EL), contains four examples of practical solutions that organizations can 406 implement in their environments to protect ICS from information and system integrity attacks. 407 The goal of this NIST Cybersecurity Practice Guide is to help organizations protect th e integrity of 408 systems and information by: 409 securing historical system data 410 preventing execution or installation of unapproved software 411 detecting anomalous behavior on the network 412 identifying hardware, software, or firmware modifications 413 enabling secure rem ote access 414 authenticating and authoriz ing users 415 This document provides a detailed description of how each solution was implemented and what 416 technologies were used to achieve each of the above listed goals across four example builds. Scenarios 417 are used to d emonstrate the efficacy of the solutions. The results and challenges of each scenario in the 418 four example builds are also presented and discussed. 419 Ultimately, manufacturing organizations that rely on ICS can use the example solutions described in this 420 guide to safeguard their information and system integrity from : 421 destructive malware 422 insider threats 423 unauthorized software 424 unauthorized remote access 425 loss of historical data 426 anomalies network traffic 427 unauthorized modification of systems 428 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 2 This document contains the following sections: 429 Section 1 , Summary , presents the challenges addressed by the NCCoE project, with a look at the 430 solutions demonstrated to address the challenge, as well as benefits of the solutions. 431 Section 2, How to Use This Guide, explains how readers \u2014business decision makers, program managers, 432 control system engineers, cybersecurity practitioners, and IT professionals (e.g., systems 433 administrators) \u2014 might use each volume of thi s guide. 434 Section 3 , Approach , offers a description of the intended audience and the scope of the project. This 435 section also describes the assumptions on which the security architecture and solution development 436 was based, the ri sk assessment that informed architecture development, the NIST Cybersecurity 437 Framework functions supported by each component of the architecture and reference design, and 438 which industry collaborators contributed support in building, demonstrating, and docu menting the 439 solutions. This section also includes a mapping of the NIST Cybersecurity Framework subcategories to 440 other industry guidance, and identifies the products used to address each subcategory. 441 Section 4, Architecture , summarizes the Cybersecurity for Smart Manufacturing Systems (CSMS) 442 demonstration environment , which emulates real- world manufacturing processes and their ICS by using 443 software simulators and commercial off- the-shelf hardware in a laboratory environment. The 444 implementation of the information and system integrity solutions is also described. 445 Section 5, Security Characteristic Analysis , summarizes the scenarios and findings that were employed to 446 demonstrate the example implementations' functionality. Each of the scenarios is mapped to the 447 relevant NIST Cybersecurity Framework functions and subcategories and the security capabilities of the 448 products tha t were implemented. Additionally, it briefly describes how the security capabilities that 449 were used in the solution implementation help detect cyber attacks and protect the integrity of the 450 manufacturing systems and information. 451 Section 6, Future Build Considerations , identifies additional areas that should be reviewed in future 452 practice guides. 453 Section Appendix D, Scenario Execution Results , describes, in detail, the test results of the scenarios , 454 including screenshots from the security products captured during the tests. 455 1.1 Challenge 456 Manufacturing organizations that rely on ICS to monitor and control physical processes face risks from 457 malici ous and non -malicious insiders along with external threats in the form of increasing ly 458 sophisticated cyber attacks. A compromise to system or information integrity may very well pose a 459 significant threat to human safety and can adversely impact an organization's operations , resulting in 460 financial loss and harming production for years to come. 461 Manufacturing organizations may be the targets of malicious cyber actors or may be incidentally 462 impacted by a broader malware event such as ransomware attacks. ICS com ponents remain vulnerable 463 to cyber attacks for numerous reasons , including adoption and integration of enhance d connectivity , 464 remote access , the use of legacy technologies , flat network topologies, lack of network segmentation, 465 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 3 and the lack of cybersecurity technologies (e.g., anti-virus, host -based firewalls, encryption ) typically 466 found on IT systems. 467 Organizations are increasing ly adopti ng and integrating IT into the ICS environment to enhance 468 connectivity to business systems and to enable remote access . As a result, ICS are no longer isolat ed 469 from the outside world , making them more vulnerable to cyber attacks. Security controls designed for 470 the IT environment may impact the performance of ICS when implemented within the OT environment, 471 so sp ecial precautions are required when introducing these controls. I n some cases, new security 472 techniques tailored to the specific ICS environment are needed. 473 Another challenge facing manufacturing organizations comes from authorized users who accidentally or 474 intentionally compromise information and system integrity. For example , a user may install an 475 unapproved software utility to perform maintenance activities or update the logic of a programmable 476 logic controller (PLC) to fix a bug. Even if the software or logic changes are not malicious, they may 477 inadvertently disrupt information flows, starve critical software of processing resources, or degrade the 478 operation of the system . In a worst -case scenario, mal ware may be inadvertently installed on the 479 manufacturing system, causing disruptions to system operations, or opening a backdoor to remote 480 attackers. 481 1.2 Solution 482 This NCCoE Cybersecurity Practice Guide demonstrates how manufacturing organizations can use 483 commercially available technologies that are consistent with cybersecurity standards to detect and 484 prevent cyber incidents on their ICS. 485 Manufacturers use a wide range of ICS equipment and manufacturing processes. This guide contains 486 four different example solutions that are applicable to a range of manufacturing environments, focusing 487 on discrete and continuous manufacturing processes. 488 This project provides example solution s, compos ed of the following capabilities , for manufacturing 489 environments : 490 application allowlisting 491 behavior anomaly detection ( BAD ) 492 file integrity 493 user authentication and authorization 494 remote access 495 1.2.1 Relevant Standards and Guidance 496 The solutions presented in this guide are consistent with the practices and guidance provided by the 497 following references. 498 NIST Special Publication ( SP) 800-167: Guide to Application Whitelisting [2] 499 Department of Homeland Security, Critical Manufacturing Sector Cybersecurity Framework 500 Implementation Guidance [3] 501 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 4 Executive Order no. 13636: Improving Critical Infrastructure Cybersecurity [4] 502 NIST, Framework Systems: [6] 505 NIST Internal Manufacturing [7] Control System Cybersecurity Performance Testbed [8] 507 NIST SP 800 -53 Rev. 5 : Security and Privacy Controls for Federal Information Systems and 508 Organizations [9] 509 NIST SP 800 -181: National Initiative for Cybersecurity Education (NICE) Cybersecurity Workforce 510 Framework [10] 511 NIST Special Publication 1800 -25: Data Integrity: Identifying and Protecting Assets Agains t 512 Ransomware and Other Destructive Events [11] 513 NIST Interagency or Internal Report 7298 Rev 3 : Glossary of Key Information Security Terms [12] 514 U.S.-Canada Power System Outage Task Force [13] 515 NIST SP 800-82 Rev. 2 : Guide to Industrial Control Systems (ICS) Security [14] 516 1.3 Benefits 517 This NCCoE practice guide can help organizations: 518 mitigate cybersecurity risk 519 reduce downtime to operations 520 provide a reliable environment that can detect cyber anomalies 521 respond to security alerts through automated cybersecurity -event products 522 develop and execute an OT cybersecurity strategy for which continuous OT cybersecurity 523 monitoring is a foundational building bloc k 524 implement current cybersecurity standards and best practices 525 2 How to Use This Guide 526 This NIST Cybersecurity Practice Guide demonstrates a modular design and provides users with the 527 information they need to replicate the described manufacturing ICS security solutions, specifically 528 focusing on information and system integrity. This reference design is modular and can be deployed in 529 whole or in part. 530 This guide contains three volumes: 531 NIST SP 1800 -10A: Executive Summary 532 NIST SP 1800 -10B: Approach, Architecture, and Security Characteristics - what we built and why 533 (this document) 534 NIST SP 1800 -10C: How -To Guide - instructions for building the example solution 535 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 5 Depending on your role in your organization, you might use this guide in different ways: 536 Senior information technology (IT) executives, including chief information security and technology 537 officers, will be interested in the Executive Summary, NIST SP 1800 -10A, which describes the following 538 topics: 539 challenges that enterprises face in ICS environm ents in the manufacturing sector 540 example solution built at the NCCoE 541 benefits of adopting the example solution 542 Technology or security program managers might share the Executive Summary , NIST SP 1800 -10A, with 543 your leadership to help them understand the imp ortance of adopting a standards -based solution. Doing 544 so can strengthen their information and system integrity practices by leveraging capabilities that may 545 already exist within their operating environment or by implementing new capabilities. 546 Technology or security program managers who are concerned with how to identify, understand, assess, 547 and mitigate risk will be interested in NIST SP 1800 -10B (this document), which describes what we did 548 and why. Sect ion 3.4.4 , which maps the security characteristics of the example solutions to 549 cybersecurity standards and best practices, will be of particular interest: 550 IT and OT professionals who want to implement an approach like this will find the whole 551 practice guid e useful, particularly the how -to portion, NIST SP 1800 -10C, which provides step - 552 by-step details to replicate all, or parts of the example solutions created in our lab. Volume C 553 does not re- create the product manufacturers' documentation, which is generall y widely 554 available. Rather, Volume C shows how we integrated the products together to create an 555 example solution. 556 This guide assumes that IT and OT professionals have experience implementing security products within 557 the enterprise. While we have used a su ite of commercial products to address this challenge, this guide 558 does not endorse these particular products. Your organization can adopt this solution or one that 559 adheres to these guidelines in whole, or you can use this guide as a starting point for tailo ring and 560 implementing parts of the manufacturing ICS solution. Your organization's security experts should 561 identify the products that will best integrate with your existing tools and IT system infrastructure. We 562 hope that you will seek products that are co ngruent with applicable standards and best practices. 563 Section 3.5 , Technologies, lists the products we used and maps them to the cybersecurity controls 564 provided by this reference solution. 565 A NIST Cybersecurity Practice Guide does not describe \"the\" solution. Every organization is unique in its 566 priorities, risk tolerance , and the cyber ecosystem they operate in. This document presents a possible 567 solution that may be tailored or augmented to meet an organization's own needs. 568 This document provides initial guidance. We seek feedback on its contents and welcome your input. 569 Comments, suggestions, and success stories will improve subsequent versions of this guide. Please 570 contribute your thoughts to manufacturing_nccoe@nist.gov . 571 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 6 2.1 Typographic Conventions 572 The following table presents typographic conventions used in this volume . 573 Typeface/Symbol Meaning Example Italics file names and path names ; references to documents that are not hyperlinks ; new terms ; and placeholders For language use and style guidance, see the NCCoE Style Guide . Bold names of menus, options, command buttons , and fields Choose File > Edit. Monospace command -line input, onscreen compute r output, sample code examples, and status codes mkdir Monospace Bold command -line user input contrasted with computer output service sshd start blue text link to other parts of the document, a web URL, or an email address All publications from NIST's NCCoE are available at https://www.nccoe.nist.gov . 3 Approach 574 This practice guide documents the approach the NCCoE used to develop example solutions, called 575 builds, supporting information and system integrity objectives . The approach includes a logical design, 576 example build development, testing, security control mapp ing, and analysis. 577 Based on our discussions with cybersecurity practitioners in the manufacturing sector, the NCCoE 578 pursued the Information and System Integrity in ICS Environments project to illustrate the broad set of 579 capabilities available to manage an d protect OT assets. 580 The NCCoE collaborated with the NIST Engineering Lab (EL), Community of Interest (COI) members, and 581 the participating vendors to produce an example architecture and its corresponding implementations. 582 Vendors provided technologies that met project requirements and assisted in installation and 583 configuration of those technologies. This practice guide highlights the implementation of example 584 architectures, including supporting elements such as functional test s, security characteristic anal ysis, 585 and future build considerations 586 3.1 Audience 587 This guide is intended for individuals or entities responsible for cybersecurity of ICS and for those 588 interested in understanding information and system integrity capabilities for OT and how one 589 approaches the implementation of an architecture. It may also be of interest to anyone in industry, 590 academia, or government who seeks general knowledge of an OT information and system integrity 591 solution for manufacturing -sector organizations. 592 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 7 3.2 Scope 593 This document f ocuses on information and system integrity in ICS environments typical of 594 manufacturing organizations. It provides real- world guidance on implementing a solution for 595 manufacturing ICS environments. 596 The scope of this project is to protect the integrity of information and systems , which includes: 597 securing the data historians 598 preventing the execution or installation of unapproved software 599 detecting anomalous behavior on the network that affect s system or information integrity 600 detecting hardware, software, or firmware modification 601 enabling secure remote access 602 authenticating and authorizing users 603 Organizational cybersecurity policies and procedures , as well as response and recovery functions , are 604 out of scope for this document . 605 The security capabilities used in this demonstration for protecting information and system integrity in 606 ICS environments are briefly described below. These capabilities are implemented using commercially 607 available third -party and open -source solutions that provid e the following capabilities: 608 Application Allowlisting (AAL): A list of applications and application components (libraries, 609 configuration files, etc.) that are authorized to be present or active on a host according to a 610 well- defined baseline . [2] 611 Behavioral Anomaly Detection: A mechanism providing a approach to detecting 612 cybersecurity attacks. [6] 613 Hardware/Software/Firmware Modification Detection: A mechanism providing the ability to 614 detect changes to hardware, software , and firmware on systems or network connected devices. 615 File Integrity Checking: A mechanism providing the ability to detect changes to files on systems 616 or network -connected devices. 617 User Authentication and Authorizat ion: A mechanism for verifying the identity and the access 618 privileges granted to a user, process, or device. [12] 619 Remote Access: A mechanism supporting access to an organizational information system by a 620 user (or an information s ystem acting on behalf of a user) communicating through an external 621 network (e.g., the Internet) . [12] 622 3.3 Assumptions 623 This project makes the following assumptions: 624 Each solution is comprised of several readily available products. The m odularity of the solutions 625 might allow organizations to consider swap ping one or more products , depending on their 626 specific requirements. 627 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 8 A cybersecurity stakeholder might implement all or part of a solution in a manner that is 628 compatible with their existing environment. 629 Organizations will test and evaluate the compatibility of the solutions with their ICS devices 630 prior to production implementation and deployment. Response and recovery functions are 631 beyond the scope of this guide. 632 3.4 Risk Assessment 633 NIST SP 800 -30 Revision 1, Guide for Conducting Risk Assessments , states that risk is \" a measure of the 634 extent to which an entity is threatened by a potential circumstance or event, and typically a function of: 635 (i) the adverse impacts that would arise if t he circumstance or event occurs; and (ii) the likelihood of 636 occurrence. \" The guide further defines risk assessment as \" the process of identifying, estimating, and 637 prioritizing risks to organizational operations (including mission, functions, image, reputation), 638 organizational assets, ind ividuals, other organizations, and the Nation, resulting from the operation of 639 an information system. Part of risk management incorporates threat and vulnerability analyses, and 640 considers mitigations provided by security controls planned or in place. \" 641 The NCCoE recommends that any discussion of risk management, particularly at the enterprise level, 642 begin s with a comprehensive review of NIST SP 800 -37 Revision 2, Risk Management Framework for 643 Information Systems and Organizations , material that is available to the public. The Risk Management 644 Framework (RMF) guidance , as a whole , proved to be invaluable in giving us a baseline to assess risks, 645 from which we developed the project, the security characteristics of the build, and this guide. 646 3.4.1 Threats 647 A threat is \"any circumstance or event with the potential to adversely impact organizational operations\" 648 [11]. Within an IT environment, threats are typically thought of in terms of threats to confidentiality, 649 integrity, or availability. 650 The realization of a threat to confidentiality, integrity, and availability may have different impacts to the 651 OT versus the IT environments. OT environments are sensitive to loss of safety, availability, and 652 integrity, while traditional IT environ ments tend to direct more resources toward confidentiality. 653 Organizations that combine IT and OT operations are advised to evaluate the threats from both 654 perspectives. 655 In a cyber -physical system, cybersecurity stakeholders are advised to consider events t hat occur in the 656 OT environment may have impact to physical assets and events that occur in the physical world may 657 impact the OT environment . For example, in 2021 a ransomware attack against an American oil pipeline 658 system led to a disruption of operations and ultimately resulted in fuel shortages at airports and filling 659 stations on the United States east coast. At the time of this writing, a full assessment has not been 660 completed, but the economic impact to the pipeline was substantial. 661 An integrity loss need not be malicious to cause a significant impact. For example, a race condition in a 662 supervisory control and data acquisition ( SCADA) program caused a loss of information integrity. This led 663 to alarm and notification failures and ultimately caus ed the N ortheast Blackout of 2003. In excess of 55 664 million people were affected by this blackout and more than 100 people died. [13] Similarly, a sensor or 665 metrology malfunction can lead to corrupted values in databases, logs, or other re positories. 666 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 9 Examples of integrity loss that may have an impact on the physical system include: 667 Data corruption of alarm thresholds or control setpoints may lead to poor production quality in 668 products or, in the extreme case, damage and destruction to phys ical manufacturing equipment. 669 A loss of integrity of telemetry data may cause control algorithms to produce erroneous or even 670 detrimental commands to manufacturing or control equipment. 671 Corrupted routing tables or a denial -of-service attack on the communi cations infrastructure may 672 cause the manufacturing processes to enter into a fail -safe state, thus inhibiting production. If 673 the process is not designed to be fail -safe, an attack could result in equipment damage and lead 674 to a greater disaster. 675 Unauthorize d remote access to the plant network could enable an attacker to stop production 676 or operate the plant and equipment beyond its intended operating range. An attacker 677 succeed ing in disabling the safety instrument systems or chang ing its threshold parameters \u2014 678 operating the plant beyond its intended range \u2014could lead to severe equipment damage. 679 3.4.2 Vulnerabilities 680 A vulnerability as defined in NISTIR 7298, Glossary of Key Information Security Terms [12] is a \"weakness 681 in an information system, system security procedures, internal controls, or implementation th at could 682 be exploited by a threat source.\" 683 As indicated in Section 1 of this document, when IT and OT environments are integrated, each domain 684 inherits the vulnerabilities of the other. Increasing complexity of the interfaces typically results in the 685 vulnerability of the overall system being much greater than the sum of the vulnerabilities of the 686 subsystems. 687 NIST SP 800- 82 categorizes I CS vulnerabilities into the following categories with examples [ 14]: 688 Policy and Procedure : incomplete, inappropriate, or nonexistent security policy, including its 689 documentation, implementation guides (e.g., procedures), and enforcement 690 Architecture and Design: design flaws, development flaws, poor administration, and 691 connections with other systems and networks 692 Configuration and Maintenance : misconfiguration and poor maintenance 693 Physical : lack of or improper access control, malfunctioning equipment 694 Software Development : improper data validation, security capabilities not enabled, inadequate 695 authentication privileges 696 Communication and Network : nonexistent authentication, insecure protocols, improper firewall 697 configuration 698 The first step in understanding the vulnerabilit ies and securing an organization's ICS infrastructure is 699 knowledge of deployed assets and their interfaces. The knowledge of an asset's location and baselining 700 of its behavior enable detection of anomalous behavior, via network monitoring , that may be the result 701 of a successfully exploited vulnerability. The ability to reliably detect changes in asset behavior and 702 knowing an asset's attributes are key in responding to potential cybersecurity incidents. 703 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 10 3.4.3 Risk 704 The risk to an organization is the intersection of: 705 the vulnerabilities and threats to the organization 706 the likelihood that the vulnerability and threat event will be realized 707 the impact to the organization should the event be realized 708 A meaningful risk assessment must be performed in the context of the cyber -ecosystem and the impact 709 to an organization should a loss or degradation occur. The usefulness of the risk assessment is limited by 710 how well the organization identifies and prioritizes the criticality of its assets, identifies the thre ats, and 711 estimates the likelihood of the threats being realized. 712 Though risk analysis is a mature discipline, careful deliberations and analys es are necessary to determine 713 the effect integrating IT and OT assets has on the threats, vulnerabilities, and im pact to the organization. 714 Once a baseline risk assessment has been completed, information assurance controls, such as the 715 integrity protection measures investigated in this project, can be evaluated on how well they reduce the 716 likelihood of the threat and subsequent reduction of risk. Cybersecurity stakeholders are strongly 717 encouraged to leverage the NIST Cybersecurity Framework and manufacturing overlays to identify the 718 components, elements, or items for which a risk assessment must be conducted. In additi on, NIST SP 719 800-82 [14] mentions special considerations for performing an ICS risk assessment. 720 3.4.4 Security Control Map 721 Implementation of cybersecurity architectures is most effective when executed in the context of an 722 overall cybersecurity framework. Frameworks include a holistic set of activities or functions (i.e., what 723 needs to be done) and a selection of controls (i.e., how these are done) that are appropriate for a given 724 cyber -ecosystem. For this project, the NIST Cybersecurity Framework provided the overarching 725 framework. 726 The subset of NIST Cybersecurity Framework Functions, Categories, and Subcategories that are 727 supported by this example solution are listed below in Table 3 -1, along with the subset of mappings to 728 NIST SP 800- 53 Rev. 5 and to the National Initiative for Cybersecurity Education (NICE) Workforce 729 Framework . NIST SP 800 -53 Rev 5: Security and Privacy Controls for Information Systems and 730 Organizations provides a list of controls for protecting operations, assets, and individuals. The controls 731 detail requirements necessary to meet organizational needs. The NICE Cybersecurity Workforce 732 Framework identifies knowledge, skills, and abilities (KSAs) needed to perform cybersecurity tasks. It is a 733 referenc e guide on how to recruit and retain talent for various cybersecurity roles. 734 For more information on the security controls, the NIST SP 800 -53 Rev.5, Security and Privacy Controls 735 for Information Systems and Organizations is available at 736 https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800 -53r5.pdf . 737 For more information about NICE and resources that are available to employers, education an d training 738 providers, students, and job seekers, the NIST SP -181 Rev. 1 , NICE Cybersecurity Workforce Framework , 739 and other NICE resources are available at - SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 11 Table 3-1: Security Control Map 742 Function Category Subcategory NIST SP 800- 53 Rev. 5 NIST SP 800- 181 Rev. 1 (NICE Framework) Work Roles PROTECT (PR) Identity Management, Authentication, and Access Control (PR.AC): Access to physical and logical assets and associated facilities is limited to authorized users, processes, and devices, and is managed consistent with the assessed risk of unauthorized access to authorized activities and transa ctions. PR.AC -1: Identities and credentials are issued, managed, verified, revoked, and audited for authorized devices, users, and authorizations are managed, incorporating the principles of least privilege and separation of duties assets are authenticated (e.g., single -factor, multi- factor) commensurate with the risk of the transaction (e.g., individuals' security and privacy risks and other organizational risks) AC-14, IA-4, IA-5 OM-STS- 001, OM-ADM -001 Data Security (PR.DS): Information and records (data) are managed consistent with the organization's risk strategy to protect the confidentiality, integrity, and availability of information. PR.DS -1: Data PR.DS Integrity checking mechanisms are used to verify software, firmware, and information integrity SI-7 OM-DTA-001 Information Protection Processes and Procedures (PR.IP): Security policies (that address purpose, scope, roles, responsibilities, management commitment, and coordination among organizational entities), processes, PR.IP -4: Backups of informati on are conducted, maintained, 001, SP-SYS- 002, OM-DTA-001 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 12 Function Category Subcategory NIST SP 800- 53 Rev. 5 NIST SP 800- 181 Rev. 1 (NICE Framework) Work Roles and procedures are maintained and used to manage protection of information systems and assets. Maintenance (PR.MA): Maintenance and repairs of industrial control and information system components is performed consistent with policies and procedures. PR.MA -1: Maintenance and repair of organizational assets are performed and logged, with approved and controlled tools MA-3 SP-SYS- 001, OM-ANA -001 PR.MA -2: Remote maintenance of organizational assets is approved, logged, and performed in a manner that prevents unauthorized access. MA-4 SP-SYS- 001, OM-ANA -001 DETECT (DE) Anomalies and Events (DE.AE): Anomalous activity is detected in a timely manner and the potential impact of events is understood. DE.AE -1: A baseline of network operations and expected data flows for users and systems is established and managed CM-2, SI-4 SP-ARC-001, PR-CDA -001 DE.AE -2: Detected events sensors CA-7, PR-CIR-001, CO-OPS-001 Security Continuous Monitoring (DE.CM): The information system and assets are monitored at discrete intervals to identify cybersecurity e vents and verify the effectiveness of protective measures. DE.CM- 1: The network is monitored to detect Protecting Information and System Integrity in Industrial Control System Environments 13 3.5 Technologies 743 Table 3 -2 lists the capabilities demonstrated in this project, the products, and their functions, along with 744 a mapping of the capabilities to the NIST Cybersecurity Framework . Refer to Table 3 -1 for an explanation 745 of the NIST Cybersecurity Framework subcategory codes. 746 Table 3-2: Products and Technologies 747 Capability Product Function NIST Cybersecurity Framework Subcategories Mapping Application Allowlisting (AAL) VMWare Carbon Black Allow approved ICS applications to execute. DE.AE -2, DE.AE -3, DE.CM -3, DE.CM -7 Windows Software Restriction Policies (SRP) (Note: This component was not provided by collaborator. It is a feature of the Windows operating system product.) File Integrity Checking GreenTec WORMdisk and ForceField Provides immutable storage for PR.IP -4, PR.MA -1 VMWare Carbon PR.DS -6, PR.MA -1, DE.AE -2, DE.CM -3 Wazuh (Note: This component was not provided by collaborator. It is an open source product.) BAD , Hardware/ Software/ Firmware Modification Detection Microsoft Azure Defender for IoT Passively scans the OT network to create a baseline of devices and network traffic. Alerts when activity deviates from the 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 14 Capability Product Function NIST Cybersecurity Framework Subcategories Mapping PI System Collects, analyzes, and visualizes time -series data from multiple sources. Alerts when activity and User Authorization TDi ConsoleWorks Provides a central location for managing password changes. Provides a security perimeter for all devices within the OT environment. PR.AC DE.CM -7 Dispel Remote Access Dispel Provides secure remote access. Records and logs user activity for each session. PR.AC -3, PR.MA -2, DE.AE-2, DE.CM -7 Cisco AnyConnect (Note: This component was not provided by collaborator. It was a component of the existing lab infrastructure. ) 4 Architecture 748 These mechanisms and technologies were integrated into the existing NIST Cybersecurity for Smart 749 Manufacturing Systems (CSMS) lab environment [8]. This cybersecurity performance testbed for ICS is 750 comprised of the Process Control System (PCS) and the Collaborative Robotic System (CRS) ICS 751 environments along with additional networking capabilities to emulate common manufacturing 752 environments. 753 Typically, manufacturing organizations have unique cyb er-ecosystems and specific needs for their 754 operation. To demonstrate the modularity and interoperability of the provided solutions, this project 755 used available CRADA partner technologies to assemble four \"builds\" deployed across both the PCS and 756 CRS. Addit ionally, to increase the diversity of technologies between builds, two of the builds also utilized 757 open source solutions (Security Onion Wazuh ), native operating system features (Windows Software 758 Restriction Policies [SRP]), and a Cisco Adaptive Security A ppliance ( ASA) device configured with the 759 AnyConnect VPN client . 760 This modular approach , focusing on specific products and outcomes , demonstrates how solutions might 761 be tailored to the operating environment. Table 4 -1 provides a summary of the four builds and how the 762 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 15 products were distributed across them . Detailed descriptions of the installation, configuration, and 763 integration of these builds are included in Volume C of this guide . 764 Table 4-1: Summary of What Products W ere Used in Each Build 765 Capability Build 1 Build 2 Build 3 Build 4 PCS CRS Application Allowlisting Carbon Black Windows SRP Windows SRP Carbon Black Behavior Anomaly Detection , Hardware/Software/Firmware Modification Detection PI Server PI Server PI Server PI Server Tenable.ot eyeInspect Dragos Azure Defender for IoT File Integrity Checking ConsoleWorks Dispel Remote Access AnyConnect Dispel AnyConnect Dispel Sections 4.1 , 4.2, 4.3, and 4.4 , present descriptions of the manufacturing processes and control systems 766 of the testbed that are used for demonstrating the security capabilities required for protecting 767 information and system integrity in ICS environments. Section 4.5 describes the network and security 768 architectures that are used to implement the above security capabilities. 769 4.1 Manufacturing Process and Control System Description 770 The CSMS demonstration environment emulates real- world manufacturing processes and their ICS by 771 using software simulators and c ommercial off- the-shelf (COTS) hardware in a laboratory environment 772 [8]. The CSMS environment was designed to measure the performance impact on ICS that is induced by 773 cybersecurity technologies. For this effort, the CSMS and the integrated PCS and CRS are used to 774 demonstrat e the information and system integrity capabilities an d are described in Sections 4.3 and 4.4. 775 4.2 Cybersecurity for Smart Manufacturing Systems Architecture 776 Figure 4 -1 depicts a high -level architecture for the demonstration environment consisting of a testbed 777 local area network (LAN), a demilitarized zone (DMZ), the PCS, and the CRS. The environment utilizes a 778 combination of physical and virtual systems and maintains a local network time protocol (NTP) serve r 779 for time synchronization. Additionally, the environment utilizes virtualized Active Directory (AD) servers 780 for domain services. The tools used to support information and system integrity are deployed and 781 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 16 integrated in the DMZ, Testbed LAN, PCS, and CRS a ccording to vendor recommendations and standard 782 practices as described in the detailed sections for each build. 783 Figure 4-1: CSMS Network Architecture 784 4.3 Process Control System 785 A continuous manufacturing process is a type of manufacturing process that produce s or process es 786 materials continuously and in which the materials are continuously moving, going through chemical 787 reactions, or undergoing mechanical or thermal treatment . Continuous manuf acturing usually implies a 788 24-hours a day, seven days a week (24/7 ) operation with infrequent maintenance shutdowns. Examples 789 of continuous manufacturing systems are chemical production, oil refining, natural gas processing, and 790 wastewater treatment. 791 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 17 The PCS emulates the Tennessee- Eastman ( TE) chemical reaction process. The TE problem, presented by 792 Downs and Vogel [15] , is a well- known process -control problem in continuous chemical manufacturing. 793 A control loop is required in the PCS to maintain a steady and stable chemical production. The PCS 794 presents a rea l-world scenario in which a cybersecurity attack could r epresent a real risk to human 795 safety, environmental safety, and economic viability . This allows the PCS to be used to assess the impact 796 of cybersecurity attacks on the continuous process manufacturing environment. 797 The PCS includes a software simulator to emulate the TE chemical reaction process. The simulator is 798 written in C code and is executed on a workstation -class computer. In addition, the system includes a 799 series of COTS hardware , including an Allen -Bradley Co ntrolLogix 5571 PLC, a software controller 800 implemented in MATLAB for process control , a Rockwell FactoryTalk Human Machine Interface( HMI ), an 801 object linking and embedding for process control (OPC) data access (DA) server, a data historian, an 802 engineering workstation, and several virtual LAN (VLAN) switches and network routers. Figure 4 -2 and 803 Figure 4 -3 outline the process flow of the TE manufacturing process. The simulated TE process includes 804 five major units with multiple input feeds, products , and byproducts that has 41 measured variables 805 (sensors) and 12 manipulated variables (actuators). The PCS consists of a software simulated chemical 806 manufacturing process (TE process), integrated with a series of COTS hardware , including PLCs, 807 industrial network switches, protocol converters , and hardware modules to connect the simulated 808 process and the control loop. 809 Figure 4-2: Simplified Tennessee Eastman Process Model 810 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 18 Figure 4-3: HMI Screenshot for the PCS Showing the Main Components in the Process 811 The PCS network architecture is shown in Figure 4 -4. The PCS network is connected to the Testbed LAN 812 via a boundary router. The boundary router is an Allen -Bradley Stratix 8300. All network traffic is going 813 through the boundary router to access the Testbed LAN and the DMZ. The PCS environment is 814 segmented into three local networks, namely the engineering LAN, Operations LAN (VLAN1) , and the 815 Supervisory LAN (VLAN2). Each of these local network s is connected using an industrial network switch , 816 an Allen -Bradley Stratix 5700 . The engineering workstation is hosted in the engineering LAN. The HMI 817 and the Plant Controller are hosted in the operations LAN. The Plant Simulator is hosted in the 818 supervisory LAN along with the Local Historian, OPC Server, and the Supervisory PLC. 819 The Operations LAN (VLAN1) simulates a central control room environment. The supervisory LAN 820 (VLAN2) simulates the process operation / manufacturing environment, which typically consists of the 821 operating plant, PLCs, OPC server, and data historian. 822 An OPC DA server is the main data gateway for the PLC and the simulated controller. The PLC reads in 823 the manufacturing p rocess sen sor data from the Plant Simulator using the DeviceNet connection and 824 communicate s the data to the OPC DA server. The PLC also retrieves actuator information from the 825 controller through the OPC DA and transmit s to the Plant Simulator. T he controller uses a MATLAB 826 Simulink interface to communicate with the OPC DA server directly. 827 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 19 Figure 4-4: PCS Network 828 4.4 Collaborative Robotics System (CRS) 829 The CRS workcell, shown in Figure 4 -5, contains two robotic arms that perform a material handlin g 830 process called machine tending [8]. Robotic machine tending utilizes robots to interact with machinery, 831 performing physical operations a human operator would normally perform (e.g., loading and unloading 832 of parts in a machine, op ening and closing of machine doors, activating operator control panel buttons, 833 etc.). 834 Parts are transported by two Universal Robots UR3e robot ic arms through four simulated machining 835 stations. Each station communicates with the Supervisory PLC (a Beckhoff CX9020) over the workcell 836 network , which monitors and controls all aspects of the manufacturing process. An HMI (Red Lion G310) 837 allows the workcell operator to monitor and control process parameters. 838 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 20 Figure 4-5: The CRS Workcell 839 The CRS network, shown in Figure 4 -6, is hierarchically architected, separating the supervisory devices 840 from the low -level OT that control the manufacturing process. The top-level router is a Siemens 841 RUGGEDCOM RX1510 , which provides firewall capabilities, logical access to the Testbed LAN network, 842 network address translation (NAT), and other cybersecurity capabilities. The router is connected to the 843 Testbed LAN (identified in Figure 4 -1 as the Testbed LAN) using NAT. Layer 2 network traffic for the 844 Supervisory LAN is handled by a Netgear GS724T -managed Ethernet switch, and network traffic for the 845 Control LAN is handled by a Siemens i800 -managed Ethernet switch. 846 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 21 Figure 4-6: CRS Network 847 4.5 Logical Network and Security Architectures 848 The following sections provide a high -level overview of the technology integration into the ICS 849 environments for each solution , also referred to as a build. Additional details related to the installation 850 and configuration of these tools are provided in Volume C of this guide. 851 4.5.1 Build 1 852 For Build 1 , the technologies in Table 4 -2 were integrated into the PCS environment, Testbed LAN , and 853 DMZ segments of the testbed environment to enhance system and information integrity capabilities. 854 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 22 Table 4-2: Build 1 Technology Stack to Capabilities Map 855 Capability Products Description Application Allowlisting Carbon Black Carbon Black Server is d eployed within the Testbed LAN with the Carbon Black Agents installed on key workstations and servers in the Testbed LAN, PCS environment , and DMZ to control application execution . Behavior Anomaly Detection , Hardware/Software/Firmware Modification Detection PI Server Deployed in the DMZ and PCS envir onments, the PI Server provides the historian repository for process data through its Data Archive and generate s Event Frames upon detection of abnormal manufacturing system behavior. Tenable.ot Passively monitors the PCS network , Testbed LAN, and DMZ for abnormal network activity via SPAN ports, and is also configured to capture detailed asset information for supporting inventory, change via both passive and active scanning. File Integrity Checking Carbon Black Deployed within the Testbed LAN environment with the Carbon Black Agents installed on key workstations and servers to monitor the integrity of local files. ForceField, WORMdisk A GreenTec fileserver is added to the DMZ environment and configured with both a ForceField and WORM drive to provide a protected archive for the historian data and the approved versions of configuration , source (PLC Programs), and executable files for the ICS envir onment. User Authentication and Authorization ConsoleWorks Deployed to centralize the access and management of the systems and credentials. ConsoleWorks is deployed to the Testbed LAN to allow connection s to the PCS environment. DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 23 Capability Products Description Remote Access AnyConnect Supports authenticated VPN connections to the environment with limited access to only the TDI ConsoleWorks web interface. The technology was integrated into the lab environment as shown in Figure 4 -7. DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 24 Figure 4-7: Build 1, PCS Complete Architecture with Security Components 856 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 25 4.5.2 Build 2 857 For Build 2, t he technologies in Table 4 -3 were integrated into the PCS, Testbed LAN , and DMZ segments 858 of the testbed environment to enhance system and information integrity capabilities. 859 Table 4-3: Build 2 Technology Stack to Capabilities Map 860 Capability Product Description Application Allowlisting Windows SRP AD Group Policy Objects (GPOs) are used to configure and administer the Windows Software Restriction Policy (SRP) capabilities within the Testbed LAN environment and PCS environments. For non -domain systems (e.g., Dispe l VDI and DMZ systems), the GPO was applied as local settings on the systems. Behavior Anomaly Detection , Hardware/Software/Firmware Modification Detection PI Server Deployed in the DMZ and PCS environments, the PI Server provides the historian repository for process data through its Data Archive and generates Event Frames upon detection of abnormal manufacturing system behavior. eyeInspect ICSPatrol Passively monitors the PCS network , Testbed LAN, and DMZ for abnormal network activity via SPAN ports , and is also configured to capture detailed asset information for supporting inventory and change management capabilities using the ICSPatrol server , which can perform scans on ICS components. File Integrity Checking Wazuh The Security Onion server is used to manage and monitor the integrity of local files using the Wazuh agents deployed on the Dispel VDI, DMZ, and PCS. is added to the DMZ environment a nd configured with both a ForceField and WORM drive to provide a protected archive for the historian data and the approved versions of configuration , source, and executable files for the ICS environment. DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 26 Capability Product Description User Authentication and Authorization Dispel The Dispel Wicket is deployed to the DMZ environment and integrated with the Dispel cloud -based environment to provide a virtual desktop interface (VDI) with a secure remote connection to the testbed environment. Through this connection, authorized users a re permitted to access resources in both the Testbed LAN and PCS environment. Remote Access The technology was integrated into the lab environment as shown in Figure 4 -8. 861 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 27 Figure 4-8: Build 2, PCS Complete Architecture with Security Components 862 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 28 4.5.3 Build 3 863 The technologies in Table 4 -4 were integrated into the CRS for Build 3 to enhance system and data 864 integrity capabilities. 865 Table 4-4: Build 3 Technology Stack to Capabilities Map 866 Capability Products Description Application Allowlisting Windows SRP AD Group Policy Objects (GPOs) are used to configure and administer the Windows Software Restriction Policy (SRP) capabilities within the Testbed LAN environment and CRS environments. Behavior Anomaly Detection , Hardware/Software/Firmware Modification Detection PI Server Deployed in the DMZ and CRS environments, the PI Server provides the historian repository for process data through its Data Archive and generates Event Frames upon detection of abnormal manufacturing system behavior Dragos Passively monitors the CRS network, Testbed LAN, and DMZ for abnormal network activity via SPAN ports and receives Event Frames from the DMZ PI system through the PI Web API interface. File Integrity Checking Wazuh The Security Onion server is used to manage and monitor the integrity of local files using the Wazuh agents deployed on the DMZ, Testbed LAN, and CRS . ForceField, WORMdisk A GreenTec fileserver is added to the DMZ environment and configured with both a ForceField and WORM drive to provide a protected archive for the historian data and the approved versions of configuration and coding files for the ICS environment. User Authentication and Authorization ConsoleWorks Deployed to centralize the access and management of the systems and credentials. ConsoleWorks is deployed to allow connection s within the CRS environment. Remote Access AnyConnect Supports authenticated VPN connections to the environment with limited access to only the TDI ConsoleWorks web interface. DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 29 The technology was integrated into the lab environment as shown in Figure 4 -9. 867 Figure 4-9: Build 3, CRS Complete Architecture with Security Components 868 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 30 4.5.4 Build 4 869 For Build 4, the technologies in Table 4 -5 were integrated into the CRS, Testbed LAN , and DMZ segments 870 of the testbed environment to enhance system and data integrity capabilities. 871 Table 4-5: Build 4 Technology Stack to Capabilities Map 872 Capability Products Description Application Allowlisting Carbon Black Deployed within the Testbed LAN environment with the Carbon Black agents installed on key workstations and servers to control application execution . Behavior Anomaly Detection , Hardware/Software/Firmware Modification Detection PI Server Deployed in the DMZ and CRS environments, the PI Server provides the historian repository f or process data through its Data Archive and generates Event Frames upon detection of abnormal manufacturing system behavior. Azure Defender for IoT Passively monitors the CRS network, Testbed LAN, and DMZ for abnormal network activity via SPAN ports and i s also configured to capture detailed asset information for supporting inventory and change management capabilities . File Integrity Checking Carbon Black Deployed within the Testbed LAN environment with the Carbon Black agents installed on key workstations and servers to monitor the integrity of local files. ForceField, WORMdisk A GreenTec fileserver is added to the DMZ environment and configured with both a ForceField and WORM drive to provide a protected archive for the historian data and the approved versions of configuration and coding files for the ICS environment. User Authentication and Authorization Dispel The Dispel Wicket is deployed to the DMZ environment an d integrated with the Dispel cloud - based environment to provide a virtual desktop interface (VDI) with a secure remote connection to the testbed environment. Through this connection, authorized users are permitted to access resources in both the Testbed LA N and CRS environment. Remote Access DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 31 The technology was integrated into the lab environment as shown in Figure 4 -10. 873 Figure 4-10: Build 4, CRS Complete Architecture with Security Components DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 32 5 Security Characteristic Analysis 874 The purpose of the security characteristic analysis is to understand the extent to which the project 875 meets its objective to demonstrat e protecting information and s ystem integrity in ICS environments . In 876 addition, it seeks to understand the security benefits and drawbacks of the example solution. 877 5.1 Assumptions and Limitations 878 The security characteristic analysis has the following limitations: 879 It is n either a comprehensive test of all security components nor a red -team exercise. 880 It cannot identify all weaknesses. 881 It does not include the lab infrastructure. It is assumed that devices are hardened. Testing these 882 devices would reveal only weaknesses in im plementation that would not be relevant to those 883 adopting this reference architecture. 884 5.2 Example Solution Testing 885 This section presents a summary of the solution testing and results. A total of eleven tests were 886 developed for the builds. The following inf ormation is provided for each scenario: 887 Objective: Purpose of the scenario and what it will demonstrate 888 Description: Brief description of the scenario and the actions performed 889 Relevant NIST Cybersecurity Framework Subcategories: Mapping of NIST Cybersecurity 890 Framework subcategories relevant to the scenario 891 Assumptions: Assumptions about the cyber -environment 892 Security Capabilities and Products: Capabilities and products demonstrated during the scenario 893 Test Procedures: Steps performed to execute the scenario 894 Expected Results: Expected results from each capability and product demonstrated during the 895 scenario, and for each build 896 Actual Test Results: Confirm the expected results 897 Overall Result: Were the security capabilities and products able to meet the objective when the 898 scenario was executed (PASS/FAIL rating). 899 Additional information for each scenario such as screenshots captured during the execution of the test 900 procedures and detailed results from the security capabilities are presented in Appendix D . 901 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 33 5.2.1 Scenario 1: Protect Host from Malware Infection via USB 902 Objective This test demonstrates block ing the introduction of malware through physical access to a workstation within the manufacturing environment. Descri ption An authorized user transports executable files into the manufacturing system via a USB flash drive that contains malware. Relevant NIST Cybersecurity Framework Subcategories PR.DS -6, PR.MA -2, DE.AE -2 Assumptions User does not have administrative privileges on the target machine. User has physical access to the target machine. Security Capabilities and Products Build 1: Carbon Black: Application Allowlisting Build 2: Windows SRP: Application Allowlisting Build 3: Windows SRP: Application Allowlisting Build 4: Carbon Black: Application Allowlisting Test Procedures 1. Attempt to execute malware on the target machine. Expected Results The application allowlisting tool will detect and stop the malware upon execution. Actual Test Results The application allowlisting technology successfully blocks and alerts on the execution of the application on the workstation in all builds. Overall Result PASS DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 34 5.2.2 Scenario 2: Protect Host from Malware Infection via Network Vector 903 Objective This test demonstrates the detection of malware introduc ed from the network. Description An attacker pivoting from the corporate network into the manufacturing environment attempts to insert malware to establish persistence in the manufacturing environment. -7 Assumptions The attacker has completed reconnaissance and initial access, gaining the ability to pivot into the manufacturing environment. Security Capabilities and Products Build 1: Carbon Black : Application Allowlisting Tenable. ot: Behavioral Anomaly Detection Build Allowlisting Forescout eyeInspect : Behavioral Anomaly Windows SRP: Application Allowlisting Dragos: Behavioral Anomaly Detection Build 4: Carbon Black : Application Allowlisting Azure Defender for IoT: Behavioral Anomaly Detec tion Test Procedures 1. Attacker pivots into the manufacturing environment . 2. Attacker copies malware to the server in Testbed LAN . 3. Attacker attempts to execute malware on server in Testbed LAN. DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 35 Expected Results The application allowlisting capabilities installed on target systems will block execution of the malicious code. The behavioral anomaly detection tool will capture the suspicious traffic and generate an alert. Actual Test Results The application allowlisting technology successfully blocks and alerts on the execution of the application on the workstation in all builds. The BAD tool is able to detect and alert on activity pivoting into manufacturing systems. Overall Result PASS 5.2.3 Scenario 3: Protect Host from Malware via Remote Access Connections 904 Objective This test demonstrates blocking malware that is attempting to infect the manufacturing system through authorized remote access connections. Description A remote workstation authorized to use a remote access connection has been infected with malware. W hen the workstation is connected to the manufacturing environment through the remote access connection, the malware attempts to pivot and spread to vulnerable host(s). Assumptions Infection of the remote workstation occurs prior to remote access session. DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 36 Security Capabilities and Products Build 1: Cisco VPN: Remote Access ConsoleWorks : User Authenticatio n and User Authorization Build 2: Dispel: User Authenticatio n and User Authorization , and Remote Access Build 3: Cisco VPN : Remote Access ConsoleWorks : User Authenticatio n and User Authorization Build 4: Dispel: User Authentication and User Authorization, and Remote Access Test Procedures 1. Authorized remote user connects to the manufacturing environment. 2. Malware on remote host attempts to pivot into the manufacturing environment. Expected Results Malware will be blocked from propagation by the remote access capabilities. Actual Test Results Remote access connection blocks malware attempts to pivot into the manufacturing environment. Overall Result PASS 5.2.4 Scenario 4: Protect Host from Unauthorized Application Install ation 905 Objective This test demonstrates blocking installation and execution of unauthorized applications on a workstation in the manufacturing system. Description An authorized user copies downloaded software installation files from a shared network drive accessible from the workstation in the manufacturing system. The user then attempts to install the unauthorized software on the workstation. DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 37 Relevant -7 Assumptions User does not have administrative privileges on the target machine. Applications to be installed are unapproved applications. Security Capabilities and Products Build 1: Carbon Black : Application Allowlisting Tenable. ot: Behavioral Anomaly Detection Build 2: Windows SRP: Application Allowlisting eyeInspect : Behavioral Anomaly Detection Build 3: Windows SRP: Application Allowlisting Dragos : Behavioral Anomaly Detection Build 4: Carbon Black : Application Allowlisting Azure Defender for IoT : Behavioral Anomaly Detection Test Procedures 1. The user copies s oftware to a host in the manufacturing environment . 2. The user attempts to install the software on the host. 3. The user attempts to execute software that does n ot require installation. Expected Results The application allowlisting tool will detect and stop the execution of the software installation or executable file. The BAD tool will capture the suspicious traffic and generate an alert. DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 38 Actual Test Results The application allowlisting technology successfully blocks and alerts on the execution of the application on the workstation in all builds. The BAD tool is able to detect and alert on activity in the manufacturing system. Overall Result PASS 5.2.5 Scenario 5: Protect from Unauthorized Addition of a Device 906 Objective This test demonstrates detection of an unauthorized device connecting to the manufacturing system. Description An individual authorized to access the physical premises connects and us es an unauthorized device on the manufacturing network . -7 Assumptions Ports on switch are active and available. Security Capabilities and Products Build 1: Tenable. ot: Behavioral Anomaly Detection Build 2: eyeInspect : Behavioral Anomaly Detection Build 3: Dragos : Behavioral Anomaly Detection Build 4: Azure Defender for IoT : Behavioral Anomaly Detection Test Procedures 1. The i ndividual connects the unauthorized device to the manufacturing network. 2. The individual uses an unauthorized device to access other devices on the manufacturing network. Expected Results The behavioral anomaly detection tool will capture the suspicious traffic and generate an alert. DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 39 Actual Test Results The behavioral anomaly detection tool is able to detect and alert on activity in the manufacturing system. Overall Result PASS 5.2.6 Scenario 6: Detect Unauthorized Device -to-Device Communication s 907 Objective This test demonstrates detection of unauthorized communications between devices. Description A device authorized to be on the network attempts to establish an unapproved connection. Relevant -7 Assumptions The environment has a predictable communications pattern. Security Capabilities and Products Build 1: Tenable. ot: Behavioral Anomaly Detection. Build 2: eyeInspect : Behavioral Anomaly Detection. Build 3: Dragos: Behavioral Anomaly Detection. Build 4: Azure Defender for IoT : Behavioral Anomaly Detection. Test Procedures 1. The d evice attempts to establish an unapproved connection. Expected Results The BAD tool will capture the suspicious traffic and generate an alert. Actual Test Results The BAD tool is able to detect and alert on activity in manufacturing systems. Overall Result PASS DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 40 5.2.7 Scenario 7: Protect from Unauthorized Deletion of Files 908 Objective This test demonstrates protection of files from unauthorized deletion both locally and on network file share. Description An authorized user attempts to delete files on an engineering workstation and a shared network drive within the manufacturing system. Relevant User does n ot have administrative privileges on the target machine. Security Capabilities and Products Build 1: Carbon Black: File Integrity Checking. WORMdisk: File Integrit y Protection. Build 2: Security Onion : File Integrity Checking. WORMdisk: File Integrity Protection. Build 3: Security Onion: File Integrity Checking. WORMdisk: File Integrit y Protection. Build 4: Carbon Black: File Integrity Checking. WORMdisk: File Integrit y Protection . Test Procedures 1. User attempts to delete files located on a workstation in the manufacturing system. 2. User attempts to delete files from the network file share containing the golden images for the manufacturing system. DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 41 Expected Results Deletion of files on the workstation will be detected and alerted on by the file integrity checking tool. Deletion of files on the network file share will be prevented by the file integrity checking tool. Actual Test Results Host -based file integrity checking is able to detect and alert on deletion of files . Protected network file share is able to prevent deletion of files on the network file share . Overall Result PASS 5.2.8 Scenario 8: Detect Unauthorized Modification of PLC Logic 909 Objective This test demonstrates detection of PLC logic modification. Description An authorized user performs an unapproved or unauthorized modification of the PLC logic from an engineering workstation. Relevant None Capabilities and Products Build 1: Tenable. ot: Behavioral Anomaly Detection and Software Modification Cisco VPN: Remote Access ConsoleWorks: User Authentication, User Authorization, and Remote Access Build 2: eyeInspect : Behavioral Anomaly Detection and Software Modification Dispel: User Authenticatio n and User Authorization , and Remote Access DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 42 Build 3: Dragos : Behavioral Anomaly Detection and Software Modification Cisco VPN: Remote Access ConsoleWorks: User Authentication, User Authorization, and Remote Access Build 4: Azure Defender for IoT : Behavioral Anomaly Detection and Software Modification Dispel: User Authentication and User Authorization, and Remote Access Test Procedures 1. The authorized user remotely connects to a manufacturing environment. 2. The user modifies and downloads a logic file to the PLC. Expected Results The behavioral anomaly detection tool will capture the suspicious traffic and generate an alert. The user authent ication/authorization/remote access is able to remotely access the engineering systems as intended. Actual Test Results The behavioral anomaly detection tool is able to detect and alert on activity accessing the PLC. Overall Result PASS 5.2.9 Scenario 9: Protect from Modification of Historian Data 910 Objective This test demonstrates blocking of modification of historian archive data. Description An attacker coming from the corporate network pivots into the manufacturing environment and attempts to modify historian archive data. Relevant NIST Cybersecurity 10B: Protecting Information and System Integrity in Industrial Control System Environments 43 Assumptions The attacker has completed reconnaissance and initial access, gaining the ability to pivot into the manufacturing environment. Security Capabilities and Products Build 1: Tenable. ot: Behavioral Anomaly Detection. ForceField WFS: File Behavioral Anomaly Det ection. ForceField WFS: Behavioral Anomaly Detection. ForceField WFS: File Integrity Protection. Build 4: Azure Defender for IoT: Behavioral Anomaly Detection. ForceField WFS: File Integrity Protection. Test Procedures 1. Attacker pivots into the manufacturing environment from the corporate network. 2. Attacker attempts to delete historian archive data file . 3. Attacker attempts to replace historian archive data file . Expected Results The file operation s will be blocked by the file integrity checking tool. Actual Test Results File integrity checking tool is able to prevent f ile operation s on the protected files. Overall Result PASS DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 44 5.2.10 Scenario 10: Detect Sensor Data Manipulation 911 Objective This test demonstrates detection of atypical data reported to the historian. Description A sensor in the manufacturing system begins sending atypical data values to the historian Devices in the manufacturing system (HMI and PLCs ) are not validating sensor data. Security Capabilities and Products PI Server: Behavioral Anomaly Detection Test Procedures 1. A sensor sends invalid data to the historian. Expected Results The behavioral anomaly detection capability will detect atypical sensor data and generate alerts. Actual Test Results The behavioral anomaly detection tool is able to detect atypical data and create an event frame. Overall Result PASS 5.2.11 Scenario 11: Detect Unauthorized Firmware Modification 912 Objective This test demonstrates detection of device firmware modification. Description An authorized user performs a c hange of the firmware on a NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 45 Security Capabilities and Products Build 1: Cisco VPN: Remote Access . ConsoleWorks : Remote Access , User , and Authorization . Tenable. ot: Anomaly Detection Firmware Modification 2: Dispel: Remote Access , User Authentication , and User Authorization . eyeInspect and ICSPatrol: Behavioral Anomaly Detection and Firmware Modification . Build 3: Cisco VPN: Remote Access. ConsoleWorks: Remote Access , User Authentication , and User Authorizatio n. Dragos: Behavioral Anomaly Detection and Firmware Modification . Build 4: Dispel: Remote Access , User Authentication , and User Authorization . Azure Defender for IoT: Behavioral Anomaly Detection and Firmware Modification . Test Procedures 1. Authorized remote user connects to manufacturing environment. 2. The user changes firmware on the PLC component. Expected Results The behavioral anomaly detection tool will identify the change to the PLC and generate an alert for review. Actual Test Resul ts The behavioral anomaly tool is able to detect and generate alerts for update s to PLC component firmware. Overall Result PASS DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 46 5.3 Scenarios and Findings 913 One aspect of our security evaluation involved assessing how well the reference design addresses the 914 security characteristics that it was intended to support. The NIST Cybersecurity Framework 915 Subcategories were used to provide structure to the security assessment by consulting the specific 916 sections of each standard that are cited in referenc e to a Subcategory. The cited sections provide 917 validation points that the example solution would be expected to exhibit. Using the NIST Cybersecurity 918 Framework Subcategories as a basis for organizing our analysis allowed us to systematically consider 919 how w ell the reference design supports the intended security characteristics. 920 5.3.1 PR.AC -1: Identities and credentials are issued, managed, verified, revoked, 921 and audited for authorized devices, users, and processes 922 This NIST Cybersecurity Framework Subcategory i s supported through the user authentication and user 923 authorization capabilities in addition to the native credential management capabilities associated with 924 the tools. In each of the systems, user accounts were issued, managed, verified, revoked, and audit ed. 925 5.3.2 PR.AC -3: Remote access is managed 926 This NIST Cybersecurity Framework Subcategory is supported by remote access tool s integrated with the 927 user authentication and authorization systems. Together, these tools provide a secure channel for an 928 authorized user to access the manufacturing environment from a remote location. These tools are 929 configurable to allow organizations to control who can remotely access the system, what the user can 930 access, and when access is allowed by a user. 931 5.3.3 PR.AC -4: Access perm issions and authorizations are managed, 932 incorporating the principles of least privilege and separation of duties 933 This NIST Cybersecurity Framework Subcategory is supported by the user authentication and user 934 authorization capabilities. These tools are used to grant access rights to each user and notify if 935 suspicious activity is detected. This includes granting access to maintenance personnel responsible for 936 certain sub -systems or components of the ICS environments while preventing them from accessing 937 other sub-systems or components. Suspicious activities include operations attempted by an 938 unauthorized user, restricted operations performed by an authenticated user who is not authorized to 939 perform the operations, and operations that are performed outside of th e designated time frame. 940 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 47 5.3.4 PR.AC -7: Users, devices, and other assets are authenticated (e.g., single - 941 factor, multi -factor) commensurate with the risk of the transaction (e.g., 942 individuals' security and privacy risks and other organizational risks) 943 This NIST Cybersecurity Framework Subcategory is supported through the user authentication and user 944 authorization capabilities in addition to the native credential management capabilities associated with 945 the tools. Based on the risk assessment of the lab, t he authentication and authorization systems used 946 user passwords as one factor to verify identity and grant access to the environment. To bolster security 947 in the environment, IP address es were used as a secondary factor to for remote access. 948 5.3.5 PR.DS -1: Data-at-rest is protected 949 This NIST Cybersecurity Framework Subcategory is supported using file integrity checking. For end 950 points, the file integrity tools alert when changes to local files are detected. For historian backups and 951 system program and configuration backups, data was stored on read only or write -once drives to 952 prevent data manipulation. 953 5.3.6 PR.DS -6: Integrity checking mechanisms are used to verify software, 954 firmware, and information integrity 955 This NIST Cybersecurity Framework Subcategory is supported through file integrity checking tools and 956 the behav ioral anomaly detection tools. The file integrity checking tools monitor the information on the 957 manufacturing end points for changes. The behavioral anomaly detection tools monitor the 958 environments for changes made to software, firmware , and validate senso r and actuator information. 959 5.3.7 PR.IP -4: Backups of information are conducted, maintained, and tested 960 This NIST Cybersecurity Framework Subcategory is supported by f ile integrity checking using secure 961 storage to protect backup data. System configuration se ttings, PLC logic files, and historian databases all 962 have backups stored on secure storage disks. The secure storage is constructed in a way that prohibits 963 modifying or deleting data that is on the disk. 964 5.3.8 PR.MA -1: Maintenance and repair of organizational assets are performed 965 and logged, with approved and controlled tools 966 This NIST Cybersecurity Framework Subcategory is supported by a combination of tools including 967 application allowlisting, the user authentication and user authorization tools , and the behavior anomaly 968 detection tools. User authentication and user authorization tools provide a controlled environment for 969 authorized users to interact with the manufacturing environment. Behavior anomaly detection tools 970 provide a means to detect ma intenance activities in the environment such as PLC logic modification or 971 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 48 PLC firmware updates via the network. This information can be combined with data from a 972 computerized maintenance management system to ensure that all maintenance activities are 973 appro priately approved and logged. Also, application allowlisting prevents unapproved software from 974 running on systems to ensure that only approved tools are used for maintenance activities. 975 5.3.9 PR.MA -2: Remote maintenance of organizational assets is approved, 976 logged, and performed in a manner that prevents unauthorized access 977 This NIST Cybersecurity Framework Subcategory is supported by the remote access capability integrated 978 with the user authentication and user authorization system. The tools in the solution were used to grant 979 access for performing remote maintenance on specific assets. The tools prevent unauthorized users 980 from gaining access to the manufacturing environment. 981 5.3.10 DE.AE -1: A baseline of network operations and expected data flows for 982 users and s ystems is established and managed 983 This NIST Cybersecurity Framework Subcategory is supported by behavior anomaly detection tools . 984 Network baselines were established and approved based on an understanding of normal operations and 985 data flows identified by th e behavior anomaly detection tools. 986 5.3.11 DE.AE -2: Detected events are analyzed to understand attack targets and 987 methods 988 This NIST Cybersecurity Framework Subcategory is supported by all the capabilities included in the 989 solutions. Logs of suspicious activiti es from the tools can be used by security managers and engineers to 990 understand what unusual activity has occurred in the manufacturing system. Analyzing these logs 991 provides a mechanism to determine what systems were accessed and what actions may have been 992 performed on them. Although not demonstrated in these solutions , an analytic engine would enhance 993 the detection capability of the solution. 994 5.3.12 DE.AE -3: Event data are collected and correlated from multiple sources and 995 sensors 996 This NIST Cybersecurity Frame work Subcategory is supported by all the capabilities included in the 997 solutions. Each tool detects different aspects of the scenarios from diverse perspectives. Although not 998 demonstrated in these solutions, a data aggregation and correlation tool such as a security information 999 and event management (SIEM) tool would enhance the detection capability of the solution. 1000 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 49 5.3.13 DE.CM -1: The network is monitored to detect 1001 events 1002 This NIST Cybersecurity Framework Subcategory by the b ehavioral anomaly detection and 1003 remote access capabilities used in the example solutions to monitor the manufacturing network to 1004 detect potential cybersecurity events. The behavioral anomaly detection tools monitor network 1005 communications at the external bo undary of the system and at key internal points within the network, 1006 along with user activities and traffic patterns , and compar e it to the established baseline. The remote 1007 access capabilities monitor the network communications at the external boundary of the system. This 1008 helps detect unauthorized local, network, and remote connections and identify unauthorized use of the 1009 manufacturing system. 1010 5.3.14 DE.CM -3: Personnel activity is monitored 1011 events 1012 This NIST Cybersecurity Framework Subcategory is supported by the authentication and authorization 1013 tools that allow for monitoring personnel activity while connected through these tools. Furth er, 1014 application allowlisting and file integrity checking tools provide the ability to monitor user actions on 1015 hosts. Additionally, behavioral anomaly detection tools monitor and record events associated with 1016 personnel actions traversing network traffic. Each tool provides a different perspective in monitoring 1017 personnel activity within the environment. The resulting alerts and logs from these tools can be 1018 monitored individually or collectively to support investigations for potential malicious or unauthorized 1019 activity within the environment. 1020 5.3.15 DE.CM -7: Monitoring for unauthorized personnel, connections, devices, 1021 and software is performed 1022 This NIST Cybersecurity Framework Subcategory is supported by behavioral anomaly detection, 1023 application allowlisting , user authentication and user authorization, and remote access capabilities of 1024 the solutions. The behavioral anomaly detection tools established a baseline of information for 1025 approved assets and connections. Then the manufacturing network is monitored using the behavioral 1026 anomaly detection capability for any deviation by the assets and connections from the established 1027 baseline. If any deviation is detected, an alert is generated. Additionally, the application allowlisting tool 1028 blocks any unauthorized application installation or execution and generates an alert on these events. 1029 User authentication and user authorization tools monitor for unauthorized personnel connecting to the 1030 environment. Remote access capabilities monitor for unauthorized connections to the environment. 1031 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 50 6 Future Build Considerations 1032 This guide has presented technical solutions for maintaining and monitoring system and information 1033 integrity , which will help detect and prevent incidents in a manufacturing environment. Future builds 1034 should demonstr ate methods and techniques for fusing event and log data from multiple platforms into 1035 a security operations center (SOC) to improve monitoring and detection capabilities for an organization. 1036 Future builds should also demonstrate how to recover from a loss of system or information integrity 1037 such as a ransomware attack for ICS environments. 1038 Additionally, trends in manufacturing such as Industry 4.0 and the industrial IoT are increasing 1039 connectivity, increasing the attack surface, and increasing the potential for vulnerabilities. Future builds 1040 should consider how these advances can be securely integrated into manufacturing environments. 1041 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control Systems 51 Appendix A List of Acronyms 1042 AAL Application Allowlisting 1043 AD Active Directory 1044 BAD Anomaly Detection 1045 CRS Collaborative Robotic System 1046 CRADA Cooperative CSF NIST 1050 EL Engineering Laboratory 1051 FOIA Freedom of Information Act 1052 ICS Industrial Control System 1053 IoT Internet of Things 1054 IT Information Technology 1055 KSA Knowledge, Skills and Abilities 1056 LAN Local Area Network 1057 NCCoE National Cybersecurity Center of Excellence 1058 NFS Network File Share 1059 NIST National Institute of Standards and Technology 1060 NISTIR NIST Interagency or Internal Report 1061 NTP Network Time Protocol 1062 OT Operational Technology 1063 PCS Process Control System 1064 PLC Programmable Logic Controller 1065 SCADA Supervisory Control and Data Acquisition 1066 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 52 SIEM Security Information and Event Management 1067 SMB Server Message Block 1068 SOC Security Operations Center 1069 SP Special Publicat ion 1070 SRP Software Restriction Policies 1072 VDI Virtual Desktop Interface 1073 VLAN Virtual Local Area Network 1074 VPN Virtual Private Network 1075 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control Systems 53 Appendix B Glossary 1076 Access Control The process of granting or denying specific requests to: 1) obtain and use information and related information processing services; and 2) enter specific physical facilities (e.g., federal buildings, military establishments, border crossing entrances) . SOURCE: Federal Information Processing Standard (FIPS) 201; CNSSI -4009 Architecture A highly structured specification of an acceptable approach within a framework for solving a specific problem. An architecture contains descriptions of all the components of a selected, acceptable solution while allowing certain details of specific components to be variable to satisfy related constraints (e.g., costs, local environment, user acceptability). SOURCE: FIPS 201 -2 Authentication Verifying the identity of a user, process, or device, often as a prerequisite t o allowing access to resources in an information system. SOURCE: FIPS 200 Authorization The right or a permission that is granted to a system entity to access a system resource. SOURCE: NIST SP 800 -82 Rev. 2 Backup A copy of files and programs made to facilitate recovery if necessary . SOURCE: NIST SP 800 -34 Rev. 1 Continuous Monitoring Maintaining ongoing awareness to support organizational risk decisions . SOURCE: NIST SP 800 -137 CRADA Collaborative SP 1800- 5c DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 54 Cybersecurity Prevention of damage to, protection of, and restoration of computers, electronic communications systems, electronic communications services, wire communication, and electronic communication, including information contained therein, to ensure its availability, integrity, authentication, confidentiality, and nonrepudiation. SOURCE: CNSSI 4009 via cybersp ace, targeting an enterprise's use of cyberspace for the purpose of disrupting, disabling, destroying, or maliciously controlling a computing environment/infrastructure; or destroying the integrity of the data or stealing controlled information. SOURCE: NIST SP 800 -30 Rev. 1 Data A subset of information in an electronic format that allows it to be retrieved or transmitted . SOURCE: CNSSI -4009 Data Integrity The property that data has not been changed, destroyed, or lost in an unauthorized or accidental manner . SOURCE: CNSSI -4009 File Integrity Checking Software that generates, stores, and compares message digests for files to detect changes made to the files. SOURCE: NIST SP 800 -115 Firmware Computer programs and data stored in hardware - typically in read - only memory (ROM) or programmable read -only memory (PROM) - such that the programs and data cannot be dynamically written or modified during execution of the programs. SOURCE: CNSSI 4009 -2015 Industrial Control Systems An information system used to control industrial processes such as manufacturing, product handling, production, and distribution. SOURCE: NIST SP 800 -30 Rev. 1 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 55 Information Security The protection of information and information systems from unauthorized access, use, disclosure, disruption, modification, or destruction in order to provide confidentiality, integrity, and availability . SOURCE: FIPS 199 (44 U.S.C., Sec. 3542) Information System A discrete set of information resources organized for the collection, processing, maintenance, use, sharing, dissemination, or disposition of information . SOURCE: FIPS 200 (44 U.S.C., Sec. 3502) Information Technology Any equipment or interconnected system or subsystem of equipment that is used in the automatic acquisition, storage, manipulation, management, movement, control, display, switching, interchange, transmission, or reception of data or information by the executive agency. SOURCE: FIPS 200 Log A record of the events occurring within an organization's systems and networks . SOURCE: NIST SP 800 -92 Malware A program that is inserted into a system, usually covertly, with the intent of compromising the confidentiality, integrity, or availability of the victim's data , applications, or operating system . SOURCE: NIST SP 800 -111 Network Traffic Computer network communications that are carried over wired or wireless networks between hosts. SOURCE: NIST SP 800 -86 Operational Technology Programmable systems or devices that interact with the physical environment (or manage devices that interact with the physical environment). SOURCE: NIST SP 800 -37 Rev. 2 Privacy Assurance that the confidentiality of, and access to, certain information about an entity is protected . SOURCE: NIST SP 800 -130 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 56 Remote Access Access to an organizational information system by a user (or an information system) communicating through an external, non- organization- controlled network (e.g., the Internet). SOURCE: NIST SP 800 -128 under Remote Access from NIST SP 800-53 Risk The level of impact on organizational operations (including mission, functions, image, or reputation), organizational assets, or individuals resulting from the operation of an information system given the potential impact of a threat and the likelihood of that threat occurring. SOURCE: FIPS 200 Risk Assessment The process of identifying the risks to system security and determining the probability of occurrence, the resulting impact, and additional safeguards that would mitigate this impact. Part of Risk Management and synonymous with Risk Analysis . SOURCE: NIST SP 800 -63-2 Risk Management Framework The Risk Management Framework (RMF), presented in NIST SP 800-37, provides a disciplined and structured process that integrates information security and risk management activities into the system development life cycle. SOURCE: NIST SP 800 -82 Rev. 2 (NIST SP 800 -37) Security Control A protection measure for a system SOURCE: NIST SP 800-123 Virtual Machine Software that allows a single host to run one or more guest operating systems SOURCE: NIST SP 800 -115 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control Systems 57 Appendix C References 1077 [1] C. Singleton et al., -167. of Homeland Security, Framework 1082 Implementation Guidance, J. McCarthy Industrial Control Systems: Behavioral Anomaly 1091 Detection, NIST Security and Privacy Controls for Federal Information Systems and Organizations, NIST SP 800 -53 1098 Revision https://doi.org/10.6028/NIST.SP.800- 53r5 . 1099 [10] W. Newhouse et al., National Initiative for Cybersecurity Education (NICE) Cybersecurity 1100 Workforce Framework, Identifying and Protecting Assets Against Ransomware and 1103 Other Destructive Events, NIST Special Protecting Information and System Integrity in Industrial Control System Environments 58 [13] U.S.-Canada Power Systems Outage Task Force, Final Report on the August 14, 2003 Blackout in 1108 the United States and Canada: Available: 1109 https://www.energy.gov/sites/default/files/oeprod/DocumentsandMedia/Outage_Task_Force_ 1110 -_DRAFT_Report_on_Implementation.pdf 1111 [14] K. Stouffer et al., Guide to Industrial Control Systems (IC S) Security , NIST SP 800 -82 Revision \"A Plant -wide Industrial Problem Process,\" Comput. Chem. Eng., 1115 17, no. 3, 245- 255. 1116 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control Systems 59 Appendix D Scenario Execution Results 1117 The following section provides details regarding the execution and results from each scenario. Details 1118 such as usernames , filenames, IP addresses , etc. are specific to the NCCoE lab environment and are 1119 provided for reference only . 1120 D.1 Executing Scenario 1: Protect Host from Malware via USB 1121 An authorized user insert s a USB storage devic e contain ing a malware file (1.exe ) into a system in the 1122 manufacturing environment (e.g., an engineering workstation) . After insert ion, the malware file (1.exe) 1123 attempts to execute. The expected outcome is that the application allowlisting technology blocks the 1124 execution of the file. 1125 D.1.1 Build 1 1126 Configuration 1127 Application Allowlisting : Carbon Black 1128 Agent installed on an HMI Workstation and configured to communicate to the Carbon 1129 Black Server . 1130 D.1.1.2 Test Results 1131 Carbon Black successfully detects and blocks the malware (1.exe) from running as shown in Figure D -1. 1132 Figure D -2 shows Carbon Black's server log. The log provides more detail on the activity detected by 1133 Carbon Black. 1134 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 60 Figure D -1: An Alert from Carbon Black Showing that Malware (1.exe) was Blocked from Executing 1135 Figure D -2: Carbon Black's Server Provides Additional Details and Logs of the Event 1136 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 61 Figure D -3: Carbon Black's Server Log of the Event 1137 D.1.2 HMI Workstation . 1141 D.1.2.2 Test Results 1142 The execution of 1.exe is blocked successfully when Windows SRP is enforced as shown in Figure D -4. 1143 Figure D -4: Windows 7 Alert as a Result of Windows SRP Blocking the Execution of 1.exe 1144 D.1.3 Workstation . 1148 D.1.3.2 Test Results 1149 For Build 3, Windows SRP application allowlisting is enabled in the Collaborative Robotics environment. 1150 Figure D -5 shows that the executable is blocked on the CRS workstation. 1151 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 62 Figure D -5: Windows 10 Alert as a Result of Windows SRP Blocking the Execution of 1.exe 1152 D.1.4 Build 4 : Carbon Black 1155 Agent installed on Engineering Workstation and configured to communicate to the Carbon 1156 Black Server . 1157 D.1.4.2 Test Results 1158 Carbon Black successfully detects and blocks the malicious file as shown by the Carbon Black notification 1159 in Figure D -6. 1160 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 63 Figure D -6: Carbon Black Blocks the Execution of 1.exe for Build 4 1161 D.2 Execu ting Scenario 2: Protect Host from Malware via Network Vector 1162 An attacker who has already gained access to the corporate network attempts to pivot into the ICS 1163 environment through the DMZ. From a system in the DMZ, the attacker scans for vulnerable systems in 1164 the Testbed LAN environment to continue pivoting toward the ICS environments. In an attempt to 1165 establish a persistent connection into the ICS environment, the malicious file (1.exe) is copied to a 1166 system in the Testbed LAN environment and executed. The expected outcome is that the malicious file is 1167 blocked by the application allowlisting tool, and the RDP and scanning network activity is observed by 1168 the behavioral anomaly detection tool. 1169 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 64 D.2.1 Build 1 1170 D.2.1.1 Configuration 1171 Application Allowlisting : Carbon Black 1172 Agent installed on systems in the DMZ, Testbed LAN, and PCS VLAN 1 and 2 and configured 1173 to communicate to the Carbon Black Server. 1174 Behavior Anomaly Detection: Tenable. ot 1175 Configured to receive packet streams from DMZ, Testbed LAN, and PCS VLAN 1 and 2 . 1176 D.2.1.2 Test Results 1177 Abnormal network traffic is detected by Tenable.ot as shown in Figure D -7. Figure D -8 shows the initial 1178 RDP connection between an external system and the DMZ system, and Figure D -9 provides more detail 1179 of the session activity. Figure D -10 show that Tenable.ot detected VNC connection between the DMZ 1180 and the Testbed LAN . Figure D -11 show s a detected ports scan performed by the DMZ system target at a 1181 system in the Testbed LAN . Tenable.ot detected the RDP scan from the DMZ to the NESS US VM in the 1182 Testbed LAN , as shown in Figure D -12, and Figure D -13 provides more details on that detected event. 1183 The execution of the malware (1.exe) is blocked by Carbon Black agent as shown in Figure D -14. 1184 Figure D -7: Tenable.ot Dashboard Sho wing the Events that were Detected 1185 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 65 Figure D -8: Detected RDP Session Activity from External System to DMZ System 1186 Figure D -9: Event Detection Detail for the RDP Connection from the External System to the Historian in 1187 the DMZ 1188 Figure D -10: Tenable.ot Detected LAN 1189 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 66 Figure D -11: Tenable.ot Event Detail for a Detected Port Scan from a DMZ System Targeting a System in 1190 the Testbed LAN 1191 Figure D -12: Detected RDP from a DMZ system to a Testbed LAN system 1192 Figure D -13: Tenable.ot Event Detail Showing the RDP Connection Between the Historian in the DMZ 1193 to a Workstation in the Testbed LAN 1194 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 67 Figure D -14: Attempt to Execute 1.exe Failed 1195 D.2.2 SRP are applied to systems in the DMZ, Testbed LAN, and PCS VLAN 1 and 1199 2. 1200 Behavior Anomaly Detection: eyeInspect 1201 Configured to receive packet streams from DMZ, Testbed LAN, and PCS VLAN 1 and 2 . 1202 D.2.2.2 Test Results 1203 Figure D -15 shows the RDP alert for connection into the DMZ while Figure D -16 shows the details of the 1204 alert. Figure D -17 shows a collection of suspicious activity detected by Forescout eyeInspec t when 1205 scanning and an RDP connection is executed. Figure D -18 and Figure D -19 show details of a port 1206 scanning alert and the second RDP connection into the manufacturing environment, respectively. The 1207 attempt to execute malware (1. exe) is blocked by Windows SRP as shown in Figure D -20. 1208 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 68 Figure D -15: Alert Dashboard Showing Detection of an RDP Session 1209 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 69 Figure D -16: Details of the Detected RDP Session Activity from an External Syste m to DMZ System 1210 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 70 Figure D -17: Detection of Scanning Traffic and RDP Connection into Manufacturing Environment 1211 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 71 Figure D -18: Details of One of the Port Scan Alerts 1212 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 72 Figure D -19: Details of Alert for RDP Connection into Manufacturing Environment 1213 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 73 Figure D -20: Dialog Message Showing 1.exe was Blocked from Executing 1214 Build 3 Windows SRP policies are applied to systems in the DMZ, Testbed LAN, and Supervisory LAN 1218 Behavior Anomaly Detection: 1219 Configured to receive packet streams from DMZ, Testbed LAN, Supervisory LAN, and 1220 Control LAN . 1221 D.2.3.2 Test Results 1222 Windows SRP blocks the attempted execution of 1.exe ( Figure D -21). Figure D -22 shows the alerts 1223 generated by Dragos when it detected the remote connection to the target. Figure D -23 depicts the 1224 detected RDP session from an external system to the DMZ system. Figure D -24 depicts network scanning 1225 alert details. Figure D -25 depicts the RDP session from a DMZ system to the Testbed LAN system. 1226 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 74 Figure D -21: Windows SRP blocked 1.exe From Executing 1227 Figure D -22: Log of Alerts Detected by Dragos 1228 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 75 Figure D -23: Detail of RDP Session Activity Between an External System and a DMZ System 1229 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 76 Figure D -24: Detail for Network Scanning Alert 1230 Figure D -25: Detail of RDP Session Activity Between a DMZ System and a Testbed LAN System 1231 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 77 D.2.4 Build 4 1232 D.2.4.1 installed on systems in the DMZ, Testbed LAN, and Supervisory LAN and configured 1235 to communicate to the Carbon Black Server. 1236 Behavior Anomaly Detection: Azure Defender for IoT 1237 Configured to receive packet streams from DMZ, Testbed LAN, Supervisory LAN, and 1238 Control LAN . 1239 D.2.4.2 Test Results 1240 Azure Defender for IoT is able to detect the remote access connection to the DMZ as seen in Figure D - 1241 26. Figure D -27 shows detection of scanning activity , while Figure D -28 shows details of the scan. The 1242 RDP connection into the manufacturing environment is seen in Figure D -29. Carbon Black blocks 1.exe 1243 from executing as shown in Figure D -30. 1244 Figure D -26: Azure Defender for IoT \"info \" Event Identified the Remote Access Connection to the DMZ 1245 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 78 Figure D -27: Alert for Scanning Activity 1246 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 79 Figure D -28: Details for the Scanning Alert 1247 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 80 Figure D -29: Detection of RDP Connection into the Manufacturing Environment 1248 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 81 Figure D -30: Carbon Black Shows an Alert for Blocking File 1.exe 1249 D.3 Executing Sce nario 3: Protect Host from Malware via Remote Access 1250 Connections 1251 An authorized user with an authorized remote workstation, infected with a worm -type malware , 1252 connects via remote access capabilities to the manufacturing environments. The malware on the remote 1253 host attempts to scan the manufacturing environment to identify vulnerable hosts. The expected result 1254 is that the remote access tools effectively stop the worm -type malicious code from propagating to the 1255 manufacturing environment from the infected remote workstation. 1256 D.3.1 Build 1 1257 D.3.1.1 Configuration 1258 VPN 1259 Configured to allow authorized VPN users to access to ConsoleWorks web interface. 1260 Authorization: ConsoleWorks 1261 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 82 Configured for access PCS environment. 1262 D.3.1.2 Test Results 1263 Figure D -31 shows the remote connection being established through the Cisco AnyConnect VPN 1264 application through which a browser is used to access the ConsoleWorks web interface ( Figure D -32). 1265 Once a connection to ConsoleWorks was established, the simulated worm attack was executed on the 1266 remote PC to scan the target network. The scan was successfully blocked by the VPN configuration. 1267 Figure D -31: Secured VPN Connection to with Cisco AnyConnect 1268 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 83 Figure D -32: Remote Access is Being Established Through ConsoleWorks 1269 D.3.2 Build 2 1270 D.3.2.1 Configuration User Authentication/User Authorization: Dispel 1272 Dispel VDI is configured to allow authorized users to access PCS environment through the 1273 Dispel Enclave to the Dispel Wicket . 1274 D.3.2.2 Test Results 1275 The user connects to the Dispel VDI as shown in Figure D -33 and then connects to the PCS workstation 1276 as shown in Figure D -34. Once a connection to the NCCOE environment was established, the simulated 1277 worm attack was executed on the remote PC to scan the target network. The scan was successfully 1278 blocked by the Dispel VDI configuration. 1279 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 84 Figure D -33: Dispel VDI with Interface for Connecting Through Dispel Enclave to Dispel Wicket ESI 1280 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 85 Figure D -34: Nested RDP Session Showing Dispel Connection into the PCS Workstation 1281 D.3.3 Build 3 1282 D.3.3.1 Configuration 1283 VPN 1284 Configured to allow authorized VPN users to access ConsoleWorks web interface. 1285 User Authentication/User Authorization: ConsoleWorks 1286 access 1287 D.3.3.2 Test Results 1288 Figure D -35 shows the remote connection being establi shed through the Cisco AnyConnect VPN 1289 application , where a browser is used to access the ConsoleWorks web interface ( Figure D -36). Once a 1290 connection to ConsoleWorks was established, the simulated worm attack was executed on the remote 1291 PC to scan the target network. The scan was successfully blocked by the VPN configuration. 1292 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 86 Figure D -35: VPN Connection to Manufacturing Environment 1293 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 87 Figure D-36: Remote Access is Being Established Through ConsoleWorks 1294 D.3.4 Build 4 1295 Authentication/User Authorization: Dispel 1297 Dispel VDI is configured to allow authorized users to access the PCS environment through 1298 the Dispel Enclave to the Dispel Wicket. 1299 D.3.4.2 Test Results 1300 Figure D -37 shows the Dispel VDI desktop , which allows a connection to the CRS workstation in 1301 Figure D -38. Once a connection to the NCCOE environment was established, the simulated worm attack 1302 was executed on the remote PC to scan the target network. The scan was successfully blocked by the 1303 use of the Dispel VDI. 1304 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 88 Figure D -37: Dispel VDI Showing Interface for Connecting Through Dispel Enclave to Dispel Wicket 1305 Figure D -38: Nested RDP Session Showing Dispel Connection into the CRS Workstation 1306 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 89 D.4 Executing Scenario 4: Protect Host from Unauthorized Application 1307 Install ation 1308 An authorized user copies downloaded software installation files and executable files from a shared 1309 network drive to a workstation. The user attempts to execute or install the un authorized software on 1310 the workstation. The expected result is that the application allowlisting tool prevents execution or 1311 installation of the software. Also, the behavioral anomaly detection identifies file transfer activity in the 1312 manufacturing environment. 1313 D.4.1 Build 1 1314 Application Allowlisting : Carbon Black 1316 Agent installed on systems in the DMZ, Testbed LAN, and PCS VLAN 1 and 2 and configured 1317 to communicate to the Carbon Black Server. 1318 Behavior Anomaly Detection: Tenable. ot 1319 Configured to receive packet streams from DMZ, Testbed LAN, and PCS VLAN 1 and 2 . 1320 D.4.1.2 Test Results 1321 As shown in Figure D -39, Carbon black is able to block and alert on the e xecution of putty.exe. 1322 Tenable.ot is able to detect the server message block ( SMB ) connection between an HMI in the Testbed 1323 LAN and the GreenTec server ( Figure D -40). Details of that alert are shown in Figure D -41. 1324 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 90 Figure D -39: Carbon Black Blocks the Execution of putty.exe and Other Files 1325 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 91 Figure D -40: Tenable.ot alert Showing the SMB Connection Between the HMI and the GreenTec Server 1326 Figure D -41: Tenable .ot Alert Details of the SMB Connection Between the HMI and the network file 1327 system ( NFS) Server in SRP are applied to systems in the DMZ, Testbed LAN, and PCS VLAN Behavior Anomaly Detection: Configured to packet streams from DMZ, Testbed LAN, and PCS VLAN 1 and 2 . 1335 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 92 D.4.2.2 Test Results 1336 With Windows SRP enabled , putty.exe is not allowed to execute because it is not a permitted 1337 application under group policy , as shown i n Figure D -42. Windows SRP also blocks the user's attempt to -0.74- installer.msi. ( D -43). Forescout detected the file transfer activity ( Figure D - 1339 44). Figure D-45 shows a detailed description of the alert that was generate for the file transfer activity. 1340 Figure D -42: Putty.exe is Not Permitted to Run Based on the Windows SRP Configuration 1341 Figure D -43: putty -64bit DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 93 Figure D -44: Forescout Alert on the File Transfer Acti vity 1343 Figure D -45: Forescout Alert Details for File Transfer Activity 1344 D.4.3 Build 3 1345 D.4.3.1 Configuration 1346 Application Allowlisting : Windows SRP 1347 Settings are applied to systems in the DMZ, Testbed LAN, and Supervisory LAN 1348 Behavior Anomaly Detection: 1349 Configured to receive packet streams from DMZ, Testbed LAN, Supervisory LAN, and 1350 Contro l LAN . 1351 D.4.3.2 Test Results 1352 With Windows SRP enabled, putty.exe is not allowed to execute because it is not a permitted 1353 application under group policy , as shown in Figure D -46. Windows SRP also blocks the user's attempt to 1354 putty -64bit -0.74- installer.msi ( Figure D -47). Dragos detected the file transfer activity (Figure D -48). 1355 Figure D -49 shows a detailed description of the alert that was generate d for the file transfer activity. 1356 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 94 Figure D -46: Putty.exe is Not Permitted to Run Based on the Windows SRP Configuration 1357 Figure D -47: putty -64bit DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 95 Figure D -48: Dragos Alert on the File Transfer Activity 1359 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 96 Figure D -49: Dragos Alert Details of the File Transfer Alert 1360 D.4.4 Build 4 1361 D.4.4.1 Configuration 1362 Application Allowlisting : Carbon Black 1363 Agent installed on systems in the DMZ, Testbed LAN, and Supervisory LAN and configured 1364 to communicate to the Carbon Black Server. 1365 Behavior Anomaly Detection: Azure Defender for IoT 1366 Configured to receive packet streams from DMZ, Testbed LAN and Supervisory LAN, and 1367 Control LAN . 1368 D.4.4.2 Test Results 1369 Carbon Black was able to block the execution of putty.exe ( Figure D -50) and the installation of putty - 1370 64bit -0.74 -installer.msi (Figure D -51). Figure D -52 is the alert dashboard for Azure Defender for IoT that 1371 shows new activity has been detected. The detailed alert in Figure D -53 provides details of an RPC 1372 connection between the GreenTec server and the Testbed LAN. A timeline of events showing a file 1373 transfer has occurred is shown in Figure D -54. 1374 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 97 Figure D -50: Carbon Black Alert Showing that putty.exe is Blocked from Executing 1375 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 98 Figure D -51: Carbon Black Alert Showing the Execution of putty -64bit -0.74 -installer.msi Being Blocked 1376 Figure D -52: Azure Defender for IoT Alert Dashboard Showing Detection of a New Activity 1377 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 99 Figure D -53: Azure Defender for IoT Alert Details Showing RPC Connection Between the DMZ and the 1378 Testbed LAN 1379 Figure D-54: Azure Defender for IoT Event Alert Timeline Showing the File Transfer 1380 D.5 Executing Scenario 5: Protect from Unauthorized Addition of a Device 1381 An authorized individual with physical access connects an unauthorized device on the manufacturing 1382 network and then uses it to connect to devices and scan the network. T he expected result is behavioral 1383 anomaly detection identifies the unauthorized device. 1384 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 100 D.5.1 Build 1 1385 D.5.1.1 Configuration 1386 Behavior Anomaly Detection: to receive packet streams from DMZ, Testbed LAN, and PCS VLAN 1 and 2 . 1388 D.5.1.2 Test Results 1389 Tenable.ot detects and alerts on the addition of a device to the environment. Figure D -55 shows an 1390 event reported by Tenable.ot when a device was connected to the wireless access point in the 1391 manufacturing environment. Tenable.ot also d etects other activity from the device, as shown in Figure 1392 D-56, in which the new device tries to establish a secure shell ( SSH) connection to the network switch. 1393 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 101 Figure D -55: Tenable.ot Event Showing a New Asset has Been Discovered 1394 Figure D -56: Tenable.ot Event Showing Unauthorized packet streams from DMZ, Testbed LAN, and PCS VLAN 1 and 2. 1399 D.5.2.2 Test Results 1400 Forescout detects when an unauthorized device connects to a wireless access point in the 1401 manufacturing environment. Figure D -57 shows that Forescout raises an alert on the DNS request from 1402 the wireless access point to the gateway. The device establishes an SSH connection , which is detected by 1403 Forescout as shown in Figure D -58. A more detailed view of the alert is shown in Figure D -59. 1404 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 102 Figure D -57: Forescout Alert on the DNS Request from the New Device 1405 Figure D -58: Forescout alert showing the SSH connection 1406 Figu re D -59: Detailed Forescout alert Connection receive packet streams from DMZ, Testbed LAN, Supervisory LAN, and 1411 Control LAN . 1412 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 103 D.5.3.2 Test Results 1413 Dragos detected the traffic generated by the new asset and generated several alerts as seen in the list of 1414 alerts in Figure D -60. Details of different aspects of the network scanning can be seen in Figure D -61 and 1415 Figure D -62. Details on the new device can also be seen in Figure D -63. 1416 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 104 Figure D -60: Dragos Dashboard Showing Alerts Generated upon Detecting New Device and Network 1417 Scanning 1418 Figure D -61: Details of Network Scanning Activity 1419 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 105 Figure D -62: Additional Details of Network Scanning Activity 1420 Figure D -63: Alert for New Asset on the Network 1421 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 106 D.5.4 Build 4 1422 D.5.4.1 Configuration 1423 Behavior Anomaly Detection: Azure Defender for IoT 1424 Configured to receive packet streams from DMZ, Testbed LAN, Supervisory LAN, and 1425 Control LAN . 1426 D.5.4.2 Test Results 1427 A \"New Asset Detected\" alert is shown on Azure Defender for IoT dashboard ( Figure D -64) and on t he 1428 Alert screen ( Figure D -65). Figure D -66 shows the alert management options in Azure Defender for IoT. 1429 The details of the network scanning alert are shown in Figure D -67. 1430 Figure D -64: Azure Defender for IoT Dashboard Showing the Alerts , Including for the New Asset 1431 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 107 Figure D -65: Azure Defender for IoT Detects New Asset in the Environment 1432 Figure D -66: Azure Defender for IoT Alert Management Options 1433 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 108 Figure D -67: Details for Network Scanning Alert 1434 D.6 Executing Scenario 6: Detect Unauthorized Device -to-Device 1435 Communications 1436 An authorized device that is installed on the network attempts to establish an unapproved connection 1437 not recorded in the baseline. T he expected result is the b ehavioral anomaly detection products alert on 1438 the non -baseline traffic. 1439 receive strea ms from DMZ, Testbed LAN, and PCS VLAN 2 . 1443 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 109 D.6.1.2 Test Results 1444 The unapproved SSH traffic is detected by Tenable.ot as shown in Figure D -68. 1445 Figure D -68: Tenable.ot Event Log Showing Traffic packet streams from DMZ, Testbed LAN, and PCS VLAN 1 and 2 . 1450 D.6.2.2 Test Results 1451 SSH communication from HMI computer to the network switch is not defined in the baseline ; Forescout 1452 flags this communication as shown in Figure D -69. 1453 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 110 Figure D -69: Forescout Alert Showing the Unapproved SSH Traffic receive packet streams from DMZ, Testbed LAN, Supervisory LAN, and 1458 Control LAN . Test Results 1460 Dragos detected the non SSH traffic as shown Figure D -70. 1461 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 111 Figure D -70: Dragos Alert Showing the Unapproved SSH Connection Between Devices Build 4 1463 D.6.4.1 1464 Behavior Anomaly Detection: Azure Defender for IoT 1465 Configured to receive packet streams from DMZ, Testbed LAN, Supervisory LAN, and 1466 Control LAN . 1467 D.6.4.2 Test Results 1468 A device attempts to establish a remote access connection via SSH. Azure Defender for IoT was able to 1469 detect this activity as shown in Figure D -71. 1470 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 112 Figure D -71: Azure Defender for IoT Event Identified the Unauthorized SSH Connection 1471 D.7 Executing Scenario 7: Prote ct from Unauthorized Deletion of Files 1472 An authorized user attempts to delete files on an engineering workstation and a shared network drive 1473 within the manufacturing system. The expected result is the file integrity checking tools in the 1474 environment alert on the deletion or prevent deletion entirely. 1475 D.7.1 Build 1 1476 D.7.1.1 Configuration 1477 File Carbon Black 1478 Agent installed on w orkstation s and configured to communicate to the Carbon Black 1479 Server . 1480 File Integrity Checking : WORMdisk 1481 Network file share on server is configured to use WORMdisk. 1482 D.7.1.2 Test Results 1483 Carbon Black reports file deleting activities as shown in Figure D -72. GreenTec protects the files on its 1484 drive from being deleted. 1485 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 113 Figure D -72 Event Messages from Carbon Black Showing File Deletion Attempts 1486 D.7.2 Build 2 1487 D.7.2.1 Configuration 1488 File Integrity Checking: Security Onion 1489 The a gent is installed on workstation s and configured to communicate to the Security 1490 Onion Server . 1491 File Integrity Checking: WORMdisk 1492 Network file share server is configured to use WORMdisk . 1493 D.7.2.2 Test Results 1494 Security Onion Wazuh alerts on file deletion as shown in Figure D -73. Files stored on a storage drive 1495 protected by GreenTec are protected from deletion . 1496 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 114 Figure D -73: Security Onion Wazuh Alert Showing a File Has Been Deleted 1497 D.7.3 Build 3 1498 D.7.3.1 Configuratio n 1499 File Checking: Security Onion 1500 Agent installed on w orkstation s and configured to communicate to the Security Onion 1501 Server . 1502 File Integrity Checking: WORMdisk 1503 Network file share server is configured to use WORMdisk . 1504 D.7.3.2 Test Results 1505 Security Onion Wazuh detected the deletion of the files as shown in the Security Onion Server log in 1506 Figure D -74. Files stored on a storage drive protected by GreenTec are protected from deletion . 1507 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 115 Figure D -74: Alert from Security Onion for a File Deletion 1508 D.7.4 Build 4 1509 D.7.4.1 Configuration 1510 File Carbon Black 1511 Agent installed on w orkstation s and configured to communicate to the Carbon Black 1512 Server . 1513 File Integrity Checking: WORMdisk 1514 Network file share server is configured to use WORMdisk . 1515 D.7.4.2 Test Results 1516 The attempts to delete a file are detected by Carbon Black as shown in Figure D -75. Files stored on a 1517 storage drive protected by GreenTec are protected from deletion . 1518 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 116 Figure D -75: Carbon Black Alerts Showing That a File Has Been Deleted 1519 D.8 Executing Scenario 8: Detect Unauthorized Modification of PLC Logic 1520 An authorized user performs an unapproved or unauthorized modification of the PLC logic through the 1521 secure remote access tools. The expected result is the behavioral anomaly detection tools will detect 1522 and capture the activity, flag ging it for review. 1523 The behavior anomaly detection tools can detect program downloads to the PLC. Program download 1524 detection needs to be correlated with the maintenance management system to determine if the 1525 downl oad was authorized and approved. This was not demonstrated as part of this scenario. 1526 D.8.1 Build 1 to receive packet streams from DMZ, Testbed LAN, and PCS VLAN 1 and 2 . 1530 Remote Access: Cisco VPN 1531 Configured to allow authorized VPN users to access ConsoleWorks web interface. 1532 User Authentication/User Authorization: ConsoleWorks 1533 Configured accessing the PCS environment 1534 D.8.1.2 Test Results 1535 In this build, a remote session Studio 5000 Logix Designer is established to perform PLC file operations as 1536 shown in Figure D -76 and Figure D -77. Tenable.ot is able to detect the PLC file modifica tions as shown in 1537 Figure D -78 with details shown in Figure D -79 and Figure D -80. 1538 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 117 Figure D -76: Remote Access to Systems in PCS Network is Being Established Through ConsoleWorks 1539 Figure D -77: Remote Session into Studio 5000 to Perform PLC File Operations 1540 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 118 Figure D -78: Tenable.ot Detected the Transfer of PLC Logic File to the Rockwell PLC 1541 Figure D -79: Tenable.ot PLC Stop alert details 1542 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 119 Figure D -80: Tenable.ot PLC Program Download Alert Details 1543 packet streams from DMZ, Testbed LAN, and PCS VLAN 1 and 2. 1547 Remote Access, User Authentication/User Authorization: Dispel 1548 Dispel VDI is configured to allow authorized users to access PCS enviro nment through the 1549 Dispel Enclave to the Dispel Wicket . 1550 D.8.2.2 Test Results 1551 As shown in Figure D -81 the authorized user establishes a session into the manufacturing environment 1552 using the Dispel VDI. The user connects to the engine ering workstation and launches the Studio 5000 1553 Logix Designer as shown in Figure D -82 to modify the PLC logic. Figure D -83, Figure D -84 and Figure D -85 1554 show that Forescout is able to detect the traffic between the engineering workstation and the PLC , 1555 including details of the Stop command and Download command. 1556 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 120 Figure D -81: Remote Access to Systems in PCS Network is Being Established Through Dispel 1557 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 121 Figure D -82: Modifying the Parameters for the Allen -Bradley PLC Controller Using Studio 5000 1558 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 122 Figure D -83: Forescout Alerts Showing It Detected the Traffic Between the Engineering Workstation 1559 and the PLC 1560 Figure D -84: Forescout Alert De tails for the Stop Command Issued to the PLC 1561 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 123 Figure D -85: Forescout Alert Details for the Configuration Download Command 1562 receive packet streams from DMZ, Testbed LAN, Supervisory LAN, and 1566 Control LAN . 1567 Remote Access: Cisco VPN 1568 Configured to allow authorized VPN users to access ConsoleWorks web interface. 1569 User Authentication/User Authorization: ConsoleWorks 1570 Configured accessing the CRS environment. 1571 D.8.3.2 Test Results 1572 In this build, a remote session to the CRS workstation is established to perform PLC file operations as 1573 shown in Figure D -86 and Figure D -87. Dragos is able to detect the PLC file modifications as shown in 1574 Figure D -88 with details shown in Figure D -89. 1575 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 124 Figure D -86: VPN Connection to the Manufacturing Environment 1576 Figure D -87: Remote Access is Being Established through ConsoleWorks 1577 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 125 Figure D -88: Dragos Notification Manager Showing Detect ion of the Transfer of PLC Logic File to the 1578 Beckhoff PLC 1579 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 126 Figure D -89: Dragos Alert Details for the PLC Logic File Download 1580 D.8.4 Build 4 1581 D.8.4.1 Configuration 1582 Behavior Anomaly Detection: Azure Defender for IoT 1583 Configured to receive packet streams from DMZ, Testbed LAN, Supervisory LAN, and 1584 Control LAN . Remote Access, User Authentication/User Authorization: Dispel 1586 Dispel VDI is configured to allow authorized users to access the PCS environment through 1587 the Dispel Enclave to the Dispel Wicket. 1588 D.8.4.2 Test Results 1589 Figure D -90 and Figure D -91 show the connection to the CRS environment through the Dispel VDI. The 1590 changes to the PLC program s are detected by Azure Defender for IoT, as shown in Figure D -92, because 1591 the Dispel VDI is not an authorized programming device. 1592 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 127 Figure D -90: Dispel VDI with Interface for Connecting Through Dispel Enclave to Dispel Wicket 1593 Figure D -91: Nested RDP Connections Showin g Dispel Connection into the CRS Workstation 1594 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 128 Figure D -92: Azure Defender for IoT Alert for the Unauthorized PLC Programming 1595 D.9 Executing Scenario 9: Protect from Modification of Historian Data 1596 An attacker who has already gained access to the corporate network attempts to modify historian 1597 archive data located in the DMZ. The expected result is the behavioral anomaly detection products 1598 detect the connection to the historian archive. File modification is prevented by the file integrity 1599 checking capability. 1600 D.9.1 Build 1 Behavior receive acket streams from DMZ, Testbed LAN, and PCS VLAN 2 . 1604 File Integrity Checking: ForceField 1605 PI Server . 1606 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 129 D.9.1.2 Test Results 1607 Figure D -93 shows Tenable.ot detecting the remote access connections. Figure D -94 shows that 1608 GreenTec successfully blocks the attacker from deleting archive data. 1609 Figure D -93: Tenable.ot alert Showing SMB Connection from an External Workstation to the Historian 1610 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 130 Figure D -94: GreenTec Denies Modification and Deletion File Operations in the Protected Drive 1611 D.9.2 Build 2 1612 D.9.2.1 Configuration 1613 Behavior Anomaly 1614 Configured to receive packet streams from DMZ, Testbed LAN, and PCS VLAN 1 and 2 . 1615 File Integrity Checking: ForceField 1616 PI to use ForceField drive . 1617 D.9.2.2 Test Results 1618 Forescout detects the remote session as shown in Figure D -95. When the user attempts to alter a file on 1619 the protected drive, GreenTec denies the operation as shown in Figure D -96. 1620 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 131 Figure D -95: Forescout Alert Showing Network Connection from the Corporate Network to the 1621 Historian 1622 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 132 Figure D -96: GreenTec Denies Modification and Deletion File Operations in the Protected Drive 1623 D.9.3 Build receive packet streams from DMZ, Testbed LAN, Supervisory LAN, and 1627 Control LAN . 1628 File Integrity Checking: ForceField 1629 D.9.3.2 Test Resul ts 1631 Dragos the remote session as shown in Figure D -97. When the user attempts to alter a file on 1632 the protected drive, GreenTec denies the operation as shown in Figure D -98. 1633 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 133 Figure D -97: Dragos Detection of RDP Session from an External Network to the Historian 1634 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 134 Figure D -98: GreenTec Denies Modification and Deletion File Operations in the Protected Drive 1635 D.9.4 Build 4 1636 D.9.4.1 Config Detection: Azure Defender for IoT 1638 Configured to receive packet streams from DMZ, Testbed LAN, Supervisory LAN, and 1639 Control LAN . 1640 File Integrity Checking: ForceField 1641 Server . 1642 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 135 D.9.4.2 Test Results 1643 The connection to the Historian data storage was detected by Azure Defender for IoT as shown in Figure 1644 D-99. Figure D -100 shows a Windows error message after attempting to overwrite protected H istorian 1645 files. 1646 Figure D-99: Azure Defender for IoT Event Timeline Showing the Remote Access Connection to the 1647 Historian 1648 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 136 Figure D -100: GreenTec Denies Modification and Deletion File Operations in the Protected Drive 1649 D.10 Executing Scenario 10: Detect Sensor Data Manipulation 1650 A sensor in the manufacturing system sends out -of-range data values to the Historian . The expected 1651 result is the behavioral anomaly detection (data historian) capability alerts on out -of-range data. 1652 D.10.1 All Builds Anomaly Detection: PI Server 1655 Configured to receive process data from across the manufacturing system . 1656 Configured to perform analysis on incoming data points. 1657 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 137 D.10.1.2 Test Results 1658 The Historian process monitoring capabilities provided by the PI System are able to monitor out-of- 1659 range sensor readings and generate alerts. Figure D -101 shows the PI Server's event frame alerts on the 1660 out-of-range reactor pressure readings in the PCS. 1661 Figure D -101: PI Server's Event Frames Showing Out-of-Range Sensor Readings for the Reactor 1662 Pressure 1663 D.11 Executing Scenario 11: Detect Unauthorized Firmware Modification 1664 An authorized user accesses the system remotely and performs an unauthorized change of the firmware 1665 on a PLC. The expected result is the behavioral anomaly detection tools will alert on the new firmware . 1666 The behavior anomaly detection tools can detect change s to the firmware. Firmware change detection 1667 needs to be correlated with the maintenance management system to determine if the firmware change 1668 was authorized and approved. This was not demonstrated as part of this scenario. 1669 D.11.1 Build 1 to receive packet streams from DMZ, Testbed LAN, and PCS VLAN 1 and 2 . 1673 Remote Access: Cisco VPN 1674 Configured to allow authorized VPN users access to ConsoleWorks web interface. 1675 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 138 User Authentication/User Authorization: ConsoleWorks 1676 Configured for accessing the PCS environment. 1677 D.11.1.2 Test Results 1678 Figure D -102 depicts the list of the events detected by Tenable.ot resulting from the firmware change. 1679 The details of one of the alerts are shown in Figure D -103 1680 Figure D -102: Tenable.ot Detects a Collection of Events Generated by a Firmware Change 1681 Figure D -103: Details for One of the Alerts Showing the Firmware C hange 1682 packet streams from DMZ, Testbed LAN, and PCS VLAN 1 and 2 . Remote Access, Dispel 1687 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 139 Dispel VDI is configured to allow authorized users to access the PCS environment through 1688 the Dispel Enclave to the Dispel Wicket. 1689 D.11.2.2 Test Results 1690 Figure D -104 shows the activit ies detected by Forescout as a result of firmware change. Figure D -104, 1691 Figure D -105 and Figure D -106 show more details on the alert s associated with the firmware update . 1692 Figure D -104: Forescout Detects a Collection of Alerts Associated with the Firmware Change 1693 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 140 Figure D -105: Alert Details Detected by Forescout for the Firmware Change 1694 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 141 Figure D -106: ICS Patrol Scan Results Showing a Change Configuration was Made 1695 D.11.3 Build 3 1696 D.11.3.1 Configuration 1697 VPN 1698 Configured to allow authorized VPN users to access only the ConsoleWorks web interface. 1699 User Authentication/User Authorization: ConsoleWorks 1700 Configured to allow remote access to hosts in manufact uring environment. 1701 Behavior Anomaly Detection: Dragos 1702 Configured to receive packet streams from DMZ, Testbed LAN, Supervisory LAN, and 1703 Control LAN . 1704 D.11.3.2 Test Results 1705 Dragos detects the change to the firmware as shown on the dashboard in Figure D -107 with details 1706 shown in Figure D -108. 1707 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 142 Figure D -107: Dragos Dashboard Showing an Alert for Firmware Change 1708 Figure D -108: Details for Firmware D.11.4.1 Behavior Anomaly Detection: Azure Defender for IoT 1712 Configured to receive packet streams from DMZ, Testbed LAN, Supervisory LAN, and 1713 Control LAN 1714 Remote Access , User Authentication/User Authorization : Dispel 1715 Dispel VDI is configured as the engineering workstation to connect through the Dispel 1716 Enclave to the Dispel Wicket to manage the Beckhoff PLC. 1717 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 143 D.11.4.2 Test Results 1718 Azure Defender for IoT alerts on the firmware update as shown below in Figure D -109. 1719 Figure D -109: Azure Defender for IoT Alert Showing a Version Mismatch in the Firmware Build 1720 DRAFT NIST SP 1800- 10B: Protecting Information and System Integrity in Industrial Control System Environments 144 Appendix E Benefits of IoT Cybersecurity Capabilities The National Institute of Standards and Technology's (NIST's) Cybersecurity for the Internet of Things (IoT) program support s development and application of standards, guidelines, and related tools to improve the cybersecurity of connected devices and the environments in which they are deployed. By collaborating with stakeholders across government, industry, international bodie s, and academia, the program aims to cultivate trust and foster an environment that enables innovation on a global scale. Cyber -physical components, includ ing sensors and actuators, are being designed, developed, deployed, and integrated into networks at an ever -increasing pace. Many of these components are connected to the internet. IoT devices combine network connectivity with the ability to sense or affect the physical world. Stakeholders face additional challenges with applying cybersecurity controls as cyber -physical devices are further integrated. NIST's Cybersecurity for IoT program has defined a set of device cybersecurity capabilities that device manufacturers should consider integrating into their IoT devices and that consumers should consider en abling/configuring in those devices. Device cybersecurity capabilities are cybersecurity features or functions that IoT devices or other system components (e.g., a gateway, proxy, IoT platform ) provide through technical means ( e.g., device hardware and software). Many IoT devices have limited processing and data storage capabilities and may not be able to provide these device cybersecurity capabilities on their own; they may rely on other system components to provide these technical capabilities on their be half. Nontechnical supporting capabilities are actions that a manufacturer or third -party organization performs in support of the cybersecurity of an IoT device. Examples of nontechnical support include providing information about software updates, instruc tions for configuration settings, and supply chain information. Used together, device cybersecurity capabilities and nontechnical supporting capabilities can help mitigate cybersecurity risks related to the use of IoT devices while assisting customers in achieving their goals. If IoT devices are integrated into industrial control system (ICS) environments, d evice cybersecurity capabilities and nontechnical supporting capabilities can assist in securing the ICS environment . E.1 Device Capabilities Mapping Table E -1 lists the device cybersecurity capabilities and nontechnical supporting capabilities as they map to the NIST Cybersecurity Framework Subcategories of particular importance to this project. It i s acknowledged that IoT devices vary in their capabilities, and there may not be a clear delineation between the device cybersecurity capabilities that are provided by the IoT devices and those provided by another system component. It is also understood th at the capabilities of cyber -physical components are evolving, so many of the mappings are not necessarily exact. In this project, the focus was on the engineering workstations and not on the manufacturing components. The mapping presented in Table E -1 is a summary of both technical and nontechnical capabilities that would enhance the security of a manufacturing environment. It is acknowledged that many of the device cybersecurity capabilities may not be available in modern sensors and actuators and that other system elements (e.g., proxies, gateways) or other risk mitigation strategies (e.g., network segmentation) may be necessary . DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 145 Table E-1: Mapping of D evice Cybersecurity Capabilities and N ontechnical Supporting Capabilities to NIST Cybersecurity Framework Subcategories of the ICS Project Cybersecurity Framework Subcategory Device Cybersecurity Capabilities Manufacturer NIST SP 800-53 Rev. 5 PR.AC -1: Identities and credentials are issued, managed, verified, revoked, and audited for authorized devices, users, and processes. Ability to uniquely identify the IoT device logically. Ability to uniquely identify a remote IoT device. Ability for the device to support a unique device ID . Ability to configure IoT device access control policies using IoT device identity . Ability to verify the identity of an IoT device . Ability to add a unique physic al identifier at an external or internal location on the device authorized entities can access . Ability to set and change authentication configurations, policies, and limitations settings for the IoT device. Ability to create unique IoT device user account s. Ability to identify unique IoT device user accounts . Ability to create organizationally defined accounts that support privileged roles with automated expiration conditions. Ability to establish organizationally defined user actions for accessing the IoT device and/or device interface. Ability to enable automation and reporting of account management activities. Ability to establish conditions for shared/group accounts on the IoT device. Ability to administer conditions f or shared/group accounts on the IoT device. Ability to restrict the use of shared/group accounts on the IoT device according to organizationally defined conditions. Providing details for how to establish unique identification for each IoT device associated with the system and critical system components within which it is used. Providing communications and documentation detailing how to perform account management activities, using the technical IoT device capabilities, or through supporting systems and/or tools. Providing the details necessary to establish and implement unique identification for each IoT device associated with the system and critical system components within which it is used. Providing the details necessary to require unique identif iers for each IoT device associated with the system and critical system components within which it is used. Providing education explaining how to establish and enforce approved authorizations for logical access to IoT device information and system resources. Providing education explaining how to control access to IoT devices implemented within IoT device customer information systems. Providing education explaining how to enforce authorized access at the system level. AC-2 IA-2 IA-4 . Ability to configure IoT device access control policies using IoT device identity. o Ability for the IoT device to differentiate between authorized and unauthorized remote users. N/A AC-17 AC-19 AC-20 DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 146 Cybersecurity Framework v1.1 Subcategory Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities NIST SP 800-53 Rev. 5 Ability to authenticate external users and systems. Ability to securely interact with authorized external, third -party systems . Ability to identify when an external system meets the required security requirements for a connection. Ability to establish secure communications with internal systems when the device is operating on external networks. Ability to establish requirements for remote access to the IoT device and/or IoT device interface, including: o usage restrictions o configuration requirements o connection requirements o manufacturer established req uirement Ability to enforce the established local and remote access requirements . Ability to prevent external access to the IoT device management interface. Ability to control the IoT device's logical interface (e.g., locally or remotely) . Ability to detect remote activation attempts. Ability to detect remote activation of sensors . PR.AC -4: Access permissions and authorizations are managed, incorporating the principles of least privilege and separation of duties . Ability to assign roles to IoT device user accounts . Ability to support a hierarchy of logical access privileges for the IoT device based on roles (e.g., admin, emergency, user, local, temporary) . o Ability to establish user accounts to support role-based logical acces s privileges . o Ability to administer user accounts to support role-based logical access privileges . o Ability to use organizationally defined roles to define each user account's access and permitted device actions . o Ability to support multiple levels of user/p rocess account functionality and roles for the IoT device . Providing the tools, assistance, instructions, and other types of infor mation to support establishing a hierarchy of role-based privileges within the IoT device. Providing details about the specific types of manufacturer's needs to access the IoT device interfaces, such as for specific support, updates, ongoing maintenance, a nd other purposes. Providing documentation with instructions for the IoT device customer to follow for how to restrict interface connections that enable specific activities. Providing descriptions of the types of access to the IoT device that the manufactu rer will require on an ongoing or regular AC-3 -10B: Protecting Information and System Integrity in Industrial Control System Environments 147 Cybersecurity Framework v1.1 Subcategory Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities NIST SP 800-53 Rev. 5 Ability to apply least privilege to user accounts . o Ability to create additional processes, roles (e.g., admin, emergency, temporary) and accounts as necessary to achieve least privilege . o Ability t o apply least privilege settings within the device (i.e., to ensure that the processes operate at privilege levels no higher than necessary to accomplish required functions). o Ability to limit access to privileged device settings that are used to establish and administer authorization requirements. o Ability for authorized users to access privileged settings . Ability to create organizationally defined accounts that support privileged roles with automated expiration conditions. Ability to enable automation and reporting of account management activities. Ability to establish conditions for shared/group accounts on the IoT device. Ability to administer conditions for shared/group accounts on the IoT device. Ability to restrict the use of shared/group accounts on the IoT device according to organizationally defined conditions. Ability to implement dynamic access control approaches (e.g., service -oriented architectures) that rely on: o run-time access control dec isions facilitated by dynamic privilege management. o organizationally defined actions to access/use device . Ability to allow information sharing capabilities based upon the type and/or role of the user attempting to share the information. Providing detailed instructions for how to implement management and operational controls based on the role of the IoT device user, and not on an individual basis. Providing documentation and/or other communi cations describing how to implement management and operational controls to protect data obtained from IoT devices and associated systems from unauthorized access, modification, and deletion. Providing a detailed description of the other types of devices and systems that will access the IoT device during customer use of the device, and how they will access it. Providing communications and detailed instructions for implementing a hierarchy of privilege levels to use with the IoT device and/or necess ary associated information systems. Providing communications and documentation detailing how to perform account management activities, using the technical IoT device capabilities, or through supporting systems and/or tools. Providing education explaining h ow to establish and enforce approved authorizations for logical access to IoT device information and system resources. Providing education explaining how to control access to IoT devices implemented within IoT device customer information systems. Providing education explaining how to enforce authorized access at the system level. Providing education and supporting materials explaining how to establish roles and responsibilities for IoT device data security, using the device capabilities and/or other service s that communicate or interface with the device. Providing education and supporting materials describing the IoT device capabilities for role -based controls, and how to establish different roles within the IoT device. DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 148 Cybersecurity Framework v1.1 Subcategory Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities NIST SP 800-53 Rev. 5 Ability to restric t access to IoT device software, hardware, and data based on user account roles, used with proper authentication of the identity of the user to determine type of authorization . Ability to establish limits on authorized concurrent device sessions . Ability to restrict updating actions to authorized entities. Ability to restrict access to the cybersecurity state indicator to authorized entities. Ability to revoke access to the IoT device. Providing education and supporting materials for how to establish roles to support IoT device policies, procedures, and associated documentation. PR.AC -7: Users, devices, and other assets are authenticated (e.g., single -factor, multi - factor) commensurate with the risk of the transaction (e.g., individuals' security and privacy risks and other organizational risks) . Ability for the IoT device to require authentication prior to connecting to the device. Ability for the IoT device to support a s econd, or more, authentication method(s) such as: o temporary passwords or other one -use log -on credentials o third-party credential checks o biometrics o hard tokens Ability to authenticate external users and systems . Ability to verify and authenticate any update before installing it . Providing detailed instructions and guidance for establishing activities performed by the IoT device that do not require identification or authentication. Providing documentation describing the specific IoT platforms used with the device to support required IoT authentication control techniques. Providing documentation with details describing external authentication by IoT platforms and associated authentication methods that can be used with the IoT Ability to execute cryptographic mechanisms of appropriate strength and performance. Ability to obtain and validate certificates . Ability to perform authenticated encryption algorithms. Ability to change keys securely . Ability to generate key pairs. Ability to store encryption keys securely . Ability to cryptographically store passwords at rest, as well as device identity and other authenticatio n data. Ability to support data encryption and signing to prevent data from being altered in device storage. Ability to secure data stored locally on the device. Providing detailed instructions for how to implement management and operational controls for securely handling and retaining IoT device data, associated systems data, and data output from the IoT device. Providing education describing how to secu rely handle and retain IoT device data, associated systems data, and data output from the IoT device to meet requirements of the IoT device customers' organizational security policies, contractual requirements, applicable Federal laws, Executive Orders, di rectives, policies, regulations, standards, and other legal requirements. SC-28 MP-2 MP-4 MP-5 DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 149 Cybersecurity Framework v1.1 Subcategory Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities NIST SP 800-53 Rev. 5 Ability to secure data stored in remote storage areas (e.g., cloud, server). Ability to utiliz e separate storage partitions for system and user data . Ability to protect the audit information through mechanisms such as : o encryption o digitally signing audit files o securely sending audit files to another device o other protections created by the device man ufacturer PR.DS -6: Integrity checking mechanisms are used to verify software, firmware, and information integrity . Ability to identify software loaded on the IoT device based on IoT device identity. Ability to verify digital signatures. Ability to run hashing algorithms . Ability to perform authenticated encryption algorithms. Ability to compute and compare hashes . Ability to utilize one or more capabilities to protect transmitted data from unauthorized access and modification. Ability to validate the integrity of data transmitted . Ability to verify software updates come from valid sources by using an effective metho d (e.g., digital signatures, checksums, certificate validation) . Ability to verify and authenticate any update before installing it. Ability to store the operating environment (e.g., firmware image, software, applications) in read -only media (e.g., Read On ly Memory) . Providing documentation and/or other communications describing how to implement management and operational controls to protect data obtained from IoT devices and associated systems from unauthorized access, modification, and deletion. Providing communications to IoT device customers describing how to implement management and operational controls to protect IoT device data integrity and associated systems data integrity. Providing IoT device customers with the details necessary to support secure implementation of the IoT device and associated systems data integrity controls. Providing IoT device customers with documentation describing the data integrity controls built into the IoT device and how to use them. If there are no data integrity controls built into the IoT device, include documentation explaining to IoT device customers the ways to achieve IoT device data integrity. Providing details for how to review and update the IoT device and associated systems while preserving data integrity. SC-16 SI-7 MP-4 MP-5 PR.IP -4: maintained, and tested . N/A Providing education to IoT device customers covering the instructions and details necessary for them to create accurate backups and to recover the backups when necessary. CP-4 CP-9 DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 150 Cybersecurity Framework v1.1 Subcategory Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities NIST SP 800-53 Rev. 5 Providing education to IoT device customers that includes instructions describing how to back up data from systems where IoT device data is stored. Providing awareness reminders and tips to IoT device customers (e.g., directly in person, in vide os, in an online webinar) for various aspects involved with backing up the IoT device data. PR.MA -1: Maintenance and repair of organizational assets are performed and logged, with approved and controlled tools . N/A Providing details about the types of, and situations that trigger, local and/or remote maintenance activities required once the device is purchased and deployed in the organization's digital ecosystem or within an individual consumer's home. Providing instructions and documentation describing the physical and logical access capabilities necessary to the IoT device to perform each type of maintenance activity. Providing other information and actions as necessary for physically securing, and securely using, the IoT device based upon the IoT device use, purpose, and other contextual factors related to the digital ecosystem(s) within which they are intended to be used. Providing the details necessary for IoT device customers to implement only organizationally approved IoT device diagnostic tools within their system. Providing detailed documentation describing the tools manufacturers require for IoT device diagnostics activities. Providing the details and instructions to perform necessary IoT device maintenance activities and repairs. Providing communications and comprehensive documentation describing the IoT device maintenance operations performed by the manufacturer and the manufacturer's supporting entities. Providing communications and comprehensive documentation describing maintena nce operations that the IoT device customer is required to perform. If such comprehensive IoT device maintenance operations documentation does not exist, the manufacturer should MA-2 MA-3 MA-5 MA-6 DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 151 Cybersecurity Framework v1.1 Subcategory Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities NIST SP 800-53 Rev. 5 clearly communicate to IoT device customers that the user must perform these o perations themselves. Providing communications that include details for the recommended events that will trigger IoT device system reviews and/or maintenance by the manufacturer. Providing communications and documentation detailing how to perform recommend ed local and/or remote maintenance activities. Providing the details necessary to enable IoT device customers to monitor onsite and offsite IoT device maintenance activities. Providing the details necessary to implement management and operational controls for IoT device maintenance personnel and associated authorizations, and record - keeping of maintenance organizations and personnel. Providing communications describing the type and nature of the local and/or remote maintenance activities that will involve a nd require manufacturer personnel, or their contractors, once the device is purchased and deployed in the IoT device customer's organization. Providing IoT device customers with the details necessary to implement management and operational controls in support of their security policies and legal requirements for IoT device maintenance for assigned organizationally defined personnel or roles to follow. Providing documented descriptions of the specific maintenance procedures for defined maintenance tasks. Providing the details necessary for customers to document attempts to obtain IoT device components or IoT device information system service documentation when such documentation is either unavailable or nonexistent, and documenting the appropriate response f or manufacturer employees, or supporting entities, to follow. Providing a process for IoT device customers to contact the manufacturer to ask questions or obtain help related to the IoT device configuration settings. DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 152 Cybersecurity Framework v1.1 Subcategory Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities NIST SP 800-53 Rev. 5 Providing information to allow for in -house support from within the IoT device customer organization. Providing education explaining how to inspect IoT device and/or use maintenance tools to ensure the latest software updates and patches are installed. Providing education for how to scan for c ritical software updates and patches. Providing education that explains the legal requirements governing IoT device maintenance responsibilities or how to meet specific types of legal requirements when using the IoT device. PR.MA -2: Remote maintenance of organizational assets is approved, logged, and performed in a manner that prevents unauthorized access. N/A Providing details about the types of, and situations that trigger, local and/or remote maintenance activities require d once the device is purchased and deployed in the organization's digital ecosystem or within an individual consumer's home. Providing instructions and documentation describing the physical and logical access capabilities necessary to the IoT device to per form each type of maintenance activity. Providing other information and actions as necessary for physically securing, and securely using, the IoT device based upon the IoT device use, purpose, and other contextual factors related to the digital ecosystem( s) within which they are intended to be used. Providing the details and instructions to perform necessary IoT device maintenance activities and repairs. Providing communications and comprehensive documentation describing the IoT device maintenance operations performed by the manufacturer and the manufacturer's supporting entities. Providing communications and documentation detailing how to perform recommended local and/or remote maintenance activities. Providing the details necessary to enable IoT device customers to monitor onsite and offsite IoT device maintenance activities. MA-4 DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 153 Cybersecurity Framework v1.1 Subcategory Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities NIST SP 800-53 Rev. 5 Providing the details necessary for maintaining records for nonlocal IoT device maintenance and diagnostic activities. Providing the details necessary to implement management and op erational controls for IoT device maintenance personnel and associated authorizations, and record - keeping of maintenance organizations and personnel. Providing communications describing the type and nature of the local and/or remote maintenance activities that will involve and require manufacturer personnel, or their contractors, once the device is purchased and deployed in the IoT device customer's organization. Providing IoT device customers with the details necessary to implement management and operation al controls in support of their security policies and legal requirements for IoT device maintenance for assigned organizationally defined personnel or roles to follow. Providing documented descriptions of the specific maintenance procedures for defined ma intenance tasks. DE.AE -1: A baseline of network operations and expected data flows for users and systems is established and managed . N/A Providing documentation describing how to implement and securely deploy monitoring devices and tools for IoT devices and associated systems. AC-4 CA-3 CM-2 SI-4 DE.AE -2: Detected events are analyzed to understand attack targets and methods . N/A Providing documentation describing IoT device behavior indicators that could occur when an attack is being launched. AU-6 CA-7 IR-4 SI-4 DE.AE -3: Event data are collected and correlated from multiple sources and sensors . Ability to provide a physical indicator of sensor use. Ability to send requested audit logs to an external audit process or information system (e.g., where its auditing information can be checked to allow for review, analysis, and reporting). Providing documentation describing the types of usage and environmental systems data that can be collected from the IoT device. AU-6 AU-12 CA-7 IR-4 IR-5 DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 154 Cybersecurity Framework v1.1 Subcategory Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities NIST SP 800-53 Rev. 5 Ability to keep an accurate internal system time. SI-4 DE.CM -1: The information system and assets are monitored to identify cybersecurity events and verify the effectiveness of protective measures. Ability to monitor specific actions based on the IoT device identity . Ability to access information about the IoT device 's cybersecurity state and other necessary data . Ability to monitor for organizationally defined cybersecurity events (e.g., expected state change) that may occur on or involving the IoT device . Ability to support a monitoring process to check for disclosure of organizational information to unauthorized entities. (The device may be able to perform this check itself or provide the information necessary for an external process to check). Ability to monitor communications traffic . Providing information that describes the types of system monitoring information generated from, or associated with, the IoT device and instructions for obtaining that information. Providing documentation describing the types of monitoring tools with which the IoT device is compatible, and recommendations for how to configure the IoT device to best work with such monitoring tools. Providing the details necessary to monitor IoT devices and associated systems. Providing document ation describing how to perform monitoring activities. AU-12 CA-7 CM-3 SC-7 SI-4 DE.CM -3: personnel, connections, devices, and software is performed . Ability to support a monitoring process to check for disclosure of organizational information to unauthorized entities. (The device may be able to perform this check itself or provide the information necessary for an external process to check) . Ability to monitor changes to the configuration settings. Ability to detect remote activation attempts. Ability to detect remote activation of sensors. Ability to take organizationally defined actions when unauthorized hardware and software components are detected (e.g., disallow a flash drive to be connected even if a Universal Serial Bus [ USB] port is present) . Providing appropriate tools, assistance, instructions, or other details describing t he capabilities for monitoring the IoT device and/or for the IoT device customer to report actions to the monitoring service of the manufacturer's supporting entity. Providing the details necessary to monitor IoT devices and associated systems. Providing d ocumentation describing details necessary to identify unauthorized use of IoT devices and their associated systems. Providing documentation that describes indicators of unauthorized use of the IoT device. AC-2 AU-12 AU-13 CA-7 CM-10 CM-11 DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 155 E.2 Device Capabilities Supporting Functional Test Scenarios In this project, the focus was on the engineering workstations and not on the manufacturing components. It is acknowledged th at many of the device cybersecurity capabilities may not be available in modern sensors and actuators and that other system elements (e.g., proxies, gateways) or other risk mitigation strategies (e.g., network segmentation) may be necessary . Table E-2 builds on the functional test scenarios included in Section 5 of this document. The table lists both device cybersecurity capabilities and nontechnical supporting capabilities that map to relevant CSF Subcateg ories for each of the functional test scenarios . If IoT devices are integrated into future efforts or a production ICS environment, s electing devices and/or third parties that provide these capabilities can help achieve the respective functional requiremen ts. It is acknowledged that IoT devices vary in their capabilities, and there may not be a clear delineation between the device cybersecurity capabilities that are provided by the IoT devices and those provided by another system component. It is also under stood that the capabilities of cyber- physical components are evolving, so many of the mappings are not necessarily exact. In this project, the focus was on the engineering workstations and not on the manufacturing components. It is acknowledged th at many o f the device cybersecurity capabilities may not be available in modern sensors and actuators and that other system elements (e.g., proxies, gateways) or other risk mitigation strategies (e.g., network segmentation) may be necessary . Table E-2 Device Cybersecurity Capabilities and Nontechnical Supporting Capabilities that Map to Each of the Functional Test Scenarios Scenario ID and Description with CSF Subcategories Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities Scenario 1: Protect Host from Malware via USB : This test will demonstrate blocking the introduction of malware through physical access to a workstation within the manufacturing system . PR.DS -6 PR.MA -2 DE.AE -2 Ability to identify software loaded on the IoT device based on IoT device identity. Ability to verify digital signatures. Ability to run hashing algorithms. Ability to perform authenticated encryption algorithms. Ability to compute and compare hashes. Ability to utilize one or more capabilities to protect transmitted data from unauthorized access a nd modification. Ability to validate the integrity of data transmitted. Ability to verify software updates come from valid sources by using an effective method Providing documentation and/or other communications describing how to implement management and operational controls to protect data obtained from IoT devices and associated systems from unauthorized access, modification, and deletion. Providing communications to IoT device customers describing how to implement management and operational controls to protect IoT device data integrity and associated systems data integrity. Providing IoT device customers with the details necessary to support secure implementation of the IoT device and associated systems data integrity controls. Providing IoT device customers with documentation describing the data integrity controls built into the IoT device and how to use them. If there are no data integrity controls built into the IoT device, include documentation explaining to IoT device customers the ways to achieve IoT device data integrity. Providing details for how to review and update the IoT device and associated systems while preserving data integrity. DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 156 Scenario ID and Description with CSF Subcategories Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities (e.g., digital signatures, checksums, certificate validation). Ability to verify and authenticate any update before installing it. Ability to store the operating environment (e.g., firmware image, software, applications) in read -only media (e.g., Read Only Memory). Providing the details and instructions to perform necessary IoT device maintenance activ ities and repairs. Providing communications and comprehensive documentation describing the IoT device maintenance operations performed by the manufacturer and the manufacturer's supporting entities. Providing communications and documentation detailing how to perform recommended local and/or remote maintenance activities. Providing the details necessary to enable IoT device customers to monitor onsite and offsite IoT device maintenance activities. Providing communications describing the type and nature of t he local and/or remote maintenance activities that will involve and require manufacturer personnel, or their contractors, once the device is purchased and deployed in the IoT device customer's organization. Providing documented descriptions of the specific maintenance procedures for defined maintenance tasks. Providing documentation describing IoT device behavior indicators that could occur when an attack is being launched. Scenario 2: Protect Host from Malware via Network Vector: This test will demonstra te the detection of malware -7 Ability to identify software loaded on the IoT device based on IoT device identity. Ability to verify digital signatures. Ability to run hashing algorithms. Ability to perform authenticated encryption algorithms. Ability to compute and compare hashes. Ability to utilize one or more capabilities to protect transmitted data from u nauthorized access and modification. Ability to validate the integrity of data transmitted. Ability to verify software updates come from valid sources by using an effective method (e.g., digital signatures, checksums, certificate validation). Ability to ve rify and authenticate any update before installing it. Providing documentation and/or other communi cations describing how to implement management and operational controls to protect data obtained from IoT devices and associated systems from unauthorized access, modification, and deletion. Providing communications to IoT device customers describing how t o implement management and operational controls to protect IoT device data integrity and associated systems data integrity. Providing IoT device customers with the details necessary to support secure implementation of the IoT device and associated systems data integrity controls. Providing IoT device customers with documentation describing the data integrity controls built into the IoT device and how to use them. If there are no data integrity controls built into the IoT device, include documentation explai ning to IoT device customers the ways to achieve IoT device data integrity. Providing details for how to review and update the IoT device and associated systems while preserving data integrity. Providing instructions and documentation describing the physical and logical access capabilities necessary to the IoT device to perform each type of maintenance activity. Providing detailed documentation describing the tools manufacturers require for IoT device diagnostics activities. DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 157 Scenario ID and Description with CSF Subcategories Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities Ability to store the operating environment (e.g., firmware image, software, applications) in read -only media (e.g., Read Only Memory). Ability to provide a physical indicator of sensor use. Ability to send requested audit logs to an external audit process or information system (e.g., where its auditing information can be checked to allow for review, analysis, and reporting). Ability to keep an accurate internal system time. Ability to support a monitoring process to check for disclosure of organizational information to unauthorized entities. Ability to monitor changes to the configuration settings. Ability to detect remote activation attempts. Ability to detect remote activation of sensors. Ability to take organizationally defined actions when unauthorized hardware and software components are detected (e.g., disallow a flash drive to be connected even if a Universal Serial Bus [ USB] port is present) . Providing the details and instructions to perform necessary IoT device maintenance activities and repairs. Providing communications and comprehensive documentation describing the IoT device maintenance operations performed by the manufacturer and the manufacturer's supporting entit ies. Providing communications and comprehensive documentation describing maintenance operations that the IoT device customer is required to perform. Providing communications that include details for the recommended events that will trigger IoT device syst em reviews and/or maintenance by the manufacturer. Providing communications and documentation detailing how to perform recommended local and/or remote maintenance activities. Providing documented descriptions of the specific maintenance procedures for defined maintenance tasks. Providing education for how to scan for critical software updates and patches. Providing documentation describing how to implement and securely deploy monitoring devices and tools for IoT devices and associated systems . Providing documentation describing IoT device behavior indicators that could occur when an attack is being launched. Providing documentation describing the types of usage and environmental systems data that can be collected from the IoT device. Providing appropriate to ols, assistance, instructions, or other details describing the capabilities for monitoring the IoT device and/or for the IoT device customer to report actions to the monitoring service of the manufacturer's supporting entity. Providing the details necessary to monitor IoT devices and associated systems. Providing documentation describing details necessary to identify unauthorized use of IoT devices and their associated systems. Providing documentation that describes indicators of unauthorized use of the IoT device. Scenario 3: Protect Host from Malware via Remote Access Connections: This test will demonstrate blocking malware attempting to infect Ability to uniquely identify the IoT device logically. Ability to uniquely identify a remote IoT device. Ability for the device to support a unique device ID. Ability to configure IoT device access control policies using IoT device identity. Providing details for how to establish unique identification for each IoT device associated with the system and critical system components within which it is used. Providing communications and documentation detailing how to perform account management activities, using the technical IoT device capabilities, or through suppor ting systems and/or tools. Providing the details necessary to establish and implement unique identification for each IoT device associated with the system and critical system components within which it is used. DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 158 Scenario ID and Description with CSF Subcategories Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities manufacturing system through authorized remote access Ability to verify the identity of an IoT device. Ability to add a unique physical identifier at an external or internal location on the device authorized entities can access. Ability to set and cha nge authentication configurations, policies, and limitations settings for the IoT device. Ability to revoke access to the device. Ability to create unique IoT device user accounts. Ability to identify unique IoT device user accounts. Ability to create orga nizationally defined accounts that support privileged roles with automated expiration conditions. Ability to configure IoT device access control policies using IoT device identity. Ability to authenticate external users and systems. Ability to securely int eract with authorized external, third -party systems. Ability to identify when an external system meets the required security requirements for a connection. Ability to establish secure communications with internal systems when the device is operating on ext ernal networks. Ability to establish requirements for remote access to the IoT device and/or IoT device interface. Ability to enforce the established local and remote access requirements. Ability to prevent external access to the IoT device management interface. Ability to assign roles to IoT device user accounts. Providing the tools, assistance, instructions , and other types of information to support establishing a hierarchy of role -based privileges within the IoT device. Providing details about the specific types of manufacturer's needs to access the IoT device interfaces, such as for specific support, updat es, ongoing maintenance, and other purposes. Providing education explaining how to control access to IoT devices implemented within IoT device customer information systems. Providing education explaining how to enforce authorized access at the system level . Providing detailed instructions and guidance for establishing activities performed by the IoT device that do not require identification or authentication. Providing documentation describing the specific IoT platforms used with the device to support required IoT authentication control techniques. Providing documentation with details describing external authentication by IoT platforms and associated authentication methods that can be used with the IoT device. Providing detailed documentation de scribing the tools manufacturers require for IoT device diagnostics activities. Providing the details and instructions to perform necessary IoT device maintenance activities and repairs. Providing details about the types of, and situations that trigger, lo cal and/or remote maintenance activities required once the device is purchased and deployed in the organization's digital ecosystem or within an individual consumer's home. Providing documented descriptions of the specific maintenance procedures for defined maintenance tasks. Providing appropriate tools, assistance, instructions, or other details describing the capabilities for monitoring the IoT device and/or for the IoT device customer to report actions to the monitoring service of the manufacturer's supporting entity. Provid ing the details necessary to monitor IoT devices and associated systems. Providing documentation describing details necessary to identify unauthorized use of IoT devices and their associated systems. Providing documentation that describes indicators of una uthorized use of the IoT device. DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 159 Scenario ID and Description with CSF Subcategories Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities Ability to support a hierarchy of logical access privileges for the IoT device based on roles. Ability to apply least privilege to user accounts . Ability to enable automation and re porting of account management activities. Ability for the IoT device to require authentication prior to connecting to the device. Ability for the IoT device to support a second, or more, authentication method(s). Ability to support a monitoring process to check for disclosure of organizational information to unauthorized entities. Ability to monitor changes to the configuration settings. Ability to detect remote activation attempts. Ability to detect remote activation of sensors. Ability to take organizationally defined actions when unauthorized hardware and software components are detected (e.g., disallow a flash drive to be connected even if a Universal Serial Bus [USB] port is present). Scenario 4: Protect Host from Unauthorized Application Installation : This test will demonstrate blocking the installation and execution of unauthorized Ability to identify software loaded on the IoT device based on IoT device identity. Ability to verify digital signatures. Ability to run hashing algorithms. Ability to perform authenticated encryption algorithms. Ability to compute and compare hashes. Ability to utilize one or more capabilities to protect transmitted data from unauthorized access and modification. Providing documentation and/or other communications describing how to implement management and operational controls to protect data obtained from IoT devices and associated systems from unauthorized access, modification, and deletion. Providing communications to IoT device customers describing how to implement management and operational controls to protect IoT device data integrity and associated systems data integrity. Providing IoT device customers with the details necessary to support secure implementation of the IoT device and associated systems data integrity controls. Providing IoT device customers with documentati on describing the data integrity controls built into the IoT device and how to use them. If there are no data integrity DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 160 Scenario ID and Description with CSF Subcategories Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities applications on workstation in -7 Ability to validate the integrity of data transmitted. Ability to verify software updates come from valid sources by using an effective method (e.g., digital signatures, checksums, certificate validation). Ability to verify and authenticate any update before installing it. Abilit y to store the operating environment (e.g., firmware image, software, applications) in read -only media (e.g., Read Only Memory). Ability to provide a physical indicator of sensor use. Ability to send requested audit logs to an external audit process or inf ormation system (e.g., where its auditing information can be checked to allow for review, analysis, and reporting). Ability to keep an accurate internal system time. Ability to support a monitoring process to check for disclosure of organizational informat ion to unauthorized entities. Ability to monitor changes to the configuration settings. Ability to detect remote activation attempts. Ability to detect remote activation of sensors. Ability to take organizationally defined actions when unauthorized hardwar e and software components are detected (e.g., disallow a flash drive to be connected even if a Universal Serial Bus [ USB] port is present) . controls built into the IoT device, include documentation explaining to IoT device customers the ways to achieve IoT device data integri ty. Providing details for how to review and update the IoT device and associated systems while preserving data integrity. Providing instructions and documentation describing the physical and logical access capabilities necessary to the IoT device to perfor m each type of maintenance activity. Providing detailed documentation describing the tools manufacturers require for IoT device diagnostics activities. Providing the details and instructions to perform necessary IoT device maintenance activities and repair s. Providing communications and comprehensive documentation describing the IoT device maintenance operations performed by the manufacturer and the manufacturer's supporting entities. Providing communications and comprehensive documentation describing maint enance operations that the IoT device customer is required to perform. Providing communications that include details for the recommended events that will trigger IoT device system reviews and/or maintenance by the manufacturer. Providing communications an d documentation detailing how to perform recommended local and/or remote maintenance activities. Providing documented descriptions of the specific maintenance procedures for defined maintenance tasks. Providing education for how to scan for critical softwa re updates and patches. Providing documentation describing how to implement and securely deploy monitoring devices and tools for IoT devices and associated systems . Providing documentation describing IoT device behavior indicators that could occur when an attack is being launched. Providing documentation describing the types of usage and environmental systems data that can be collected from the IoT device. Providing appropriate tools, assistance, instructions, or other details describing the capabilities for monitoring the IoT device and/or for the IoT device customer to report actions to the monitoring service of the manufacturer's supporting entity. Providing the details necessary to monitor IoT devices and associated systems. Providing documentation de scribing details necessary to identify unauthorized use of IoT devices and their associated systems. Providing documentation that describes indicators of unauthorized use of the IoT device. DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 161 Scenario ID and Description with CSF Subcategories Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities Scenario 5: Protect from Unauthorized Addition of a Device: This test will demonstrate the detection of an unauthorized device connecting to the manufacturing system -7 Ability to identify software loaded on the IoT device based on IoT device identity. Ability to verify digital signatures. Ability to run hashing algorithms. Ability to perform authenticated encryption algorithms. Ability to compute and compare hashes. Ability to utilize one or more capabilities to protect transmitted data from unauthorized access and modification. Ability to validate the integrity of data transmitted. Ability to verify software updates come from valid sources by using an effective method (e.g., digital signatures, ch ecksums, certificate validation). Ability to verify and authenticate any update before installing it. Ability to store the operating environment (e.g., firmware image, software, applications) in read -only media (e.g., Read Only Memory). Ability to provide a physical indicator of sensor use. Ability to send requested audit logs to an external audit process or information system (e.g., where its auditing information can be checked to allow for review, analysis, and reporting). Ability to keep an accurate inte rnal system time. Ability to support a monitoring process to check for disclosure of organizational information to unauthorized entities. Ability to monitor changes to the configuration settings. Providin g documentation and/or other communications describing how to implement management and operational controls to protect data obtained from IoT devices and associated systems from unauthorized access, modification, and deletion. Providing communications to I oT device customers describing how to implement management and operational controls to protect IoT device data integrity and associated systems data integrity. Providing IoT device customers with the details necessary to support secure implementation of th e IoT device and associated systems data integrity controls. Providing IoT device customers with documentation describing the data integrity controls built into the IoT device and how to use them. If there are no data integrity controls built into the IoT device, include documentation explaining to IoT device customers the ways to achieve IoT device data integrity. Providing details for how to review and update the IoT device and associated systems while preserving data integrity. Providing instructions and documentation describing the physical and logical access capabilities necessary to the IoT device to perform each type of maintenance activity. Providing detailed documentation describing the tools manufacturers require for IoT device diagnostics activiti es. Providing the details and instructions to perform necessary IoT device maintenance activities and repairs. Providing communications and comprehensive documentation describing the IoT device maintenance operations performed by the manufacturer and the manufacturer's supporting entities. Providing communications and comprehensive documentation describing maintenance operations that the IoT device customer is required to perform. Providing communications that include details for the recommended events tha t will trigger IoT device system reviews and/or maintenance by the manufacturer. Providing communications and documentation detailing how to perform recommended local and/or remote maintenance activities. Providing documented descriptions of the specific maintenance procedures for defined maintenance tasks. Providing education for how to scan for critical software updates and patches. Providing documentation describing how to implement and securely deploy monitoring devices and tools for IoT devices and associated systems . Providing documentation describing IoT device behavior indicators that could occur when an attack is being launched. DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 162 Scenario ID and Description with CSF Subcategories Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities Ability to detect remote activation attempts. Ability to det ect remote activation of sensors. Ability to take organizationally defined actions when unauthorized hardware and software components are detected (e.g., disallow a flash drive to be connected even if a Universal Serial Bus [ USB] port is present) . Providing documentation describing the types of usage and environmental systems data that can be collected from the IoT device. Providing appropriate tools, assistance, instructions, or other details describing the capabilities for monitoring the IoT device and/or for the IoT device customer to report actions to the monitoring service of the manufacturer's supporting entity. Provid ing the details necessary to monitor IoT devices and associated systems. Providing documentation describing details necessary to identify unauthorized use of IoT devices and their associated systems. Providing documentation that describes indicators of una uthorized use of the IoT device. Scenario 6: Detect Unauthorized Device -to-Device Communications : This test will demonstrate the detection of unauthorized communications between devices -7 Ability to identify software loaded on the IoT device based on IoT device identity. Ability to verify digital signatures. Ability to run hashing algorithms. Ability to perform authenticated encryption algorithms. Ability to compute and compare hashes. Ability to utilize one or more capabilities to protect transmitted data from unauthorized access and modification. Ability to validate the integrity of data transmitted. Ability to verify software updates come from valid sources by using an effective method (e.g., digital signatures, checksums, certificate validation). Ability to verify and authenticate any update before installing it. Ability to store the operating environment (e.g., firmware image, softwa re, applications) in read -only media (e.g., Read Only Memory). Ability to provide a physical indicator of sensor use. Ability to send requested audit logs to an external audit process or information system Providing documentation and/or other communications describing how to implement management and operational controls to protect data obtained from IoT devices and associated systems from unauthorized access, modification, and deletion. Providing communications to IoT device customers describing how to implement management and operational controls to protect IoT device data integrity and associated systems data integrity. Providing Io T device customers with the details necessary to support secure implementation of the IoT device and associated systems data integrity controls. Providing IoT device customers with documentation describing the data integrity controls built into the IoT dev ice and how to use them. If there are no data integrity controls built into the IoT device, include documentation explaining to IoT device customers the ways to achieve IoT device data integrity. Providing details for how to review and update the IoT devic e and associated systems while preserving data integrity. Providing instructions and documentation describing the physical and logical access capabilities necessary to the IoT device to perform each type of maintenance activity. Providing detailed documentation describing the tools manufacturers require for IoT device diagnostics activities. Providing the details and instructions to perform necessary IoT device maintenance activities and repairs. Providing communications and comprehensive documentat ion describing the IoT device maintenance operations performed by the manufacturer and the manufacturer's supporting entities. Providing communications and comprehensive documentation describing maintenance operations that the IoT device customer is requir ed to perform. DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 163 Scenario ID and Description with CSF Subcategories Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities (e.g., where its auditing information can be check ed to allow for review, analysis, and reporting). Ability to keep an accurate internal system time. Ability to support a monitoring process to check for disclosure of organizational information to unauthorized entities. Ability to monitor changes to the configuration settings. Ability to detect remote activation attempts. Ability to detect remote activation of sensors. Ability to take organizationally defined actions when unauthorized hardware and software components are detected (e.g., disallow a flash d rive to be connected even if a Universal Serial Bus [ USB] port is present) . Providing communications that include details for the recommended events that will trigger IoT device system reviews and/or maintenance by the manufacturer. Providing communications and documentation detailing how to perform recommended loc al and/or remote maintenance activities. Providing documented descriptions of the specific maintenance procedures for defined maintenance tasks. Providing education for how to scan for critical software updates and patches. Providing documentation describi ng how to implement and securely deploy monitoring devices and tools for IoT devices and associated systems . Providing documentation describing IoT device behavior indicators that could occur when an attack is being launched. Providing documentation descri bing the types of usage and environmental systems data that can be collected from the IoT device. Providing appropriate tools, assistance, instructions, or other details describing the capabilities for monitoring the IoT device and/or for the IoT device cu stomer to report actions to the monitoring service of the manufacturer's supporting entity. Providing the details necessary to monitor IoT devices and associated systems. Providing documentation describing details necessary to identify unauthorized use of IoT devices and their associated systems. Providing documentation that describes indicators of unauthorized use of the IoT device. Scenario 7: Protect from Unauthorized Modification and Deletion of Files : This test will demonstrate protection of files from unauthorized deletion both locally and on network file cryptographic mechanisms of appropriate strength and performance. Ability to obtain and validate certificates . Ability to change keys securely . Ability to generate key pairs. Ability to store encryption keys securely . Ability to cryptographically store passwords at rest, as well as device identity and other authentication data. Ability to sup port data encryption and signing to prevent data from being altered in device storage . Ability to secure data stored locally on the device. Providing detailed instructions for how to implement management and operational controls for securely handling and retaining IoT device data, associated systems data, and data output from the IoT device. Providing education describing how to securely handle and retain IoT device data, associated systems data, and data output from the IoT device to meet requirements of the IoT device customers' organizational security policies, contractual requirements, applicable Federal laws, Executive Orders , directives, policies, regulations, standards, and other legal requirements. Providing documentation and/or other communications describing how to implement management and operational controls to protect data obtained from IoT devices and associated syste ms from unauthorized access, modification, and deletion. Providing communications to IoT device customers describing how to implement management and operational controls to protect IoT device data integrity and associated systems data integrity. DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 164 Scenario ID and Description with CSF Subcategories Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities DE.AE -2 Ability to secure data stored in remote storage areas (e.g., cloud, server). Ability to utilize separate storage par titions for system and user data . Ability to protect the audit information through mechanisms such as : o encryption o digitally signing audit files o securely sending audit files to another device o other protections created by the device manufacturer Ability to i dentify software loaded on the IoT device based on IoT device identity. Ability to verify digital signatures. Ability to run hashing algorithms. Ability to perform authenticated encryption algorithms. Ability to compute and compare hashes. Ability to utilize one or more capabilities to protect transmitted data from unauthorized access and modification. Ability to validate the integrity of data transmitted. Ability to verify software updates come from valid sources by using an effective method (e.g., di gital signatures, checksums, certificate validation). Ability to verify and authenticate any update before installing it. Ability to store the operating environment (e.g., firmware image, software, applications) in read -only media (e.g., Read Only Memory). Providing IoT device customers with the details necessary to support secure implementation of the IoT device and associated systems data integrity controls. Providing IoT device customers with documentation describing the data integrity controls built into the IoT d evice and how to use them. If there are no data integrity controls built into the IoT device, include documentation explaining to IoT device customers the ways to achieve IoT device data integrity. Providing details for how to review and update the IoT dev ice and associated systems while preserving data integrity. Providing education to IoT device customers covering the instructions and details necessary for them to create accurate backups and to recover the backups when necessary. Providing education to Io T device customers that includes instructions describing how to back up data from systems where IoT device data is stored. Providing awareness reminders and tips to IoT device customers (e.g., directly in person, in videos, in an online webinar) for various aspects involved with backing up the IoT device data. Providing instructions and documentation describing the physical and logical access capabilities necessary to the IoT device to perform each type of maintenance activity. Providing detailed documentat ion describing the tools manufacturers require for IoT device diagnostics activities. Providing the details and instructions to perform necessary IoT device maintenance activities and repairs. Providing communications and comprehensive documentation descri bing the IoT device maintenance operations performed by the manufacturer and the manufacturer's supporting entities. Providing communications and comprehensive documentation describing maintenance operations that the IoT device customer is required to perf orm. Providing communications that include details for the recommended events that will trigger IoT device system reviews and/or maintenance by the manufacturer. Providing communications and documentation detailing how to perform recommended local and/or remote maintenance activities. Providing documented descriptions of the specific maintenance procedures for defined maintenance tasks. Providing education for how to scan for critical software updates and patches. Providing documentation describing IoT dev ice behavior indicators that could occur when an attack is being launched. DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 165 Scenario ID and Description with CSF Subcategories Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities Scenario 8: Detect Unauthorized Modification of PLC Logic : This test will demonstrate the detection of PLC logic modification Ability to configure IoT device access control policies using IoT device identity. Ability to authenticate external users and systems. Ability to securely interact with authorized external, third -party systems. Ability to identify when an external system meets the required security requirements for a connection. Ability to establish secure communications with internal systems when the dev ice is operating on external networks. Ability to establish requirements for remote access to the IoT device and/or IoT device interface. Ability to enforce the established local and remote access requirements. Ability to prevent external access to the IoT device management interface. Ability for the IoT device to require authentication prior to connecting to the device. Ability for the IoT device to support a second, or more, authentication method(s). Ability to identify software loaded on the IoT devic e based on IoT device identity. Ability to verify digital signatures. Ability to run hashing algorithms. Ability to perform authenticated encryption algorithms. Ability to compute and compare hashes. Ability to utilize one or more capabilities to protect transmitted data from unauthorized access and modification. Ability to validate the integrity of data transmitted. Providing detailed instructions a nd guidance for establishing activities performed by the IoT device that do not require identification or authentication. Providing documentation describing the specific IoT platforms used with the device to support required IoT authentication control techniques. Providing documentation with details describing external authentication by IoT platforms and associated authentication methods that can be used with the IoT device. Providing documentation and/or other communications describing how to implement man agement and operational controls to protect data obtained from IoT devices and associated systems from unauthorized access, modification, and deletion. Providing communications to IoT device customers describing how to implement management and operational controls to protect IoT device data integrity and associated systems data integrity. Providing IoT device customers with the details necessary to support secure implementation of the IoT device and associated systems data integrity controls. Providing IoT device customers with documentation describing the data integrity controls built into the IoT device and how to use them. If there are no data integrity controls built into the IoT device, include documentation explaining to IoT device customer s the ways to achieve IoT device data integrity. Providing details for how to review and update the IoT device and associated systems while preserving data integrity. Providing instructions and documentation describing the physical and logical access capabilities necessary to the IoT device to perform each type of maintenance activity. Providing detailed documentation describing the tools manufacturers require for IoT device diagnostics activities. Providing the details and instructions to perform nece ssary IoT device maintenance activities and repairs. Providing communications and comprehensive documentation describing the IoT device maintenance operations performed by the manufacturer and the manufacturer's supporting entities. Providing communication s and comprehensive documentation describing maintenance operations that the IoT device customer is required to perform. Providing communications that include details for the recommended events that will trigger IoT device system reviews and/or maintenanc e by the manufacturer. Providing communications and documentation detailing how to perform recommended local and/or remote maintenance activities. DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 166 Scenario ID and Description with CSF Subcategories Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities Ability to verify software updates come from valid sources by using an effective method (e.g., digital signatures, checksums, certificate vali dation). Ability to verify and authenticate any update before installing it. Ability to store the operating environment (e.g., firmware image, software, applications) in read -only media (e.g., Read Only Memory). Ability to provide a physical indicator of sensor use. Ability to send requested audit logs to an external audit process or information system (e.g., where its auditing information can be checked to allow for review, analysis, and reporting). Ability to keep an accurate internal system time. Ability to support a monitoring process to check for disclosure of organizational information to unauthorized entities. Ability to monitor changes to the configuration settings. Ability to detect remote activation attempts. Ability to detect remote activation of sensors. Ability to take organizationally defined actions when unauthorized hardware and software components are detected (e.g., disallow a flash drive to be connected even if a Universal Serial Bus [USB] port is present). Providing documented descriptions of the specific maintenance procedures for defined maintenance tasks. Provi ding education for how to scan for critical software updates and patches. Providing communications and documentation detailing how to perform recommended local and/or remote maintenance activities. Providing the details necessary to enable IoT device custo mers to monitor onsite and offsite IoT device maintenance activities. Providing communications describing the type and nature of the local and/or remote maintenance activities that will involve and require manufacturer personnel, or their contractors, onc e the device is purchased and deployed in the IoT device customer's organization. Providing documentation describing how to implement and securely deploy monitoring devices and tools for IoT devices and associated systems . Providing documentation describin g IoT device behavior indicators that could occur when an attack is being launched. Providing documentation describing the types of usage and environmental systems data that can be collected from the IoT device. Providing appropriate tools, assistance, ins tructions, or other details describing the capabilities for monitoring the IoT device and/or for the IoT device customer to report actions to the monitoring service of the manufacturer's supporting entity. Providing the details necessary to monitor IoT dev ices and associated systems. Providing documentation describing details necessary to identify unauthorized use of IoT devices and their associated systems. Providing documentation that describes indicators of unauthorized use of the IoT device. Scenario 9: Protect from Modification of Historian Data : Ability to identify software loaded on the IoT device based on IoT device identity. Ability to verify digital signatures. Ability to run hashing algorithms. Providing documentation and/or other communications describing how to implement management and operational controls to protect data obtained from IoT devices and associated systems from unauthorized access, modification, and deletion. DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 167 Scenario ID and Description with CSF Subcategories Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities This test will demonstrate the blocking of modification of historian archive data . PR.DS -6 PR.MA -1 DE.AE -2 Ability to encryption algorithms. Ability to compute and compare hashes. Ability to utilize one or more capabilities to protect transmitted data from unauthorized access and modification. Ability to validate the integrity of data transmitted. Ability to verify software updates come from valid sources by using an effective method (e.g., digital signatures, checksums, certificate validation). Ability to verify and authentic ate any update before installing it. Ability to store the operating environment (e.g., firmware image, software, applications) in read -only media (e.g., Read Only Memory). Providing communications to IoT device customers describing how to implement management and operational controls to protect IoT device data integrity and associated systems data integrity. Providing IoT device customers with the details necessary to support secure implementation of the IoT device and associated systems data integrity controls. Providing IoT device customers with documentation describing the data integrity controls built into the IoT device and how to use them. If there are no data integrity controls built into the IoT device, include documentation explaining to IoT device customers the ways to achieve IoT device data integrity. Providing details for how to review and update the IoT device and associated systems while preserving data integrity. Providing instructions and documentation describing the physical and logical access capabilities necessary to the IoT device to perform each type of maintenance activity. Providing detailed documentation describing the tools manufacturers require for IoT device diagnostics activities. Providing the details and instructions to perfo rm necessary IoT device maintenance activities and repairs. Providing communications and comprehensive documentation describing the IoT device maintenance operations performed by the manufacturer and the manufacturer's supporting entities. Providing commun ications and comprehensive documentation describing maintenance operations that the IoT device customer is required to perform. Providing communications that include details for the recommended events that will trigger IoT device system reviews and/or mai ntenance by the manufacturer. Providing communications and documentation detailing how to perform recommended local and/or remote maintenance activities. Providing documented descriptions of the specific maintenance procedures for defined maintenance tasks . Providing education for how to scan for critical software updates and patches. Providing documentation describing IoT device behavior indicators that could occur when an attack is being launched. Scenario 10: Detect Sensor Data Manipulation : This test w ill demonstrate Ability to identify software loaded on the IoT device based on IoT device identity. Ability to verify digital signatures. Ability to run hashing algorithms. Providing education to I oT device customers covering the instructions and details necessary for them to create accurate backups and to recover the backups when necessary. Providing education to IoT device customers that includes instructions describing how to back up data from systems where IoT device data is stored. DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 168 Scenario ID and Description with CSF Subcategories Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities detection of atypical data to authenticated encryption algorithms. Ability to compute and compare hashes. Ability to utilize one or more capabilities to protect transmitted data from unauthorized access and modification. Ability to validate the integrity of data transmitted. Ability to verify software updates come from valid sources by using an effective method (e.g., digital signatures, checksums, certifi cate validation). Ability to verify and authenticate any update before installing it. Ability to store the operating environment (e.g., firmware image, software, applications) in read -only media (e.g., Read Only Memory). Ability to provide a physical indicator of sensor use. Ability to send requested audit logs to an external audit process or information system (e.g., where its auditing information can be checked to allow for review, analysis, and reporting). Ability to keep an accurate internal system time. Ability to support a monitoring process to check for disclosure of organizational information to unauthorized entities. Ability to monitor changes to the configuration settings. Ability to detect remote activation attempts. Ability to detect remote activ ation of sensors. Providing awareness reminders and tips to IoT device customers (e.g., directly in person, in videos, in an online webinar) for various aspects involved with backing up the IoT device data. Providing documentati on and/or other communications describing how to implement management and operational controls to protect data obtained from IoT devices and associated systems from unauthorized access, modification, and deletion. Providing communications to IoT device customers describing how to implement management and operational controls to protect IoT device data integrity and associated systems data integrity. Providing IoT device customers with the details necessary to support secure implementation of the I oT device and associated systems data integrity controls. Providing IoT device customers with documentation describing the data integrity controls built into the IoT device and how to use them. If there are no data integrity controls built into the IoT dev ice, include documentation explaining to IoT device customers the ways to achieve IoT device data integrity. Providing details for how to review and update the IoT device and associated systems while preserving data integrity. Providing instructions and do cumentation describing the physical and logical access capabilities necessary to the IoT device to perform each type of maintenance activity. Providing detailed documentation describing the tools manufacturers require for IoT device diagnostics activities. Providing the details and instructions to perform necessary IoT device maintenance activities and repairs. Providing communications and comprehensive documentation describing the IoT device maintenance operations performed by the manufacturer and the manu facturer's supporting entities. Providing communications and comprehensive documentation describing maintenance operations that the IoT device customer is required to perform. Providing communications that include details for the recommended events that w ill trigger IoT device system reviews and/or maintenance by the manufacturer. Providing communications and documentation detailing how to perform recommended local and/or remote maintenance activities. Providing documented descriptions of the specific main tenance procedures for defined maintenance tasks. Providing education for how to scan for critical software updates and patches. DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 169 Scenario ID and Description with CSF Subcategories Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities Ability to take organizationally defined actions when unauthorized hardware and software components are detected (e.g., disallow a flash drive to be connected even if a Universal Serial Bus [USB] port is present). Providing documentation describing how to implement and securely deploy monitoring devices and tools for IoT devices and associ ated systems . Providing documentation describing IoT device behavior indicators that could occur when an attack is being launched. Providing documentation describing the types of usage and environmental systems data that can be collected from the IoT devic e. Providing appropriate tools, assistance, instructions, or other details describing the capabilities for monitoring the IoT device and/or for the IoT device customer to report actions to the monitoring service of the manufacturer's supporting entity. Providing the details necessary to monitor IoT devices and associated systems. Providing documentation describing details necessary to identify unauthorized use of IoT devices and their associated systems. Providing documentation that describes indicators of unauthorized use of the IoT device. Scenario 11: Detect Unauthorized Firmware Modification : This test will demonstrate the detection of firmware -7 Ability to identify software loaded on the IoT device based on IoT device identity. Ability to verify digital signatures. Ability to run hashing algorithms. Ability to perform authenticated encryption algor ithms. Ability to compute and compare hashes. Ability to utilize one or more capabilities to protect transmitted data from unauthorized access and modification. Ability to validate the integrity of data transmitted. Ability to verify software updates come from valid sources by using an effective method (e.g., digital signatures, checksums, certificate validation). Ability to verify and authenticate any update before installing it. Ability to store the operating environment (e.g., firmware image, software, applications) in read -only media (e.g., Read Only Memory). Providing documentation and/or other communications describing how to implement management and operational controls to protect data obtained from IoT devices and associated system s from unauthorized access, modification, and deletion. Providing communications to IoT device customers describing how to implement management and operational controls to protect IoT device data integrity and associated systems data integrity. Providing I oT device customers with the details necessary to support secure implementation of the IoT device and associated systems data integrity controls. Providing IoT device customers with documentation describing the data integrity controls built into the IoT de vice and how to use them. If there are no data integrity controls built into the IoT device, include documentation explaining to IoT device customers the ways to achieve IoT device data integrity. Providing details for how to review and update the IoT devi ce and associated systems while preserving data integrity. Providing instructions and documentation describing the physical and logical access capabilities necessary to the IoT device to perform each type of maintenance activity. Providing detailed documen tation describing the tools manufacturers require for IoT device diagnostics activities. Providing the details and instructions to perform necessary IoT device maintenance activities and repairs. DRAFT NIST SP 1800 -10B: Protecting Information and System Integrity in Industrial Control System Environments 170 Scenario ID and Description with CSF Subcategories Device Cybersecurity Capabilities Manufacturer Nontechnical Supporting Capabilities Ability to provide a physical indicator of sensor use. Ability to send requested audit logs to an external audit process or information system (e.g., where its auditing information can be checked to allow for review, analysis, and reporting). Ability to keep an accurate internal system time. Ability to support a monitoring process to check for disclosure of organizational information to unauthorized entities. Ability to monitor changes to the configu ration settings. Ability to detect remote activation attempts. Ability to detect remote activation of sensors. Ability to take organizationally defined actions when unauthorized hardware and software components are detected (e.g., disallow a flash drive to be connected even if a Universal Serial Bus [USB] port is present). Providing communications and comprehensive documentation des cribing the IoT device maintenance operations performed by the manufacturer and the manufacturer's supporting entities. Providing communications and comprehensive documentation describing maintenance operations that the IoT device customer is required to perform. Providing communications that include details for the recommended events that will trigger IoT device system reviews and/or maintenance by the manufacturer. Providing communications and documentation detailing how to perform recommended local and/ or remote maintenance activities. Providing documented descriptions of the specific maintenance procedures for defined maintenance tasks. Providing education for how to scan for critical software updates and patches. Providing documentation describing how to implement and securely deploy monitoring devices and tools for IoT devices and associated systems . Providing documentation describing IoT device behavior indicators that could occur when an attack is being launched. Providing documentation describing t he types of usage and environmental systems data that can be collected from the IoT device. Providing appropriate tools, assistance, instructions, or other details describing the capabilities for monitoring the IoT device and/or for the IoT device customer to report actions to the monitoring service of the manufacturer's supporting entity. Providing the details necessary to monitor IoT devices and associated systems. Providing documentation describing details necessary to identify unauthorized use of IoT de vices and their associated systems. Providing documentation that describes indicators of unauthorized use of the IoT device. DRAFT NIST SPECIAL PUBLICATION 1800 -10C Protecting Information and System Integrity in Industrial Control System Environments: Cybersecurity for the Manufacturing Sector Volume C: How -To Guides Michael Powell National Cybersecurity Center of Excellence National Institute of Standards and Technology Joseph Brule * Cyber Security Directorate National Security Agency Michael Pease Keith Stouffer CheeYee Tang Timothy Zimmerman Engineering Laboratory National Institute of Standards and Technology Chelsea Deane John Hoyt Mary Raguso Aslam Sherule Kangmin Zheng The MITRE Virginia Matthew Zopf Strativia Largo, Maryland *Former employee; all work for this publication done while at employer. September 2021 DRAFT This publication is available free of charge from https://www.nccoe.nist.gov/projects/use - cases/manufacturing/integrity -ics DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments i DISCLAIMER 1 Certain commercial entities, equipment, products, or materials may be identified in this document in 2 order to describe an experimental procedure or concept adequately. Such identification is not intended 3 to imply special status or relationship with NIST or recommendation or endorsement by NIST or NCCoE; 4 neither is it intended to imply that entities, equipment, products, or materials are necessarily the best 5 available for the purpose. 6 While NIST and the NCCoE address goals of improving management of cybersecurity and privacy risk 7 through outreach and application of standards and best practices, it is the stakeholder's responsibility to 8 fully perform a risk assessment to include the current threat, vulnerabilities, likelihood of a compromise , 9 and the i mpact should the threat be realized before adopting cybersecurity measures such as this 10 recommendation. 11 Domain name and IP addresses shown in this guide represent an example domain and network 12 environment to demonstrate the NCCoE project use case scenarios and the security capabilities. 13 National Institute of Standards and Technology Special Publication 1800 -10C, Natl. Inst. Stand. Technol. 14 Spec. Publ. 1800 -10C, 128 pages, September 2021 15 FEEDBACK 16 You can improve this guide by contributing feedback. As you r eview and adopt this solution for your 17 own organization, we ask you and your colleagues to share your experience and advice with us. 18 Comments on this publication may be submitted to: manufacturing_nccoe@ nist.gov . 19 Public comment period: September 2 3, 2021 through November 07 , 2021 20 All comments are subject to release under the Freedom of Information Act (FOIA). 21 National Cybersecurity Center of Excellence 22 National Institute of Standards and Technology 23 100 Bureau Drive 24 Mailstop 2002 25 Gaithersburg, MD 20899 26 Email: nccoe@nist.gov 27 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments ii NATIONAL CYBERSECURITY CENTER OF EXCELLENCE 28 The National Cybersecurity Center of Excellence (NCCoE), a part of the National Institute of Standards 29 and Technology (NIST), is a collaborative hub where industry organizations, government agencies, and 30 academic institutions work together to address businesses' most pressing cybersecurity issues. This 31 public -private partnership enables th e creation of practical cybersecurity solutions for specific 32 industries, as well as for broad, cross -sector technology challenges. Through consortia under 33 Cooperative Research and Development Agreements (CRADAs), including technology partners \u2014from 34 Fortune 50 market leaders to smaller companies specializing in information technology security \u2014the 35 NCCoE applies standards and best practices to develop modular, easily adaptable example cybersecurity 36 solutions using commercially available technology. The NCCoE do cuments these example solutions in 37 the NIST Special Publication 1800 series, which maps capabilities to the NIST Cybersecurity Framework 38 and details the steps needed for another entity to re- create the example solution. The NCCoE was 39 established in 2012 by NIST in partnership with the State of Maryland and Montgomery County, 40 Maryland. 41 To learn more about the NCCoE, visit https://www.nccoe.nist.gov/ . To learn more about NIST, visit https://www.nist.gov 43 NIST CYBERSECURITY PRACTICE GUIDES 44 NIST Cybersecurity Practice Guides (Special Publication 1800 series) target specific cybersecurity 45 challenges in the public and private sectors. They are practical, user- friendly guides that facilitate the 46 adoption of standards -based approaches to cybersecurity. They show members of the information 47 security community how to implement example solutions that help them align more easily with relevant 48 standards and best practices, and provide users wit h the materials lists, configuration files, and other 49 information they need to implement a similar approach. 50 The documents in this series describe example implementations of cybersecurity practices that 51 businesses and other organizations may voluntarily adopt. These documents do not describe regulations 52 or mandatory practices, nor do they carry statutory authority. 53 ABSTRACT 54 Today's manufacturing organizations rely on industrial control systems (ICS) to conduct their operations. 55 Increasingly, ICS are facing more frequent, sophisticated cyber attacks \u2014making manufacturing the 56 second -most targeted industry ( C. Singleton et al., X -Force Threat Intelligence IBM, February 57 2021, https://www.ibm.com/security/data -breach/threat -intelligence ). Cyber attacks against ICS 58 threaten operations and worker safety , resulting in financial loss and harm to the organization's 59 reputation. 60 The architecture and solutions presented in this guide are built upon standards -based, commercially 61 available products, and represent some of the possible solutions. The soluti ons implement standard 62 cybersecurity capabilities , such as behavioral anomaly detection, application allowlisting, file integrity - 63 checking, change control management, and user authentication and authorization. The solution was 64 tested in two distinct lab se ttings: a discrete manufacturing work cell, which represents an assembly line 65 DRAFT NIST SP 1800-10C: Protecting Information and System Integrity in Industrial Control System Environments iii production, and a continuous process control system, which represents chemical manufacturing 66 industries. 67 Organizations that are interested in protecting the integrity of the manufacturing system and 68 information from destructive malware, insider threats, and unauthorized software should first conduct a 69 risk assessment and determine the appropriate security capabilities required to mitigate those risks. 70 Once the security capabilities are identified, the sample architecture and solution presented in this 71 document may be used. 72 The security capabilities of the example solution are mapped to NIST's Cybersecurity Framework, the 73 National Initiative for Cybersecurity Education Framework, and NIST Special Publication 800 -53. 74 KEYWORDS 75 Manufacturing; industrial control systems; application allowlisting ; file integrity checking; 76 anomaly detection; software modification; 77 firmwa re modification. 78 ACKNOWLEDGEMENTS 79 We are grateful to the following individuals for their generous contributions of expertise and time. 80 Name Organization Dan Frechette Microsoft Ian Schmertzler Dispel Ben Burke Dispel Chris Jensen Tenable Bethany Brower VMWare Dennis Hui OSIsoft (now part of AVEVA) John OSIsoft (now part -USA Josh Carlson Dragos Alex Baretta Dragos T he Technology Partners/Collaborators who participated in this build submitted their products in 81 response to a notice in the Federal Register. Respondents with relevant products were invited to sign a 82 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments iv Cooperative Research and Development Agreement (CRADA) with NIST, allowing them to participate in 83 a consortium to build this example solution. The participants in this project were: 84 Technology Partner/Collaborator Product Carbon Black (VMware) Carbon Black App Control Microsoft Azure Defender for the internet of things (IoT) (incorporat- ing technology from the acquisition of CyberX) Dispel Dispel Wicket ESI Dispel Enclave Dispel VDI Interface) OSIsoft (now part of AVEVA) PI System (which comprises products such as PI Server, PI Vision and others) TDi Technologies ConsoleWorks Tenable Tenable.ot DOCUMENT CONVENTIONS 85 The terms \"shall\" and \"shall not\" indicate requirements to be followed strictly to conform to the 86 publication and from which no deviation is permitted. The terms \"should\" and \"should not\" indicate that 87 among several possibilities, one is recommended as particularly suitable without mentioning or 88 excluding others, or that a certain course of action is preferred but not necessarily required, or that (in 89 the negative form) a certain possibility or course of action is discouraged but not p rohibited. The terms 90 \"may\" and \"need not\" indicate a course of action permissible within the limits of the publication. The 91 terms \"can\" and \"cannot\" indicate a possibility and capability, whether material, physical, or causal. 92 CALL FOR PATENT CLAIMS 93 This p ublic review includes a call for information on essential patent claims (claims whose use would be 94 required for compliance with the guidance or requirements in this Information Technology Laboratory 95 (ITL) draft publication). Such guidance and/or requiremen ts may be directly stated in this ITL Publication 96 or by reference to another publication. This call also includes disclosure, where known, of the existence 97 of pending U.S. or foreign patent applications relating to this ITL draft publication and of any rel evant 98 unexpired U.S. or foreign patents. 99 ITL may require from the patent holder, or a party authorized to make assurances on its behalf, in 100 written or electronic form, either: 101 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments v a) assurance in the form of a general disclaimer to the effect that such party d oes not hold and does not 102 currently intend holding any essential patent claim(s); or 103 b) assurance that a license to such essential patent claim(s) will be made available to applicants desiring 104 to utilize the license for the purpose of complying with the gu idance or requirements in this ITL draft 105 publication either: 106 1. under reasonable terms and conditions that are demonstrably free of any unfair discrimination; 107 or 108 2. without compensation and under reasonable terms and conditions that are demonstrably free 109 of any unfair discrimination. 110 Such assurance shall indicate that the patent holder (or third party authorized to make assurances on its 111 behalf) will include in any documents transferring ownership of patents subject to the assurance, 112 provisions sufficient to ens ure that the commitments in the assurance are binding on the transferee, 113 and that the transferee will similarly include appropriate provisions in the event of future transfers with 114 the goal of binding each successor -in-interest. 115 The assurance shall also indicate that it is intended to be binding on successors -in-interest regardless of 116 whether such provisions are included in the relevant transfer documents. 117 Such statements should be addressed to: manufact uring_nccoe@nist.gov 118 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments vi Contents 119 120 121 122 123 124 125 126 2.1.1 Host and Network Configuration .................................................................................. 6 127 2.1.2 Installation .................................................................................................................... 7 128 2.1.3 Configuration ................................................................................................................ 8 129 130 2.2.1 Host and Network Configuration ................................................................................12 131 2.2.2 Installation ..................................................................................................................13 132 2.2.3 Configuration ..............................................................................................................13 133 134 2.3.1 Host and Network Configuration ................................................................................19 135 2.3.2 Installation ..................................................................................................................20 136 2.3.3 Configuration ..............................................................................................................22 137 138 2.4.1 Host and Network Configuration ................................................................................32 139 2.4.2 Installation ..................................................................................................................32 140 2.4.3 Configuration ..............................................................................................................33 141 142 2.5.1 Host and Network Configuration ................................................................................36 143 2.5.2 Installation ..................................................................................................................36 144 2.5.3 Configuration ..............................................................................................................36 145 146 2.6.1 Host and Network Configuration ................................................................................41 147 2.6.2 Installation ..................................................................................................................42 148 2.6.3 Configuration ..............................................................................................................43 149 150 2.7.1 Host and Network Configuration ................................................................................64 151 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments vii 2.7.2 Installation ..................................................................................................................65 152 2.7.3 Configuration ..............................................................................................................65 153 154 2.8.1 Host and Network Configuration ................................................................................68 155 2.8.2 Installation ..................................................................................................................68 156 2.8.3 Configuration ..............................................................................................................75 157 158 2.9.1 Host and Network Configuration ................................................................................97 159 2.9.2 Installation ..................................................................................................................97 160 2.9.3 Configuration ..............................................................................................................97 161 162 2.10.1 Host and Network Configuration ..............................................................................105 163 2.10.2 Installation ................................................................................................................106 164 2.10.3 Configuration ............................................................................................................107 165 166 2.11.1 Host and Ne twork Configuration ..............................................................................114 167 2.11.2 Installation ................................................................................................................115 168 2.11.3 Configuration ............................................................................................................115 169 Appendix A List of Acronyms ................................................................ 123 170 Appendix B Build Architecture s Diagrams ............................................ 125 171 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments viii List of Figures 172 Figure 1- 1: CSMS Network Architecture ..............................................................................................4 173 Figure 2- 1 Dispel High -level Implementation, from Remote Access for ICS ...........................................6 174 Figure 2- 2 Mapping a Network Drive ................................................................................................ 11 175 Figure 2- 3 Authentication to File Server ............................................................................................ 12 176 Figure 2- 4 Dragos OSIsoft PI Server Integration ................................................................................. 13 177 Figure 2- 5 Dragos PI Web API Configuration ...................................................................................... 14 178 Figure 2- 6 OSIsoft PI Server to Dragos Asset and Data Pairing ............................................................ 15 179 Figure 2- 7 OSIsoft PI Server and Dragos Paired Data Elements ........................................................... 15 180 Figure 2- 8 Dragos Zone Administration Page ..................................................................................... 16 181 Figure 2- 9 Dragos Create Zone Pop- up .............................................................................................. 17 182 Figure 2- 10 Forescout High -Level Components and Dataflows ........................................................... 18 183 Figure 2- 11 Forescout SecureConnector Distribution Tool ................................................................. 21 184 Figure 2- 12 Forescout Agent Download ............................................................................................ 21 185 Figure 2- 13 eyeInspect Sensor Admin/Overview Page - Add Sensor .................................................. 22 186 Figure 2- 14 Adding a New SilentDefense Sensor Dialog ..................................................................... 23 187 Figure 2- 15 eyeInspect ICMP Protocol/Port Scan Attempt Settings .................................................... 24 188 Figure 2- 16 eyeInspect Sensor Configuration Options ........................................................................ 24 189 Figure 2- 17 eyeInspect Portscan Detection Settings .......................................................................... 25 190 Figure 2- 18 Add ICS Patrol Sensor Dialog .......................................................................................... 26 191 Figure 2- 19 ICS Patrol Sensor Admin Page ......................................................................................... 27 192 Figure 2- 20 Add an ICS Patrol Scan Policy .......................................................................................... 28 193 Figure 2- 21 eyeSight Add Dialog - General Information ..................................................................... 29 194 Figure 2- 22 eyeSight Add - Command Center Credentials .................................................................. 30 195 Figure 2- 23 eyeSight OT Settings ....................................................................................................... 31 196 Figure 2- 24 eyeSight Test Connection Successful Message ................................................................. 31 197 Figure 2- 25 Azure Defender for IoT SSH Session for Network Configuration ....................................... 37 198 Figure 2- 26 Azure Defender for IoT Create New Data Mining Report for AMS Protocol Information ... 38 199 Figure 2- 27 Azure Defender for IoT Custom Alert for Firmware Major Version Number Change .......... 39 200 Figure 2- 28 Azure Defender for IoT Custom Alert for Firmware Minor Version Number Change .......... 40 201 Figure 2- 29 Azure Defender for IoT Custom Alert for Firmware Build Version Number Change ........... 40 202 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments ix Figure 2- 30 Screenshot of the PI Interface Configuration Utility before the Interface is configured. .... 44 203 Figure 2- 31 Screenshot of the PI Data Collection Manager Displaying Green Checkmarks After the PI 204 System Connector is Properly Configured ......................................................................................... 45 205 Figure 2- 32 Screenshot of the PI Interface Configuration Utility Showing the Added Scan Class # 2 for 206 Polling the PLC Every 60 Seconds ...................................................................................................... 54 207 Figure 2- 33 Screenshot of the PI System Management Tools Component After Configuring the PI 208 Points for PLC Hardware and Firmware Version Number Integrity Checking ....................................... 56 209 Figure 2- 34 Screenshot of PI System Explorer Displaying some Attributes of the PLC Element. 210 Attributes for the TwinCAT version number are visible in the list. ..................................................... 59 211 Figure 2- 35 Screenshot of PI System Explorer Displaying the Hardware Serial Number Mismatch Event 212 Frame Template. .............................................................................................................................. 60 213 Figure 2- 36 Screenshot of PI System Explorer Displaying the TwinCAT Version Mismatch Event Frame 214 Template ......................................................................................................................................... 61 215 Figure 2- 37 Screenshot of PI System Explorer Displaying the Hardware Serial Number Mismatch 216 Analysis Template in the PLC Element Template ............................................................................... 62 217 Figure 2- 38 Screenshot of PI System Explorer Displaying the TwinCAT Firmware Version Mismatch 218 Analysis Template in the PLC Element Template ............................................................................... 63 219 Figure 2- 39 Wazuh Agent Manager ................................................................................................... 66 220 Figure 2- 40 ossec.conf File ................................................................................................................ 66 221 Figure 2- 41 Wazuh Agent Manager User Interface ............................................................................ 67 222 Figure 2- 42 Log Received After a File Change Was Detected .............................................................. 67 223 Figure 2- 43 ConsoleWorks Registration Screen ................................................................................. 73 224 Figure 2- 44 ConsoleWorks Offline Registration Process ..................................................................... 73 225 Figure 2- 45 ConsoleWorks System Backups ....................................................................................... 74 226 Figure 2- 46 ConsoleWorks Importing System Configurations and Components .................................. 75 227 Figure 2- 47 ConsoleWorks P assword Settings ................................................................................... 76 228 Figure 2- 48 ConsoleWorks Add the Local Graphical Gateway for RDP Access ..................................... 77 229 Figure 2- 49 ConsoleWorks Example Device Type Definition ............................................................... 79 230 Figure 2- 50 ConsoleWorks List of Device Types ................................................................................. 79 231 Figure 2- 51 ConsoleWorks Example Device Definition ....................................................................... 80 232 Figure 2- 52 ConsoleWorks List of PCS (Build 1) Devices ..................................................................... 81 233 Figure 2- 53 ConsoleWorks List of CRS (Build 3) Devices ..................................................................... 82 234 Figure 2- 54 ConsoleWorks Example RDP Configuration ..................................................................... 83 235 Figure 2- 55 ConsoleWorks List of PCS (Build 1) RDP Connections ....................................................... 85 236 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments x Figure 2- 56 ConsoleWorks List of CRS (Build 3) RDP Connections ....................................................... 86 237 Figure 2- 57 ConsoleWorks Example Console (SSH) Connection .......................................................... 87 238 Figure 2- 58 ConsoleWorks Example Console (Web Forward) Connection ........................................... 88 239 Figure 2- 59 ConsoleWorks List of PCS (Build 1) Console Connections ................................................. 89 240 Figure 2- 60 ConsoleWorks List of CRS (Build 3) Console Connections ................................................. 90 241 Figure 2- 61 ConsoleWorks List of Tags for PCS (Build 1) ..................................................................... 91 242 Figure 2- 62 ConsoleWorks Example Tag Definition Screen ................................................................. 92 243 Figure 2- 63 ConsoleWorks Example Profile ....................................................................................... 95 244 Figure 2- 64 Tenable.OT Local Device Setting for NTP Service ............................................................. 98 245 Figure 2- 65 Tenable.OT Asset Discovery Settings ............................................................................... 99 246 Figure 2- 66 Tenable.OT Controller Scans ......................................................................................... 100 247 Figure 2- 67 Tenable.OT Network Scan Settings ............................................................................... 101 248 Figure 2- 68 Tenable.OT Create Asset Group Type ............................................................................ 101 249 Figure 2- 69 Tenable.OT Create Asset Group Definition .................................................................... 102 250 Figure 2- 70 Tenable.OT Policy Settings ........................................................................................... 103 251 Figure 2- 71 Tenable.OT Create Policy - Event Type Options ............................................................ 103 252 Figure 2- 72 Tenable.OT Create Policy - Definition ............................................................................ 104 253 Figure 2- 73 Tenable.OT Create Policy - Actions................................................................................ 105 254 Figure 2- 74 Excerpt from Carbon Black Documentation on Support Server Requirements ................ 108 255 Figure 2- 75 IIS Configuration for Carbon Black, Server Roles ............................................................ 109 256 Figure 2- 76 Carbon Black Policy Edit ............................................................................................... 110 257 Figure 2- 77 Carbon Black App Control System Configuration ........................................................... 111 258 Figure 2- 78 Carbon Black App Control AD Policy Mappings .............................................................. 112 259 Figure 2- 79 Ca rbon Black Agent Download ...................................................................................... 113 260 Figure 2- 80 Carbon Black App Control Computers ........................................................................... 113 261 Figure 2- 81 Carbon Black App Control File Catalog .......................................................................... 114 262 Figure 2- 82 Setting Enforcement Properties .................................................................................... 117 263 Figure 2- 83 Setting Security Level Default ....................................................................................... 118 264 Figure 2- 84 Additional Rules Defined for Lab Environment .............................................................. 119 265 Figure 2-85 Menu Options for Accessing the Link an Existing GPO Option ........................................ 120 266 Figure 2- 86 Dialog Box for Selecting GPO to Link ............................................................................. 121 267 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments xi Figure B - 1 Build 1 Architecture Diagram ........................................................................................ 125 268 Figure B - 2 Build 2 Architecture Diagram ........................................................................................ 126 269 Figure B - 3 Build 3 Architecture Diagram ........................................................................................ 127 270 Figure B - 4 Build 4 Architecture Diagram ........................................................................................ 128 271 List of Tables 272 Table 2 -1 Dispel Deployment ..............................................................................................................6 273 Table 2 -2 Firewall Rules for Dispel ......................................................................................................9 274 Table 2 -3 Firewall Rules .................................................................................................................... 10 275 Table 2 -4 Dragos Deployment .......................................................................................................... 12 276 Table 2 -5 Fore scout Deployment ...................................................................................................... 19 277 Table 2 -6 eyeSight Agent Deployment .............................................................................................. 278 Table 2 -7 Firewall Rules for Forescout .............................................................................................. 20 279 GreenTec -USA WORMdrive and ForceField Deployment .................................................... 32 280 Table 2 -9 Microsoft Azure Defender IoT Deployment ........................................................................ 36 281 Table 2 -10 OSIsoft PI Domain Hosts Deployment .............................................................................. 41 282 Table 2 -11 OSIsoft PI CRS Hosts Deployment .................................................................................... 41 283 Table 2 -12 OSIsoft PI PCS Hosts Deployment ..................................................................................... 41 284 Table 2 -13 Security Onion Domain Hosts Deployment ....................................................................... 64 285 Table 2 -14 Security Onion PCS Hosts Deployment ............................................................................. 65 286 Table 2 -15 Security Onion CRS Hosts Deployment ............................................................................. 65 287 Table 2 -16 ConsoleWorks Build 1 Deployment .................................................................................. 68 288 Table 2 -17 ConsoleWorks Build 3 Deployment .................................................................................. 68 289 Table 2 -18 ConsoleWorks Device Type List ........................................................................................ 78 290 Table 2 -19 ConsoleWorks PCS (Build 1) Devices ................................................................................ 80 291 Table 2 -20 ConsoleWorks CRS (Build 3) Devices ................................................................................ 81 292 Table 2 -21 ConsoleWorks PCS (Build 1) Graphical Connections .......................................................... 84 293 Table 2 -22 ConsoleWorks CRS (Build 3) Graphical Connections .......................................................... 86 294 Table 2 -23 ConsoleWorks PCS (Build 1) Co nsole Connections ............................................................ 88 295 Table 2 -24 ConsoleWorks CRS (Build 3) Console Connections ............................................................ 89 296 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments xii Table 2 -25 2 -26 Firew all Rules for Tenable.OT .......................................................................................... 97 298 Table 2 -27 Carbon Black App Control Domain Hosts Deployment .................................................... 106 299 Table 2 -28 Carbon Black App Control PCS Hosts Deployment .......................................................... 106 300 Table 2 -29 Carbon Black App Control CRS Hosts Deployment .......................................................... 106 301 Table 2 -30 Windo ws SRP Domain Servers ....................................................................................... 114 302 Table 2 -31 Windows SRP Build 2 Deployment ................................................................................. 115 303 Table 2 -32 Windows SRP Build 3 Deployment ................................................................................. 115 304 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 1 1 Introduction 305 The following volume of this guide show information technology ( IT) professionals and security 306 engineers how we implemented this example solution. We cover all the products employed in this 307 reference design. We do not re- create the product manufacturers' documentation, which is presumed 308 to be widely available. Rather, these volumes show how we incorporated the products together in our 309 environment. 310 Note: These ar e not comprehensive tutorials. There are many possible service and security configurations 311 for these products that are out of scope for this reference design. 312 1.1 How to Use this Guide 313 This NIST Cybersecurity Practice Guide demonstrates a modular design and provides users with the 314 information they need to replicate the described manufacturing industrial control system ( ICS) security 315 solutions, specifically focusing on information and system integrity. This reference design is modular and 316 can be dep loyed in whole or in part. 317 This guide contains three volumes: 318 NIST SP 1800 -10A: Executive Summary 319 NIST SP 1800 -10B: Approach, Architecture, and Security Characteristics - what we built and why 320 NIST SP 1800 -10C: How -To Guides - instructions for building the example solution (this 321 document ) 322 Depending on your role in your organization, you might use this guide in different ways: 323 Senior information technology (IT) executives, including chief information security and technology 324 officers, will be interested in the Executive Summary, NIST SP 1800 -10A, which describes the following 325 topics: 326 challenges that enterprises face in ICS environments in the manufacturing sector 327 example solution built at the NCCoE 328 benefits of adopting the examp le solution 329 Technology or security program managers might share the Executive Summary , NIST SP 1800 -10A, with 330 your leadership to help them understand the importance of adopting a standards -based solution. Doing 331 so can strengthen their information and syste m integrity practices by leveraging capabilities that may 332 already exist within their operating environment or by implementing new capabilities. 333 Technology or security program managers who are concerned with how to identify, understand, assess, 334 and mitigat e risk will be interested in NIST SP 1800 -10B, which describes what we did and why. The 335 following sections will be of particular interest: 336 Section 3.4.1, Security Control Map, maps the security characteristics of this example solution to 337 cybersecurity standards and best practices . 338 IT professionals who want to implement an approach like this will find th is whole practice guide 339 useful. You can use th is How -To portion of the guide, NIST SP 1800- 10C, to replicate all or parts 340 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 2 of the build crea ted in our lab. Th is How -To portion of the guide provides specific product 341 installation, configuration, and integration instructions for implementing the example solution. 342 We do not recreate the product manufacturers' documentation, which is generally wide ly 343 available. Rather, we show how we incorporated the products together in our environment to 344 create an example solution. 345 This guide assumes that IT professionals have experience implementing security products within the 346 enterprise. While we have used a su ite of commercial products to address this challenge, this guide does 347 not endorse any products . Your organization can adopt this solution or one that adheres to th ese 348 guidelines in whole, or you can use this guide as a starting point for tailoring and impl ementing parts of 349 this manufacturing ICS solution . Your organization's security experts should identify the products that 350 will best integrate with your existing tools and IT system infrastructure. We hope that you will seek 351 products that are congruent with applicable standards and best practices. Section 3.5, Technologies, in 352 NIST SP 1800- 10B, lists the products that we used and maps them to the cybersecurity controls provided 353 by this reference solution. 354 A NIST Cybersecurity Practice Guide does not describe \"the\" solution, but a possible solution. This is a 355 draft guide. We seek feedback on its contents and welcome your input. Comments, suggestions, and 356 success stories will improve subsequent versions of th is guide. Please contribute your thoughts to 357 manufacturing_nccoe@nist.gov . 358 1.1 Build Overview 359 The NCCoE partnered with NIST's Engineering Laboratory (EL) to provide real- world scenarios that could 360 happen in I CS in the manufacturing sector. This collaboration spawned four unique builds: two builds 361 within the Collaborative Robotics (CRS) environment and two builds within the Process Control System 362 (PCS) environment. For each build, the NCCoE and the EL performed eleven scenarios. The step -by-step 363 instructions on how each product was installed and configured in this lab environment are outlined in 364 this document. For more information on the two environments refer to Section 4.5 in NIST SP 1800 -10B. 365 Additionally, Appendix B of this Volume contains the four build architecture diagrams for reference. 366 1.2 Typographic Conventions 367 The following table presents typographic conventions used in this volume. 368 Typeface/Symbol Meaning Example Italics file names and path names ; references to documents that are not hyperlinks ; new terms ; and placeholders For language use and style guidance, see the NCCoE Style Guide . Bold names of menus, options, command buttons , and fields Choose File > Edit. Monospace command -line input, on- screen computer output, sample code examples, and status codes mkdir DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 3 Typeface/Symbol Meaning Example Monospace Bold command -line user input contrasted with computer output service sshd start blue text link to other parts of the doc-ument, a web URL, or an email address All publications from NIST's NCCoE are available at http s://www. nccoe.nist.gov . 1.3 Logical Architecture Summary 369 The security mechanisms and technologies were integrated into the existing NIST Cybersecurity for 370 Smart Manufacturing Systems (CSMS) lab environment. This cybersecurity performance testbed for ICS 371 is comprised of the PCS and the CRS environments along with additional networking capabilities to 372 emulate common manufacturing environments. For more information see An Industrial Control System 373 Cybersecurity Performance Testbed, NISTIR 8089, 374 manufacturing organizations have unique cyber- ecosystems and specific needs for their 376 operation s. To demonstrate the modularity and interoperability of the provided solutions, this project 377 used av ailable Cooperative Research and Development Agreement ( CRADA ) partner technologies to 378 assemble four \"builds\" deployed across both the PCS and CRS. Additionally, to increase the diversity of 379 technologies between builds, two of the builds also utilized open source solutions (Security Onion 380 Wazuh), native operating system features (Windows Software Restriction Policies [ SRP]), and a Cisco 381 Adaptive Security Appliance ( ASA) device configured with the AnyConnect VPN client. 382 Figure 1 -1 depicts a high -level architecture for the demonstration environment consisting of a Testbed 383 Local Area Network (LAN), a demilitarized zone (DMZ), the PCS, and the CRS. The environment utilizes a 384 combination of physical and virtual systems and maintains a local n etwork time protocol (NTP) server 385 for time synchronization. Additionally, the enviro nment utilizes virtualized Active Directory (AD) servers 386 for domain services. The tools used to support information and system integrity are deployed and 387 integrated in the DMZ, Testbed LAN, PCS, and CRS per vendor recommendations and standard practices 388 as described in the detailed sections for each build. 389 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 4 Figure 1-1: CSMS Network Architecture 390 Collaborative Robotics System Manufacturing Station Controllers 192.168.1.101 -104 Corporate Network Historian 10.100.1.4 Layer 2 Switch Corporate Router Firewall VPN Corporate Workstation Operator HMI 192.168.0.98 Engineering Workstation 192.168.0.20 PLC 192.168.0.30 Remote I/O 192.168.0.60 Local Historian 192.168.0.21 Robot Controller 192.168.1.202 Robot Controller 192.168.1.201 Active Directory Primary 10.100.0.17 Windows Server 10.100.0.25 NTP/PTP Clock 10.100.0.15 Active Directory Secondary 10.100.0.13 Layer 2 Switch Layer 2 Switch CRS LAN Router (NAT) 10.100.0.20 192.168.0.2 192.168.1.2 Engineering Workstation 172.16.3.10 Field BusProcess Control System PLC 172.16.2.102 HMI Host 172.16.1.4 Controller 172.16.1.5 Layer 2 Switch Plant Simulator 172.16.2.3 OPC Server 172.16.2.5 Layer 2 Switch Local Historian 172.16.2.14 TE LAN Router (OSPF) 10.100.0.40 Layer 2 Switch In summary, there are six networks within the CSMS architecture: 391 Testbed LAN: This network is where the majority of the collaborators' products are installed. This LAN 392 has access to the PCS and CRS environments. Other systems , such as AD, an NTP server, and a Windows 393 server , are also located on this LAN. The Testbed LAN has three gateways to other network segments , 394 including 10.100.0.1 to reach the DMZ and the corporate network , 10.100.0.20 as a network address 395 translation (NAT) interface to the CRS environment , and 10.100.0.40 as the gateway to the PCS 396 environment. 397 DMZ: A demilitarized zone t hat separates the corporate network from the operational technology ( OT) 398 network. Many of the collaborators' products are also installed in the DMZ. The DMZ is used across the 399 PCS and CRS environments. 400 PCS Virtual Local Area Network ( VLAN ) 1: This is the o perations LAN within the PCS environment. This 401 LAN simulates a central control room environment. The gateway interface for this network segment is 402 172.16.1.1 403 PCS VLAN 2: This is the supervisory LAN within the PCS environment. This LAN simulates the process 404 operation/manufacturing environment, which consists of the operating plant, programmable logic 405 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 5 controller ( PLC)s, object linking and embedding for process control ( OPC ) server , and data historian. The 406 gateway interface for this network segment is 172.16.2.1 407 CRS Supervisory LAN: This LAN is within the CRS environment. The historian, PLCs, o perating human 408 machine interface ( HMI ), Engineering workstation, and remote input/output devices are connected t o 409 this network. The gateway interface for this network segment is 192.168.0.2 410 CRS Control LAN : This LAN is within the CRS environment. The robot controllers and manufacturing 411 station controllers are connected to this network. The gateway interface for this network segment is 412 192.168.1.2 413 The test bed networks used static IPv4 addresses exclusively, and the subnet masks were set to 414 255.255.255.0. No IPv6 addresses were used. This setup is consistent with industry pr actice. Specific 415 Internet Protocol ( IP) addr esses are listed for each component in the following sections. 416 For an in -depth view of the architectures PCS and CRS builds, specific build architecture diagrams can be 417 found in Volume B of this practice guide, Section 4.3, Process Control System , and Section 4.4, 418 Collaborative Robotics System. 419 2 Product Installation Guides 420 This section of the practice guide contains detailed instructions for installing and configuring all the 421 products used to build the example solution s. 422 2.1 Dispel Remote Access 423 Dispel is a remote access tool for OT environments that provides secure remote access to the industrial 424 networks. Dispel, implemented in Build 2 and Build 4, uses cloud -based virtual desktop interfaces (VDIs) 425 that traverse a cloud -based Enclave to reach a Wicket ESI device that is deployed within the local OT 426 network. Dispel supports both user authentication and authorization, and remote access for Builds 2 427 and 4. 428 Virtual Desktop Interfaces (VDIs) 429 VDIs are Virtual Machines (VMs) that reside in the cloud and allow users to connect using Remote 430 Desktop Protocol (RDP). The VDIs establish a secure connection to the Wicket ESI located in the OT 431 network to provide network access to the OT devices. 432 Enclave 433 Enclaves are single -tenanted, colorless core, moving target defen se (MTD) networks. Enclaves are 434 composed of VMs that act as traffic nodes. To create a shifting target profile, these VMs are steadily 435 replaced by new VMs launched on different hypervisors, in different geographic regions, and/or on 436 altogether different pu blic or private clouds. In the case of Builds 2 and 4, the Enclaves were launched 437 exclusively on public clouds. To provide a static set of IP addresses throughout the builds , the MTD 438 characteristic was disabled. 439 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 6 Wicket ESI 440 Wicket , shown in Figure 2 -1, that allows users to connect to the OT 441 network remotely. These devices establish encrypted connection s from the local OT network up to an 442 Enclave which, in turn , is connected to the VDI , allo wing a remote user to access the OT devices. 443 Additional information is available in Remote Access for Industrial Control Systems from Dispel.io at: 444 https://s3.amazonaws.com/downloads.dispel.io/resources/One+Pager/dispel -ics- 445 brochure_20190529.pdf 446 Figure 2-1 Dispel High -level Implementation , from Remote Access for I CS 447 2.1.1 Host and Network Configuration 448 The Wicket ESI is connected to two ports within the DMZ , one for supporting outbound communications 449 to the Dispel Enclave (labeled \"WAN\") and one for supporting communication through the local firewall 450 to the ICS environment (labeled \"LAN\"). The items listed in Table 2 -1 are the Wicket ESI specific device 451 and network settings for the hardware provided to support Build 2 Figure B-2 and 4 Figure B -4. 452 Table 2-1 Dispel Deployment 453 Name System OS CPU Memory Storage Network Dispel Wicket ESI DMZ Dispel Enclave Cloud Virtual Machines Ubuntu 16.04 Variable Variable Variable N/A Dispel VDI Cloud Virtual Machine Windows Server 2016 Intel 8GB 120GB N/A DRAFT NIST SP 1800- 10C: Protecting and System Integrity in Industrial Control System Envir onments 7 2.1.2 Installation 454 Installation involves establishing an account on the Dispel cloud -infrastructure and deploying the 455 preconfigured Wicket ESI device within the OT environment. Detailed installation information , 456 customized to the end user's deployment, is provided by Dispel. 457 After connecting the WAN and LAN network cables, configuring the Wicket ESI required connecting a 458 monitor, keyboard, and mouse to the unit using the available VGA and USB ports. Logging into the unit 459 locally using the credentials provided by Dispel enable d configur ation of the network connections using 460 the following procedure (note: these procedures were executed using root privileges and can also be 461 performed using S udo). 462 1. Update the network interfaces with the IP configuration information : 463 #> vi address > 2. Update the Wicket ESI netcutter.cfg file to include the local subnet information (toward the 465 bottom of the file) : 466 #> vi /home/ubuntu/wicket/netcutter.cfg 467 ... subnets = ( { name = \"Default\"; value = \"10.100.0.0/24\"; advertise = \"false\"; }, { name = \"PCS\"; value = \"172.16.0.0/22\"; advertise = \"false\"; DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 8 }, { name = \"DMZ\"; value = \"10.100.1.0/24\"; advertise = \"false\"; } ); 3. Restart the Wicket services with the following command : 468 #> service wicket restart 469 4. Check the log for errors and test connectivity to the Dispel environment (note: IP address will be 470 account specific) : 471 #> tail - f /home/ubuntu/wicket/wicket.log 472 2.1.3 Configuration 473 With the Wicket ESI connected to the lab environment, the solution may be configured by establishing 474 an account and configuring the cloud infrastructure, configuring the corporate router/firewall to allow 475 authorized connections to and from the Wicket ESI , and configuring the VDI env ironment to support the 476 remote access to the ICS environments. 477 For full documentation and configuration instructions , see the Dispel documentation at 478 https://intercom.help/dispel/en/ . 479 Dispel created an orga nization named \"NCCOE\" with an Enclave name \"NCCoE -Manufacturing\" in their 480 pre-production staging environment. A single \"user\" account was created for accessing the cloud 481 infrastructure environment named nccoe -m-user@dispel.io . Organizations will need to p lan for 482 implementing multiple accounts for supporting the \"owner\" and \"admin\" roles in addition to the \"user\" 483 roles. The \"owner\" and \"admin\" roles are for monitoring and managing the cloud infrastructure and are 484 separate from the user accounts used to logi n to the VDI environment. 485 The staging environment was configured without the Dispel multifactor authentication ( MFA) settings 486 because personal identity verification ( PIV) cards were not available as a supported mechanism , and the 487 lab environment did not support authenticator application or security keys. However, MFA is very 488 important for implementation and is strongly encouraged when planning the implementation. For this 489 effort, to reduce the risk of not having the MFA implementation, NCCoE worked with Dispel to limit 490 access to the cloud infrastructure and the VDI instances to only approved source IP addresses. The 491 additional protection of restricting access to the cloud i nfrastructure and VDI instances is also 492 encouraged to reduce the risks associated with the internet -accessible web and RDP service s. 493 Configure Firewall Settings : 494 The Wicket ESI needs access to the internet and to the internal OT environment. Table 2 -2 below 495 describes the firewall rules implemented on the corporate r outer/ firewall for communications on the 496 internet- facing firewall and internal network zone firewall. 497 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 9 Table 2-2 Firewall Rules for Dispel 498 Rule Type Source Destination Protocol:Port(s) Purpose Allow 10.100.1.60 IdAM : 159.65.111.193 Entry Node : 52.162.177.202 TCP/UDP:1194, HTTPS Outbound Secure Web to Dis- TCP:1515 UDP:1514 Build 2: Communication be- the server Allow 10.100.1.61 172.16.0.0/22 TCP:RDP, HTTP/HTTPS Build 2: Authorized Inbound Communications Envi- ronment Allow 10.100.1.61 Carbon Black 10.100.0.52 TCP:41002 Build 4: C ommunication port used between Carbon Black Agent and the server Allow 10.100.1.61 CRS NAT 10.100.0.20 TCP:48898 UDP:48899 Build 4: Inbound Automation Device Specification ( ADS) Protocol for Communication with PLC Device Notes: 499 Dispel 's recommended rule for allowing secure shell ( SSH)for installation and remote support 500 from the Dispel environment was not enabled for this effort. 501 The rules implemented included restricting these outbound ports to E nclave specific IP 502 addresses. 503 The Enclave's MTD characteristics were disabled to keep the Enclave's IP addresses static for the 504 duration of the project. 505 Configure Virtual Desktop Infrastructure (VDI) : 506 The VDI instance is a fully functional workstation/server within the cloud environment. From the 507 VDI instance, authorized users establish a VPN tunnel to the Wicket ESI withi n the OT 508 environment and then have the access to the environment configured by the device and firewall 509 configurations. In this effort, NCCoE implanted the VDI configuration to support Build 2 and 510 Build 4. The configuration supports the OT environment 's jump server configuration (allowing 511 RDP and SSH access to systems within the PCS and CRS environment) and remote engineering 512 workstation (configuring the VDI with the tools needed to support the ICS environment). The 513 configuration for each build is detailed in the following sections. 514 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 10 1. Build 2: PCS Configuration 515 i. For the PCS setup, the Dispel VDI was used in a jump server configuration. No 516 additional software was installed. The firewall and Wicket ESI configuration 517 allowed RDP and SSH connections to the PCS ICS environment. Additionally, RDP, 518 SSH, and HTTP/HTTPS ac cess to the Cybersecurity LAN environment was 519 authorized for the remote sessions as defined in the previously described f irewall 520 settings , Table 2-2. 521 2. Build 4: CRS Config uration 522 i. For the CRS setup, the Dispel VDI was configured as a remote engineering 523 workstation. To support the Beckhoff PLC, the TwinCAT 3 XAE software was 524 installed on a VDI, and the network drive provided by the GreenTec -USA solution 525 and hosted in the DMZ environment that contained the PLC code was mapped to 526 the VDI . Additionally, RDP, SSH, and HTTP/HTTPS access to the Cybersecurity LAN 527 environment was authorized for the remote sessions as defined in the previously 528 described firewall settings , Table 2-2. 529 ii. For the interaction with the Beckhoff PLC, the TwinCAT 3 XAE software (TC31 - 530 FULL -Setup.3.1.4024.10.exe) was installed on the VDI . 531 iii. The Dis pel VPN connection does not allow split -tunneling so, once the VPN 532 connection is established from the VDI to the Wicket ESI, the VDI is disconnected 533 from the internet . Therefore, download and installation of software occurred 534 prior to connecting to the Wic ket ESI. 535 iv. Due to the NAT configuration of the RUGGEDCOM RX1510 router between the 536 Cybersecurity LAN and the CRS environment, port forwarding rules were 537 configured to allow external traffic to reach the Beckhoff CX9020 PLC. 538 v. The following rules ( Table 2 -3) were created in the RX1510 firewall to enable 539 destination network address translation (DNAT) from the firewall WAN interface 540 (10.100.0.20) to the CRS PLC ( 192.168.0.30) 541 Table 2-3 Firewall Rules 542 Rule 10.100.1.61 192.168.0.30 UDP:48899 DNAT discovery protocol used by the TwinCAT 3 software to discover ADS devices. DNAT 10.100.1.61 192.168.0.30 TCP:48898 DNAT (10.100.0.20) - Beckhoff ADS by the TwinCAT 3 software to com- municate with the PLC . DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 11 3. As described in 2.i above, t he GreenTec WORMdisk (\\\\10.100.1.7 \\crs) was mapped to the 543 VDI to access the PLC code. T he configuration to map Windows is shown in Figure 2 -2 544 below: 545 Figure 2-2 Mapping a Network Drive 546 4. After clicking Finish , the user is prompted for credentials, as shown in Figure 2 -3. An account 547 authorized to access the network drive must be use d. This is separ ate from the Dispel VDI 548 credentials. 549 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 12 Figure 2-3 Authentication to File Server 550 2.2 Dragos 551 The Dragos platform implementation in Build 3 consists of two physical servers hosting the Dragos 552 SiteStore and the Dragos sensor to meet the behavioral anomaly detection (BAD ), hardware 553 modification, firmware modification, and s oftware modification capabilities. Dragos utilizes a 554 combination of a passive sensor and integration with the OSIsoft PI Server to monitor critical networks 555 for anomalies . OSIsoft PI performs active querying to retrieve information about endpoints in the CRS 556 environment , which is shared with Dragos . 557 2.2.1 Host and Network Configuration 558 Dragos is installed and configured to support the CRS Environment in Build 3 . The overall build 559 architecture is shown in Figure B -3, and the Dragos specific components are listed in Table 2 -4. 560 Table 2-4 Dragos Deployment 561 Name System OS CPU Memory Storage Network VMware Server Dell OEMR R740 VMware 7 1.5 TB 1.5 TB Testbed LAN 10.100.0.63/24 Dragos Sensor Dell OEM 128 240 GB LAN 10.100.0.64/24 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 13 2.2.2 Installation 562 The Dragos platform , which includes the SiteStore server and the Dragos sensor , was delivered as pre - 563 configured hardware appliance by Dragos with the required IP addresses already assigned . The only 564 installation step was corre ctly connecting the server and the sensor management ports to the Testbed 565 LAN and adding the switch port analyzer (SPAN ) port connection to the sensor . 566 The Dragos Platform Administrator Guide and Dragos Platform User Guide for Release 1.7 were used to 567 guide the installation. Customers can obtain these guides from Drag os. 568 2.2.3 Configuration 569 In addition to the standard configuration preset by Dragos, the Dragos Platform was configured to work 570 with OSIsoft PI for alerting on certain conditions. 571 Configure the Dragos SiteStore Server: 572 1. Configure the data between Dragos SiteStore and OSIsoft PI Server : 573 a. Once installation is successful, open a browser to access the configuration screen by us- 574 ing the URL https://<SiteStore ip address>/osisoft/ -4) 575 Figure 2-4 Dragos OSIsoft PI Server Integration 576 b. Click Configuration Pi Web API to open a screen for filling out the required information , 577 includ ing privacy enhanced mail (PEM ) format certificate and password for secure 578 authentication (Figure 2 -5). 579 i. Upload the server public key for the HTTPS certificate . 580 ii. Specify the user credentials for the OSIsoft PI Web API interface. 581 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 14 iii. Click Save . 582 Figure 2-5 Dragos PI Web API Configuration 583 584 c. Click Map Elements to access the interface to pair elements between OSI soft PI Server 585 and the Dragos Platform assets. Here , the PLC in OSIsoft Elements panel is paired with 586 Beckhoff asset in the Dragos Platform asset (Figure 2 -6). 587 i. Select the OSIsoft Database CRS-backup on the left side to access the devices list 588 from the Historian Database . 589 ii. Select the Default NetworkID RFC 1918 and use the Filer options to find specific 590 assets. 591 iii. For each asset in the OSIsoft Database , select the corresponding asset in the Dra- 592 gos asset repository and click Pair Selected . 593 iv. Repeat this process for each asset until all paired assets are listed in the Paired 594 Data table ( Figure 2 -7). 595 1) PLC paired to 192.168.0.30 596 2) Station 1 paired to 192.168.1.101 597 3) Station 2 paired to 192.168.1.10 2 598 4) Station 3 paired to 192.168.1.10 3 599 5) Station 4 paired to 192.168.1.10 4 600 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 15 Figure 2-6 OSIsoft PI Server to Dragos Asset and Data Pairing 601 602 Figure 2-7 OSIsoft PI Server and Dragos Paired Data Elements 603 604 a. Configure Zones 605 NOTE: Zones are ordered in a similar manner to firewall rules . In other words, higher rules 606 have priority over lower rules. 607 i. Click Assets and select the Zones tab ( Figure 2 -8). 608 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 16 Figure 2-8 Dragos Zone Administration Page 609 b. Click + New Zone (Figure 2 -9) and define the following zones: 610 i. Name: DMZ : 611 1) Description: Lab 1) Description: Lab Testbed LAN 616 2) Auto Zone Criteria (Match ALL): 617 a) IPV4 CIDR Matches CIDR 10.100.0.0/24 618 iii. Name: CRS: 619 1) Description: Parent CRS 620 2) No Criteria 621 iv. Name: CRS - Level 0 : 622 1) Description: Robots and Controllers 623 2) Parent Zone: CRS 624 3) Auto Zone Criteria (Match ALL) : 625 a) IPV4 CIDR Matches CIDR 192.168.1.0/24 626 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 17 v. Name: CRS - Level 1 : 627 1) Description: Lab DMZ 628 2) Parent Zone: CRS 629 3) Auto Zone Criteria (Match ALL) : 630 a) IPV4 CIDR Matches CIDR 192.168.0.0/24 631 Figure 632 2.3 Forescout Platform 633 The Forescout products included in the practice guide are eyeInspect (formally SilentDefense), eyeSight, 634 ICS Patrol, and Forescout Console. These products are utilized in Build 2 to meet the BAD , hardware 635 modification, firmware modification, and s oftware modification The Fores cout 636 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 18 implementation utilizes different components and modules installed on different devices to monitor 637 critical networks for anomalies and active query capabilities to retrieve information about endpoints in 638 the PCS envi ronment. A high -level of the key server and agent components is presented in Figure 2 -10. 639 Figure 2-10 Forescout High -Level Components and 641 The eyeInspect (Version 4.1.2) control server and monitoring sensor are installed on a single appliance 642 with a management interface on the Testbed VLAN and network monitoring capabilities through a 643 dedicated SPAN port. The SPAN port provides passive monitoring for netwo rk-based anomalies and 644 retrieves information about endpoints within the network. The eyeInspect appliance also serves as the 645 command center for supporting the ICS Patrol and eyeSight components. 646 eyeSight 647 Forescout eyeSight ( Version 8.2.1 network monitoring and response using an agent 648 installed on endpoints. In this build, eyeSight instances are configured through the Forescout Console to 649 provide additional monitoring and reporting information to eyeInspect. 650 ICS Patrol 651 Forescout ICS Patr ol (Version 1.1.2 -4.a826b94) is a sensor that supports active queries for ICS devices to 652 obtain status and other information such as hardware configuration and firmware version. ICS Patrol 653 queries and reporting results are managed through eyeInspect. 654 Fores cout Console 655 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 19 The Forescout Console (Version 8.2.1) is a Java -based application for configuring and managing eyeSight 656 and eyeSight agents. The Forescout Console is installed on a computer with network access to the 657 eyeSight server. 658 2.3.1 Host and Network Configur ation 659 Forescout was installed and configured to support the PCS Environment as part of Build 2 . The overall 660 build architecture is provided in Figure B -2 with the Forescout specific components in Table 2 -5 and the 661 eyeSight agents in Table 2 -6. 662 Table 2-5 Forescout Deployment 663 Name System OS CPU Memory Storage Network eyeInspect control server Dell Embed-ded Box PC 5000 Ubuntu 16.04 Intel i7- 6820EQ 32 GB 250 GB Testbed LAN Console Hyper -V VM Windows 2x 6 GB 65 GB LAN Dell R640 Ubuntu 4110 600 GB Patrol VirtualBox VM Ubuntu 16.04.06 2x vCPU 2 GB 40 GB PCS VLAN 2 172.16.2.62 For the lab environment, network connectivity between the components in the Testbed LAN and the 664 components in the PCS environment required the following persistent route configured on Testbed LAN 665 systems : 666 route -p ADD 172.16.0.0 MASK 255.255.252.0 10.100.0.40 667 The following systems were configured to utilize the eyeSight Agents. 668 Table 2-6 eyeSight Agent Deployment 669 Name System OS CPU Memory Storage Network Engineering Workstation Dell T5610 Windows 7 Intel i5 - 4570 16 GB 465 GB PCS VLAN 3 172.16.3.10 HMI Host Generic Windows 7 Intel i5 - 4590 8 GB 233 GB PCS VLAN 1 172.16.1.4 Additional details for Build 2 are available in Section 4.5 of Volume B. 670 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 20 2.3.2 Installation 671 The Forescout products included in the practice guide are eyeInspect, Forescout Console, ICS Patrol, and 672 eyeSight. These products are installed as indicated in the appropriate subsection below. To support 673 these components, the PCS Gateway/Firewall rules were updated as follows (Table 2 -7). 674 Table 2-7 Firewall Rules for Forescout 675 Rule Purpose Allow 10.100.0.65 22 (ssh) 676 eyeInspect is an appliance hosted on a Dell Embedded Box PC 5000 . The unit was placed within a 677 standard datacenter rack unit with the eyeSight appliance and connected to the network as described in 678 Section 2.3.1. SPAN ports from the DMZ, Testbed LAN, and PCS VLAN 1, 2, and 3 switches were routed 679 to the appliance for passive network monitoring. Installation also require d uploading the license file 680 after successfully logging onto the appliance. 681 2.3.2.2 Forescout Console 682 Forescout Console was installed following the standard installation procedures. Instructions can be 683 found in the Forescout Installation Guide Version 8.2.1 availab le at https://docs.forescout.com . The 684 software is available from https://forescout.force.com/support/s/downloads , where current and past 685 versions are available. Login credentials were provided by Forescout. 686 2.3.2.3 eyeSight 687 Forescout eyeSight is an appliance hosted on a 1U Dell R640 that is installed within a standard 688 datacenter rack and connected to the network as described in the previous section. 689 2.3.2.4 eyeSight SecureConnector Agent 690 1. In a browser on a system with web connectivity to the eyeSight server, navigate to 691 https://172.16.2.61/sc.jsp to access the SecureConnector download page ( Figure 2 -11) and 692 follow these steps: 693 a. Select Create SecureConnector for: Windows . 694 b. Enable Show the SecureConnector icon on the endpoint systray . 695 c. Select Install Permanent As Click Submit . 697 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 21 2. Download the Forescout Agent -12): 698 a. Select Version Win64 . 699 b. Click Download . 700 3. Install the d ownloaded agent on the t arget systems using an administrator account. 701 Figure 2-11 Forescout SecureConnector Distribution Tool 702 Figure ICS Patrol 704 Forescout ICS Patrol (Version 1.1.2 -4.a826b94) is a sensor that is deployed on an existing VirtualBox host 705 in the PCS environment. Ubuntu 16.04.06 is required for proper installation and can be downloaded 706 from http://old -releases.ubuntu.com/releases/xenial/ubuntu -16.04.6- server -amd64.iso . Install the 707 operating system on a VM connected to PCS VLAN 2 following the procedures from the Silent Defense 708 Installation and Configuration Guide 4.1.2 document Section 2.2.2 , Installing the Linux Ubuntu OS. 709 1. Install the ICS Patrol Component from the Silent Defense Installation and Configuration Guide 710 4.1.2 document Section s 2.2.4 and 2.2.5 following these steps: 711 a. Establish an SSH session to the eyeInspect appliance. 712 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 22 b. Copy the components to the ICS Patrol VM : 713 $ scp os_provisioning_4.1.1_install.run \\ 714 main_configuration_4.1.1_install.run \\ 715 silentdefense@172.16.2.62:/home/silentdefense 716 c. SSH to the ICS Patrol VM and execute the installation components : 717 $ Configuration 722 The eyeSight agents and ICS Patrol do not require specific configurations. 723 2.3.3.1 eyeInspect 724 1. Access the eyeInspect web interface and log in with an administrator account. 725 2. Register the local sensor for SPAN traffic monitoring : 726 a. Click the Sensors option to access the Sensor Admin/Overview Page ( Figure 2 -13). 727 b. Click the m enu option Add > SilentDefense sensor . 728 c. Specify the sensor parameters in the dialog box ( Figure 2 -14). 729 Figure 2-13 eyeInspect Sensor Admin/Overview Page - Add Sensor 730 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 23 Figure 2-14 Adding a New SilentDefense Sensor Dialog 731 3. Adjust Passive Monitoring settings : 732 a. From the Dashboard , click Sensors. 733 b. Select the SilentDefense Sensor from the list of available sensors . 734 c. Click the Industrial Threat Library Overview option in the upper right corner . 735 d. Click the Security menu option on the left under Checks by Category . 736 e. Enter \"ICMP \" in the Search field to reduce the list of available options. 737 f. Click the ICMP protocol/port scan attempt to open the settings dialog box ( Figure 2 -15) 738 and verify the following settings: 739 i. Verify Enable Check is selected . 740 ii. Verify Maximum occurrences in window is set to 20 . 741 iii. Verify Time Window (in s econds ) is set to 60 . 742 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 24 Figure 2-15 eyeInspect ICMP Protocol/Port Scan Detection under Buil t-in Modules ( Figure 2 -16). 744 Figure 2-16 eyeInspect Sensor Configuration Options 745 746 h. Click the Settings tab and set the following parameters ( Figure 2 -17): 747 i. Sensitivity level: User defined 748 ii. Number of Hosts with failed connections to make a distributed scan: 10 749 iii. Detect SYN scans : Checked 750 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 25 iv. Target detection probability : 0.99 751 v. Target FP probability : 0.01 752 vi. Detect ACK scans : Checked 753 vii. Number of out of sequence ACK packets : 5 754 Figure 2-17 eyeInspect Portscan Det ection Settings 755 756 4. Register the ICS Patrol Sensor: 757 a. From the Sensor admin page, click the menu option Add > ICS Patrol sensor . 758 b. Specify the sensor parameters in the dialog box ( Figure 2 -18). 759 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 26 Figure 2-18 Add ICS Patrol Sensor Dialog 760 c. Define a scan policy to periodically check the PCS PLC to monitor for changes. 761 i. Click the PCS Sensor cre ated in the previous step to open the sensor admin page 762 (Figure 2 -19). 763 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 27 Figure 2-19 ICS Patrol Sensor Admin Pa ge 764 ii. Click the m enu option Scans > Scan Policies . 765 iii. In the dialog option (Figure 2 -20) enter the scanning parameters : 766 1) Name : PCS PLC 767 2) Scan Type : EtherNet/IP 768 3) Target Type : Custom target 769 4) IP address reuse : No 770 5) Network Address: 172.16.2.102 771 6) Schedule : Yes 772 7) Frequency : Repeat 773 8) Interval: 1 . Select \"Hours \" from the drop -down menu. 774 9) Click Finish . 775 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 28 Figure 2-20 Add an ICS Patrol Scan Policy 776 2.3.3.2 eyeSight 777 Using the Forescout Console application, users may configure, monitor, and manage the eyeSight 778 appliance and agents. The Forescout Console is also used to test and verify connectivity to the 779 eyeInspect server. 780 1. Login to the Forescout Console . 781 2. Select the Gear Icon in the upper right corner or the Tools > Option menu item to bring up the 782 Options display. 783 3. Enter \"Operational\" in the search bar. 784 4. Select the Operational Technology tab on the left side of the screen to display the current 785 settings. 786 5. Select the IP entry for the Command C enter and select Add to start the workflow process. 787 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 29 a. Specify General Information ( Figure 2 -21): 788 i. Enter the Command Center IP Address \" 10.100.0.65 \" for IP Address/Name . 789 ii. Select \"172.16.2.61\" from the Connecting CounterAct device drop -down menu . 790 iii. Select \"443\" from the TCP Port drop -down me nu. 791 Figure 2-21 eyeSight Add Dialog - General Information 792 b. Click Next . 793 c. Enter the command center c redentials ( Figure 2 -22). 794 d. Click Finish . 795 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 30 Figure 2-22 eyeSight Add - Command Center Credentials 796 6. Select the IP address for the Command Center and Click Test (Figure 2 -23). If the connection is 797 successful, a message like the one shown in Figure 2 -24 is displayed. 798 7. Click Apply to save the changes. 799 8. Click Close to close the message. 800 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 31 Figure 2-23 eyeSight OT Settings 801 Figure eyeSight Test Connection Message 802 2.4 GreenTec -USA 803 The GreenTec -USA products included in this practice guide are the ForceField and WORMdisk zero trust 804 storage devices. The se products were utilized in Builds 1, 2, 3, and 4 to meet the File Integrity Checking 805 capability by storing and protecting critical PCS and CRS data from modification and deletion. 806 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 32 ForceField 807 A ForceField hard disk ) provides a protected write -once -read -many data storage location for 808 historian data backups and database backups. Data is immediately protected as it is written to the HDD 809 in real time, permanently preventing the data from modification and deletion. 810 WORMdisk 811 A WORMdisk HDD provides a protected data storage location for PLC logic, device firmware, and 812 approved software applications for use in the manufacturing environment. Data is protected by 813 \"locking\" individual partitions of the HDD using a software utility, permanently preventing the data from 814 modification and deletion. 815 2.4.1 Host and Network Configuration 816 The WORMdisk and ForceField HDDs were installed in a rack -mount server appliance provided by 817 GreenTec -USA and described in Table 2 -8. The overall build architectures utilizing this appliance and 818 devices are described in Section 4.5 in Volume B. 819 Table 2-8 GreenTec -USA WORMdrive and ForceField Deployment 820 Name System OS CPU Memory Storage Network GreenTec - USA Server Supermicro x8 Series Server Ubuntu 18.04 2x Intel Xeon E5620 and WORMdisk HDDs were hosted on a hardware appliance provided by GreenTec -USA. 822 The unit was placed within a standard datacenter rack unit and connected to the network as shown in 823 Figure B -1, Figure B -2, Figure B -3, and Figure B -4. 824 Full docu mentation and installation guides are provided to customers by GreenTec -USA. 825 NIST chose to utilize Samba as the network file sharing proto col due to the prevalence of Windows and 826 Linux workstations within the testbed. The GreenTec -USA appliance did not come with Samba pre - 827 installed, so installation was performed via the Ubuntu Advanced P ackag ing Tool and the Ubuntu 828 package repository. 829 NOTE: GreenTec -USA typically provides turnkey server storage solutions. Installation and configuration 830 of file sharing packages and other software will likely not be required. 831 NOTE: Many of the commands used to manage the ForceField and WORMdisk HDDs must be e xecuted 832 by a user with superuser privileges or as the root user. 833 1. Add the default gateway so the appliance can communicate to other devices on the network 834 using the following command : 835 $ sudo route add default gw 10.100.1.1 836 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 33 2. In a terminal window on the GreenTec -USA appliance, execute these commands: 837 $ sudo apt update 838 $ sudo apt - y install samba 839 $ sudo ufw allow samba 840 2.4.3 Configuration 841 The appliance provided by GreenTec -USA for this project was preconfigured with the ForceField HDD as 842 device /dev/sdc HDD 844 The ForceField HDD is configured as a mounted volume, allowing the drive to be used as a typical HDD 845 by using native operating system commands. 846 1. Create a mount point (empty directory) for the ForceField HDD using the following command : 847 $ sudo mkdir /mnt/forcefield 848 2. Start the ForceField WFS volume manager to mount the drive using the following command : 849 $ sudo divided into 120 partitions to enable periodic updates and revisions to the protected 852 data (i.e., data in the \"golden\" directory). Once a partition is locked it cannot be modified, so the next 853 sequential partition on the drive is used as the new \"golden\" directory. 854 1. Format the WORMdisk with 120 partitions (NOTE: this operation must be performed from the 855 command line as a dministrator on a computer with the Microsoft Windows OS) using the 856 following command : 857 > gt_format.exe 1 /parts:120 858 2. In the Ubuntu OS, create the mountpoint for the WORMdisk HDD partition using the following 859 command : 860 $ sudo mkdir /mnt/golden 861 3. Add a persistent mount to /etc/fstab file: 862 $ sudo >> 865 4. Create a directory structure within the \"golden\" directory and copy approved files into those 866 directories (e.g., PLC logic, device firmware, appro ved software). 867 5. Once all files have been copied and verified, lock the partition to protect the data: 868 $ sudo /greentec/Ubuntu/wvenf /dev/sdb2 869 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 34 When it is time to create a new \"golden\" partition, the partition names in the /etc/fstab file must be 870 updated to point to the correct partition. The following instructions provide an example process to 871 update the files and increment the golden partition f rom /dev/sdb2 to /dev/sdb3. 872 1. On the GreenTec -USA appliance, create a temporary directory, mount the folder to the next 873 unlocked WORMdisk partition, and copy existing \"golden\" files to the temporary directory: 874 $ - R /mnt/golden /mnt/tmp 877 2. Update the files and folders in the temporary directory , /mnt/tmp, as desired. 878 3. Unmount the temporary directory and lock the partition: umount /mnt/tmp 880 $ se $ sudo systemctl stop smb.service partition: $ sudo umount /mnt/golden 885 6. Modify the /etc/fstab file with the new partition name and save the file: 886 /dev/sdb3 /mnt/golden fuseblk 887 889 7. Re-mount all partitions, start the Samba service, and remove the temporary directory: 890 $ sudo mount - a 891 $ sudo systemctl stop $ sudo rmdir - r /mnt/tmp 893 2.4.3.3 Samba 894 1. Add local user accounts to the appliance for accessing the network file shares and create a 895 password: 896 $ sudo adduser nccoeuser 897 $ sudo a nccoeuser 898 2. Open the file /etc/samba/smb.conf and add the following content to the end of the 899 file to create t he individual shares: 900 # GreenTec -USA ForceField Share strict sync=no backups [ForceField] DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 35 browsable = yes guest ok = no path = /mnt/forcefield read only = no writeable = yes case sensitive = yes # GreenTec- USA Golden WORMDisk Share [golden] browsable = yes guest ok = no path = /mnt/golden read only = no writeable = yes case sensitive = yes 3. Restart Samba: 901 $ sudo systemctl restart smbd.service 902 2.4.3.4 OSIsoft PI Server and Database Backups 903 Create the scheduled backup task to backup PI Data Archive files. The script automatically inserts the 904 current datetime stamp into the filename of each file copied to the ForceField drive. Follow these steps: 905 1. On the server containing the PI Data Archive, o pen a command prompt with Administrator 906 privileges. 907 2. Change to the PI \\adm directory: 908 > cd /d \"%piserver%adm\" 909 3. Create the backup directory, and start the Windows scheduled task to perform the backup: 910 > pibackup h:\\ PIBackup -install 911 Create a scheduled task to copy the backup files to the ForceField HDD. Follow these steps: 912 1. Open the Task Scheduler and create a new scheduled task to rename, timestamp, and copy the 913 backup files to the ForceField HDD: 914 Trigger: At 3:30 AM every day 915 Action: Start a Program 916 Program/s cript: 917 C:\\Windows\\ System32\\ SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 36 2.5 Microsoft Azure Defender for IoT 923 Microsoft Azure Defender for IoT, based on technology acquired via CyberX, consists of a single 924 appliance containing the sensor and application interface integrated into Build 4 to meet BA D, hardware 925 modification, firmware modification , and software modification capabilities. The Microsoft Azure 926 Defender for IoT implementation utilizes passive monitoring and protocol analysis to support 927 cybersecurity monitoring and threat detection. 928 2.5.1 Host an d Network Configuration 929 Microsoft Azure Defender for IoT was installed and configured to support the CRS environment as part 930 of Build 4. The overall build architecture is provided in Figure B -4. The Microsoft Azure Defender fo r IoT 931 specific components are in Table 2 -9. 932 Table 2-9 Microsoft Azure Defender IoT Deployment 933 Name System OS CPU Memory Storage Network Azure Defender for IoT Dell OEMR XL R340 Ubuntu 18.04 Intel Xeon E Drives RAID -5 Testbed LAN 10.100.0.61 2.5.2 Installation 934 The Microsoft Azure Defender for IoT (Version 10.0.3) appliance was preinstalled with the operating 935 system and application. The appliance is mounted in a rack with power and network interfaces 936 connected to the Testbed LAN on the Eth0 port along with the SPAN connection on the expansion 937 network interface board. 938 2.5.3 Configuration 939 To configure the Microsoft Azure Defender for IoT platform , follow these steps: 940 1. Set the Network Configuration : 941 a. Using either SSH, iDRAC, or the KVM Console connections on the appliance, establish 942 shell acces s to the appliance. 943 b. From the console , enter the following command : 944 $sudo cyberx- xsense-network- reconfigure 945 c. The system will walk through a series of network options ( Figure 2 -25) that are set as 946 follows: 947 i. IP Address : \"10.100.0.61\" 948 ii. Subnet Mask: \"255.255.255.0\" 949 iii. DNS : \"10.100.0.17 \" 950 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 37 iv. Default Gateway : \"10.100.0.1\" 951 v. Hostname: Not set Interface(s): Not Set 955 Figure 2-25 Azure Defender for IoT SSH Session for Network Configuration 956 2. Create AMS Protocol report as a d ata mining tool: 957 a. Login to the application web interface and click Data Mining in the left menu navigation. 958 b. Click the + sign and click New Report . In the Create New Report panel set the following 959 settings ( Figure 2 -26): 960 i. Under Categories select AMS to automatically select the sub -elements , including: 961 1) AMS Firmware Information 962 2) AMS Index Group 963 3) AMS Index Group Offset 964 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 38 4) AMS Protocol Command 965 ii. Enter \"AMS Data Analysis \" as the name for the report . 966 iii. Click Save . 967 Figure 2-26 Azure Defender for IoT Create New Data Mining Report for AMS Protocol Information 968 3. Create AMS - Custom Alert Rules 969 For this effort, the CRS PLC is configured to run using f irmware version 3.1.4022 as the approved 970 production firmware version. To detect changes to the approved version, custom alert rules are 971 created to monitor for deviations from the approved version num bers through the AMS protocol 972 messages over the network. 973 a. Click Horizon on the left menu navigation. 974 b. Select AMS > Horizon Customer Alert under the Plugin Options on the left menu. 975 c. Create Custom Alert to Detect Change in PLC Firmware Major Build Number ( Figure 976 2-27): 977 i. Enter \" PLC Firmware Major Build Mismatch \" as the title for the custom alert. 978 ii. Enter \"PLC {AMS_server_ip} Firmware Major Version Build Mism atch Detected \" 979 as the message to display with the alert . 980 iii. Set the following conditions: 981 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 39 1) AMS_server_ip == 3232235550 (Note: this is the PLC IP address 982 192.168.0.30 in Integer format ). 983 2) AND AMS_major ~= 3 984 Figure 2-27 Azure Defender for IoT Custom Alert for Firmware Major Version Number Change 985 d. Create the c ustom alert to detect change in PLC firmware minor build number ( Figure 986 2-28): 987 i. Enter \" PLC Firmware Minor Build Mismatch \" as the title for the custom alert. PLC 988 Firmware Minor Build Mismatch 989 ii. Enter \" PLC {AMS_server_ip} Firmware Minor Version Build Mismatch Detected \" 990 as the message to display with the alert . 991 iii. Set the following conditions: 992 1) AMS_server_ip == 3232235550 (Note: this is the PLC IP address 993 192.168.0.30 in Integer format). 994 2) AND AMS_ minor ~= 1 995 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 40 Figure 2-28 Azure Defender for IoT Custom Alert for Firmware Minor Versi on Number Change 996 997 e. Create the c ustom alert to detect change in the PLC Firmware Build Version ( Figure 998 2-29): 999 i. Enter \" PLC Firmware Build Version Mismatch \" as the Title for the c ustom alert. 1000 ii. Enter \"PLC {AMS_server_ip} Build Version Mismatch Detected\" as the message to 1001 display with the alert: 1002 iii. 1003 1) AMS_server_ip (Note: this is the PLC IP address 1004 192.168.0.30 in Integer format). 1005 2) AND AMS_ version_build ~= 4022 1006 Figure 2-29 Azure Defender for Alert for Firmware Build Version Number Change 1007 1008 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 41 2.6 OSIsoft PI Data Archive 1009 The OSIsoft product included in this practice guide is Process Information (PI) , which is used to collect, 1010 store, analyze, and visualize testbed data. The prod uct was utilized in Builds 1, 2, 3, and 4 to meet the 1011 Historian capability by collecting and storing testbed data and the BAD capability by alerting when 1012 activity deviates from a baseline . 1013 OSIsoft PI is a suite of software applications for capturing, analy zing, and storing real- time data for 1014 industrial processes. Although the PI System is typically utilized as a process historian, the PI System is 1015 also utilized to collect, store, and manage data in real time. Interface nodes retrieve data from disparate 1016 sources to the PI Server, where the PI Data Archive resides. Data is stored in the data archive and is 1017 accessible in the assets defined in the Asset Framework (AF). Data is a ccessed either directly from the 1018 data archive or from the AF Server by using tools in the PI visualization suite. 1019 2.6.1 Host and Network Configuration 1020 PI was installed on virtual machines hosted on hypervisors located in the DMZ and CRS networks. The 1021 virtual machine details and resources are provided in Tabl e 2-10, Table 2 -11 and, Table 2 -12. The overall 1022 build architectures utilizing PI are described in Section 4 .5 in Volume B . 1023 Table 2-10 OSIsoft PI Domain Hosts Deployment 1024 Name System OS CPU Memory Storage Network DMZ Histo- rian Virtual Machine Microsoft Windows Server 2016 4x Intel Xeon E3-1240 8 GB Boot: 80 DMZ 10.100.1.4 1025 Table 2-11 OSIsoft PI CRS Hosts Deployment 1026 Name System OS CPU Memory Storage Network CRS Local Historian Virtual Machine Microsoft Windows Server 2016 4x Intel Xeon E5-2407 16 GB Boot: 80 GB Supervi- sory LAN 192.168.0.21 1027 Table 2-12 OSIsoft PI PCS Hosts Deployment 1028 Name System OS CPU Memory Storage Network PCS Local Historian Virtual Machine Microsoft Windows Server 2008 R2 1x Intel i5 - 4590 2 GB 50 GB 2 172.16.2.14 1029 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 42 2.6.2 Installation 1030 PI was previously installed in the testbed as part of the NISTIR 8219: Securing Manufacturing installation for this 1033 project involved upgrading the existing CRS Local Historian and DMZ Historian VMs to Microsoft 1034 Windows Server 2016, and subsequently upgrading all the PI software components. Step -by-step 1035 instructions for each PI component installation are not included for brevity. Detailed instructions 1036 provided by the vendor can be found on the OSIsoft Live Library: https://livelibrary.osisoft.com/ . 1037 DMZ Historian Server 1038 The following software is installed on the DMZ Historian server : 1039 Microsoft SQL Server 2019 Express 15.0.2080.9 1040 PI Server 2018 (Data Archive Server, Asset Framework Server) 1041 PI Server 2018 SP3 Patch 1 1042 PI Interface Configuration Utility version 1.5.1.10 1043 PI to PI Interface version 3.10.1.10 1044 PI Interface for Ramp Soak Simulator Data 3.5.1.12 1045 PI Interface fo r Random Simulator Data 3.5.1.10 1046 PI Connector Relay version 2.6.0.0 1047 PI Data Collection Manager version 2.6.0.0 1048 PI Web API 2019 SP1 version 1.13.0.6518 1049 CRS Local Historian Server (Collaborative Robotics System) 1050 The following software is installed on the CRS Local Historian server: 1051 Microsoft SQL Server 2019 Express 15.0.2080.9 1052 PI Asset Framework Service 2017 R2 Update 1 1053 PI Data Archive 2017 R2A 1054 PI Server 2018 SP3 Patch 1 1055 PI Interface Configuration Utility version 1.5.1.10 1056 PI to PI Interface version 3.10.1.10 1057 PI Interface for Ramp Soak Simulator Data 3.5.1.12 1058 PI Interface for Random Simulator Data version 3.5.1.10 1059 PI Interface for Performance Monitor version 2.2.0.38 1060 PI Ping Interface version 2.1.2.49 1061 PI Interface for Modbus ReadWrite version 1063 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 43 PI TCP Response Interface version 1.3.0.47 Processbook 2015 R3 Patch 1 version 3.7.1.249 1065 PI Vision 2019 Patch 1 version 3.4.1.10 1066 PI System Connector version 2.2.0.1 1067 PCS Local Historian (Process Control System Historian ) 1068 Rockwell FactoryTalk Historian SE version 1.00 1069 2.6.3 Configuration 1070 The following sections describe how to configure select PI components to enable the capabilities 1071 described in this guide. Configurations for t he other PI components are not included for brevity. 1072 2.6.3.1 PI to PI Interface (PCS) 1073 The PCS uses the Rockwell FactoryTalk Historian to collect, store, and analyze historical process data. 1074 The PI to PI Interface is used to duplicate the process data to the DMZ H istorian server. The following 1075 steps describe how to configure the PI to PI Interface to collect data from the Rockwell FactoryTalk 1076 Historian. 1077 1. On the DMZ Historian server, launch the PI Interface Configuration Utility as shown in Figure 1078 2-30 from the Start menu and sign in with the local administrator account. 1079 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 44 Figure 2-30 Screenshot of the PI Interface Configuration Utility before the I nterface is configured. 1080 1081 1082 2. On the top menu , click Interface > New Windows Interface Instance from BAT File... 1083 3. Navigate to E:\\Program Files (x86) 4. In the \"Select Host PI Data server/collective\" dialog box , select PI-DMZ from the drop -down 1085 menu and click OK . 1086 5. In the left navigation panel select PItoPI . In the Source host textbox, enter \"172.16.2.4 \". 1087 6. In the left navigation panel , select Service . In the \" Create / Remove \" section click the Create 1088 button . Click Yes in the dialog box. 1089 7. Enter the commands net start PItoPI and net stop PItoPI in the files 1090 pisrvsitestart.bat and pisrvsitestop.bat files , respectively. Save and close the f iles. 1091 8. At the bottom of the PI Interface Configuration Utility click the Apply button. On top menu bar 1092 click the green play button to start the service. 1093 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 45 9. Close the PI Interface Configuration Utility . The interface is now configured to pull tags from the 1094 Rockwell Historian. 1095 2.6.3.2 PI System Connector (CRS) 1096 The PI System Connector is used to duplicate process data on the DMZ Historian from the CRS Local 1097 Historian server. The following steps describe how to configure the PI -to-PI Interface to collect data 1098 from the OSIsoft PI Server . 1099 Figure 2-31 Screenshot of the PI Data Collection Manager Displaying Green Checkmarks After the PI 1100 System Connector is P roperly Configured 1101 1102 1. On the DMZ Historian server, launch the PI Data Collection Manager as shown in Figure 2 -31 1103 from the S tart menu and sign in with the local administrator account. 1104 a. Click + on the Relays column to add a new connector relay. Use the following settings : 1105 b. 1109 3. Click Save Settings to add the connector relay. 1110 4. Click + Add Destination to add the target PI Data Archive and PI AF Server. Use the following 1111 settings: 1113 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 46 b. PI AF Server: 10.100.1.4 1115 5. Click Save Settings to add the destination. 1116 6. On the CRS Local Historian server, open the PI System Connector Administration from the Start 1117 menu and sign in with the local administrator account. 1118 7. Click Set up Connector to create a new connector. 1119 8. Use the following information to request registration: 1120 a. Registration Server Address: to PI- DMZ 1124 9. Click Request Registration to send the request to the DMZ Historian server. 1125 10. On the DMZ Historian server, open the PI Data Collection Manager from the Start menu and 1126 sign in with the local administrator account. 1127 11. Click Untitled Connector 1 and click Approve This Registration and Configure to approve the PI 1128 System Connector registration. 1129 12. In the Untitled Connector 1 details panel, click Edit . 1130 13. Use the following information to create the -Connector connector: 1131 DMZ 1133 14. Click Save Settings to create the CRS -Connecto r. 1134 15. Click CRS-Connector in the Connectors column. On the Overview panel click CRS -Connector : No 1135 Data Sources option to create the data source. 1136 16. On the CRS-Connector Connector Details in the Overview panel, click + Add Data Source . 1137 17. In the Data Source Settings window, use the following settings: 1138 a. AD Database: TestbedDatabase 1141 d. Select Collect All Data from this Entire Database . 1142 18. Click Save to save the data source. 1143 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 47 19. Click 10.100.1.4 in the Destination column of the Routing panel and then click Data in the 1144 10.100.1.4 Destination Details panel to configure the destination database for the CRS - 1145 Connector. 1146 20. In the 10.100.1.4 Destination Details panel, change from Change Default Settings for new 1147 connectors to \"CRS-Connector \" and then click Edit Destination Data Settings. 1148 21. In the 10.100.1.4 Destination Details of the Overview panel, use the following settings: 1149 a. Change the connector to CRS -Connector . 1150 b. Database: CRS-backup 1151 c. Click on Elements and it will change <select a path using the tree below> to $Elements \\ 1152 d. Use default settings in Root AF Elements and Point Names . 1153 e. Element CRS Prefix Point CRS -Connector checkbox: Checked 1155 22. Click Save Destination Data Se ttings to save the configuration. 1156 23. Click the white space in the Routing panel. 1157 24. Click CRS-Connector: No Relays in the Overview panel. 1158 25. Select the PI-DMZ -Relay checkbox in the Routing panel. 1159 26. Click the white space in the Routing panel again, then Click PI-DMZ -Relay: No Destination to 1160 add the routing between relays and destinations. 1161 27. Select the 10.100.1.4 checkbox to add the routing between the relay and the destination. 1162 28. Click Save Configuration. 1163 29. In the Save Routing and Data Configuration window, select Save and Start All Components to 1164 continue. 1165 30. Each box should now contain a green checkmark (i.e., Data Sources, Connectors, Relays, and 1166 Destinations). The elements in the AF database \"testbeddatabase\" on CRS Local Historian server 1167 is now replicated to AF databas e \"CRS -backup\" on the DMZ Historian server. 1168 31. Finally, create a Windows firewall rule to open the inbound ports 5460, 5461, 5471, and 5472. 1169 2.6.3.3 PI Asset Template Analysis Functions and Event Frames 1170 Analysis functions and event frame templates were created to generate alerts in the PLC asset template 1171 when their respective anomalous events are detected. When an analysis function result is TRUE , an 1172 event frame is generated from the event frame template and ends when the analysis function result is 1173 FALS E or per a user -defined function. The following steps describe how the \"Station Mode Error\" 1174 analysis function and event frame template were created and used in Scenario 10. 1175 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 48 1. On the CRS Local Historian server, open the PI System Explore r by navigating to Start Menu > PI 1176 System > PI System Explorer . 1177 2. On the left navigation panel, select Library . 1178 3. In the navigation tree in the Library panel, select Templates > Event Frame Templates . 1179 4. Right click in the whitespace of the Element Templates window and select New T emplate . 1180 a. Enter the following: 1181 Mode Error 1182 c. Description: CRS Workcell machining MM-dd 1184 HH:mm:ss.fff% 1185 6. In the navigation tree in the Library panel, select Templates > Element Templates > 1186 Machining_Station. 1187 7. In the Machining_Station panel select the Analysis Templates tab and click Create a new 1188 analysis template . 1189 8. Enter the name \"Station Mode Error\" in the Name textbox, enter a description of the analysis in 1190 the Description textbox, and select the option \"Event Frame Generation\" for the Analysis Type . 1191 9. Select \"Station Mode Error\" in the Event Frame template drop -down menu. 1192 10. In the Expression field for \"StartTrigger1\", enter the expression: 1193 'RawMode' < 0 OR 'RawMode' > 1; 1194 11. Click the Add... drop -down menu and select End Trigger , and enter the expression: 1195 ('RawMode' > 0 AND 'RawMode' < 1) 1196 12. Select the \"Event- Triggered\" option for the Scheduling type. 1197 13. Click the Check In button on the top menu to save all changes to the database. 1198 2.6.3.4 PI Web API 1199 The PI Web API is used by Dragos to collect event frames from the DMZ Historian server. After 1200 completing the installation of the PI Web API, the \"Change PI Web API Installation Config uration\" dialog 1201 displays . The following steps describe how to configure the Web API on the DMZ Historian server. 1202 1. In the Telemetry section, verify the checkbox option and click Next . 1203 2. In the Configuration Store section, select \" PI-ROBOTICS \" in the Asset Server drop -down menu 1204 and click Connect . Leave the default instance name. 1205 3. In the Listen Port section, verify port 443 is entered in the Communication Port Number 1206 textbox and check the Yes, please create a firewall Exception for PI Web API checkbox. 1207 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 49 4. In the Certificate section, click Next to continue and use the self -signed certificate or select 1208 Change to modify the certificate. 1209 5. In the API Service section, leave the default service NT Service\\ piwebapi and click Next . 1210 6. In the Crawler Service section, leave the default service NT Service\\ picrawler and 1211 click Next . 1212 7. In the Submit URL section, enter the URL of the DMZ Historian server Web API service: 1213 https://pi- dmz/piwebapi/. Click Next . 1214 8. In the Review Chang es section, verify all the configuration settings, check the checkbox Accept 1215 all the configurations , and click Next . 1216 9. Click Finish to complete the configuration. 1217 2.6.3.5 Firmware Integrity Checking 1218 Software was developed to demonstrate the ability of PI to obtain device and firmware data from a 1219 Beckhoff PLC for integrity checking purposes. A new PLC task was programmed to periodically query its 1220 operating system for hardware and software telemetry and make it available via Modbus TCP. PI will 1221 query these Modbus registers and use analysis functions to generate event frames if any tags do not 1222 match their expected values. 1223 It is important to note that this capability was developed to demonstrate a method of maintaining 1224 visibility of PLC hardware and firmware version nu mbers for integrity purposes and is not secure or 1225 infallible. If a malicious actor takes control of the PLC, the hardware and firmware versions provided by 1226 the PLC can be spoofed. 1227 The following steps describe how to sequentially configure this capability across multiple systems and 1228 software. Only one system or software is described in each section. 1229 Beckhoff PLC Modbus TCP Server 1230 The base Modbus TCP server configuration file only allows one PLC task to write to the registers. The 1231 following steps describe how to modify the configuration to allow two PLC tasks to write to the Modbus 1232 TCP server input registers. 1233 1. Log in to the Windows CE Desktop of the Beckhoff PLC and open the XML 1236 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in 1238 4. Restart the PLC. 1239 The Modbus TCP server will now have two register address ranges: 128 addresses for the PLC tas k at 1240 port 851, and 128 addresses for the PLC task at port 852. 1241 Beckhoff PLC Project 1242 A new PLC task must be created to perform the integrity checking and write the data to the Modbus TCP 1243 registers. The following steps describe how to create and configure t he new task. 1244 1. On the engineering workstation, open the TwinCAT XAE Shell by navigating to Start Menu > 1245 Beckhoff > TwinCAT XAE Shell and open the current PLC project. 1246 2. In the Solution Explorer , right click PLC and select Add New Item... 1247 3. In the Add New Item dialog box, select Standard PLC Project , enter the name 1248 FirmwareIntegrityCheck in the Name textbox, and click Add. 1249 4. In the Solution Explorer , double click SYSTEM > Tasks > PLCTask1 . Verify the Auto Start 1250 checkbox is checked and change the Cycle Ticks textbox to 100 ms. 1251 5. In the Solution Explorer , right click PLC > FirmwareIntegrityCheck > References and click Add 1252 library ... In the dialog box , select the library System > Tc2_System and click OK. 1253 6. In the Solut ion Explor er, right click PLC > GVLs and click Add > Global Variable List . In the dialog 1254 box enter the name GVL in the Name textbox and click Open. 1255 7. In the Editor Window , enter the following SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 51 8. In the Solution Explorer , right click PLC > FirmwareIntegrityCheck > POU and select Add > POU . 1258 In the Add POU dialog box, enter the name GetSystemInfo, select the type Function Block , 1259 select the Implementation Language Structured Text (ST)and click Open . 1260 9. In the Editor Window , enter the following code in the Variables section: 1261 // Gathers PLC information for system integrity checking // (e.g., PLC serial number, TwinCAT version). FUNCTION_BLOCK GetSystemInfo VAR_INPUT NetId : PLC END_VAR VAR_OUTPUT HardwareSerialNo : WORD; // Serial number // number //PLC data struct Timer : TON; // Timer to trigger the scan Period : TIME := T#5M; // Amount of time between each scan State : INT := 0; // Function block state END_VAR 1262 10. In the Editor Window , enter the following code in the Code section: 1263 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 52 CASE state OF 0: // Start a new request for device identification DeviceData(bExecute:=TRUE, tTimeout:=T#100MS, sNetId:=NetId); // Switch to the next state once the request completes IF DeviceData.bBusy = FALSE THEN state := 10; END_IF 10: // Store the interesting the next state Timer(IN:= FALSE); state := 20; 20: // Make sure the timer is running and change to the // next state once the period has been reached Timer(IN:=TRUE,PT:=Period); IF Timer.Q = TRUE THEN state := 0; 1264 11. Save and close the POU. 1265 12. In the Solution Explorer , double click PLC > FirmwareIntegrityCheck > POUs > MAIN (PRG) . 1266 13. In the Editor Window , enter the following into the Variables section (your AMS net ID may 1267 differ from what is shown below): 1268 PROGRAM MAIN VAR PLCInfo : GetSystemInfo; // Periodically collects PLC data SelfNetId : := NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 53 14. In the Editor Window , enter the following into the Code section: 1270 // Captures hardware serial numbers and TwinCAT version // numbers from the PLC and shares them with other // devices and close the POU. 1272 16. In the top menu, select Build > Build Pr oject . Once the build process completes select PLC > 1273 Login . In the TwinCAT PLC Control dialog box, select Login with download, verify the Update 1274 boot project checkbox is checked, and click OK . If the PLC code is not running after the 1275 download completes, se lect PLC > Start in the top menu. 1276 17. The firmware integrity checking code is now running on the Beckhoff PLC. In the top menu 1277 select PLC > Logout and close the TwinCAT XAE Shell. 1278 The PLC will now write the hardware serial number and firmware version numbers to the Modbus 1279 TCP server registers. 1280 OSIsoft PI Points 1281 The following steps describe how to create the PI p oints and tags in the CRS Local Historian server and 1282 duplicate the tags to the DMZ Historian server. 1283 1. On the CRS Local Historian server, open the PI Interface Configuration Utility by navigating to 1284 Start > All Programs > PI System > PI Interface Configuration Utility . 1285 2. In the Interface drop -down the Modbus Interf ace (PIModbusE1) . 1286 3. Select the General menu option. In the Scan Classes section, click the New Scan Class button. 1287 4. Set the Scan Frequency to \"60\" and the Scan Class # to the next sequential class number as 1288 shown in Figure . 1289 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 54 Figure 2-32 Screenshot of the PI Interface Configuration Utility S howing the A dded Scan Class # 2 for 1290 Polling the PLC E very 60 S econds 1291 1292 1293 5. Click Apply and close the program. 1294 6. On the CRS Local Historian server, open the PI System Management Tools by navigating to Start 1295 Menu > PI System > PI System Management Tools . 1296 7. In the System Management Tool panel, select Points > Point Builder . 1297 8. Create a new tag for the PLC hardware serial number with the following 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 55 f. Location 1: 1 1304 g. Location 2: 0 1305 h. Location 3: 104 1306 i. Location 4: 2 1307 j. Location 5: 32897 1308 k. Instrument Tag: 192.168.0.30 1309 9. Create a new tag for the PLC TwinCAT build number with the 1315 f. Location 1: 1 1316 g. Location 2: 0 1317 h. Location 3: 104 1318 i. Location 4: 2 1319 j. Location 5: 32900 1320 k. Instrument Tag: 192.168.0.30 1321 10. Create a n ew tag for the PLC TwinCAT revision number with the following 1327 f. Location 1: 1 1328 g. Location 2: 0 1329 h. Location 3: 104 1330 i. Location 4: 2 1331 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 56 j. Location 5: 32899 1332 k. Instrument Tag: 192.168.0.30 1333 11. Create a new tag for the PLC TwinCAT version number with the following configuration as shown 1334 in Figure 1340 f. Location 1: 1 1341 g. Location 2: 0 1342 h. Location 3: 104 1343 i. Location 4: 2 1344 j. Location 5: 32898 1345 k. Instrument Tag: 192.168.0.30 1346 12. Close the PI System Management Tools program. The PI points are now available to the DMZ 1347 Historian server via the PI System Connector. 1348 Figure 2-33 Screenshot of the PI System Management Tools Component After Configuring the PI Points 1349 for PLC H ardware and F irmware Version Number Checking 1350 1351 1352 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 57 13. On the DMZ Historian server, open the PI System Explorer by navigating to Start Menu > PI 1353 System > PI System Explorer . 1354 14. On the left navigation panel, select Library . 1355 15. In the navigation tree in the Library panel, select Templates > E lement Templates > 1356 PLCTemplate . Templates tab in the PLCTemplate panel. 1358 17. On the top menu bar , click New Attribute Template and create a new attribute for the PLC 1359 hardware serial number by entering the following configuration: 1360 a. Name: HardwareSerialNumber 1361 b. Description: Hardware serial 1362 c. Value Type: \\\\PI-ROBOTICS\\ PLC-HardwareSerialNumber 1365 18. On the top menu bar click New Attribute Template and create a new attribute for the expected 1366 hardware serial number by entering the following configuration: 1367 a. Name: HardwareSerialNumber- Expected 1368 b. Description: Expected serial number of the CRS Beckhoff 1369 PLC. 1370 c. Value Type: V 1371 d. Data Reference: None 1372 19. On the top menu bar click New Attribute Template and create a new attribute for the PLC 1373 TwinCAT build number by entering TwinCATBuildNumber \\\\PI-ROBOTICS\\ PLC-TwinCATBuild 1379 20. On the top menu bar click New Attribute Template and create a new attribute for the PLC 1380 TwinCAT revision number by entering TwinCATRevisionNumber 1383 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 58 c. Value Type: PLC-TwinCATRevision 1386 21. On the top menu bar click New Attribute Template and create a new attribute fo r the PLC 1387 TwinCAT version number by entering TwinCATVersionNumber 1392 e. Tag: \\\\PI-ROBOTICS\\ PLC-TwinCATVersion 1393 22. On the top menu bar click New Attribute Template and create a new attribute for the string 1394 representation of the version, revision, and build numbers by entering the follo wing 1395 1398 c. Value Type: String 1399 1401 'TwinCATVersionNumber';.;'TwinCATRevisionNumber';.;'TwinCAT 1402 23. On the top menu bar cli ck New Attribute Template and create a new attribute for the PLC 1404 expected TwinCAT version number by entering the following configuration as shown in Figure 1405 2-34: 1406 a. Name: TwinCATVersion- Expected 1407 1408 1409 Type: String 1410 d. Data Reference: None 1411 The PI points are now available as PLC attributes in the Asset Framework on the DMZ Historian server. 1412 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 59 Figure 2-34 Screenshot of PI System Explorer Displaying some Attributes of the PLC E lement. Attributes 1413 for the TwinCAT version number are visible in the list. 1414 1415 OSIsoft PI Analyses and Event Frames 1416 The following steps descri be how to create the PI analyses and event frame templates to generate event 1417 frames when the hardware or firmware version numbers do not match the expected values. 1418 1. In the navigation tree in the Library panel, select Templates > Event Frame Templates . 1419 2. On t he top menu bar click New Template and enter the following configuration as shown in 1420 Figure 2 -35: 1421 a. Name: NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 60 Figure 2-35 Screenshot of PI System Explorer Displaying the Hardware Serial Number Mismatch E vent 1427 Frame Template. 1428 1429 3. On the top menu bar click New Template and enter the following configuration as shown in 1430 Figure 2 -36: 1431 a. and System Integrity in Industrial Control System Envir onments 61 Figure 2-36 Screenshot of PI System Explorer Displaying the TwinCAT Version Mismatch E vent Frame 1437 Template 1438 1439 1440 4. Click the Check In button on the top menu to save all changes to the database. 1441 5. In the navigation tree in the Library panel, select Templates > E lement Templates > s Templates tab in the PLCTemplate panel and click Create a new analysis 1444 template . 1445 7. Enter the following configuration as shown in Figure 2 -37: 1446 a. Name: Hardware Serial Number Mismatch 1447 b. Description: The PLC hardware serial number does not match the 1448 expected serial number. 1449 c. Analysis Type: Event Frame Generation 1450 d. Enable analyses when created from template: Checked 1451 e. Generation Mode: Explicit Trigger 1452 f. Event F rame Template : Hardware Serial Number Mismatch 1453 8. In the Expression field for \"StartTrigger1\", enter the expression: 1454 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 62 'HardwareSerialNumber'<>'HardwareSerialNumber- Expected' and NOT 1455 BadVal('HardwareSerialNumber'); 1456 9. Click Add... drop -down menu and select End Trigger , and enter the 1457 'HardwareSerialNumber'='HardwareSerialNumber- Expected'; 1458 10. Select the for the Scheduling type and \"Any Input\" for the Trigger On 1459 drop -down menu. 1460 Figure 2-37 Screenshot of PI System Explorer Displaying the Hardware Serial Number Mismatch 1461 Analysis Template in the PLC E lement Template 1462 1463 1464 11. To create a new analysis template for TwinCAT firmware version mismatch, click Create a new 1465 analysis template . 1466 12. Enter the following configuration as shown in Figure 2 -38: 1467 a. Name: TwinCAT Firmware Version Mismatch 1468 b. Description: The TwinCAT version installed in the PLC does not 1469 match the expected version. 1470 c. Analysis Type: Event Frame Generation 1471 d. Enable analyses when created from template: Checked 1472 e. Generation Mode: Explicit Trigger 1473 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 63 f. Event Frame Template: Hardware Serial Number Mismatch 1474 13. In the Expression field for \"StartTrigger1\", enter the 1475 not Compare('TwinCATVersion','TwinCATVersion- Expected') and BadVal('TwinCATVersion'); 1477 14. Click the Add... drop -down m enu and select End Trigger , and enter the expression: 1478 Compare('TwinCATVersion','TwinCATVersion- Expected'); 1479 15. Select the for the Scheduling type and \"Any Input\" f rom the Trigger 1480 On drop -down menu. 1481 Figure 2-38 Screenshot of PI System Explorer Displaying the TwinCAT Firmware Version Mismatch 1482 Analysis Template in the PLC E lement Template 1483 1484 1485 16. On the top menu bar click Check In , verify the changes in the dialog box and click the Check In 1486 button . 1487 17. On the left navigation panel, select Elements . 1488 18. In the navigation tree in the Elements panel, select CRS-Connector > Workcell 1 > PLC. 1489 19. Open the Attributes tab in the PLC panel. 1490 20. Select the attribute HardwareSerialNumber -Expected and enter the expected hardware serial 1491 number (e.g., 5870) in the Value textbox. 1492 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 64 21. Select the attribute TwinCATVersion -Expected and enter the expected hardware serial number 1493 (e.g., 3.1.4022) in the Value textbox. 1494 22. On the top men u bar and click Check In , verify the changes in the dialog box , and click Check In . 1495 Event frames will now be generated in the DMZ Historian if the PLC reports a hardware serial number 1496 that does not match the expected value or if the TwinCAT firmware versio n number does not match the 1497 expected value. 1498 2.7 Security Onion 1499 Security Onion is a Linux -based, open source security playbook. It includes numerous security tools for 1500 intrusion detection, log management, incident response , and file integrity monitoring. For t his project, 1501 the tool Wazuh was used in Builds 2 and 4 for file integrity checking. Wazuh works at the host -level to 1502 detect unusual and unauthorized activity and changes to file and software configurations. Security 1503 Onion and Wazuh use Elastic Stack compon display alert data. 1505 Note: Wazuh is a fork of the open source project OSSEC, a host -based intrusion detection system. In 1506 some places in Wazuh and this document, the term OSSEC will be used in place of Wazuh. 1507 2.7.1 Host and Network Configuration 1508 Wazuh is an agent -based software. For this project, an existing Security Onion server was used, and the 1509 Wazuh agent was installed on multiple endpoints in both the PCS and CRS environments. The table s 1510 below list the network configuration for the Security Onion server (Table 2 -13) and the hosts ( Table 2 -14 1511 and Table 2 -15) with the installed agent. 1512 Table 2-13 Secu rity Onion Domain Hosts Deployment 1513 Name System OS CPU Memory Storage Network Security On- ion Server Hyper -V VM Ubuntu 16.04 LTS 4 16GB 450GB LAN DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 65 Table 2-14 Security Onion PCS Hosts Deployment 1515 Name System OS CPU Memory Storage Network PCS Engineer- ing Work- station HP Z230 Tower PC Windows 7 4 16GB 465GB PCS LAN 3 172.16.3.10 PCS HMI Host Supermicro Z97X -Ud5H Windows 7 600GB PCS LAN 1 172.16.1.4 1516 Table 2-15 Security Onion CRS Hosts Deployment 1517 Name System OS CPU Memory Storage Network CRS Engi-neering Workstation Dell Preci-sion T5610 1518 2.7.2 Onion Server version 3.9 and Wazuh Agent version 3.9 w ere used. 1520 Installation of Wazuh involves setting up the central server and installing agents on hosts that needed to 1521 be monitored. 1522 Security Onion server contains the Wazuh manager and API components as well as the Elastic Stack. The 1523 Wazuh manager is responsible for collecting and analyzing data from deployed agents. The Elastic Stack 1524 is used for reading, parsing, indexing, and storing alert data ge nerated by the Wazuh manager. 1525 The Wazuh agent , which runs on the monitored host , is responsible for collecting system log and 1526 configuration data and detecting intrusions and anomalies. The collected data is then forward ed to the 1527 Wazuh manager for further analysis. 1528 The Security Onion server was already a part of the lab infrastructure prior to this effort. For the server 1529 component installation process, please follow the guidance from the Security Onion Installation Guide 1530 for version 3.9 available at https://documentation.wazuh.com/3.9/installation -guide/index.html . 1531 For information on adding agents to the server , please follow the guidance from the Security Onion 1532 Installation Guide for version 3.9 available at Files for Wazuh Agent File Integrity Monitoring : 1536 a. Files and directories to be monitored are specified in the ossec.conf file on each host. 1537 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 66 i. To view or edit this file, click the View tab in the Wazuh Configuration Manager 1538 on the host machine and select View Config as shown in Figure 2 -39. 1539 Figure Agent Manager View Config open s the ossec.conf file in Notepad. Alternatively, the file can be 1542 opened in Notepad from its location in the \"C: \\Program Files (x86) \\ossec -agent\" direc- 1543 tory on the host machine , as shown in Figure 2 -40. 1544 Figure 2-40 ossec.conf File 1545 1546 c. To add files or directories to the default configuration, copy and modify an existing line 1547 in the ossec.conf file to ensure the proper XML syntax is used. 1548 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 67 d. Once the changes are made, save the ossec.conf file and restart the Wazuh Agent by 1549 opening the Confi guration r User Interface 1552 1553 e. Changes to the files or directories specified in the ossec.conf file will be detected and 1554 sent to the Wazuh Manager. Figure 2 -42 show s the l og received after a file change was 1555 detected . 1556 Figure 2-42 Log Received After a F ile Change Was Detected 1557 1558 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 68 2.8 TDi ConsoleWorks 1559 The TDi Console Works implementation in Build s 1 and 3 consist s of a single VM hosted on VMWare ESXi 1560 to meet the user a uthentication and a uthorization capabilities. ConsoleWorks provides a secure web 1561 interface through which authenticated and authorized users receive access to graphical and shell 1562 interfaces on configured ICS components. 1563 2.8.1 Host and Network Configuration 1564 ConsoleWorks resides on a VM that was reconfigured for supporting Build s 1 and 3 as described in Table 1565 2-16 and Table 2 -17 respectively. 1566 Table 2-16 ConsoleWorks Build 1 Deployment 1567 Name System OS CPU Memory Storage Network ConsoleWorks VMWare VM CentOS 7 8x Table 2-17 ConsoleWorks Build 3 Deployment 1569 Name System OS CPU Memory Storage Network ConsoleWorks VMWare VM CentOS 7 8x vCPU 2.8.2 Installation 1571 ConsoleWorks version 5.3 -1u3 is installed on a CentOS 7 operating system using the following 1572 procedures. Product installation guides and documentation are available at 1573 https://suppor t.tditechnologies.com/product -documentation . Follow these steps for installation: 1574 1. Harden and configure the Operating System : 1575 a. Log in to the system with privileged access and set the Static IP Address information by 1576 editing /etc/sysconfig/network -scripts/ifc fg-eth0 using the following settings : 1577 i. For Build 1 use the following network configuration : 1578 1) IP ii. For Build 3 use the following network configuration : 1583 1) IP Address: 192.168.0.65 1584 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments the network service as follows : 1588 # systemctl restart network 1589 b. Set the NTP Configuration as follows: 1590 i. In /etc/ntp.conf , the first server entry: 1591 server 10.100.0.15 1592 c. Apply the following Department of Defense (DOD) Security Technology Implementation 1593 Guide (STIG) settings : 1594 i. Ensure ypserv is not installed using the following command: 1595 # yum remove ypserv 1596 ii. Ensure Trivial File Transfer Protocol (TFTP ) is not installed using the following 1597 command: 1598 # yum remove tftp- server 1599 iii. Ensure RSH- SERVER is not installed using the following command: 1600 # yum remove rsh- server 1601 iv. Ensure File Transfer Protocol (FTP) is not in stalled using the following command: 1602 # yum remove vsftpd 1603 v. Ensure TELNET -SERVER is not installed using the following command: 1604 # yum remove telnet- server 1606 1) To disable SSHv1 , ensure only Protocol 2 is allowed in the 1607 /etc/ssh/ssh d_config. an empty password as follows: 1614 1) Add PermitEmptyPasswords no to /etc/ssh/sshd_config file. 1615 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 70 2) Remove any instances of the nullok /etc/pam.d/system as follows: 1618 1) FIPS mode can be enabled by running the command: 1619 # yum install dracut 1620 # dracut - f 1621 2) When step 1) is complete, add fips=1 to the /etc/default/grub file and run # grub2- -o /boot/efi/EFI/redhat/grub.cfg 1624 3) When step 2) completes , reboot the server with this command: 1625 # reboot 1626 ix. Enable server auditing 1627 1) Ensure events on the server are being recorded for investigation in the 1628 event of an outage or attack. This can be enabled by running the command: 1629 # systemctl start auditd.service. 1630 x. Configure system to only install approved digitally signed packages : 1631 1) Configure yum to verify the Certificate Authority is from an approved 1632 organization. To enable this, ensure that gpgcheck=1 is in the 1633 /etc/yum.conf file. 1634 xi. Enable the firewall : 1635 To enable the firewall, run the following commands: 1636 # yum install firewalld and 1637 # systemctl start firewalld. 1638 2) Check Firewall Zone and confirm only SSH and HTTPS is allowed. Note: the 1639 default zone is Public and SSH is already permitted. For the 1640 implementation , we checked the configuration using command: # firewall- cmd configuration to 1647 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 71 1) Add SELINUX=enforcing and SELINUXTYPE=targeted in the 1648 /etc/selinux/config file and then reboot the server with this command: 1649 # reboot 1650 xiii. Enable Antivirus as follows: 1651 1) ClamAV is used for the lab implementation using the following commands 1652 adapted from infor function 1660 # setsebool - P antivirus_can_scan_system 1 1661 3) Make a backup copy of the scan.conf file and update to remove the 1662 Example string from the file using these commands: 1663 # cp /var/run/clamd.scan/clamd.sock 1667 5) Configure freshclam to commands: 1669 # 1671 6) Manually run freshclam settings as follows: 1672 # freshclam 1673 7) Start and enable the clamd service with these c ommands: 1674 1675 # systemctl enable clamd@scan 1676 8) Ensure log available this # mkdir /var/log/clamav 1678 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 72 9) Create the daily scan script to scan directories of interest. Note: for the lab 1679 implementation only the /home volume was selected for scanning. 1680 # file to have execute privilege with this command: 1689 # chmod +x /etc/cron.daily/clamav_scan.sh 1690 ConsoleWorks 1691 a. Login to 1692 ) to download -1u3 installation package. Cre- 1693 dentials will be provided by TDi. 1694 b. After downloading the ConsoleWorks installation package, copy it to the ConsoleWorks 1695 VM using a Secure Copy (scp) utility. 1696 c. Follow the procedures from TDi ConsolWorks New Installation and Upgrade Guide for 1697 Linux Chapter 3: Automated New Installation of ConsoleWorks 1698 i. During installation, create a New Invocation named \" NCCOE \". 1699 ii. Create a new certificate . 1700 iii. Set the system to automatically start the ConsoleWorks Invocation . 1701 d. Login to the platform and initiate the offline registration process (Figure 2 -43). 1702 e. Once the license file is obtained, comp lete the registration process ( Figure 2 -44). 1703 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 73 Figure 2-43 ConsoleWorks Registration 2-44 ConsoleWorks Offline Registration Process 1706 1707 f. This completes the default installation and establishes a basic ConsoleWorks server con- 1708 figuration. For the lab implementation, ConsoleWorks support provided two additional 1709 add-on packages (XML) files setup BOARDS_NCCoE. ; 1711 and NCCOE_ACRs_20210122_083645.zip provid ing the access control rules, tags, and 1712 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 74 automation scripts used for the dashboards. These packages are scheduled for inclusion 1713 in future releas es or can be requested from ConsoleWorks . 1714 i. Prior to installing these packages, a backup of the configuration should be made 1715 (Figure 2 -45) by accessing Admin > Databa se Management > Backups and click- 1716 1718 1719 ii. Perform the XML Imports ( Figure 2 -46) by accessing Admin > Database Manage- 1720 ment > XML Imports following these steps: 1721 1) Import the Dashb oard Add- On XML file. 1722 2) Import the Supporting Configuration Add- On XML file. 1723 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 75 Figure 2-46 ConsoleWorks Importing System 1724 1725 2.8.3 Configuration 1726 The ConsoleWorks implementation required the following changes to the lab Cisco VPN ap pliance to 1727 allow remote users to access the ConsoleWorks system : 1728 1. Login to the Cisco Firepower Appliance . 1729 2. Create the Following Destination Network Objects : 1730 a. For Build 1 : 1731 i. Name: ConsoleWorks 1732 ii. IP Address: -IP 1735 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 76 a. For Build 1 : 1738 Allow 1739 ii. then configured For configuration procedures , please see the ConsoleWorks 1748 2-47 ConsoleWorks Password Settings 1751 a. NCCOE_ADMIN 1754 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 77 b. NCCOE_USER 1755 3. Configure the Graphical Gateway to allow users to use RDP within ConsoleWorks following 1756 these steps (Figure 2 -48): 1757 a. Name: LOCAL_GG 2-48 Gateway for RDP Access 1764 1765 4. Configure Device Types to organize the registered devices within the system as follows: 1766 a. Enter the information for the supported d evice types as shown in the example device 1767 type ( Figure 2 -49) for each type listed in Table 2 -18 (and shown in Figure 2 -50). 1768 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 78 Table 2-18 ConsoleWorks Device Type List 1769 Name Description Parent Device Type Order NETWORKING Devices supporting networked com- munications 1 IT_FWROUTER Network Router/Firewall for support-ing IT Communications NETWORKING 1 IT_SWITCH Network switch supporting IT com-munications NETWORKING 1 OT_FWROUTER ICS Firewall/Router for ICS Network Separation NETWORKING 1 OT_SWITCH ICS Switch for supporting OT Subnets NETWORKING 1 SERVERS Devices for providing one or more IT/OT Services 1 IT_SERVERS Servers providing IT Services SERVERS 1 OT_SERVERS Servers providing OT Services SERVERS 1 WORKSTATIONS Computers used to support IT/OT Op-erations 1 HMI Specialized workstation supporting human -machine interfaces WORKSTATIONS 1 IT_WORKSTATIONS Computers used by users to support IT Operations WORKSTATIONS 1 OT_WORKSTATIONS Computers used by users to support OT Operations WORKSTATIONS 1 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 79 Figure 2-49 1772 1773 5. Configure Devices for each system within the testbed that is accessible from ConsoleWorks. 1774 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 80 Figure 2-51 ConsoleWorks Example Device Definition 1775 1776 a. For Build 1 (PCS), e nter the information for the d evice s as shown in the example device 1777 (Figure 2 -51) for each device listed in Table 2 -19 (Figure 2 -52). 1778 Table 2-19 ConsoleWorks PCS (Build 1) Devices 1779 Name Device Type DMZ_HISTORIAN Historian in DMZ PCS_HISTORIAN Local Historian Subnet HMI PCS_ROUTER PCS PCS VLAN 1 2 OT Switch OT_SWITCH Workstation OT_WORKSTATIONS DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 81 Figure 2-52 ConsoleWorks List of PCS (Build 1) Devices 1780 1781 b. For Build 3 (CRS) , e nter the information for the d evice s as shown in the example device 1782 (Figure 2 -51) for each device listed in Table 2 -20 (also shown in Figure 2 -53). 1783 Table 2-20 Consol eWorks CRS (Build 3) Devices Type DMZ_HISTORIAN Historian in DMZ CRS_HISTORIAN Local Historian Subnet Workstation HMI CRS_ROUTER CRS Boundary OT_FWROUTER CRS_SWITCH_CONTROL OT Switch for Control Network OT_SWITCH CRS_SWITCH_FIELD OT Switch for Field Network OT_SWITCH CRS_WORKSTATION Workstation OT_WORKSTATIONS NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 82 Figure 2-53 ConsoleWorks List of CRS (Build 3) Devices 1785 6. Configure Graphical Connections for the PC (RDP) based devices. 1786 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 83 Figure 2-54 ConsoleWorks Example RDP Configuration 1787 a. For Build 1 (PCS), enter the information for the Graphical Connections as shown in t he 1788 example ( Figure 2 -54) for each graphical connection listed in Table 2 -21 (also shown in 1789 Figure 2 -55). For each entry, the following are common settings for all g raphical connec- 1790 tions : 1791 i. and select LOCAL_GG . 1792 ii. Single Session Connection: Checked 1793 iii. Allow Join with Active Sessi on: Checked 1794 iv. Under Recordings : 1795 1) Directory : /opt/ConsoleWorks/NCCOE/graphical 1796 2) Retain Records : Checked 1797 3) Auto -Purge: 0 1798 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 84 4) Max Size: 0 1799 5) End Session when Max Size Reached : Checked 1800 6) Max Time: 0 1801 v. Authentication 1802 1) Specify local or domain credentials , which are securely stored by 1803 ConsoleWorks , to allow complex passwords/credentials without having to 1804 share between users. 1805 2) Ignore Certificate Errors: Checked only if self- signed certificates are in use. 1806 vi. Performance 1807 1) Display Width: 1900 1808 2) Display Height: 1200 1809 Table 2-21 ConsoleWorks PCS (Build 1) Graphical Connections 1810 Name and System Integrity in Industrial Control System Envir onments 85 Figure 2-55 ConsoleWorks List of PCS (Build 1) RDP Connections 1811 b. For Build 3 (CRS) , enter the information for the g raphical connections as shown in the 1812 example ( Figure 2 -54) for each graphical connection listed in Table 2 -22 (also shown in 1813 Figure 2 -56). For each entry, the following are common settings for all graphical connec- 1814 tions. 1815 i. Under Gateway , click Add and select LOCAL_GG . 1816 ii. Under , use these setti ngs: 1817 1) Directory /opt/ConsoleWorks/NCCOE/graphical 1818 2) Retain Records Checked 1819 3) Auto -Purge: 0 1820 4) Max Size: 0 1821 5) End Session when Max Size Reached : Checked 1822 6) Max Time: 0 1823 iii. Authentication : 1824 1) Specify local or domain credentials , which are securely stored by 1825 ConsoleWorks , to allow complex passwords/credentials without having to 1826 share between users. 1827 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 86 iv. Performance 1828 1) Display Width: 2) Display Height: 1200 1830 Table 2-22 ConsoleWorks CRS (Build 3) Graphical Connections 1831 RDP Connections 1833 1834 7. Configure console connections for non interfaces DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 87 Figure 2-57 ConsoleWorks DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 88 Figure 2-58 ConsoleWorks Example Console ( Web Forward) Connection 1837 1838 a. For Build 1 (PCS) , enter the information for the Console Connections as shown in the ex- 1839 ample s (Figure 2 -57 and Figure 2 -58) for each console connection listed in Table 2 -23 1840 (also shown in Figure 2 -59). For each e ntry, the following are common settings for all 1841 console connections. 1842 i. Under Connection Details : 1843 1) Specify the username and password , which are securely stored by Console- 1844 Works , to allow complex passwords/credentials without having to share 1845 between users. 1846 Table 2-23 ConsoleWorks PCS (Build 1) Console Connections 1847 Name Device Connector Host Port PCS_ROUTER PCS_ROUTER SSH 10.100.2.8 22 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 89 Name Device Connector Host Port PCS_VLAN2 PCS_SWITCH_VLAN2 SSH with Password 172.16.2.2 22 1848 Figure 2-59 ConsoleWorks List of PCS (Build 1) Console Connections 1849 1850 b. For Build 3 (CRS) , enter the information for the console connections as shown in t he ex- 1851 ample ( Figure 2 -57 and Figure 2 -58) for eac h console connection listed in Table 2 -24 1852 (Figure 2 -60). For each entry, the following are common settings for all console connec- 1853 tions. 1854 i. Under Connection Details 1855 1) Specify the username and password , which are securely stored by Console- 1856 Works , to allow complex passwords/credentials without having to share 1857 between users. 1858 Table 2-24 ConsoleWorks CRS (Build 3) Console Connections 1859 Name Device Connector Host Port CRS_CONTROL_LAN CRS_SWITCH_CONTROL Web Forward 192.168.0.239 80 CRS_FIELD_LAN 22 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 90 Name Device Connector Host Port CRS_ROUTER CRS_ROUTER with Password CRS_STATION4 Forward 192.168.0.98 80 1860 Figure 2-60 ConsoleWorks List of CRS (Build 3) Console Connections 1861 1862 8. Configure tags to support profiles and access controls. 1863 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 91 Figure 2-61 ConsoleWorks List of Tags for PCS (Build 1) 1864 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 92 Figure 2-62 ConsoleWorks Example Tag Definition Screen 1865 1866 a. For Build 1 (PCS) the following tags were created as shown in Figure 2 -61. Figure 2 -62 show s an 1867 example of a single tag. 1868 i. Name: PCS_GENERAL 1869 1) Under Dashboards , click Add and select Devices . 1870 2) Under Custom UI Classes click Add and select : 1871 a) DEVICE_LISTGRID 1872 b) LISTGRID 1873 3) Under Devices , click Add and select : 1874 a) DMZ_HISTORIAN 1875 b) PCS_HISTORIAN 1876 c) PCS_HMI 1877 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 93 i. PCS_WORKSTATION 1878 4) Under Graphical Connections , click Add and select : 1879 a) DMZ_HISTORIAN 1880 b) PCS_HISTORIAN Name: PCS_ADMIN : 1884 1) Under Dashboards click Add and select Devices 1885 2) Under Custom UI Clas ses click Add and select : 1886 a) DEVICE_LISTGRID 1887 b) LISTGRID 1888 3) Under Consoles click and select : 1889 a) PCS_ROUTER 1890 b) PCS_SWITCH_VLAN1 1891 c) PCS_SWITCH_VLAN2 1892 4) Under Devices , click Add and select : 1893 a) PCS_ROUTER 1894 b) PCS_SWITCH_VLAN1 1895 c) PCS_SWITCH_VLAN2 1896 b. For Build 3 (CRS) Create the following: 1897 i. Name: NCCOE_CRS 1898 1) Under Dashboards , click Add and select Devices . 1899 2) Under Custom UI Classes, click Add and select : 1900 a) DEVICE_LISTGRID 1901 b) LISTGRID 1902 3) Under Consoles , click Add and select : 1903 a) CRS_STATION1 1904 b) CRS_STATION2 1905 c) CRS_STATION3 1906 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 94 d) CRS_STATION4 1907 e) HMI 1908 4) Under Devices , click Add and select : 1909 a) CRS_HMI 1910 b) CRS_STATION1 1911 c) CRS_STATION2 1912 d) CRS_STATION3 1913 e) CRS_STATION4 1914 f) CRS_WORKSTATION 1915 5) Under Graphical Connections , click Add and select : 1916 a) CRS_WORKSTATION 1917 ii. Name: NCCOE_ADMIN 1918 1) Under Dashboards click Add and select Devices 1919 2) Under Custom UI Classes click Add and select : 1920 a) DEVICE_LISTGRID 1921 b) LISTGRID 1922 3) Under Consoles click Add and select : 1923 a) CRS_CONTROL_LAN 1924 b) CRS_FIELD_LAN 1925 c) CRS_ROUTER 1926 4) Under Devices click Add and select : 1927 a) CRS_SWITCH_CONTROL 1928 b) CRS_SWITCH_FIELD 1929 c) CRS_ROUTER 1930 9. Configure profiles to provide user accounts with granular access controls to available resources 1931 (Figure 2 -63). 1932 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 95 Figure 2-63 ConsoleWorks Example Profile 1933 1934 a. For Build 1 (PCS) the following profiles were created : 1935 i. PCS_GENERAL 1936 1) Under Users click Add and select 1937 a) NCCOE_USER 1938 2) Under Tags click Add and select 1939 a) PCS_GENERAL 1940 b) TBA_DASHBOARD_VIEW 1941 c) TBA_DEVICE_CONNECT 1942 d) TBA_SUBSET 1943 ii. PCS_ADMIN 1944 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 96 1) Under Users , click Add and select : 1945 a) NCCOE_ADMIN 1946 2) Under Tags , click Add and select : 1947 a) PCS_ ADMIN 1948 b) TBA_DASHBOARD_VIEW 1949 c) TBA_DEVICE_CONNECT 1950 d) TBA_SUBSET 1951 e) CONSOLE_CONTROL_ACCESS 1952 f) CONSOLE_VIEW_ACCESS 1953 b. For Build 3 (CRS) create the followin g: 1954 i. NCCOE_CRS profile for the NCCOE_USER with access to Tags: 1955 1) Under Users , click Add and select : 1956 a) NCCOE_USER 1957 2) Under Tags click Add and select the following: 1958 a) NCCOE_CRS 1959 b) TBA_DASHBOARD_VIEW 1960 c) TBA_DEVICE_CONNECT 1961 d) TBA_SUBSET 1962 e) CONSOLE_CONTROL_ACCESS 1963 f) CONSOLE_VIEW_ACCESS 1964 ii. NCCOE_ ADMIN profile for the NCCOE_USER with access to Tags: 1965 1) Under Users , click Add and select : 1966 a) NCCOE_ADMIN 1967 2) Under Tags click Add and select the following: 1968 a) NCCOE_ADMIN 1969 b) TBA_DASHBOARD_VIEW 1970 c) TBA_DEVICE_CONNECT 1971 d) TBA_SUBSET 1972 e) CONSOLE_CONTROL_ACCESS 1973 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 97 f) CONSOLE_VIEW_ACCESS 1974 2.9 Tenable.OT 1975 The Tenable.OT implementation in Build 1 consists of a single appliance to meet the BAD, h ardware 1976 modification, firmware modification, and s oftware modification capabilities. Tenable.OT utilizes a 1977 combination of passive and active sensors to monitor critical networks for anomalies and active 1978 query ing to retrieve information about endpoints in the PCS environment. 1979 2.9.1 Host and Network Configuration 1980 Tenable.OT is installed and configured to support the PCS environment in Build 1 . The overall build 1981 architecture is described in Figure B -1, and the Tenable.OT specific components are listed in Table 2 -25. 1982 Table 2-25 Tenable.OT Appliance Details. 1983 Name System OS CPU Memory Storage Network Tenable.OT Model: NCA - 4010C -IG1 CentOS 7 Intel Xeon 64 2 TB 2 TB Testbed LAN 10.100.0.66 2.9.2 Installation 1984 The Tenable.OT (Version 3.8.17) appliance is installed in a rack with network connections for the 1985 Management/Query traffic on Port 1 and SPAN traffic on Port 2 of the appliance. Documentation for 1986 Tenable.OT is available at https://docs.tenable.com/Tenableot.htm . 1987 2.9.3 Configuration 1988 This section outlines the steps taken to configure Tenable.OT to fully integrate and support the PCS 1989 environment. These include setting NTP settings to synchronize the system time with the lab time 1990 source, configuring the scanning options for the PCS environment, and configuring network objects and 1991 policies to enhance alerting for DMZ specific remote connections. 1992 1. Enable connection through PCS Firewall 1993 a. Add the following rules ( Table 2 -26) to the PCS Firewall to allow Tenable.OT to perform 1994 asset discovery and controller scanning. 1995 Table 2-26 Firewall Rules for Tenable.OT 1996 Rule Type Source Destination Protocol:Port(s) Purpose Allow 10.100.0.66 172.16.0.0/22 ICMP Asset Discovery Allow 10.100.0.66 172.16.2.102 TCP:44818,2222 PLC Controller Scans 2. Set NTP Services as follows: 1997 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 98 a. After logging into the appliance, navigate to Local Settings > Device . 1998 b. To the right of System Time, click Edit to display the time service options ( Figure 2 -64). 1999 c. Enter the NTP Server information: 10.100.0.15 2000 d. Click Save . 2001 Figure 2-64 Tenable.OT Local Device Setting for NTP Service 2002 2003 3. Configure Scanning Options as follows: 2004 a. Set Asset Discovery Scans : 2005 i. Navigate to Local Settings > Queries > Asset Discovery (Figure 2 -65) 2006 ii. Enable both scan options . 2007 iii. Select Edit next to Asset Discovery . 2008 1) Enter the following CIDR for the PCS, DMZ, and Testbed networks : 2009 a) 172.16.0.0/22 2010 b) 10.100.0.0/24 2011 c) 10.100.1.0/24 2012 2) Set the scan properties as follows: 2013 a) Number of Assets to Poll Simultaneously: 10 2014 b) Time Between Discovery Queries: 1 second 2015 c) Frequency: Daily 2016 d) Repeats Every: 7 Days 2017 e) Repeats at: 9:00 PM 2018 3) Click Save . 2019 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 99 Figure 2-65 Tenable.OT Asset Discovery Settings 2020 2021 b. Set Controller Scans as follows: 2022 i. Navigate to Local Settings > Queries > Controller (Figure 2 -66) 2023 ii. Enable the following options: 2024 1) All Controller Queries 2025 2) Periodic Snapshots 2026 3) Controller Discovery 2027 4) Controller Status Query 2028 5) Controller Details Query 2029 6) Backplane Query 2030 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 100 Figure 2-66 Tenable.OT Controller Scans 2031 2032 c. Set Network Scans as follows: 2033 i. Navigate to Local Settings > Queries > Network ( Figure 2 -67) 2034 ii. Enable the following options: 2035 1) All Network Queries 2036 2) DNS Query 2037 3) ARP Query 2038 4) NetBIOS Query 2039 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 101 Figure 2-67 Tenable.OT Network Scan Settings 2040 2041 4. Create Group Object as follows: 2042 a. Set DMZ Group Object 2043 i. Navigate to Groups > Asset Groups 2044 ii. Click Create Asset Group to initiate the Wizard p rocess . 2045 1) Select IP Range for the Asset Group Type ( Figure 2 -68) and Click Next . 2046 2) Enter the a sset name in Name , the s tarting IP address in Start IP, and the 2047 ending IP Address in End IP (Figure 2 -69) and Click Create . 2048 Figure 2-68 Tenable.OT Group Type 2049 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 102 Figure 2-69 Tenable.OT Create Asset Group Definition 2050 2051 5. Create Policy to Detect External RDP Traffic : 2052 a. In the left side navigation, click Policies . 2053 b. Click Create Policy in the upper right corner of the page ( Figure 2 -70), then follow these 2054 steps: 2055 i. For the Event Type ( Figure 2 -71), select as a Network Event s > RDP Connection 2056 (Authenticated) and click Next . 2057 ii. For the Policy Definition ( Figure 2 -72), specify the following parameters and click 2058 Next : 2059 1) Policy Name: Enter \" External RDP C ommunications \" 2060 2) Source Group : Select \" In\" from the first drop -down , and \" DMZ \" from the 2061 second drop -down. 2062 3) Destination Group : Select \" In\" from the first drop -down and select \" In Any 2063 Asset \" from the second drop -down. 2064 4) Schedule Group : Select \" In\" from the first drop -down, and \" In Any Time \" 2065 from the second drop -down. 2066 iii. For the Policy Action ( Figure 2 -73), select Medium Sensitivity and click Create . 2067 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 103 Figure 2-70 Tenable.OT Policy Settings 2068 2069 2-71 Tenable.OT Create Event Type Options 2070 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 104 Figure 2-72 Tenable.OT Create Policy - Definition 2071 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 105 Figure 2-73 Tenable.OT Create Policy - 2.10 VMware Carbon Black App Control 2073 VMWare Carbon Black App Control is an endpoint protection tool that provid es multiple file integrity 2074 and application features , including application allow/deny listing and file modification or deletion 2075 protection. Carbon Black was used fo r Builds 1 and 4 as the a pplication allowlisting (AAL) and file 2076 integrity checking tool. 2077 2.10.1 Host and Network Configuration 2078 The following tables ( Table 2 -27, Table 2 -28, and Table 2 -29) detail the host a nd network configuration 2079 of the Carbon Black App Control server for PCS and CRS . 2080 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 106 Table 2-27 Carbon Black App Control Domain Hosts Deployment 2081 Name System OS CPU Memory Storage Network Carbon Black Server VMware ESXi VM Windows Server 2016 Datacenter 4 8GB 500GB Testbed LAN 10.100.0.52 Windows Server Hyper VM 2012 R2 2 6GB 65GB Testbed LAN 10.100.0.25 OSIsoft Pi Server Hyper 2016 4 8GB 80GB/171GB DMZ 10.100.1.4 Dispel VDI 2 8GB 126GB N/A Table 2-28 Carbon Black App Control PCS Hosts Deployment 2082 Name System OS CPU Memory Storage Network PCS HMI Workstation Supermicro Z97X -Ud5H Windows 172.16.3.10 Table 2-29 Carbon Black App Control CRS Hosts Deployment 2083 Name System OS CPU Memory Storage Network CRS Engi- neering Workstation Dell Preci-sion T5610 Supervi-sory 192.168.0.20 CRS OSIsoft Pi Server Hyper -V VM Windows Standard 16GB 80GB/171GB CRS Supervi- sory 192.168.0.21 2.10.2 Installation 2084 Prepare the Carbon Black App Control Server (fka CB_Protection) in accordance with the CB Protection 2085 Operating Environment Requirements v8.1.6 document that is provided for installation. This document, 2086 and all Carbon Black documentation, can be found on the website https://community.carbonblack.com . 2087 1. Install Carbon Black App Control Server (fka CB_ Protection ) using these steps: 2088 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 107 a. Created nccoeCarbon domain user account on LAN AD to be used for installation and 2089 administration of CB App Control Server and add this user to the local administrators' 2090 group on the server. 2091 b. Install SQL Server Express 2017 acc ording to the CB Protection SQL Server Configuration 2092 v8.1.4 document . 2093 c. Install the CB App Control Server according to the CB Protection Server Install Guide 2094 v8.1.6 document . 2095 2.10.3 Configuration to configure Windows Server 2016: 2097 1. On the Carbon Bl ack App Control Server, configure Windows Server 2016 : 2098 a. Based on Carbon Black documentation ( Figure 2 -74), Windows Server 2016 will need to 2099 have the following features for the Internet Information Services (IIS) role enabled for 2100 Carbon Black to work ( Figure 2 -75). 2101 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 108 Figure 2-74 Excerpt from Carbon Black Documentation on Support Server Requirements 2102 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 109 Figure 2-75 IIS Configuration for Carbon Black, Server Roles 2103 2. Manually update the Windows Server firewall configuration to allow inbound port 41002 traffic 2104 from CB App Control clients/agents . 2105 3. Configure Policy in the Carbon Black Console using these steps: 2106 a. In the CB App Control Console, go to Rules > Policies . 2107 b. Create a new policy with the desired enforcement level. In this case, a h igh enforcement 2108 level was chosen to actively block execution of unapproved or banned executables ( Fig- 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 110 Figure 2-76 Carbon Black Policy Edit 2111 2112 4. Enable AD Integration Features as follows: 2113 a. Enable AD integration features on CB App Control Console for domain user account 2114 login and AD -Based Policy mapping. AD-Based Policy mapping allows automatic policy 2115 assignment to be mapped to AD users, groups, computers, organizational units ( OUs) , 2116 etc., as configured by a CB App Control Console administrator (Figure 2 -77). 2117 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 111 Figure 2-77 Carbon Black App Control System Configuration 2118 2119 5. Add users from AD and assign policies : 2120 a. Add \"Test Users\" OU from the AD to policy mapping settings and assign the \"High- 2121 Enfcmt_NCCOE\" policy (Figure 2 -78). 2122 This OU includes the \"nccoeUser\" and \"nccoeAdmin\" user accounts created for the test 2123 scenarios. This policy will be automatically applied to these users logged in on any com- 2124 puter that is ru nning the CB Protection Agent. The \"HighEnfcmt_NCCOE\" policy is set to 2125 High Enforcement level, which will actively block all unapproved or banned files, applica- 2126 tions, or devices. 2127 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 112 Figure 2-78 Carbon Black App Control AD Policy Mappings 2128 2129 6. Download and install CB App Control Agent from CB App Control Server 2130 (The process outlined below uses the CRS Engineering Workstation as an example, but the process 2131 was the same for all the agent computers.) . Follow these step s: 2132 a. Open the browser on the CRS Engineering Workstation and enter the URL to download 2133 the agent installer: htt ps://CB -Server.lan.lab/hostpkg . This URL is on the Carbon Black 2134 server itself and is accessed on the local network. CB-Server.lan.lab is the full host name 2135 we gave this server during installation. 2136 i. If the host cannot access CB -Server.lan.lab, update the environment DNS Server 2137 by mapping the IP address , 10.100.0.52, to CB -Server.lan.lab or add the mapping 2138 to the local host file. 2139 b. Download the Windows CB A pp Control Agent installer from the CB App Control Server 2140 and install on the CRS Engineering Workstation (Figure 2 -79). 2141 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 113 Figure 2-79 Carbon Black Agent Download 2142 2143 c. Check the CB App Control Console to verify communication and initialization of the new 2144 CRS Engineering Workstation agent computer on the CB App Control Server (Figure 2145 2-80). 2146 Figure 2-80 Carbon Black App Control Computer s 2147 2148 d. Approv e all new trusted files and publishers that were added from the CRS Engineering 2149 Workstation to the catalog on the CB App Control Server. 2150 e. This image ( Figure 2 -81) shows the Cb Protection - Files page of the CB App Control Con- 2151 sole. 2152 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 114 Figure 2-81 Carbon Black App Control File Catalog 2153 2154 2.11 Windows Software Restriction Policy (SRP) 2155 Windows SRP is a feature that is a part of the Windows operating system. It identifies applications that 2156 are running on any domain -controlled computer, and it can block any programs that have not been 2157 allow -listed. Configuring Wind ows SRP is done through Group Policy Object management. Windows SRP 2158 was used for AAL in Builds 2 and 3. 2159 2.11.1 Host and Network Configuration 2160 Windows SRP configuration is established by Group Policy Objects (GPOs) located on the two AD 2161 servers. The domain control lers were common across all builds as detailed in Table 2-30. 2162 Table 2-30 Windows SRP Domain Servers 2163 Name System OS CPU Memory Storage Network AD (Primary) Server Hyper -V VM Windows 2012R2 2x vCPU 2 GB 45 GB Testbed LAN 10.100.0.17 ary) Server Hyper -V VM Windows 2012R2 vCPU 2 GB 21 GB Testbed LAN 10.100.0.13 2164 The following systems were configured to utilize Windows SRP for each build. Additional details for each 2165 build are available in Section 4.5 of Volume B. 2166 Build 2 supports the testing within the PCS environment . The overall build architecture is provided in 2167 Figure B -2. The Windows SRP specific components are in Table 2-31. 2168 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 115 Table 2-31 Windows SRP Build 2 Deployment 2169 Name System OS CPU Memory Storage Network Windows Server Hyper -V VM Windows 2012R2 2x vCPU 6 GB 65 GB Testbed LAN VDI Hyper -V VM Windows 2016 vCPU 8 GB 126 GB DMZ LAN 10.100.1.61 DMZ Historian Hyper -V VM Windows 2016 4x vCPU 8 GB 80 GB, 171 GB DMZ LAN 10.100.1.4 Engineering Workstation HP Z230 Workstation Windows 7 Intel i5 - 4570 16 GB 465 GB 172.16.3.10 HMI Host Generic Windows 7 Intel i5 - 4590 8 GB 233 GB PCS VLAN 1 172.16.1.4 Build 3 supports the testing within the CRS environment . The overall build architecture is provided in 2170 Figure B -3. The Windows SRP specific components are in Table 2-32. 2171 Table 2-32 Windows SRP Build 3 Deployment 2172 Name System OS CPU Memory Storage Network Windows Server Hyper -V VM Windows 2012R2 2x vCPU 6 GB 65 GB Testbed LAN Historian Hyper -V VM Windows 2016 4x vCPU 8 GB 80 GB, 171 GB DMZ LAN 10.100.1.4 Engineering Workstation Dell T5610 Windows 10 2x Intel E3-2609 v2 16 GB 465 GB CRS Supervi- sory LAN 192.168.0.20 CRS Local His-torian Hyper -V VM Windows 2016 4x vCPU 16 GB 80 GB, 171 GB CRS Supervi- sory LAN 192.168.0.21 2.11.2 Installation 2173 Windows SRP is a feature of the Windows o perating system and therefore did not require any specific 2174 installation for use in the project . 2175 2.11.3 Configuration 2176 The Windows SRP configuration required setting GPOs on the AD servers to enable the policy on all 2177 hosts that were part of the Windows domain. Additionally, hosts that were not part of the Windows 2178 Domain had GPO settings configured locally to the host. Follow t hese steps to configure AD with user 2179 accounts and set enforcement policies: 2180 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 116 1. Set up AD with a \"Test User\" OU and add the NCCOE User (nccoeUser) and Admin (nccoeAdmin) 2181 accounts for this project to the OU . 2182 2. To allow the NCCOE Admin account to be included as a local administrator within the 2183 environment, modify the Default Domain GPO to add Administrators to Restricted Group and 2184 include the NCCOE Admin account. 2185 3. To support applying GPOs as local settings to non -domain computers , download LGPO.zip from 2186 Microsoft Se https://www.microsoft.com/en - 2187 us/download/details.aspx?id=55319 . 2188 4. Review the National Security Agency ( NSA) Guidance for Application Whitelisting using Software 2189 Restriction Policies and Guidelines for Application ICSs respectively. 2193 5. Windows SRP GPO with the following settings: 2194 a. From the Enforcement Properties dialog ( Figure 2-82): 2195 i. Select the All Software Files radio button. 2196 ii. Select the All Users radio button. 2197 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 117 Figure 2-82 Setting Enforcement Properties 2198 2199 b. In the Group Policy M anagement Editor, in the Security Levels folder: 2200 i. Double -click the Disallowed security level to open the Disallowed Properties win- 2201 dow. 2202 ii. Click the Set as Default radio button ( Figure 2-83) to configure SRP in allowlist 2203 mode. After completing this step, only programs in the paths specified by the en- 2204 vironment permit- 2206 ted to execute. These path rules are automatically added when the \" Disallowed \" 2207 security level is set as the default. 2208 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 118 Figure 2-83 Setting Security Le vel Default 2209 2210 c. Customize the Allowlist Rules to enhance security by disallowing specific subfolders in 2211 the default allowed paths and to support organization application requirements. 2212 i. Click the Additional Rules folder and apply the rules shown in Figure 2-84. This 2213 figure combines the NSA recommended path settings in addition to lab applica- 2214 tion requirements and for disabling installers and other executable content as in- 2215 dicat ed in the comments. Organizations should audit their environments to deter- 2216 mine the appropriate rules to define within the policy . 2217 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 119 Figure 2-84 Additional Rules Defined for Lab Environment 2218 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 120 6. Link the GPO to the Tes t User OU : 2219 a. In the Group Policy Management tool , right click the \"Test User\" OU and select Li nk an 2220 Existing GPO from the pop -up menu ( Figure 2-85). 2221 Figure 2-85 Menu Options for Accessing the Link an Existing GPO Option 2222 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 121 b. In the d ialog box, select the Windows SRP GPO Object from the list and click OK (Figure 2223 2-86). 2224 Figure 2-86 Dialog Box for Selecting GPO to Link 2225 2226 (Optional) Install GPO as the l ocal policy on non -domain systems ; for systems that are not joined 2227 to the domain, the nccoeUser and nccoeAdmin accounts are created as local user and 2228 administrator accounts, respectively. Additionally, the Windows SRP GPO is manually applied to 2229 the local system using the LGPO.exe application contained in the ZIP file from Step 3. 2230 c. Create a Backup of the Windows SRP GPO Object : 2231 i. From the Group Policy Manager, select the Group Policy Objects folder and right - 2232 click on the Windows SRP GPO object. 2233 ii. Select the Back Up... option from the pop -up menu. 2234 iii. In the d ialog box, choose a destination location such as C: \\Backup GPO Folder or 2235 some other convenient location to place the files and click Back Up . 2236 d. Copy the LGPO.exe along with the files created in the previous step to the non -domain 2237 computer system. 2238 e. Login as an a dministrator on the non -domain computer navigate \\Do- 2239 \\User folder , for the GPO. 2240 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 122 f. Execute the following commands to apply the settings to the local nccoeUser and Application Allowlisting 2246 AD Active Directory 2247 AF Framework 2248 Anomaly Detection 2249 CRS Collaborative Robotic System 2250 CRADA Cooperative CSF NIST DNAT Destination Network Address Translation 2255 FOIA Freedom of Information Act 2256 GPO Group Policy Object 2257 HDD Hard Disk Drive 2258 ICS Industrial Control System 2259 IIS Internet Information Services 2260 IoT Internet of Things 2261 IT Information Technology 2262 LAN Local Area Network 2263 MFA Multifactor Authentication 2264 MTD Moving Target Network Address Translation 2266 NCCoE National Cybersecurity Center of Excellence 2267 NIST National Institute of Standards and Technology 2268 NISTIR NIST Interagency or Internal Report 2269 NSA National Security Agency 2270 NTP Network Time Protocol 2271 OT Operational Technology 2272 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 124 OU Organizational Unit 2273 PCS Process Control System 2274 PI Process Information 2275 PLC Programmable Logic Controller 2276 RDP Remote Desktop Protocol 2277 SP Special Publication 2278 SPAN Switch Port Analyzer 2279 VDI Virtual Desktop Interface 2280 VLAN Virtual Local Area Network 2281 VM Virtual Machine 2282 VPN Virtual Figure B-1 Build 1 Architecture Diagram 2285 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 126 Figure B-2 Build 2 Architecture Diagram 2286 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 127 Figure B- 3 Build 3 Architecture Diagram 2287 DRAFT NIST SP 1800- 10C: Protecting Information and System Integrity in Industrial Control System Envir onments 128 Figure B-4 "}