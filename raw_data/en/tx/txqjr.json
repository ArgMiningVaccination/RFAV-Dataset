{"title": "PDF", "author": "PDF", "url": "http://philsci-archive.pitt.edu/16772/1/RDic_REV3ACBI_D_19.pdf", "hostname": "PDF", "description": "PDF", "sitename": "PDF", "date": "PDF", "cleaned_text": "(will be inserted by the editor) Measuring infection transmission in a stochastic SIV model with infection reintroduction and imperfect vaccine M Gamboa \u0001MJ Lopez-Herrero Received: date / Accepted: date Abstract An additional compartment of vaccinated individuals is considered in a SIS stochastic epidemic model with infection reintroduction. The quan- ti cation of the spread of the disease is modeled by a continuous time Markov chain. A well-known measure of the initial transmission potential is the ba- sic reproduction number R0, which determines the herd immunity threshold or the critical proportion of immune individuals required to stop the spread of a disease when a vaccine o ers a complete protection. Due to repeated contacts between the typical infective and previously infected individuals, R0 overestimates the average number of secondary infections and leads to, per- haps unnecessary, high immunization coverage. Assuming that the vaccine is imperfect, alternative measures to R0are de ned in order to study the in- uence of the initial coverage and vaccine e\u000ecacy on the transmission of the epidemic. Keywords Stochastic Markovian epidemic \u0001Imperfect vaccine \u0001Basic reproduction number Mathematics Subject Classi cation (2000) 92D30\u000160J28\u000160J22 The authors would like to thank the referees and the editor for their useful comments and suggestions, which helped us to improve the manuscript. Financial support for this work was provided by the Government of Spain (Department of Science, Technology and Innovation) and the European Commission through project MTM 2014-58091-P. The rst author is grateful for the economical support of Banco Santander and Universidad Complutense of Madrid (Pre-doctoral researcher contract CT42/18-CT43/18) M Gamboa Faculty of Statistical Studies, Complutense University of Madrid, Spain E-mail: mgamboa@ucm.es MJ Lopez-Herrero (Corresponding author) Faculty of Statistical Studies, of Madrid, Spain E-mail: lherrero@estad.ucm.es2 M Gamboa, MJ Lopez-Herrero 1 Introduction Mathematical modeling is an essential tool to represent the progress of an epidemic through a population. It is commonly accepted that the work of Kermack and Mckendrick (1927) is the prototype of almost all epidemiological models based on a classi cation of individuals by their epidemic status. Since then, many other compartmental models have been developed to investigate a diverse range of communicable diseases to obtain a better knowledge of their transmission mechanisms (Anderson and Britton 2000; Kretzschmar et and Lopez-Herrero 2014; Liu et al. 2018). A common assumption is that the communicable disease spreads in a com- munity of constant size. The population can be closed in the sense that infec- tious individuals can infect only other individuals within the population under study during the epidemic's time span. However, assuming reintroduction of the disease through contact with infected individuals from other areas could represent a more realistic scenario (Marchette and Wierman 2004; Stone et al. 2007; Amador 2016). After infection, it is assumed that patients recover due to their own im- mune system which acts as a body's defense force against germs and other invading substances. Hence, to reduce the incidence of an infectious disease requires improving sanitary and living conditions. In that sense, we cannot ig- nore the impact of vaccination on this reduction, especially in the developing world. Vaccines activate the immune system's capacity of producing antibod- ies to ght diseases without exposing it to diseases-producing pathogens. If a vaccinated person comes into contact with the disease for which she/he has been vaccinated, her/his immune system recognizes the invading germs and immediately produces the antibodies that will kill foreign invaders. Generally, vaccines provide immunity similar to that acquired from the natural infection, and duration of protection varies depending on diseases and also on vaccine strains. Lifelong immunity is not always provided by vaccination and usually several doses of vaccine may be required. Furthermore, the immune response may wane over time and it is necessary to administrate new doses of vaccine to increase or restore immunity. As it is an e ective method of disease control, recent epidemiological mod- Ball and Sirl 2018; Li and Zhang 2019) have added a vaccination compartment and vaccination strategies into their mathematical model. Some papers discussing the impact of vaccination on the spread of an epidemic assume complete protection (Iannelli et al. 2005; Alexan- der et al. 2006; Ball et al. 2007; et al. 2014; Eckalbar and Eckalbar 2015; Guo 2017) but even vaccine e\u000ecacy, as measured by observational studies, is not 100% pends on internal or individual factors, as well as on the dose and strain of the vaccine virus (Demicheli et al. 2012). In scienti c literature, vaccine e\u000ecacy and e ectiveness are often used interchangeably. Vaccine e\u000ecacy represents the reduction in the risk of infection at individual level under optimal condi-Infection transmission in a stochastic SIS with imperfect vaccine 3 tion (e.g., randomized controlled trials) while vaccine e ectiveness compares rates of the transmission of the disease between vaccinated and unvaccinated individuals once the vaccine is approved for use in the general population. The SIS model with imperfect vaccine has been studied from a determin- istic point of view in the papers by Moghadas (2004) and Safan and Rihan (2014), under nonlinear incidence in Xiao and Tang (2010) and Yang et al. (2015), and with inclusion of a latency period as well as psychological ef- fects in both susceptible and vaccinated individuals in Cheng et al. (2015). A SIV model with stochastic perturbations is discussed in Liu et al. (2018) and L\u0013 opez-Garc\u0013 \u0010a (2016). The above-mentioned studies deal with large populations, but transmission patterns become quantitatively di erent when a small population is involved. Firstly, individual variations of infectivity, recovery periods and vaccine pro- tection, even for a homogeneous social group, should be taken into account. Moreover, when the susceptible population becomes depleted the extent of the epidemic is interrupted and, for closed populations, the extinction of the disease is possible (Keeling and Ross 2008). The aim of this paper is to quantify the spread of an infectious disease that does not confer immunity, within a population that is partially protected against the disease by a vaccine. A continuous time Markov chain ( CTMC ) model represents changes in the composition of infected and vaccinated classes. Two random variables will quantify the transmission of the epidemic process with reintroduction: Re0, the number of infectious cases caused directly by the rst infected individual, and Rp, which is the number of infectious cases caused by any infectious spreader. These random variables act as stochastic counterparts to the basic reproduction number, R0, and more speci cally the control reproduction number, Rc, when there is an available vaccine. In the literature, the term herd-immunity threshold refers to the critical proportion of immune individuals that is needed to interrupt epidemic trans- mission in a population. There is a simple relationship between herd-immunity coverage and the basic reproduction number. If a perfect vaccine is available and a fraction fof the population is vaccinated, then the disease will not spread if (1\u0000f)R0<1. In general terms, we can represent the quality of a vaccine by a measure of the vaccine imperfection h2[0;1], withh= 0 indi- cating a perfect vaccine, and h= 1 a useless vaccine. For imperfect but not useless vaccines, the critical vaccination coverage level to eradicate the infec- tion is related to the proportion (1 \u00001=R0)=(1\u0000h):In any case, herd immunity depends on estimates of R0, and is the result of a reduction in viral transmis- sion caused by removing vaccinated individuals from the susceptible class. We will investigate the spread of the disease directly, at any time, by updating the current population state, and we will apply our alternative measures to control disease spread by xing an adequate vaccine coverage level. The structure of the paper is as follows. In Section 2, we describe the SIV stochastic model with infection reintroduction and summarize results for its long term behavior in terms of the reintroduction parameter. Section 3 introduces the proposed random variables, Re0andRp, as measures of the in-4 M Gamboa, MJ Lopez-Herrero fection transmission in a partially vaccinated population. Theoretical and al- gorithmic results will provide probability mass functions and moments for Re0 andRp, depending on the initial vaccine coverage and e ectiveness. Section 4 illustrates the applicability of the algorithmic results and presents several qualitative facts regarding the infection transmission. Finally, we present some concluding remarks and tentative future research lines. 2 Model description We consider a homogeneous and uniformly mixing population of constant size, N, where individuals are a ected by a contagious disease. This disease is trans- mitted by direct contact with an infected individual. The population is not isolated, so we assume that there is an additional source of infection due to external contacts. We suppose that some individuals in the population have been protected against the disease with an available vaccine that confers im- munity, but it is not a perfect vaccine and some contacts between vaccinated and infectious individuals produce an e ective contagion. Once a vaccinated individual gets the infection, he no longer belongs to the class of individuals that have been vaccinated and he belongs to the infective class while he is in- fectious. Recovered individuals become susceptible to the disease, no matter if they were previously vaccinated or not. Consequently, individuals in the popu- lation are classi ed into three separate classes, namely susceptible, vaccinated and infected. Vaccination was implemented at t= 0 and no vaccination will take place after this epoch. In general terms, the underlying mathematical model involves a SIV model, where movement of individuals among the three epidemiological classes is shown in Figure 1, with Sdenoting the class of susceptible individuals, Ide- noting the class of infected individuals, and Vdenoting the class of vaccinated individuals. Fig. 1 SIV compartmental diagram At any time t > 0, the state of the epidemic is described by random variablesS(t);V(t);I(t), that record the number of susceptible, vaccinated and infective individuals, respectively, at time t. According to the constant size hypothesis we have S(t) +V(t) +I(t) =N:Infection transmission in a stochastic SIS with imperfect vaccine 5 We represent the evolution of the disease in terms of a two-dimensional CTMC: X=f(V(t);I(t));t\u00150g:Assuming that initially the population contains v0 vaccinated individuals, with 0 \u0014v0\u0014N, the state space of : 0\u0014v\u0014v0, 0\u0014i\u0014N;0\u0014v+i\u0014Ngthat contains v0+ 1) (N+ 1\u0000v0=2) states. Notice that once v= 0 the vaccination compartment is empty and the underlying model is the standard SIS epidemic one. Next, we describe the dynamics of the Markov chain, X, in full details. See Table 1 for a summary of parameters used. The exhaustive description of the events and their transition rates is presented in Table 2. Finally, a diagram showing transitions from a general state ( v;i)2Sis depicted in Figure 2. Table 1 Parameters of the model Population size N Disease internal transmission rate Disease external transmission rate \u0018 Probability of vaccine failure h Recovery rate Table 2 E ective events and their transition rates E ective event Transition Rate Susceptible-Infected internal contagion ( loss of immunity ( v;i)!(v;i\u00001) Fig. 2 Transitions among states6 M Gamboa, MJ Lopez-Herrero To understand the dynamics of the model it is necessary to describe the events that cause a change in the current model state ( v;i). There are ve possible e ective events that are listed in Table 2. E1. A susceptible individual gets the infection from an infective individual within the population. E2. A susceptible individual gets the infection from an external source of infection. E3. Due to vaccine failure, a vaccinated individual becomes infected from an infective individual within the population. E4. Due to vaccine failure, a vaccinated individual becomes infected from an external source of infection. E5. An infective individual is recovered and becomes susceptible. Sojourn times at each state in Sare independent and exponential random variables, with rate qv;i=\u0012 i N+\u0018\u0013 (N\u0000v\u0000i) +h\u0012 i N+\u0018\u0013 v+ i: (1) describe Q, the in nitesimal generator of the Markov chain X, we partition the state space in levels regarding the number of vaccinated individuals, that is S=[v0 v=0L(v), 1\u0000v) states. Then, we can express the in nitesimal generator of Xin the following The blocks Qv;v\u00001, for 1\u0014v\u0014v0, correspond to transitions due to vaccine failures, and the blocks Qv;v, for 0\u0014v\u0014v0, correspond to transitions within level L(v) that are due either to infections of susceptible or recoveries. Non-null sub-matrices are described of Qguarantees that square matrices appearing in the forthcoming theoretical results are, at most, tridiagonal and diagonally dominant. Thus, they are non-singular, and linear systems involving these matrices can be solved e\u000eciently by a simpli ed form of the Gaussian elimination algorithm (Golub and van Loan 1996). 2.1 Stationary behavior As we are dealing with a nite state CTMC, the long-term behavior of X depends on the structure of communicating classes of absorbing states. In that sense, we notice that the reintroduction parameter (that is, the external transmission rate \u0018) plays an important role in the classi cation of the states inS. If we assume that the population is isolated and contagions are produced only by internal contacts; i.e., \u0018= 0, then states with 0 infective individuals are absorbing. This fact and the niteness of the state space guarantee that the process will become absorbed into any of the non-communicating classes of absorbing states with probability one. Hence, the epidemic extinction is certain and outbreaks involve a single epidemic episode that will last a nite expected time. On the other hand, when \u0018 > 0, the state space of the nite CTMC X contains a single absorbing set given by L(0) =f(0;i) : 0\u0014i\u0014Ng. Thus, once the process enters into L(0) it can move across these states but it can not leave the absorbing set. Hence the stationary distribution assigns mass to every state with no vaccinated individuals. Which means that, in the model with external source of infection, occasionally the disease is faded away (i.e., I= 0) for a short time, but the infection is reintroduced at a later time. More speci cally, the theoretical long-term distribution of the number of infective individuals agrees with the stationary distribution provided in Stone et al. (2007), Section 2.6.8 M Gamboa, MJ Lopez-Herrero 0 0.5 1 1.5 2 2.5 3 3.5 Time0510152025Individualsinfected vaccinated susceptible Fig. 3 Simulated trajectories of XwhenN= 25, = 2:5,\u0018= 0,h= 0:3 and = 1:0 0 2 4 6 8 10 12 Time05101520Individualsinfected vaccinated susceptible Fig. 4 Simulated trajectories of XwhenN= 25, = 2:5,\u0018= 0:01,h= 0:3 and = 1:0 Figures 3 and 4 show typical trajectories for the CTMC X, starting from a single individual infected in a population of 25 individuals, 5 of which are vaccinated. We simulate 500 transitions among states and keep track of the time at which a transition occurs. Each line in Figures 3 and 4 represents the sequence of time points and the number of individuals (infected, vaccinated or susceptible) recorded at these time epochs. The paths in Figure 3 correspond to an isolated population and we observe that, approximately, after 2 time units the epidemic transmission will cease. In Figure 4, the reintroduction parameterInfection transmission in a stochastic SIS with imperfect vaccine 9 is\u0018= 0:01. The path for vaccinated individuals shows that vaccine protection has faded away in about 10 time units, while the paths for the infected and susceptible populations settle towards the stationary endemic scenario. 3 Disease spread This section deals with a probabilistic characterization of the o spring distri- bution of secondary infections of an epidemic process, at a particular time. We will consider two random variables to measure the spread of the infection, when a rst case of disease is identi ed in a population. In epidemiology, the individual who rst brings the disease into a group is called the index case and we will start focusing on the number of infections coming from the index case during its entire infectious period. Secondly, we will study all of the secondary cases produced by the whole set of currently infectious individuals prior to the rst recovery. The above mentioned measures are the stochastic analogues to the well-known basic reproduction number cally, to the control reproduction number Rc, de ned as the average number of secondary cases due to each infective individual in the presence of control measures. In the case of vaccination R0andRc satisfy the simple expression Rc=R0(1\u0000(1\u0000h)f), wherehis the proportion of vaccinated individuals for which the vaccine has no e ect (hence, 1 \u0000h quanti es the vaccine e ectiveness), and frepresents the vaccine coverage as the initial fraction of the target population that has received the vaccine (Alexander et al. 2004; Magpantay 2014). The Markovian chain, describing the evolution of the epidemic in the com- partmental model, will play an essential role to develop theoretical results. The evaluation of the probability mass distribution of the number of secondary infections produced by a selected individual was rstly introduced by Ross (2011) and, in an independent way, by Artalejo and Lopez-Herrero (2013). Both papers consider nite SIS and SIR compartmental models and present probabilities of the o spring distribution as the solution of systems of linear equations. Their results generalize the study of the infection transmission from the instant of the invasion to any stage of the disease progression and show that, for populations of moderate size, the basic reproduction number can overestimate the potential transmission of the epidemic process. The analysis of the transmission of an epidemic process has been ex- tended to epidemic models with vector-borne infections (Artalejo 2014), 2016), latency periods (Lopez- Herrero competition (G\u0013 omez-Corral and L\u0013 opez-Garc\u0013 \u0010a 2015). Our results will reveal the in uence of the vaccine, coverage and e ective- ness, and the reintroduction parameter on the transmission potential of the10 M Gamboa, MJ Lopez-Herrero disease. Hence, in the subsequent sections we proceed with theoretical discus- sions leading to probabilistic results. 3.1 The exact transmission variable Re0 In this section we study the potential transmission of an infective process by studying the random variable Re0, de ned as the number of infective individ- uals that arise from contagions caused directly by the index case, that is, the rst individual in the population able to spread the disease. The objective is to characterize the distribution of the random variable Re0and to observe the in uence of the initial group of vaccinated individuals (i.e., vaccine coverage) on the transmission. This analysis is directly related to the infectious period of the index case. During this period, the underlying Markov chain Xevolves inbS, the subset of states showing at least one infectious individual. For practical purposes bS will be partitioned in levels, according to the current number of vaccinated individuals, as follows: bS=v0S v=0bL(v) =v0S v=0f(v;i) : 1\u0014i\u0014N\u0000vg: First, we introduce appropriate notations for the generating and probability mass functions, and for the factorial moments of Re0conditioned to rest we will develop algorithmic schemes for deter- mining'v;i(z),xk v;iand the moments mk v;i. Firstly, we mark the index case. The homogeneous mixing assumption guarantees all-to-all interactions with no preferences in relationship among individuals. Therefore, individuals are all the same and we split transitions in Table 2, associated to contagions, by distinguishing whether or not a new infection comes from the index case. That is, we partition contagion rates in the following way \u0012 stochastic SIS with imperfect vaccine 11 Then, for (v;i)2bS, we de ne new (5) A rst-step argument, conditioning on the possible transitions out of a xed state (v;i)2bS, shows that generating functions 'v;i(z) satisfy the following set of linear function, de ned as 1 when i=j, and 0 otherwise. Equation (6) is the basis to get the mass function of the conditional random variableRe0j(V(0) =v;I(0) =i) by numerical inversion, which can be done with the help of a Fast Fourier Transform ( FFT ) algorithm (Tijms 2003). As mass functions will be obtained through a direct recursive scheme, we do not go further on this point and we proceed to get factorial moments mk v;i, for k\u00151: By di erentiating equation (6) with respect to zrepeatedlyktimes (k\u00151) and evaluating at z= 1, we obtain the equations involving factorial (2)-(5), we can write a useful and simpli- ed version equation (8) provides conditional moments of order kbased on conditional moments of one order less. Moreover, at any level 0 \u0014v\u0014v0, the system of equations described in (8), for 1\u0014i\u0014N\u0000vandk\u00150, can be written in matrix form as and vectors involved in (9)-(10) are de ned below. For 0\u0014v\u0014v0,evis an all-ones vector of dimension ( N\u0000v) and Avwill denote the integer k;factorial moments are recursively determined with the help of the algorithmic scheme shown in Algorithm 1. Remark 1 Notice that the random variable Re0measures the exact number of secondary infective individuals arising directly from the index case and, in contradistinction with R0orRcthat are de ned at the time of the in- vasion,Re0can be checked at all times. If we set t= 0 for the time at which the invasion starts the initial situation is V(0) =v0andI(0) = 1, andRe0=E[Re0jV(0) =v0;I(0) = 1] provides the exact amount of expected disease transmission, considering vaccine characteristics such as coverage and e ectiveness.Infection transmission in a stochastic SIS with imperfect vaccine 13 Algorithm 1 Re0factorial moments 1a. 0\u0014v\u0014v0;setm0 Step 2. go to 2c. Step 3. Set j=j+ 1:Ifj\u0014k;go to Step 2a. Let us proceed to the analytic derivation of the probabilities xk v;ithat the index case will originate k\u00150 new infections, given that the current situation is (v;i)2bS:A new appeal to the rst-step methodology, by observing transitions out of the state ( v;i), provides the following set (11) for states in L(v) can be written in matrix form in the as de ned in the lines following equations (9)-(10). The remaining algebraic structures appearing in matrix expressions (12) are described next: vectors (v;i)2bS, because bSis a nite union of disjoint nite sets, amd in a nite population the number of infective individuals arising from contagions caused by the index case is necessarily nite. Consequently,P1 k=0xk v;i= 1, for (v;i)2bS. For every number k\u00150 the equations in (12) are solved recursively with the help of Algorithm 2. In order to determine mass dis- tribution functions, a stopping criteria should be provided to avoid longer computation runs. In fact, numerical results appearing in Section 4 come from applying both recursive Algorithms 1 and 2. More speci cally, those results dealing with Re0-distributions for a given initial coverage value, v0, are ob- tained from iterating Algorithm 2 until 95% of the values of the distribution of (Re0jV(0) =v0;I(0) = 1) is accumulated. Algorithm 2 Re0probabilities For a xed integer k\u00150, the set of conditional probabilities xk v;i, for (v;i)2bS, can be computed according to the following scheme: Step 1. Set v= 0. Step 1a. Set 0. 2. 1. Ifv0= 0, stop. Step 2a. 1. Ifv\u0014v0, go to step 2a. 3.2 The population transmission variable Another measure of the expansion of a contagious disease is Rp, which provides the global spread of the disease by counting all the infections that take place within the population, no matter who is the infectious spreader, before the rst recovery occurs. Rpis a random variable that can be analyzed either at the beginning of the outbreak or at any later time, by updating the population situation in terms of the current state of the CTMC X. The aim of this section is to describe the probabilistic behavior of Rpand to study the in uence of the model parameters on global infection transmission. In particular, we are interested in comparing Rc, the control reproduction number of this model, with the expected value Rp=E[Rpj(V(0) =v0; I(0) = 1)] for di erent scenarios. First, we derive theoretical results involving the probability distribution and factorial moments of Rp. As in the preceding section, the central tool forInfection transmission in a stochastic SIS with imperfect vaccine 15 our results will be the rst-step methodology. But to avoid repetitive argu- ments we provide results in a comprehensive manner, leaving out unnecessary details. Let v;i(z) be the generating function of Rp, given that the current state ofXis (v;i)2bS, with factorial moments Mk v;ifork\u00151 (M0 v;i= 1). At any pointz;withjzj\u00141, generating functions are the solution of the following tridiagonal set of linear equations: v;i(z) states ( v;i)2bSare the solution of a system of linear equations, arising from (13) as usual by taking derivatives with respect tozfollowed by an evaluation for z= 1, that is expressed in matrix the random variable Rp, conditioned to any state (v;i)2bS, can be obtained by inverting transforms with the help of the recur- sive equations (13) and an FFT algorithm. But, as it was stated in the pre- ceding section, it is possible to nd a set of equations whose solution provides directly the point mass function of v;i=P(fRp=kjV(0) we iinfected indi- viduals in the population, then the number of secondary cases taking place be- fore the rst recovery is at most N\u0000i. So, for any integer k, with 0\u0014k\u0014N\u00001; zk v;i= 0, whenever i>N\u0000k. Next, we introduce appropriate v, with 0\u0014v\u0014v0; Rppoint probabilities come from the following where DQandd are a diagonal matrix and a vector, with respective entries qv;iand i, for 1\u0014i\u0014N\u0000v. As in Section 3.1, Rpfactorial moments and probabilities can be computed from recursive schemes based on equations (14) and (15 - 16), respectively. Their algorithmic descriptions are similar to Algorithms 1 - 2 and are not stated in the text, but they are the basis for obtaining Rp's numerical results appearing in Section 4. Remark 2 In the paper by Artalejo and Lopez-Herrero (2014), the authors presented closed form expressions for probabilities dealing with the popula- tion transmission random variable in stochastic SIS and SIR models. For our SIV model, the mathematics is more involved due to the external transmis- sion parameter and, unfortunately, it is not possible to derive general closed expressions for conditional probabilities zk v;i. However, after some algebra we obtained the closed values of point probabilities in a few speci c situations. in a stochastic SIS with imperfect vaccine 17 4 Numerical illustrations This section illustrates theoretical and algorithmic results derived in previous sections. We x the recovery rate as = 1:0 in all the experiments, so the time unit is taken as to be the expected time that an infected individual takes to recover to become susceptible again. In the rst scenario, we consider a population of N= 100 individuals, 20% of which is partially protected against the infection by a vaccine with e ectiveness of 97%. We are interested in the random variable Re0, that is the number of secondary infections produced by the index case. Hence, the initial number of infective individuals is I(0) =i0= 1: 0 1 2 3 4 5 6 7 8 9 10 11 1200.050.10.150.20.25 =0.01 =0.1 =1.0 =2.0 Fig. 100, = 10:0 andh= 0:03 Figures 5 and 6 represent histograms for the distribution of Re0when we vary external or internal contact rates, respectively. Heights indicate the value of the probabilities xk 20;1=P(fRe0=kjV(0) = 20;I(0) = 1g) and colors ap- pearing in both gures are depicted for a better distinction among considered situations. In more detail, Figure 5 shows mass functions of Re0when the exter- nal transmission rate \u0018is 0:01;0:1;1:0 and 2:0, for a xed internal transmission rate = 10:0. For each rate \u0018, mean values of Re0are 4:2035;3:7601;2:5342 and 2:0592, respectively. Moreover, distributions present a strictly positive mode that occurs with a probability that decreases for increasing values of the external rate. This remark is according to the intuition because for a xed internal contact transmission rate , when the external transmission rate in-18 M Gamboa, MJ Lopez-Herrero creases the index case has less opportunities to spread the disease compared with outsider infection sources. 0 1 2 3 4 5 6 7 8 9 10 11 1200.10.20.30.40.50.6 = 1.0 = 5.0 =10.0 Fig. 6Re0distribution of , whenN= 100,\u0018= 0:01 andh= 0:03 Figure 6 displays mass functions corresponding to = 1:0;5:0 and 10:0, for an external transmission rate \u0018= 0:01. We get decreasing shape functions for = 1:0 or = 5:0 and the chance that the index case produces no secondary infections is 55% and 20%, respectively. However, for = 10:0, the Re0distribution is bimodal, with an 11.2% chance that the index case recovers before spreading the infection. In general terms, long internal transmission rates contribute a higher number of secondary cases. Next we focus on the e ect of the vaccine coverage on the expansion of the infection. Figure 7 shows the probability that the index case produces two or more secondary cases of infection, as a function of the external rate . This quantity can give an idea of what is, for a given infective process, the chance of invading a susceptible-vaccinated population. Each curve corresponds to a di erent initial vaccine coverage. The remaining parameters of the model are N= 100,\u0018= 0:01, and the vaccine is e\u000ecient in 97% of the vaccinated indi- viduals. Probability increases with , no matter how large the initial coverage v0is. For a xed external transmission rate, the chance of having at least two infections increases when initial coverage decreases. In particular for a small population of 100 individuals a ected by a hard measles outbreak, with R0= = = 18:0, numerical results evince that a massive vaccination policy with two doses of MMR vaccine (measles, mumps, rubella) guarantees that the probability of having two or more measles infections from the index caseInfection transmission in a stochastic SIS with imperfect vaccine 19 is 0.12, while in an unprotected population ( v0= 0) this probability grows up to 0.9. 0 5 10 15 2000.10.20.30.40.50.60.70.80.91 Fig. 7P(fRe0>1jV(0) =v0;I(0) = 1g) as a function internal transmission rate whenN= 100,\u0018= 0:01 andh= 0:03 Now we deal with the expected number of secondary cases produced by the index case since their introduction in a population where individuals are either susceptible or vaccinated. We observe the in uence of the model parameters , \u0018,handv0on the expected value of Re0. Results correspond to a population ofN= 100 individuals. Figures 8-10 are contour graphs for Re0=E[Re0jV(0) =v0;I(0) = 1], arising when we combine the in uence of two parameters of the model. Dif- ferent colors represent di erent values for Re0, as it is indicated by the color code given in each of the Figures. Figure 8 shows the in uence on Re0of the internal and external transmis- sion rates, when 20% of the population has received a vaccine which is e ective among 97% of the vaccinated individuals. The average of secondary infections, produced by the index case, increases with the internal transmission rate and it decreases when \u0018increases, which is in agreement with the comment for Figure 5. These behaviors are more noticeable for large transmission intensities. Figure 9 displays Re0as a function of the internal transmission rate, , and the potential risk of vaccine failure, h. We assume in addition that 20% of the20 M Gamboa, MJ Lopez-Herrero population is vaccinated and that the rate of external transmission is \u0018= 0:01. The expected number of infections caused directly by the index case increases with . In the early spread of the epidemic, the in uence of the vaccine failure risk is relatively small for outbreaks showing internal rates smaller than 6 compared to those with higher values for . 2 4 6 8 10 120.20.40.60.811.21.41.61.82 0.511.522.533.54 Fig. 8Re0as a function of and\u0018whenN= 100,h= 0:03 andv0= 20 Finally, the contour graph shown in Figure 10 presents the relationship of the internal transmission and vaccine coverage on Re0. The additional param- eters for vaccine e ectiveness. An increase of vaccine coverage produces a decrease on the initial spread of the infection. For instance, administration of two doses of MMR vaccine is 97% e ective against rubella (basic reproduction R0\u00196). So, assuming that R0= = , re- sults in Figure 10 show that the index case transmits an infection like rubella to an average of 3.5 people in an unprotected population, and to less than one person when a massive vaccination policy was launched in the population. To achieve that the infection will not propagate in the population, that is Re0<1, higher immunization coverage is needed as increases.Infection transmission in a stochastic SIS with imperfect vaccine 21 h 2 4 6 8 10 120.050.10.150.20.250.30.350.40.450.5 11.522.533.544.5 Fig. 9Re0as a function of andhwhenN= 100,\u0018= 4 6 0:03 The boxplot appearing in Figure 11 corresponds to the distribution of the number of secondary infections produced by the index case. The box encloses the middle central part of the distribution, lower and upper edges of the box22 M Gamboa, MJ Lopez-Herrero correspond to the lower and upper quartile, respectively, and the line drawn across the box indicates the median of the distribution; nally, whiskers above and below the box cover 95% of the distribution. The objective is to com- pare the patterns of the epidemic when we increase the vaccination coverage, in a population of N= 100 individuals, assuming that a 97%-e ective vac- cine is available to control an epidemic process with internal and external transmission rates = 10:0 and\u0018= 0:1, respectively. This choice for model parameters corresponds to an infection by varicella-zoster virus (VZV) and the administration of varicella vaccine that is 97% e ective in the rst year after vaccination. A low vaccine coverage leads to a large number of secondary infections. In general terms, the number of secondary cases produced by the index case decreases when v0increases. Notice that changes on the number of secondary infections are not signi cant while the vaccination coverage is under 25. This fact shows the importance of the random variable Re0to x an appropriate vaccination level. 0 10 25 50 75 90 95 990246810 v0Re0 Fig. 11 Boxplot for Re0under several vaccine N= 100, = 10:0, \u0018= 0:1 andh= 0:03 Next we present some results relative to the global spread of the disease. In Figure 12, we compare Rc,Re0andRpwhen the internal transmission rate varies over the interval (0 ;20:0). As in previous scenarios, the recovery rate is = 1:0. Vaccine coverage reaches half of the population and presents an e ectiveness of 97%. We compare results for populations of N= 100 and 1000 individuals, with external transmission rate \u0018= 1=N. For our parameter se- lectionR0= andRc=R0(1\u0000(1\u0000h)=2) = 0:515 . Hence, as a function of , the control reproduction number corresponds to the top line in FigureInfection transmission in a stochastic SIS with imperfect vaccine 23 12. We notice that di erences between RcandRe0increase with increasing transmission rates. When = 20:0, we ndRc= andRe0= 4:36 show the overes- timation of the number of secondary cases of infection produced by the index case, as provided by Rc, and how the expected exact reproduction number Re0corrects the e ect of the linearization hypothesis commonly assumed in the deterministic literature. Regarding the expected population transmission, Rp, we conclude that it converges to the control reproduction number as the population size increases. In fact, for N= 1000 di erences between RcandRp are smaller than 0 :4 when 2(0;20:0). Hence, the line for Rpis graphically indistinguishable from Rcand it is not plotted for N= 1000. 0 2 4 6 8 10 12 14 16 18 20024681012 Fig. 12 Comparing Rc,Re0andRpversus the internal transmission rate when \u0018= 1=N, h= 0:03 andv0=N=2 Finally, Table 3 shows the minimal vaccination coverage needed to inter- rupt epidemic transmission; that is, in order to get values smaller than one for the expected number of secondary cases coming from the index case. Notice that if the expected transmission (either from the whole set of infectious or limited to the index case) is less than 1, each infected individual transmits the disease to less than one person, which means that not every case will re- sult in a new individual infection and epidemic transmission will cease. We display results for a population of N= 1000 individuals, where the external transmission rate is taken as \u0018= 1=Nand the internal rate is assumed to be at least 1. We compare two scenarios by considering that the e ective- ness of a vaccine is either 97% or 90%. Values represented by vcgive the herd-immunity threshold based on the control reproduction number Rc(i.e., starting from R0= = , coverage is chosen vc=N > (R0\u00001)=(R0(1\u0000h)) in order thatRc<1 ). Additionally, ve0andvpare minimal critical levels that guarantee that expected values Re0andRp, respectively, are less than one.24 M Gamboa, MJ Lopez-Herrero Numerical values come from an iterative application of Algorithm 1 for Re0 and its variant for Rp, by raising initial coverage until expected values ful ll the required condition. Any dash symbol in Table 3 means that even a 100% vaccine coverage does not guarantee that the expected number of secondary cases (measured in terms of Rc,Re0orRp) are less than one. Note that, as Rp includes also secondary cases arising from external infectious individuals, the minimal critical level vppresents higher values, at a xed transmission rate , when it is compared with vcorve0. On the other hand, when the internal transmission rate increases, higher immunization coverage is needed to keep the expansion of the epidemic under control. Table 3 Minimum level of vaccination with parameters N= 1000 and \u0018= 445 1:5344 341 556 370 368 695 2 515 513 645 556 554 808 3 687 750 741 739 873 809 833 832 915 5 825 823 848 889 888 944 6 859 858 875 926 925 966 7 884 882 896 952 952 982 8 902 902 911 972 972 996 9 916 915 923 988 988\u0000 10 928 927 933\u0000\u0000\u0000 11 937 936 942\u0000\u0000\u0000 12 945 944 949\u0000\u0000\u0000 5 Conclusions This paper studies infectious disease dynamics in a stochastic framework, where a Markov chain is used to model disease transmission. The continu- ous time Markov chain models changes in the state of the process de ned as the number of individuals that are susceptible, infected or vaccinated. Assum- ing that susceptible and vaccinated individuals (due to vaccine failures) can get the infection through both internal and external contacts makes the model more realistic than those with only internal contacts. Deterministic models are very useful in understanding the dynamics of infectious diseases and estimating important epidemiological descriptors as, for instance, the basic reproduction number. In this context, populations are relatively large, and the e ect of depletion of susceptibles is minor but leads to reproductive numbers that overestimate the transmission potential of the disease. Our research involves a pair of random variables, Re0andRp, as alternative measures of the control reproduction number Rc. The stochasticInfection transmission in a stochastic SIS with imperfect vaccine 25 Markovian framework allows us to identify the e ective event leading to a new contagion. Consequently, we exclude repeated contacts established between the index case and already infected individuals, thus correcting for the e ect of the linearization assumption commonly assumed in the deterministic frame- work and which produces the overestimation of the reproductive potential of a disease. Concerning speed, our numerical algorithms provide results depending strongly on the population size and the other parameters of the model. For in- stance, the derivation of Re0through Algorithm 1 involves factorial moments m1 v;iof (N\u0000v0=2)(v0+ 1) transient states, which for the particular choice ofN= 1000 and v0=N=2 implies 375 ;750 such states and requires 118 sec CPU time, in a personal computer of 2.31GHz and 6GB RAM. Numerical results regarding vaccination coverage levels should be seen as a rst approach to investigate optimal policies for controlling the spread of an infectious disease. The aim for future research is to develop health policies based on time horizons and warning levels related to the remaining vaccinated individuals. This research can be generalized to di erent models for imperfect vaccine response by considering vaccines that reduce the probability of infection or that confer protection that wanes over time (see, for instance, Ball et al. 2008, Ball and Sirl 2018). Additionally, more sophisticated models could be treated by introducing population structures such as households, and also by includ- ing assumptions concerning to epidemics showing latent infectious periods or lifetime immunity after recovery. References 1. Aguiar M, Martins J, Pinto A, Stollenwerk epidemiological models. Acta 58:381-389. https://doi.org/10.1007/s10441-010-9116-7 2. Alexander Summers R, Gumel AB, Sahai BM (2004) A vaccination model for transmission dynamics of in uenza. SIAM J Appl Dyn Summers AR (2006) Modelling the ef- fect of a booster vaccination on disease epidemiology. J Math Biol 52:290-306. https://doi.org/10.1007/s00285-005-0356-0 4. Almaraz SIR-models with Markov-modulated events: Length of an outbreak, total size of the epidemic and number of secondary infections. AIMS 23:2153-2176 https://doi.org/10.3934/dcdsb.2018229 5. Almaraz E, G\u0013 omez-Corral A, Rodr\u0013 \u0010guez-Bernal On the time to reach a crit- ical number of infections in epidemic models with infective and susceptible immigrants. Biosystems 144:68-77. https://doi.org/10.1016/j.biosystems.2016.04.007 6. Amador J (2016) The SEIQS stochastic epidemic model with external source of infection. Appl Math Model 40:8352-8365. http://dx.doi.org/10.1016/j.apm.2016.04.023 7. Anderson M, Stochastic epidemics in dynamic pop- Arino J, McCluskey CC, van den Driessche P (2003) Global results for an epidemic model with vaccination that exhibits backward bifurcation. SIAM J Appl Math 64:260276. https://epubs.siam.org/doi/abs/10.1137/S003613990241382926 M Gamboa, MJ Lopez-Herrero 9. Arino J, Sun C, Yan W (2010) Global analysis for a general epidemiological model with vaccination and varying population. J Math Anal Appl 372:208223. https://doi.org/10.1016/j.jmaa.2010.07.017 10. Artalejo JR (2014) On the Markovian approach for modeling the dynamics of nosocomial 62:15-34. https://doi.org/10.1007/s10441-013-9204-6 11. Artalejo JR, Lopez-Herrero MJ (2013) On the exact measure of disease spread in stochastic epidemic models. Bull Math Biol New be- havioral indicators of the disease spreading. Appl Math Model 38:4371-4387. https://doi.org/10.1016/j.apm.2014.02.017 13. Ball F, Knock ES, O'Neill PD (2008) Control of emerging infectious dis- eases using responsive imperfect vaccination and isolation. Math Biosci 216:100-113. https://doi.org/10.1016/j.mbs.2008.08.008 14. Ball F, O'Neill PD, Pike J (2007) Stochastic epidemic models in structured pop- ulations featuring dynamic vaccination and isolation. J Appl Probab 44:571-585. https://doi.org/10.1239/jap/1189717530 15. Ball F, Sirl D (2013) Acquaintance vaccination in an epidemic on a ran- dom graph with speci ed degree distribution. J Appl Probab 50:1147-1168. https://doi.org/10.1239/jap/1389370105 16. Ball F, Sirl D (2018) Evaluation of vaccination strategies for SIR epidemics on random networks incorporating household structure. J Math Biol 76: 483-530. https://doi.org/10.1007/s00285-017-1139-0 17. Cheng Y, Pan Q, He M (2015) Psychological and behavioral e ects in epidemiologi- cal model with imperfect vaccination compartment. Math Meth Appl Sci 38:4729-4740. https://doi.org/10.1002/mma.3387 18. Demicheli V, Rivetti C (2012) Vaccines for measles, mumps and rubella in 19. Eckalbar JC, Eckalbar WL (2015) Dynamics of an SIR model with vaccination de- pendent on past prevalence with high-order Mech Appl 421:78-97. https://doi.org/10.1016/j.physa.2014.10.054 21. Golub GH and van Loan CF (1996) Matrix Computations. John Hopkins University Press, Baltimore 22. G\u0013 omez-Corral A, L\u0013 opez-Garcia M (2015) Lifetime and reproduction of a marked individual in a two-species competition process. Appl with generally dis- tributed infectious periods: Number of secondary cases and probability of infection. Inter- nat J Biomath 10:1750024. https://doi.org/10.1142/S1793524517500243 24. Guo Y (2017) Stochastic regime switching SIS epidemic model with vaccination driven by L\u0013 evy noise. Adv Strain replacement in an epi- demic model with super-infection and perfect vaccination. Math Biosci 195:23-46. https://doi.org/10.1016/j.mbs.2005.01.004 26. Kermack WO, McKendrick AG (1927) Contribution to the mathematical theory of epidemics. Proc R Soc Ross JV (2008) On methods for studying stochastic disease dynamics. J R Soc Interface 5:171-181. https://doi.org/10.1098/rsif.2007.1106 28. Kretzschmar M, Welte R, van den Hoek A, Postma MJ (2001) Comparative model-based analysis of screening for trachomatis infections. Am J Epidemiol 153:90-101. https://doi.org/10.1093/aje/153.1.90 29. Kribs-Zaleta CM, Martcheva M (2002) Vaccination strategies and backward bi- furcation in an age-since-infection structured model. Math Biosci 177:317-332. https://doi.org/10.1016/S0025-5564(01)00099-2Infection transmission in a stochastic SIS with imperfect vaccine 27 30. Li W, Zhang Q (2019) Construction of positivity-preserving numerical method for stochastic SIVS epidemic model. Adv Di erence Equ 219:25. https://doi.org/10.1186/s13662-019-1966-y 31. Lin Y, Jiang D, Wang S (2014) Stationary distribution of a stochas- tic SIS epidemic model with vaccination. Physica A 394:187-197. https://doi.org/10.1016/j.physa.2013.10.006 32. Liu Q, Jiang D, Shi N, Hayat T, Alsaedi A (2018) The threshold of a stochastic SIS epidemic model with imperfect vaccination. Math Computers in Simulation 144:78-90. https://doi.org/10.1016/j.matcom.2017.06.004 33. L\u0013 opez-Garc\u0013 \u0010a M (2016) Stochastic descriptors in an SIR epidemic model for heterogeneous individuals in small networks. Math Biosci 271:42-61. https://doi.org/10.1016/j.mbs.2015.10.010 rate. Math Sci 40:2532-2541. https://doi.org/10.1002/mma.4179 35. Magpantay FM (2014) Epidemiological consequences of imperfect vaccines for immu- nizing infections. SIAM J Appl Math, 74:1810-1830. https://doi.org/10.1137/140956695 36. Marchette DJ, Wierman JC (2004) Modeling computer virus prevalence with a susceptible-infected-susceptible model with reintroduction. Comput Stat Data An 45:3-23. https://doi.org/10.1016/S0167-9473(03)00113-0 37. Moghadas SM (2004) Modelling the e ect of imperfect vaccines on disease epidemiology. Discrete Continuous Dyn Syst Ser B 4:999-1012. https://doi.org/10.3934/dcdsb.2004.4.999 38. Ross JV (2011) Invasion of infectious diseases in nite homogeneous populations. J Theor Biol 289:83-89. https://doi.org/10.1016/j.jtbi.2011.08.035 39. Safan M, Rihan FA (2014) Mathematical analysis of an SIS model with im- perfect vaccination and backward bifurcation. Math Comput Simulat 96:195-206. https://doi.org/10.1016/j.matcom.2011.07.007 40. Samanta GP (2015) Mathematical analysis of a Chlamydia epidemic model with pulse vaccination strategy. Acta Biotheor 63: 1-21. https://doi.org/10.1007/s10441-014-9234-8 41. Stone P, Wilkinson-Herbot H, (2007) A stochastic model for Math Biol 56:743-763. 42. First Course in Stochastic Models. Wiley, Chichester. 43. Xiao Y, Tang S (2010) Dynamics of infection with nonlinear incidence in a simple vaccination model. Nonlinear Anal Real World Appl 11:4154-4163. https://doi.org/10.1016/j.nonrwa.2010.05.002 44. Yang J, Martcheva M, Wang L (2015) Global threshold dynamics on an SIVS model with waning vacine-induced immunity "}