{"title": "PDF", "author": "PDF", "url": "https://eprints.nottingham.ac.uk/56483/1/JS_Thesis_Resubmission.pdf", "hostname": "PDF", "description": "PDF", "sitename": "PDF", "date": "PDF", "cleaned_text": "E. Stockdale Thesis submitted to The University of Nottingham for the degree of Doctor of Philosophy April 6, 2019Abstract Mathematical modelling has become a useful and commonly-used tool in the analysis of infectious disease dynamics. Understanding disease spread is of considerable importance for public health planning and the prevention of fu- ture outbreaks, and mathematical analysis of disease outbreaks offers insight which may not be so easily obtained through direct biological study. One key aspect, in mathematical analysis of infectious diseases specically, is that generally the epidemic process is only partially observed. We might be able to identify the time at which infective individuals become symptomatic or recover, but rarely are we able to observe when infection began, or from whom it was transmitted. This leads to a number of complications with analysis, which will be a focus of this work. The rst part of this thesis describes a full Bayesian analysis for such an out- break with only partial observation of the disease process. We will perform the rst Bayesian analysis of the Abakaliki smallpox data, which have been widely cited within the infectious disease modelling literature, to include the full data. In order to do this, we use data augmented Markov Chain Monte Carlo (DA-MCMC) techniques to perform parameter estimation. Analysis in- volves interpretation of these parameter estimates as well as model assessment with simulation-based methods. We also compare our results to a previous analysis which used an approximate likelihood expression. The second part of this thesis describes novel approximate likelihood methods, motivated in part by the results of the Abakaliki study. Although DA-MCMC iis generally considered the standard tool for analysis of partial epidemic data, it often struggles for large population sizes and large amounts of missing data, both through issues of highly correlated missing data and of potentially lim- iting computation times. We suggest that likelihood approximation methods are a useful tool for dealing with these issues. We develop a series of such methods, which essentially assume some independence in the outbreak pop- ulation in order to obtain likelihood expressions which do not depend on any missing data. These methods will be motivated and developed, and then il- lustrated both by simulation study and by application to real data. List of Relevant Publications \u000fThe work contained in Chapter 2 is published in Stockdale et al. (2017). \u000fThe work contained in Chapters 3 and 4 is currently being prepared for submission to a peer-reviewed journal. Acknowledgements This PhD project was carried out under the supervision of Phil O'Neill and Theo Kypraios, whom I would like to thank for all of their help. This work was supported by the UK Engineering and Physical Sciences Research Council, grant number EP/M506588/1. iiContents List of Figures viii List of Tables xviii 1 Introduction 1 1.1 . . full conditional distributions 261 B Appendix for PBLA: likelihood calculations for gamma infectious pe- of Figures 1.1 Typical disease timeline for an SEIR model with 2 stage infec- tious period. Times \" e\", \"i\" and \" r\" refer to the start of the in- dividual's exposed (infected, but not yet infectious), infective (able to infect others) and removed (plays no further part in the outbreak) periods, structure of the population of Abakaliki as used in this study. FTC = member of the Faith Tabernacle Church, n-FTC = not a member of the FTC. Numbers in brackets represent the num- ber of individuals within that category, after the move of four individuals on day 25 as detailed in Section in the smallpox model. The top image rep- resents the infection of an individual who is removed through recovery or death, and the bottom shows an infection of some- one who is quarantined. Isolation is only possible once quaran- tine measures have Tree diagram for protection status of individuals outside the compounds. Here inf = infected, n-inf 2.5 Posterior densities of the six parameters of interest and the basic reproduction number, from the Abakaliki outbreak data. Red lines represent Eichner and Dietz' MLEs. Shown are 100,000 samples densities of the reproduction numbers contained in Table 2.8, from the Abakaliki outbreak data. Shown are 100,000 samples from the model parameters, including Pearson's correlation coefcient for each pair and, on the diagonal, the posterior densities of map of the estimated exposure times of each infective, from estimated transmission pathway for the Abakaliki outbreak. Nodes represent infected individuals and the edge pointing to them represents the highest posterior probability among all pos- sible infectors. Individuals are clustered by compound. Note that individuals 7 and 8 moved from compound 1 to compound 2 during the the posterior probabilities of individuals hav- ing infected others in of the posterior estimates of 30 simu- lations for the Eichner and Dietz parameter values. Red lines represent the true values used simulations. . . . . . . . means of the posterior estimates of 30 simula- tions for modied la=0.4. Red lines represent the true posterior estimates of 30 simula- tions for modied tq=150 and lf=0.2. Red lines represent the true values 2.14 Posterior densities of the six parameters of interest and R0, when different mean durations of the infectious periods are used. . . 85 2.15 Posterior densities of the six parameters of interest and R0, when the time taken to quarantine an infective, the parameter estimates to sim- ulate outbreaks, a histogram displaying the nal size of each, compared to the comparison of nal size between all 5000 simulations and the subset of simulations where an individual who moves com- pound is infected during their move. The dashed line represents the mean nal size of all simulations, the dotted line represents the mean nal size of only those outbreaks where an infected in- dividual moves compound, and the solid black line represents the the parameter estimates to sim- ulate outbreaks, a histogram displaying the duration from the rst rash time to the last of each, compared to the observed epidemic duration between all 5000 simula- tions and only those simulations where an individual who moves compound is infected before the move. The dashed line repre- sents the mean duration of all simulations, the dotted line rep- resents the mean duration of only those outbreaks where an infected individual moved compound and the solid black line represents the observed 1000 simulated outbreaks, a scatterplot of nal size against the duration of the epidemic. The black point provides the val- ues from The cumulative number of smallpox cases observed by each day is shown, for 4000 outbreaks of size 32 only. The black curve shows the incidence curve for the true Abakaliki outbreak. . . . 94 Timeline showing how total infectious pressure Tis built up, under scaled approxima- tion, where r= (1, 2,x)and xvaries. This demonstrates the impact on estimation of equal removal times. N=10 in all cases. 163 4.1 To compare the impact of varying bandg, these gures show densities of MLEs from both the ED and PBLA III approxima- tion methods with exponential infectious periods. Data are from 1000 simulations with N=100 and true values b=3,g=2 in the rst plot and impact of varying N, these gures show den- sities of MLEs from both the ED and PBLA III approximation methods with exponential infectious periods. Data are from 500 simulations with N=500 and 1000 simulations with N=40, respectively, where in both the true values are b=1.5,g=1. . 184 xiLIST OF FIGURES 4.3 To compare the impact of varying R0, these gures show den- sities of MLEs from both the ED and PBLA III approximation methods with exponential infectious periods. Data are from 500 simulations with N=500, and true values b=1.5,g=1 in the rst plot and b=0.5,g=1 in the second. This leads to R0 values of 1.5 and compare the impact of varying R0, these gures show densities of MLEs from both the ED and PBLA III approxima- tion methods with exponential infectious periods. Data are from 200 simulations with N=500 and N=1000, respectively, as well as true values b=3,g=1 in the rst plot and b=2, g=1 in the second. This leads to R0values of 3 and 2. . . . . . 187 4.5 To compare R0estimation, these gures show densities of MLEs from both the ED and PBLA III approximation methods with ex- ponential infectious periods. Data are from, respectively, 1000 simulations with N=100, b=1.5 and g=1, and 200 simula- tions with N=500, the impact of varying bandg, these gures show densities of MLEs from both the ED and PBLA III methods with gamma infectious periods. Data are from 1000 simulations with N=50 and shape m=2 in all cases, where the true values areb=12 and g=10,b=1.2 and impact of varying N, these gures show den- sities of MLEs from both the ED and PBLA III methods with gamma infectious periods. Data are from 1000 simulations with shape m=2,b=1.2 and g=1. In the upper plots N=15 and FIGURES 4.8 To compare the impact of varying N, these gures show den- sities of MLEs from both the ED and PBLA III methods with gamma infectious periods. Data are from 500 simulations with shape m=2,b=1.2 and g=1. In the upper plots N=250 and the bias in estimating parameters bandgas Nvaries, for both the PBLA and ED methods. Shown are esti- mated values with shape parameter mequal to 2 and 8, where in all cases 1000 outbreaks were squared error in estimating pa- rameters bandgasNvaries, for both the PBLA and ED meth- ods. Shown are estimated values with shape parameter mequal to 2 and 8, where in all cases 1000 outbreaks were simulated. . . 195 4.11 To compare the impact of varying m, these gures show den- sities of MLEs from both the ED and PBLA III methods with gamma infectious periods. Data are from 1000 simulations with N=50 and b=2. In the upper plots the true values are m=g=1, in the middle plots m=g=2 and in varying m, these gures show den- sities of MLEs from both the ED and PBLA III methods with gamma infectious periods. Data are from 1000 simulations with N=50 and b=2. In the upper plots the true values are m=g=5, in the middle plots m=g=8 and in the bias in estimating parameters bandgas m=gvaries, for both the PBLA and ED methods. Shown are estimated values with R0xed to 1.6 and 4, N=80, and where in all cases 1000 outbreaks the mean squared error in estimating pa- rameters bandgasm=gvaries, for both the PBLA and ED methods. Shown are estimated values with R0xed to 1.6 and 4,N=80, and where in all cases 1000 outbreaks were simulated. 201 4.15 To compare the impact of varying R0, these gures show den- sities of MLEs from both the ED and PBLA III methods with gamma infectious periods. Data are from 1000 simulations with N=80 and shape m=5. In the upper plots the true values areb=0.16 and g=1, and in the lower plots b=0.31 and g=1. This leads to R0values of 0.8 and 1.55, respectively, with the average number of infectives in these simulations being R0, these gures show den- sities of MLEs from both the ED and PBLA III methods with gamma infectious periods. Data are from 1000 simulations with N=80 and shape m=5. In the upper plots the true values are b=0.8 and g=1, and in the lower b=1.5 and g=1. This leads to R0values of 4 and 7.5, respectively, with the average number of infectives in these simulations being 78 and 80. . . . 203 4.17 To compare the these gures show den- sities of MLEs for 1000 simulations over a range of population sizes with exponentially distributed infectious periods, where b=1.5 and g=1. Note: PBLA II curve is these gures show den- sities of MLEs for 1000 simulations with gamma distributed in- fectious periods. Respectively, true b=1.2,g=1 and N=100, andb=1.2,g=1,N=500. In both plots, m=2. Note: PBLA II, III PBLA versions, these gures show den- sities of MLEs for 1000 simulations with gamma distributed in- fectious periods. Respectively, true b=1,g=5,m=8 and N=15, and b=0.8,g=1,N=100 this gure shows den- sities of MLEs for 1000 simulations with gamma distributed fectious periods, where b=2,g=1,m=2 and N=100. per second of bandg, ob- tained from PBLA MCMC and DA-MCMC for population size Nand xed shape parameter m=1. Note: the lines are for visualisation purposes, only Nvalues at the marked effective sample size per second of bandg, ob- tained from PBLA MCMC and DA-MCMC for population size Nand xed shape parameter m=2. Note: the lines are for visualisation purposes, only Nvalues at the marked effective sample size per second of bandg, ob- tained from PBLA MCMC and DA-MCMC for population size Nand xed shape parameter m=5. Note: the lines are for visualisation purposes, only Nvalues at the marked Da Cunha data using the PBLA III approximation method. Dotted lines represent the mean estimates using DA-MCMC from Hayakawa kunder the PBLA log-likelihood, using the full CDC data. Red lines display the corresponding MLEs using PBLA log-likelihood, us- ing the full CDC data. Black points indicate the corresponding MLEs using overlaid with equiv- alent estimations from the Althaus simulation method, with er- ror bars displaying the assumed variability. Dashed lines show the end of the Althaus data. Red lines display the PBLA log-likelihood, using the Althaus data. Black points indicate the Cumbrian and surrounding farms in- cluded in the 2001 Foot and Mouth disease dataset. Red points represents infected farms and green points represent those that were not All param- not being proled are xed to their PBLA MLEs. Dotted lines mark the MLE for the parameter in question, and green lines provide posterior mean estimates from Kypraios (2007). . 249 xviLIST OF FIGURES 4.32 Trace plots of MCMC samples for the six FMD model param- eters, both from PBLA MCMC (red) and DA-MCMC (green). DA-MCMC samples were not provided in Kypraios (2007), but were obtained from the author. Red horizontal lines mark the PBLA MCMC posterior mean and green horizontal the FMD data using MCMC samples, for six randomly selected pairs of farms (i,j). Red bars are PBLA MCMC samples, and green are from DA-MCMC. . Histograms of gfor the FMD data using MCMC samples, for six randomly selected pairs of farms (i,j). Red bars are PBLA MCMC samples, 2.1 Smallpox cases in Abakaliki during 1967, from Thompson and Foege (1968). Compounds are listed after the move of cases 7 and 8 and two non-infectives, on day 25 from compound 1 to 2. 41 2.2 Composition of the compounds affected by smallpox in Abaka- liki, Nigeria during 1967, from Eichner and . . . . 42 2.3 Durations of periods in the infection process for Abakaliki small- pox outbreak. Time until quarantine determined by the maxi- mum of rash time and time quarantine Possible combinations of twelve individuals, labelled 183, 213, 214, 215, 217, 231, 232, 233, 234, 236, 237, 250, with kfrom infective j. Here, w2f1, ..., 9gis any one of the affected compounds, and wcdenotes any affected compound other than w. In addition, N = size of the population, n= number of FTC individuals in the population (note this change in denition of nfor this chapter alone) and nc,fj(t)= number of individuals in the same com- pound and of the same faith as individual jat time t. Note: If jis in the fever stage, pressure is multiplied by the infectivity 95% credible intervals for the Abakaliki smallpox outbreak from the true likelihood ap- proach, alongside the results of Eichner and Dietz (2003) for comparison. 100,000 MCMC equal-tailed 95% credible intervals for various reproduction numbers, where 100,000 MCMC samples are used. RQis the reproduction number for once quarantine measures are introduced. Rxis the reproduction number corre- sponding to the infection rate lx, where x=a,forh, and RQx is equivalent, but once quarantine measures are in place. . . . . 76 2.9 Simulation study results. 30 simulations per set of parameter values were created, and MCMC run on this simulated data. We provide the mean estimate of the 30 posterior mean values and a 95% probability interval, where 100,000 study results for a single large outbreak of nal size 734. We provide the mean estimate over a single MCMC run of length 10,000, and the equal-tailed 95% credible interval. . . . . of 4000 simulated outbreaks from posterior esti- mates, and the Abakaliki data over a range of criteria. * This value is calculated considering only outbreaks where at least one of the individuals who moves compound is infected by the time of their notation for the likelihood approxima- tion methods, as used in chapters the PBLA methods and associated assump- tions explored in Chapter 3. All PBLA versions follow the initial approximation of independence over rate band removal rate gfor 12 simu- lated data sets using standard DA-MCMC, the ED approxima- tion and PBLA, for an SIR For the 12 simulated data sets in Table 4.1, this table includes the estimates of R0using standard DA-MCMC, the ED approx- imation . . . . . 178 4.3 Estimates of infection rate band removal rate gfor 12 simu- lated data sets using standard DA-MCMC, the ED approxima- tion and PBLA, for an SIR model with exponential infectious periods. Shape For the 12 simulated data sets in Table 4.3, this table includes the estimates of R0using standard DA-MCMC, the ED approx- imation and PBLA with per second obtained from DA-MCMC and PBLA MCMC, for a range of population sizes N. Values sband sgare the variances of the Gaussian proposals used for bandg. 213 4.6 Removal data from the 1967 respiratory disease outbreak on Tristan Da Cunha (from Hayakawa et al. (2003), and originally Becker and Hopper (1983)). Age groups dened as: infants aged 0-4, children aged 5-14, and and above. . . . . . . 219 4.7 Gamma prior distributions for the infection parameters in the Tristan Da Cunha outbreak, as in Hayakawa et al. (2003). . . . . 221 xxLIST OF TABLES 4.8 Mean parameter estimates for the the Tristan Da Cunha data us- ing PBLA with MCMC concerning deaths in the West African Ebola epi- demic of 2014, adapted from the Centers for Disease Control and Prevention (Accessed 2018-03-11). Details of the adaptation of the data are given the West African Ebola outbreak, using the full CDC data with the Althaus deaths in the West African Ebola epi- demic of 2014, adapted from Althaus (2014) though originally from the CDC. Details of the data adaptation are given in for the West African Ebola outbreak. The t0estimates from the Althaus method were used for FMD data analysis. For each param- eter, we use a gamma distributed prior with shape parameter m and FMD data model parameters us- ing the PBLA likelihood, compared with DA-MCMC posterior means from Kypraios (2007). NOTE: the b0estimate was not provided in Kypraios (2007), but was obtained from the author. 248 xxiCHAPTER 1 Introduction In this thesis, we will explore different aspects of Bayesian analysis for in- fectious disease data. Bayesian methods are of particular use for epidemic modelling since data are typically only partially observed. Data Augmented Markov Chain Monte Carlo (DA-MCMC) is currently the standard computa- tional Bayesian method employed, and this will be the focus of the rst part of this thesis in an application to a much-cited data set concerning a smallpox outbreak. The second part of this thesis will then introduce novel approximate likelihood methods for Bayesian inference. These are motivated by a number of computational problems of DA-MCMC. A series of such likelihood meth- ods will be described, as well as applied to various simulated and real data sets. First, this introduction will provide relevant background material. We begin with a discussion of the history of infectious disease data analysis, and the use of stochastic models for this. We dene important aspects of the data and models which are used, and describe current computational methods. We par- ticularly consider methods which involve approximation, since this will be the focus of much of this thesis. 1CHAPTER 1: INTRODUCTION 1.1 Mathematical Infectious Disease Modelling 1.1.1 Background Mathematical models have seen increasing popularity as tools for furthering the understanding of infectious disease epidemiology. Often, experimental study on the spread of disease in humans and animals is ethically difcult and resource intensive, but mathematical models offer an alternative in seeking to replicate the underlying factors driving disease dynamics, to allow estima- tion of parameters which, for example, govern disease transmission. Models aim to describe transmission of disease between hosts by incorporating con- tact patterns and a realistic representation of the disease itself (e.g. lengths of infectious periods, latent periods and so on). Predictions may then be made about key parameters such as infection rates or vaccine efcacies. In fact, the aims of analysis may largely be categorised into three main areas: furthering understanding of the mechanisms by which diseases spread, predicting future spread, and discovery of the methods which best control this (Daley and Gani, 2001). Development of vaccination strategies, health care interventions, and public health initiatives may all be informed by this mathematical research. The development of mathematical theories on the spread of infectious diseases can be traced back to at least the ancient Greeks, although real progress was arguably only made from the 19th century with the discovery of the connec- tion of microorganisms to disease. This laid the foundations for the develop- ment of more rigorous mathematical descriptions of disease outbreaks. Al- though there had been previous studies such as the famed Broad Street Pump study of 1854/5, in which a contaminated water pump was identied as the source of a cholera outbreak in London (see e.g. Newsom, 2006), these had been largely empirical rather than theoretical. In the last century, however, the eld has seen great advancement, driven both by development of mathemati- cal theory and increasing computational resources. From the development of individual-based, deterministic models where outbreak progression depends 2CHAPTER 1: INTRODUCTION specically on the numbers of susceptible and infectious individuals, to the introduction of stochastic models which incorporate probabilities of events oc- curring, development has been rapid. In Kermack and McKendrick (1927), the rst complete, deterministic mathematical model to receive attention was in- troduced, named the general epidemic model , with its stochastic counterpart in McKendrick (1926), though this received less attention. Previously, these kinds of models were generally only used within mathematical theory, but since the 1990s or so there has been an increased interest in the eld by more applied sci- entists as well as public health ofcials and policy makers. Central texts which further describe the history of the eld as well as key methods and applica- tions include Bailey (1975), Becker (1989), Anderson and May (1991) and An- dersson and Britton (2000). Today, with increasing volumes of data driven by increasing computational power, there is growing demand on mathematical models which capture more complex populations, as well as methods which can translate these into real-world conclusions. 1.1.2 Stochastic Models The set of models for analysis of infectious disease is often split into determin- istic and stochastic. Deterministic models are usually dened through a set of ordinary (or partial) differential equations, which seek to describe the flow of individuals between different disease stages over time. Stochastic models, although often less straightforward to analyse, are generally considered more realistic than their deterministic counterparts. In capturing the variability of real-life events, they represent the natural stochasticity of disease outbreaks. The use of stochastic models has allowed for considerable development in in- fectious disease analysis. From the 1930s, when the idea of using binomial distributions to represent successive crops of new cases was introduced (de- scribed in Bailey, 1975), there has been an increase in their use. They are es- pecially useful when the number of individuals in the population is small, since in these cases the innate randomness of the processes involved is more 3CHAPTER 1: INTRODUCTION pronounced and hence deterministic models less well describe the epidemic spread. Models are generally constructed on an individual-based level, where we consider individual units (humans, animals, or even groups of individu- als) within some population. The total population might refer to a household, a city, or a country, for example. One model which has received signicant attention (although it was never published) was proposed by Reed and Frost. This is a discrete time chain- binomial model, in which outbreaks are described as evolving in generations where each infected individual infects each susceptible individual indepen- dently, with a xed probability p. The individuals infected by those in some generation gthen form generation g+1, and those in gare assumed to re- cover. The number of infectives in each generation is therefore binomially dis- tributed, with probability dependent upon the number of infectives present in the previous generation, and the entire outbreak is described by a chain of such binomial random variables. A more detailed description of the Reed-Frost model can be found in Andersson and Britton (2000), Section 1.2 or Abbey (1952). The so-called general stochastic model for an epidemic process was then formulated by Bartlett (1949). This was the rst work to dene a stochas- tic model using Markovian processes, and most stochastic models since have been dened as such, in either discrete or continuous time. From this point on, we will restrict our attention to stochastic rather than deterministic mod- els, since these are the focus of this work. 1.1.2.1 SIR and SEIR Stochastic Epidemic Models Models used for analysis of infectious diseases generally include some kind of state of health of the individuals concerned. These are commonly known as compartmental models, since they categorise individuals into a discrete set of disease states. The standard terminology is to dene all individuals who are currently able to become infected by the disease as ' susceptible ', all currently infectious (i.e. able 4CHAPTER 1: INTRODUCTION to pass the disease on to others) individuals as ' infective ' and all individuals who are no longer infectious but are also not able to contract the disease again as 'removed '. This removed state might correspond to a number of causes: death, removal from the population, recovery and immunity from reinfection, or perhaps recovery with the timescale of the outbreak too short for reinfec- tion to reasonably occur. These states may be combined to form what is called an SIR (susceptible-infective-removed) model, though there are others which may be considered and are often applied. For example, if we also introduce a 'latent ' or ' exposed ' period before the infectious period, wherein individuals are infected but not yet able to infect others, we may use an SEIR (susceptible- exposed-infective-removed) model. If we do not wish to include a removal period, but instead to allow all recovered individuals to become immediately infected again, we may use an SIS (susceptible-infective-susceptible) model. In this thesis, however, we will largely focus on SIR and SEIR models, and extensions thereof. Figure 1.1 depicts a typical timeline for the stages of a disease that an indi- vidual might pass through. The model used here is an extension of the SEIR model, which we will see more of in Chapter 2, where we have split the in- fectious period into two parts according to whether the individual is symp- tomatic or asymptomatic. These periods might be categorised by differing infection rates. Of course, compartmental models may be dened with any compartments desired, but we consider here those which are frequently seen in practice. We will discuss different types of infectious disease data further in Section 1.2, but typically outbreak data contain the removal times only (or, say, case detec- tion times treated as removal times). The length of each individual's infectious period, and the latent period if we include this, are then assumed random and independent of other individuals. In general, these lengths of time are as- sumed to be random samples from distributions with known parameters. Transmission of the disease is modelled as being the result of infectious con- 5CHAPTER 1: INTRODUCTION Figure 1.1: Typical disease timeline for an SEIR model with 2 stage infectious period. Times \" e\", \"i\" and \" r\" refer to the start of the individual's exposed (infected, but not yet infectious), infective (able to infect others) and removed (plays no further part in the outbreak) peri- ods, respectively. tacts . Infectious individuals in the population are assumed to have contacts with others at some dened rate, where a contact is dened as an interaction close enough for an infection to occur. In reality, this contact may refer to a physical meeting of these individuals, but also a proxy for the infective dis- persing pathogens in their environment and the contacted individual making contact with this pathogenic material. Examples include using objects they have encountered, breathing in the same air, or, in hospital settings, medical staff being the intermediary link. An infectious contact with a susceptible is normally assumed to result in the susceptible's immediate infection. We now more rigorously dene the SIR model, which may be extended to any compartmental model of choice. We rst dene a closed population of size N, which does not include any demographic changes (i.e. births or deaths). We assume, for now, that this population is homogeneously mixing (i.e. all individuals mix uniformly), so that the chance that any two individuals meet is independent of the choice of individuals. All individuals will at all times t\u00150 be in one of the three states: susceptible, infective and removed. The total numbers of individuals in these categories at any time tare given by S(t),I(t)and R(t), respectively, where for all t,S(t) +I(t) +R(t) = N. We assume external infection of the initial infective, so that initially S(0) =N\u00001, 6CHAPTER and R(0) =0. Any given infective individual will contact any other given individual at times given by the points in a homogeneous Poisson process of rate b, where all Pois- son processes are mutually independent. Any contact between an infective and a susceptible is assumed to result in immediate infection of the suscepti- ble. The length of any infective's infectious period xis assumed independent of all others, and identically distributed with arbitrarily dened probability density (or mass) function fI(xjq), where qincludes the parameters control- ling the length of the infectious periods. The outbreak ends when there are no more infectives in the population. The general stochastic epidemic model for infectious periods following an expo- nential distribution with rate g(so that fI(xjq) =ge\u0000gx,x>0) ash!0 where the rst equation corresponds to an infection and the second to a re- moval. At time t, infections then occur at rate bS(t)I(t)and removals at rate gI(t). Under this model, the infectious periods are independent exponentially dis- tributed lengths of time with mean1 g. In this standard form of the model there are hence two parameters; the infection rate band the removal rate g. We will also often employ gamma distributed infectious periods within this the- sis, with meanm gfor shape parameter mand rate parameter g. Gamma (or Erlang, for integer valued m) distributions are frequently used since exponen- tially distributed infectious periods, although leading to convenient mathe- matical results, may be unrealistic in practice (see e.g. Lloyd, 2001, Streftaris and Gibson, 2004). 7CHAPTER 1: INTRODUCTION 1.1.2.2 Population Structures Although in Section 1.1.2.1 we assumed that all individuals mixed homoge- neously, in reality we often assume some heterogeneity in the mixing behaviour of individuals. The structure for the populations within which outbreaks oc- cur can have considerable impact on the behaviour of the model, and more complex choices of population structure are becoming more commonly used in practice to meet the demands of real data analyses. Models must be com- plex enough to accurately represent the dynamics of the real population, but simple enough to allow consideration of the impact of modelling assumptions on the outcomes, as well as not being over-parameterised. There are numerous options for population structures which have been ex- plored (see e.g. Britton et al., 2015 or Mollison, 1995). Global contact structures (or homogeneously mixing structures) as dened in Section 1.1.2.1 essentially assume no structure at all, and individuals within the population do not differ in their interactions, infectivity or in the average length of time spent infected. Although simple and comparatively easy to implement, this assumption is often unrealistic (especially in larger populations rather than smaller commu- nities e.g. households), and so a more detailed description of the population may be necessary. For this we require a heterogeneously mixing population model, within which we may dene a number of structure subcategories. A multi-type model would include a set of structured subgroups in the population, categorising for ex- ample by age, sex, or social grouping. Ball et al. (1997) dened a two level mixing household model, where individuals have local contacts within their household and global contacts between households. This was extended to three levels by Britton et al. (2011), who considered global, household and school/workplace contacts in the context of a measles outbreak. Network models, on the other hand, deal with a more complex structure of in- teraction between individuals. Considering each individual in the population 8CHAPTER 1: INTRODUCTION as a node, the contact rate between any two individuals is given by the weight of the edge between them. These have become widely applied, see e.g. Keel- ing and Eames (2005), Barth\u00e9lemy et al. (2005) and Newman (2002), as well as Britton and O'Neill (2002) who developed methods for inference. Denition of network models is difcult since any individual-based model may be repre- sented as a network of the individuals (for example, a homogeneously mixing population structure is just a completely connected network where the weight of all edges is equal). For simplicity, we will consider them here as any popula- tion structure where members vary individually in their infectivity or mixing behaviour, rather than by some structured grouping as in a multi-type model. Danon et al. (2011) provide a detailed discussion of many forms of network models for infectious diseases. One such example is a spatial model, whereby individuals' infectivity/mixing behaviour in some way depends on their 'dis- tance' from others. This could be geographically (for example the distance between individuals' area of residence, as in Chowell et al., 2007), or other- wise (for example the 'genetic distance' between individuals' DNA samples, as in Worby et al., 2016). 1.1.2.3 Reproduction Numbers Reproduction numbers play an important role in infectious disease analysis. Usually referred to as R, the exact denition of these varies but generally we dene, as in Becker (2015): R=the average number of infections that a single infective will cause. The name reproduction number comes from the fact that models for disease transmission may essentially be considered as birth-death processes, where an infection describes a 'birth' and a recovery describes a 'death'. Then Ris the mean number of 'offspring' produced by an infective. Although we may ob- tain an estimate of Rfor an entire outbreak, of course in reality Ris constantly changing with the number of susceptibles left in the population, and also po- 9CHAPTER 1: INTRODUCTION tentially with the reaction of the population to the outbreak. We hence dene the more interpretable, and more commonly used, basic reproduction number R0: R0=the average number of infections that a single infective will cause, in a large and entirely susceptible population. In the calculation of R0we therefore require that none of the population is immune, by vaccination or otherwise, and that all individuals are able to in- teract. Although this requirement of complete susceptibility makes R0less interpretable in its meaning for any given outbreak where this is not the case, it makes it much more comparable between different data sets and diseases. It offers a general measure of the overall infectivity of a disease. Other reproduction numbers may also be dened, and we will explore a num- ber of these in Chapter 2. We may, for example, dene a reproduction number during a particular section of the infectious period, or within a particular sub- group of the population. The exact formula for any reproduction number will of course depend on the model used for the infection and removal rates. In general, for stochastic mod- els we may dene R0=infection rate\u0002number of susceptibles \u0002 mean length of the infectious period , and for the Markovian SIR model dened in Section 1.1.2.1 above, R0=bN g. This is since each individual will be infectious for, on average, time1 g, and the average number of susceptibles infected per unit time is bN. A key interpretation of R0is in its relation to the epidemic spread as a thresh- old quantity. In an innitely large population, it is possible to show with prob- ability one that if R0\u00141 then the epidemic will die out (only a nite number 10CHAPTER 1: INTRODUCTION of individuals become infected). Correspondingly, a major outbreak in a large population is possible if and only if R0>1, by the threshold limit theorem (Andersson and Britton, 2000, Chapter 4). Estimating the value of R0from the model parameter estimates allows us to gain an understanding of how large a future outbreak could be. This is particularly useful in informing vaccination strategies, for example, since we can calculate the proportion of a population that would need to be vaccinated to prevent a widespread outbreak. For a more detailed discussion of this, and reproduction numbers in general, we direct the reader to Andersson and Britton (2000) or Heesterbeek and Dietz (1996), for example. 1.2 Data So far in this chapter we have focused on dening models for the spread of infectious disease, but of course in a statistical context we are also concerned with inference about the model parameters. This requires data from disease outbreaks, which we now discuss. Disease outbreak data are most commonly mathematically collected in a tem- poral form. These typically contain a time series of outbreak events, usually case detection times or removal times. This is often aggregated e.g. into daily or weekly data. Final size data are also common, consisting just of the initial number of susceptibles and which of these were eventually infected. How- ever, this thesis will not focus on nal size data, and from this point all data will be assumed temporal. There is frequently some extra information available as well: for example age, sex or location of residence of the individuals within the population. These may inform the population structure aspects of the model. Information on the vaccination of individuals may also be present, as will be particularly rel- evant in Chapter 2. This may be incorporated into the model to, for example, consider a proportion of the population effectively initially in the 'removed' 11CHAPTER 1: INTRODUCTION stage. Estimation of the efcacy of the vaccine given a particular outbreak may then be performed. Daley and Gani (2001), Chapter 7 and Anderson and May (1982) include a more detailed discussion of immunization, and particularly its relation to R0. Disease outbreak data are commonly only partially observed. This is since the transmission process itself is generally unobserved, for example most in- fectives are only identied at the moment they become symptomatic. Further than this, if the system is only observed at discrete intervals (e.g. weekly hos- pital tests or similar), then there will be a large amount of uncertainty as to exactly when outbreak events occurred. Missing data may also come in the form of unobserved cases, whether due to asymptomatic individuals, misdiagnosis, or under-reporting of cases. Popu- lation sizes may also include some element of uncertainty, either in the total number of people living in some particular area or in the proportion of this which is initially susceptible, due, for example, to prior immunity. We gen- erally assume that the population is closed for the duration of the outbreak, but this is course will not always be accurate (particularly for outbreaks which occur over longer lengths of time). Performing statistical analysis on only partially observed data often proves complicated, even with simple models. Missing data may lead to likelihood expressions which are analytically intractable. We will explore this further in Section 1.3.2. 1.3 Methods for Analysis The majority of methods for inference from stochastic models use likelihood expressions. As we have discussed in Section 1.2, many of these likelihoods will be intractable, due to a combination of partially observed data and the model used to describe them. 12CHAPTER 1: INTRODUCTION Tractable likelihoods do arise, usually as a result of simplifying assumptions such as xed length infectious periods. Inference is then possible using stan- dard techniques such as maximum likelihood estimation through numerical opti- mization of the likelihood function. Intractable likelihoods, on the other hand, may occur when infection times (or indeed any event times, though we state infection times for simplicity) are unobserved. The likelihood can then be con- sidered as the integral over all possible infection times of the likelihood ex- pression when augmented with the infection times. The high dimensional and often complex region of integration, however, is what leads to intractabil- ity, often analytically and numerically. There are a number of methods which have been explored for working with these likelihoods. Initial approaches for intractable likelihoods generally took a frequentist ap- proach. Martingale methods , as described in Becker (1989), may be applied to nal size and temporal data for both parametric and nonparametric inference. Martingales are random processes evolving over time, dened in part by the martingale property which requires the expected change of a martingale over time to be zero. A Martingale process hence must be unbiased, and will usu- ally arise from a counting process in an epidemic context. These count the occurrence of events happening randomly in time, where at each event the process increases by size one. In the context of infectious disease data, this could count the number of observed infections. From this representation of the disease process, maximum likelihood estimators may be obtained, as well as asymptotic results using properties of the Martingales. However, Martin- gale methods for incomplete data involve reconstruction of the infection pro- cess, which requires various approximations or simplifying assumptions (for example, homogeneous mixing structures). Data augmentation and MCMC offer an alternative in the same spirit, but avoiding the need for simplication (Kypraios, 2007 Section 2.1.8, Becker and Britton, 1999). Data augmentation techniques, as we will more rigorously dene in Section 1.3.4, have become more common when working with partially observed data. 13CHAPTER 1: INTRODUCTION These treat missing data as model parameters. The Expectation-Maximisation (EM) algorithm is one such technique, in which we create an articial 'com- plete' data set in order to perform maximum likelihood estimation with the EM algorithm (Becker, 1997, Dempster et al., 1977). Essentially, we dene some quantity Zwhich represents the complete data, i.e. a combination of observed data Xand unobserved event times Y. In an epidemic context, this might involve combining the observed removal times with the unknown in- fection times. The algorithm then uses iterative steps to move from an initial estimate of the model parameters q(0)to new estimate q(1)and so on, where each iteration increases the likelihood. An iteration is formed of two stages: E and M. The E-step (expectation) involves calculating the expectation of the log-likelihood function of the complete data, with respect to observed data Xand under current parameter estimates q(t). The M-step then determines q(t+1)by maximising this expectation, and the two-step process is repeated until convergence is achieved. As demonstrated in Becker (1997), the EM algorithm has been successfully used in applications including HIV/AIDS data. Here, transmissibility aspects of the disease are often ignored since the disease has a considerable incuba- tion period as well as multiple methods of transmission in practice. Simpler models capturing part of the case generation process then t well with the EM algorithm, due to their natural partial observation. However, in other epidemiological contexts where transmission models are required, the condi- tional expectation in the E-step will often be difcult to calculate. This is due to the interactions between infective and susceptible individuals, the number of which of course change with time. It has become more common to t models within a Bayesian framework, using for example MCMC methods, particularly combined with data augmentation. We will explore this fully in Section 1.3.3, but rst provide some necessary background on and Smith, 1994, Lee, 2012, Gelman et al., 2013) relies upon Bayes' Theorem to derive parameter estimates from a model given data. It is a widely-used statistical framework, with the benet that it provides a natural way of combining data with prior beliefs. The approach involves deriving a posterior probability from the combination of a likelihood function, which is the conditional distribution of the data given the parameters, and a prior probability, which represents our beliefs about these parameters before the data is taken into account. This posterior distribution p(qjX)is therefore the conditional distribution of the unknown parameters qgiven (1.3.1) denominator in the rst expression is a normalising constant, and the integral is a sum if qis discrete. This constant is typically analytically intractable, especially in high dimensional problems as are usual in infectious disease analysis. In order to make inference about q, we require this posterior distribution p(qjX) which is formed of the likelihood p(Xjq)and prior density p(q). The likeli- hood expression will depend on the choice of model, and the prior distribution must be chosen in advance depending on our beliefs about the parameters. Any choice of prior distribution may be used for Bayesian inference, but cer- tain choices have proved most popular. Conjugate priors , for example, are se- lected to be 'conjugate' to the likelihood, meaning the resulting posterior will be of the same family of distributions as the prior. This often leads to easier computation. If we have some existing knowledge about the parameters, we might use an informative prior which captures that. However, this prior infor- mation about the parameters may not always be available. In these cases we use a non-informative prior , which aims to contain as little information about 15CHAPTER 1: INTRODUCTION the parameters as possible. This results in the posterior being almost entirely informed by the data. Choice of prior can greatly impact the analysis, and so must be selected carefully. The posterior distribution obtained in Bayesian inference then contains all the information from the data, as well as our prior beliefs about the parameters. Inference may be performed from the posterior, in order to obtain estimates of the model parameters. 1.3.2 Inference with Missing Data As we have discussed, infectious disease data are frequently only partially ob- served. Event times are often unknown, and additionally there may be unre- ported cases. There is hence considerable importance in methods for inference which can handle missing data. If we dene the missing data as Y, then the pair (X,Y)form what is known as theaugmented data , which under any model will have a specied distribution dependent upon parameters q. In our Bayesian framework using Equation (1.3.1), the conditional distribution of the parameters given the observed data is given, up to proportionality, by: p(qjX)\u00b5p(q)Z Yp(X,Yjq)dY. (1.3.2) This essentially applies what was discussed in Section 1.3, in that we integrate over all possible values of missing data to obtain the posterior distribution. This integral, however, is usually not analytically or even numerically feasi- ble, particularly if the missing data is of high dimension. Sampling from this therefore usually requires other techniques, such as data augmented MCMC (see Section 1.3.4). First, however, we describe standard MCMC methods. 16CHAPTER 1: INTRODUCTION 1.3.3 Markov Chain Monte Carlo Methods The last three decades have seen an increasing use of Monte Carlo methods within infectious disease modelling, particularly Markov Chain Monte Carlo (MCMC) algorithms. The use of more realistic stochastic models, as we have discussed in Section 1.1.2, has led to challenges in inference from highly di- mensional and analytically intractable expressions. MCMC methods have proved a useful tool for dealing with these problems. First introduced for use in particle physics by Metropolis et al. (1953) but not utilised for Bayesian inference until Gelfand and Smith (1990), MCMC for use with epidemic models was rst introduced by O'Neill and Roberts (1999) and Gibson and Renshaw (1998). Since, it has become arguably the standard method for analysis. The literature on MCMC applied to epidemic models is too numerous to list in full, but includes Demiris and O'Neill (2005), who applied MCMC to a model with two levels of mixing, O'Neill and Becker (2001), who rst applied MCMC for non-Markovian infectious period models, and Neal and Roberts (2004), who performed MCMC for a model incorporat- ing a spatial component of the distance between households. MCMC, com- bined with data augmentation as we will discuss in Section 1.3.4, allows for inference of data where the epidemic has only been partially observed and as such would be too complicated for standard statistical techniques. Specically when infection times are unknown and so likelihood functions cannot be eas- ily computed, as is common, inference can be made about both the parameters of interest and the missing data themselves. More specically, MCMC methods allow us to draw samples from a given distribution p(which we call the target distribution), even if pcannot be written down analytically. Using the notation we dened in Section 1.3.1, the target distribution would be the posterior distribution p(qjX), and re- ferring back to Bayes' Theorem in Equation (1.3.1) we recall that the denomi- nator is the part which is typically intractable. However, this is simply a nor- malising constant, which an MCMC approach does not require to be calcu- 17CHAPTER 1: INTRODUCTION lated explicitly. Instead, samples are drawn from the posterior distribution by constructing an ergodic Markov chain fZngwhich has stationary distri- bution p(qjX)\u00b5p(q)p(Xjq). So long as we can calculate the likelihood and prior distribution, we can sample from the posterior distribution. After an initial 'burn-in' period (the early iterations of the MCMC algorithm which we discard), provided we have specied suitable mixing parameters, we can be condent that the chain has reached equilibrium (regardless of the starting location Z0). The steps of the Markov chain then approximate samples from the target (posterior) distribution. We will now describe some well-known algorithms for obtaining these samples from the posterior distribution. The Gibbs Sampler The Gibbs sampler (Geman and Geman, 1984) samples from high dimensional distributions by breaking them down into lower dimensional sections. If q= (q1,q2, . . . , qd)so that the . conditional distributions . A summary of the Gibbs algorithm is given in Algorithm 1. Although we often update parameters individually as in Algorithm 1, it is also possible to group related parameters together and perform block updates, using the full conditional distribution given all remaining parameters and the data. Blocking correlated parameters can improve convergence of the chain since correlation can lead to high rejection rates for individual updates. The sampler dened in Algorithm 1 is also known as a 'deterministic scan' Gibbs sampler, since we update all parameters deterministically in order. We can alternately use a 'random scan' Gibbs sampler which, at each iteration, picks at random one (or more) parameter(s) to update. 18CHAPTER 1: INTRODUCTION Algorithm 1 The Gibbs sampler, for obtaining Isamples from Algorithm The Metropolis algorithm was introduced in Metropolis et al. (1953), and gen- eralized to obtain the Metropolis-Hastings (MH) algorithm in Hastings (1970). Whereas the Gibbs sampler requires full conditional distributions to compute, the MH algorithm provides an alternative when this is not possible (as is common). Most MCMC algorithms can be considered as a special case of Metropolis-Hastings. Details of the procedure are given in Algorithm 2. The MH algorithm requires a choice of proposal density q. For each proposed value q\u0003, we calculate the acceptance probability a(q,q\u0003), which is the ratio of the likelihood multiplied by this proposal density, evaluated at the proposed parameter value and the current parameter value. This describes how likely the proposed value is compared to the current value, and we accept the pro- posal with probability a. The acceptance probability is dened in this way to ensure that the stationary distribution of the Markov chain is the target poste- rior distribution as desired, and also that the chain strikes a balance between tending to visit high probability areas but also satisfactorily exploring the pa- rameter space. The simplest choice of qis known as the independence sampler . In this, qis inde- 19CHAPTER 1: INTRODUCTION Metropolis-Hastings algorithm, for Setq(i)=q(i\u00001) end if end for . pendent of the current value of the parameters, so that q\u0000 q(i\u00001),q\u0003\u0001=q\u0000 q\u0003\u0001 . Alternatively, symmetric random walk Metropolis (as introduced in Metropolis et al., 1953) sets q\u0000 q(i\u00001),q\u0003\u0001=q\u0000 q\u0003,q(i\u00001)\u0001 , which causes the proposal den- sities in the acceptance ratio a\u0000 q(i\u00001),q\u0003\u0001 to cancel. This method has become particularly popular since, in avoiding calculation of the proposal density in the accept/reject ratio, many calculations are avoided. The choice of proposal density is key for the MH algorithm. The unrestricted choice of q(\u0001,\u0001)is what allows the algorithm its wide generality, but these different choices may have great impact on performance. A low acceptance probability may lead to poor mixing of the Markov chain, whereas a high ac- ceptance probability may lead to slow convergence. In reality, a balance must be achieved. Notably, Roberts et al. (1997) identied an asymptotically opti- mal acceptance rate of 0.234 for Gaussian random walk algorithms, so long as the target density consists of a product of i.i.d. components for each pa- rameter. Tuning of the parameters which control the proposal density can be 20CHAPTER 1: INTRODUCTION performed manually, but the development of adaptive algorithms which au- tomatically tune has also received much attention, for example Haario et al. (2014) and Andrieu and Thoms (2008). 1.3.3.3 Convergence and Dependency of the Markov Chain One important factor when using an MCMC algorithm is the speed at which convergence to the equilibrium occurs, in practice determining the length of the burn-in period. We would like to ensure that equilibrium has been reached by the end of the burn-in period, to minimise the effect of the initial values chosen on the samples obtained. However, with each calculation of the likeli- hood expression being potentially costly, there is often great benet in a shorter burn-in, and hence in ensuring fast convergence to the equilibrium. In addition to this, there will be some degree of dependence between succes- sive simulated values, with high dependence causing slow convergence also. The search for methods which allow for fast convergence and low sample de- pendence has received considerable attention. Non-centered parameterisations (NCPs) are one such technique which aims to improve the efciency of convergence. Full details and discussion can be found in Kypraios (2007) and Papaspiliopoulos et al. (2003). In essence, rather than the standard centered parameterisation (CP) of the unknown quantities q,Y, a non-centered parameterisation nds some alternative (q,Y)!(q,Y)where new missing data Yisa priori independent of q. There has been considerable discussion around the use of NCPs, and if their use really provides benet over standard CPs. Gelfand et al. (1996) argued strongly for the use of CPs, which can often be applied with fast Gibbs sam- plers when NCPs cannot, potentially undoing any computational advantage of a non-centered approach. However, as Kypraios (2007) argues, NCPs may offer considerable improvement in convergence in cases where the depen- dence between missing data and model parameters is high. One major issue 21CHAPTER 1: INTRODUCTION with the use of NCPs, however, is a requirement of orthogonality between q and Y, which is often hard to achieve (Papaspiliopoulos et al., 2003). This has limited their application in practice. In reality, the standard methods for achieving convergence and low depen- dence are somewhat crude. The length of the burn-in period is normally de- termined using trace plots of the parameter values from sample runs of the MCMC algorithm, either visually or using a diagnostic tool (e.g. Geweke, 1992). To minimise autocorrelation of MCMC samples (which is usually iden- tied with ACF plots), the general solution is to only keep every nthdraw from the posterior. Known as thinning, this lowers sample dependence, but at the cost of more (potentially expensive) computations of the likelihood to obtain the same number of samples (see Gilks et al., 1995). 1.3.4 Data Augmented Markov Chain Monte Carlo Data augmentation, as rst seen in Tanner and Wong (1987) but also in Gelfand and Smith (1990), involves sampling from the predictive distribution of the missing data to obtain samples from the posterior. It has become probably the most widely used technique for Bayesian inference in missing data prob- lems. In short, we assume knowledge of the missing data Yto obtain sam- ples of both it and the parameters of interest, rather than having to compute the (usually intractable) integral in Equation (1.3.2). As we have discussed in Section 1.3, methods such as the expectation-maximisation algorithm do ex- ist for dealing with missing data, and may be preferable in simpler cases, but data augmented MCMC (DA-MCMC) helps ensure identication of a global rather than a local maximum, as well as providing improved computation times when working in a high dimension. When modelling with missing data, target density p(qjX)is now the joint posterior distribution of the parameters and the missing data, p(q,YjX). By augmenting knowledge of the unknown data (usually event times for infec- 22CHAPTER 1: INTRODUCTION tious disease data), simulation from the conditional distributions p(qjY,X) andp(Yjq,X)is tractable, and we do not require integration over the missing data (as discussed previously in Section 1.3.2). To obtain samples from the new posterior density p(q,YjX), we may therefore use a two-component Gibbs sampler, as in Algorithm 1 but where we alternate simulations from p(qjY,X)for parameters qand from p(Yjq,X)for missing data Y. In reality, the full conditional distributions required for a Gibbs sampler are often not all available. In these cases, of particular use is the Metropolis within Gibbs algorithm (as suggested in Tierney, 1994), a hybrid of the MH algorithm and Gibbs sampler. In this, calculation of the full conditional distributions is replaced with direct simulation through a Metropolis-Hastings step. Although clearly useful when the conditional distributions are unavailable, the introduc- tion of Metropolis steps can greatly decrease the speed of convergence. How- ever, with augmented data we often have the case that p(qjY,X)is avail- able in closed form (and hence a simple Gibbs sampler may be used) but that p(Yjq,X)is not, and an MH algorithm is required. In this case Metropolis within Gibbs is very useful, since we may perform a combination of Gibbs and Metropolis within Gibbs. 1.3.5 DA-MCMC for SIR models Although we have discussed MCMC methods in general, in this section we more specically focus on MCMC for SIR epidemic models. We will dene the SIR likelihood expression which will be used throughout this thesis, as well as the general DA-MCMC algorithm used for inference. We dene the likelihood for an SIR model with homogeneous mixing as in Britton and O'Neill (2002), similar to e.g. O'Neill and Roberts (1999) and Gibson and Renshaw (1998). We assume a closed population of xed size Nwithin which occurs an outbreak of nal size n\u0014N, that is to say nin- 23CHAPTER 1: INTRODUCTION dividuals have been infected by the end of the outbreak. This version of the likelihood requires infected individuals to be labelled 1, 2, . . . , n, and associ- ated with their corresponding infection and removal times i.e. each infective jhas removal time rjand infection time ij. Individuals are ordered by re- moval time, so that r1\u0014r2\u0014\u0001\u0001\u0001\u0014 rn. We dene the removal . . , n, where r1\u0014r2\u0014\u0001\u0001\u0001\u0014 initial infective, who is assumed to have been infected by an external source. The identity of individual kis not usually known from the data. For ease of exposition of the likelihood dened below, we The likelihood is then written as a product of the contributions from each individual. A model with unlabelled cases (where both removal times and infection times are ordered, so that rjand ijdo not necessarily correspond to the same individual) was proposed by Bailey and Thomas (1971), but in this thesis we will only be concerned with labelled indi- viduals. The likelihood is built from three components which, as in Britton and O'Neill (2002), we refer to as L1,L2and L3. Firstly, the product term L1contains the contribution to the likelihood of the n\u00001 infections which occur during the outbreak (we ignore the contribution from the initial infective k, since they are assumed to have been externally infected). To dene this, we introduce the concept of infectious pressure , which suscep- tible individuals receive from current infectives. For an individual jwho is susceptible at time t, we dene bas the infectious pressure acting upon them from infective k, so that P\u0000 kinfects jin(t,t+dt]\u0001=bdt+o(dt). Then, any susceptible jreceives infectious pressure bat their time of infection from infected individual kif and only if ik<ij<rk. That is, if and only if kwas infectious at j's infection. L1is therefore given by the total infectious 24CHAPTER 1: INTRODUCTION pressure on each individual at their time of infection, of the infection part of the likelihood is given by L2, which con- tains the total infectious pressure exerted over the course of the epidemic. For each infective, this corresponds to them 'failing' to infect all other individuals, both those who ultimately become infected and those who remain susceptible. This is given by Here, rj^ik\u0000ij^ikrepresents the time period for which infective jplaces infectious pressure on any individual k. The contribution of the removal process is contained in L3. This is given by the probability density function (PDF) (or probability mass function, though for simplicity we will usually refer to just PDFs) of the infectious period dis- tribution, which in Section 1.1.2.1 we dened as fI(rj\u0000ijjq), for infectious periods rj\u0000ijof all infectives j. This construction of the likelihood allows for any choice of infectious period distribution fI(\u0001). The infectious periods are assumed independent, and therefore, j=1fI(rj\u0000ijjq). (1.3.5) Combining Equations infection times ihowever, this likelihood is in- tractable. Although theoretically possible, integrating out all of the unknown 25CHAPTER 1: INTRODUCTION infection times is unfeasible in practice for any more than a handful of infec- tives, since the region of integration becomes very complex. DA-MCMC is therefore usually implemented for inference of parameters bandq, where the augmented data correspond to the unknown infection times. Before we dene the MCMC algorithm, prior distributions need to be dened for the initial infective and their infection time, the infection rate band the in- fectious period parameters contained in q. For simplicity, we assume here that the infectious periods are exponentially distributed with rate g, so that qcon- tains this single parameter. As in O'Neill and Roberts (1999), we assume con- jugate gamma distributed prior distributions for bandg. IfG(s,n)represents a gamma distribution with shape sand rate n, we assume that bandghave conjugate gamma distributed prior distributions with parameters (sb,nb)and (sg,ng), respectively. For the initial infective k, we may choose from a variety of potential prior distributions. We may use some prior knowledge to determine their identity, or we may place a uniform prior distribution over all infectives so that each is equally likely to be the initial one. In practice, we often assume k=1 is known for simplicity. For ik, we dene a uniform prior distribution on (\u0000\u00a5,r1). We multiply the likelihood expression in Equation (1.3.6) by these prior distri- butions to obtain the posterior distribution: p(b,g,ik,ijr)\u00b5p(r,ijb,g,ik)p(b)p(g)p(k)p(ik) (1.3.7) This is then the target density of the MCMC algorithm. In order to perform Gibbs updates for band g, however, we also require their full conditional distributions. To obtain the full conditional distribution for b, we consider Equations (1.3.7) and (1.3.6), where B=\u00e5n j=1(rj\u0000ij), since the only terms the likelihood with gdepen- dence are the nexponential PDFs of the infectious periods in the removal part. Combining Equations (1.3.8) and (1.3.9) with the gamma conjugate prior distri- butions dened above, the full bandgare follows: bjg,k,ik,i,r\u0018G(sb+n\u00001,nb+A) gjb,k,ik,i,r\u0018G(sg+n,ng+B). (1.3.10) Overall, the basic DA-MCMC algorithm for an SIR model given removal data is given in Algorithm 3. Samples of the model parameters band gmay be obtained using Gibbs steps as the full conditional distributions are available, but the infection times must be updated with Metropolis Hastings steps since sampling directly from their posterior is not possible. For an individual jse- lected uniformly at random from 1, . . n, we propose candidate p(i,rjb,g,k,ik)q(i\u0003 jjij)\u0013 . A common choice for the proposal density is fI(\u0001jg), which causes the pro- posal densities in the acceptance probability to cancel. After the infection times have been updated, we set kaccordingly, as the individual with the earliest current infection time. The likelihood and MCMC algorithm may be similarly extended to SEIR and other compartmental models, as well as heterogeneous mixing models. Although the technique has been widely adopted, there are a number of limi- tations to data augmented MCMC techniques for epidemic data analyses. Es- pecially with growing demand for fast (potentially real-time) analysis, com- putationally efcient analysis is key. However, DA-MCMC methods for epi- demic data often struggle with the issues of high dependence and slow chain 27CHAPTER 1: INTRODUCTION Algorithm 3 DA-MCMC algorithm for obtaining Jsamples of the model pa- rameters, for an SIR model with known removal times, unknown infection times, infection rate band infectious period parameter g. Here, xjrepresents thejth sample of parameter x. 1. Start the Markov chain from initial values b0,g0,i0,k0,i0 k; 2. forj=1toJdo i. Update busing a Gibbs step to draw from p(bjgj\u00001,kj\u00001,ij\u00001 k,ij\u00001,r) and obtain sample bj; i. Update gusing a Gibbs step to draw from p(gjbj,kj\u00001,ij\u00001 k,ij\u00001,r)and obtain sample gj; iii. Choose uniformly at random one or more infection times ik, for k= 1, . . . , n(including the initial infective). Update each using a Metropolis Hastings step to obtain ij/ij k. Update kcorrespondingly as required; end for . convergence discussed in Section 1.3.3.3, particularly for large outbreaks or complex model structures. This will be explored in more detail in Chapter 3, but essentially the unknown infection times and the parameters governing the infectious period lengths often have a high posterior correlation, leading to slow mixing of the Markov chain. This motivates the development of alternate methods which either solve, or avoid, these problems. 1.4 Approximation Methods for Infectious Disease Modelling Without any restrictions, of course an ideal mathematical model would be a complete virtual representation of the real world. However, due to limita- tions in computational power this is of course not possible, and efforts must be made to obtain the best possible partial description of reality. All mathematical 28CHAPTER 1: INTRODUCTION models contain some degree of simplication and approximation, and when introducing greater complexity we must consider the computational cost. Current methods for infectious disease analysis such as DA-MCMC, as we have discussed, are known to become computationally demanding for large population sizes or complex mixing structures. When working with large amounts of data it often becomes necessary to use very simplistic models due to computational restraints, especially when performing time-sensitive analy- ses. We suggest that likelihood approximation methods may be a useful tool for dealing with this, and these will be the focus of chapters 3 and 4. If we can obtain likelihood expressions which, although including extra levels of approximation to the 'true' likelihoods used in data augmentation, result in faster computation, this allows for more realistic models to be used in turn. This is not an area in which there has been much previous work. As we will explore more fully in Chapter 3, the likelihood approximation methods we will dene in this thesis bear some similarity to composite likelihood methods (see Varin et al., 2011 and Cox and Read, 2004), in that we attempt to build our understanding of the overall system dynamics by considering what are essen- tially marginal densities, but in reality these methods are actually quite differ- ent. Otherwise, attempts to tackle the challenges we have discussed largely focus on ideas other than direct likelihood approximation. 1.4.1 Model Approximation Model approximation is an area which has seen some focus. This involves consideration of an approximation to the model, under which the likelihood can be directly computed. One such simple approximation is the assumption of xed length infectious periods. Under this assumption, all of the unknown infection times can be directly determined from the data, and the likelihood expression becomes tractable. Inference may then be performed using stan- dard techniques for a completely observed outbreak (see e.g. Andersson and 29CHAPTER 1: INTRODUCTION Britton, 2000, Section 9). Model approximation was also performed in Britton and Becker (2000), where they dened a two-level mixing model incorporating within-household local transmission and between-household global transmission. Non-independence of individuals residing in different households results in an intractable likeli- hood, but in replacing the global transmission dynamics with a xed proba- bility that each individual avoids infection from the global source (originally seen in Addy et al., 1991), Britton and Becker (2000) obtain a model with a tractable likelihood. A further example is Filipe and Gibson (1998), who dened a spatio-temporal stochastic model for disease transmission by modelling individuals as the ver- tices of a square lattice (so that all individuals have four nearest neighbours with whom to interact, except those on the boundary who have two or three). They made the assumptions that the lattice was large enough that the bound- ary effects could be ignored, and that the initial distribution of infected indi- viduals was from a spatially stationary process. This allowed them to make a deterministic approximation to the stochastic model, expressing the over- all disease dynamics in terms of smaller cluster approximations. Cauchemez and Ferguson (2008), on the other hand, approximated a continuous-time SIR model by dividing the outbreak into a series of observation periods, and aug- menting the data with the latent state of the system (i.e. the total number of infectives and susceptibles) at the beginning of each period. They then mimicked the SIR process with a diffusion process with known exact solution. Becker (1989) also includes numerous examples of simplied models used in practice. As we have seen here, a variety of model approximation methods have been suggested in the literature, but often these have been only applied to a specic data set or model and hence lack general applicability. In contrast, we will ex- plore likelihood approximation methods in this work. These will share similar themes with some of these model approximations, in making assumptions to 30CHAPTER 1: INTRODUCTION result in a tractable likelihood and especially in using small clusters to build up overall disease dynamics, but they will not require any simplications of the actual models used. 1.4.2 Approximate Bayesian Computation (ABC) One other considerable area of research has been Approximate Bayesian Com- putation, or ABC. Rather than approximating either the likelihood or model, ABC is what is known as a likelihood-free method. It was initially proposed in Rubin (1984), and then grew in popularity within the population genetics literature from Tavar\u00e9 et al. (1997). It has since become much more widely ap- plied within, for example, ecology, systems biology and evolutionary biology (e.g. Toni et al., 2009 and Csill\u00e9ry et al., 2010), as well as infectious disease modelling (e.g. McKinley et al., 2009, Tanaka et al., 2006 and Blum and Tran, 2010). Its use in this eld relies upon the fact that stochastic models for disease outbreaks are generally straightforward to simulate, and that this can be done very quickly for a given set of model parameters. In its basic form, ABC is essentially a form of rejection algorithm. However, a benet is that it can easily be incorporated into MCMC and Sequential Monte Carlo (SMC) algorithms. It is of particular use for likelihoods which are com- putationally intractable or of a high cost to evaluate, since it replaces likelihood calculations with comparisons between observed and simulated data. We re- view ABC methods and their implementation here, but a more detailed discus- sion on their use with stochastic epidemic models may be found in Kypraios et al. (2017). Ifqcontains the parameters to be estimated (for a disease outbreak we might have q= (b,g)where bis the infection rate and gthe removal rate), as dened in Section 1.3.1, we wish to approximate the posterior distribution p(qjX), for data X. Rather than explicitly calculating likelihood p(Xjq), ABC methods take the general steps: 31CHAPTER 1: INTRODUCTION 1. Sample a candidate q\u0003from the prior distribution p(q) 2. Simulate a data set (outbreak) X\u0003from the model with parameters q\u0003. 3. Compare simulated data set X\u0003with observed data Xusing some dis- tance measure d. Ifd(X\u0003,X)\u0014efor tolerance e, we accept q\u0003. (1.4.1) This process repeats until we have accepted a pre-determined number of q\u0003 values. The result is a sample of parameters drawn from p(qjd(X\u0003,X)\u0014e), which for suitable dand sufciently small eshould well approximate p(qjX). ABC then requires no calculations of the likelihood. We simply require a choice of distance function dwhich measures the similarity between two out- breaks, and a tolerance ewhich denes how close this distance must be to be accepted. In practice, this choice of dis by no means trivial, however. Of- ten we instead measure the distance between some summary statistics of the data, such that we require d(S(X\u0003),S(X))\u0014e. For infectious disease data, this might measure the difference in the removal curves via a sum of squared dif- ferences between the observed and simulated data, for example, as in McKin- ley et al. (2009). ABC is frequently combined with MCMC and SMC since the rejection algo- rithm in (1.4.1) often suffers from very low acceptance rates. In ABC-MCMC, a Markov chain is generated with stationary distribution p(qjd(X\u0003,X)\u0014e), so that parameters are usually sampled from the vicinity of their current values. This may suffer from similar problems to DA-MCMC however: that correlated parameters may cause slow convergence of the Markov chain. ABC with SMC, as initially introduced in Sisson et al. (2007), seeks to avoid these convergence problems. Sequential Monte Carlo methods involve sam- pling from a series of proxy distributions which converge to the posterior, rather than the posterior itself. We and p1>p2>\u0001\u0001\u0001>pN. We 32CHAPTER 1: INTRODUCTION then initially draw a large number of samples, called particles, from p1(which has been dened such that direct sampling is possible). The particles are then passed through a series of sequential importance sampling steps iwhich in- volve being weighted assuming they come from the corresponding sequen- tial distribution pi. The general idea is that the intermediary distributions pitend gradually towards the target distribution, so the method proceeds by moving and weighting the particles by how well they t each successive distribution pi. For ABC-SMC, these distributions piare principle, avoid the algorithm getting stuck in areas of low proba- bility, decreasing the time to convergence. Certain choices of distance function dand tolerance ecan cause particle degradation, however, wherein after the particles have been passed through some of the intermediary distributions, only a few remain with non-zero weight. To combat this, a resampling stage is often introduced. In this, particles are resampled proportionately to their weight when degradation becomes high. Overall, ABC and ABC-SMC methods are useful for epidemic models since they are widely applicable and may be used with models involving complex populations (see e.g. Brooks-Pollock et al., 2014 who used a spatial stochastic model for bovine tuberculosis, incorporating within-farm and between-farm transmission). However, they can still result in algorithms which are inef- cient or slow, especially when the number of parameters to estimate is large. Choice of tolerance eand distance function dcan have considerable impact on the results found, and use of a summary statistic Salso introduces additional bias into the method through loss of information. These must therefore be carefully selected. For further reading, Sunn\u00e5ker et al. (2013) discuss many of the perceived drawbacks of ABC methods. 33CHAPTER 1: INTRODUCTION 1.5 Structure of the Thesis The remainder of this thesis is divided into two distinct parts. The rst part, published in Stockdale et al. (2017), concerns a Bayesian analysis of the Abaka- liki smallpox data. This data set has been much cited in the eld of stochastic epidemic modelling, but never analysed in its full form using a true likelihood method. We seek to compare parameter estimates from our Bayesian analysis to estimates from Eichner and Dietz (2003), who did analyse the full data set but using an approximate likelihood. This will be presented as follows: \u000fChapter 2 . After introducing the Abakaliki smallpox data, we dene the model to be used in our analysis. This is a variant of an SEIR model, and is the same as that used in Eichner and Dietz (2003) to ensure compara- bility. We outline the process for simulating from this model, since model assessment will be performed via simulation-based techniques. We also describe the Bayesian inference to be performed, and dene the likeli- hood expression. We then detail the MCMC algorithm to be used, before concluding with the results of the analysis, and a discussion of these. The second part of this thesis will focus on the development of likelihood ap- proximation methods for the analysis of infectious disease data. As we have briefly discussed and will further explore in Chapter 3, current methods, such as the data augmented MCMC performed in Chapter 2, become computation- ally cumbersome for large populations or large amounts of missing data, as well as being burdened by correlation problems of this missing data. We seek to develop likelihood approximation methods which remove the need for data augmentation, allowing simpler MCMC or maximum likelihood estimation to be performed more easily. \u000fChapter 3 . This chapter will describe the development of two different likelihood approximation methods. Firstly, we introduce a generalised approximation based upon the method of Eichner and Dietz (2003) from 34CHAPTER 1: INTRODUCTION Chapter 2. We will then proceed to construct a new approximation; the Pair Based Likelihood Approximation (PBLA) method. We will dene a number of different versions of this, for example for offering increased computational speed under more restrictive modelling assumptions. \u000fChapter 4 . The nal chapter will involve a series of simulation studies, which compare parameter estimation using the likelihood approxima- tion methods to standard DA-MCMC, followed by application to vari- ous real data sets. Specically, we consider data from a respiratory dis- ease outbreak on the Atlantic island of Tristan Da Cunha, from the West African Ebola epidemic of 2013-2016 and from the 2001 UK Foot and Mouth disease outbreak. These data sets will each have different require- ments in terms of modelling, allowing us to analyse the performance of the PBLA method in different settings. We will nally summarize the work presented in this thesis, in addition to possible areas of further research, in Chapter 5. 35CHAPTER 2 Modelling and Bayesian Inference for the Abakaliki Smallpox Data In this chapter we introduce the much-cited Abakaliki smallpox data set, and perform its rst full Bayesian analysis to include all aspects of the data. This work is published in Stockdale et al. (2017). We begin with an overview of the data and its relevance within the eld of mathematical disease modelling, before dening the model and performing Bayesian inference to obtain estimates of model parameters. There exists one previous analysis of the full data set, but this relies upon an approximate like- lihood. We instead use Markov Chain Monte Carlo methods with the true likelihood, which avoid the need for likelihood approximations. In addition to the basic model parameters, which will be compared to the results of the approximation method as well as interpreted in their real-world context, we estimate the path of infection and perform model assessment with simulation based methods. 2.1 Introduction In 1967, an outbreak of Smallpox occurred in the Nigerian town of Abaka- liki. The vast majority of cases were members of the Faith Tabernacle Church 36CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA (FTC), a religious organisation whose members refused vaccination. The out- break was recorded in detail in a World Health Organisation (WHO) report by Thompson and Foege (1968), with information on not only the time series of case detections but also their place of dwelling, vaccination status, and FTC membership. The outbreak has inherent historical interest as it occurred dur- ing the WHO Smallpox eradication programme initiated in 1959. Although Smallpox was declared eradicated in 1979, it regained attention as a poten- tial bioterrorism weapon in the early 2000s (see e.g. Gani and Leach, 2001, Meltzer et al., 2001, Halloran et al., 2002) and continues to be of interest due to concerns about its re-emergence or synthesis, (see e.g. Henderson and Arita, 2014, Eto et al., 2015, World Health Organisation, 2015 and references therein). Estimates of the parameters governing disease transmission are of consider- able importance for public health planning, and thus being able to accurately obtain such quantities from available data is of considerable importance also. Within the mathematical infectious disease modelling literature, the Abakaliki smallpox data set has been frequently cited, the rst appearance being Bailey and Thomas (1971). The data set consists of a time series of symptom appear- ance (rash) times for the 32 individuals who were infected, along with other information on the composition of the population: FTC membership status, vaccination status and compound number (the affected individuals lived in a series of compounds; houses built around a central courtyard). Most anal- yses of the Abakaliki data, however, have used only the rash times, such as Shanmugan (2011) and Oh (2014), or indeed only the nal size, as in Ball et al. (2002). In fact, to our knowledge, in all but one case the data set has been used as an example for new methodology; taking primarily the case detec- tion times and not considering the other aspects of the data. Lau and Yip (2008), Huggins et al. (2004) and Yip (1989) used the data set to demonstrate Martingale-based methods for inference of the basic reproduction rate, the ini- tial number of susceptibles and the infection rate, respectively. O'Neill and Becker (2001), McKinley et al. (2014), Boys and Giles (2007) and Golightly et al. (2014) introduced new MCMC techniques which the Abakaliki data rash times 37CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA were used to illustrate. In addition to incomplete use of the data, the suitabil- ity of the data to the method at hand is often not considered: in many cases, such as Clancy and O'Neill (2008), Kypraios (2009), Xiang and Neal (2014) and Becker (1976), an SIR (susceptible-infective-removed) model has been used for this outbreak despite smallpox being known to have an incubation period (see Ferguson et al., 2003). Ray and Marzouk (2008) used binomial random graphs to model inter- and intra-compound contacts, thus including the compounds feature of the data, though they did not consider the difference between FTC and non-FTC individuals or make use of the vaccination data. In fact, all of the aforementioned papers only considered a population of size 120, which is the number of FTC individuals inside the compounds; disregarding all non-FTC individuals and FTC individuals outside the affected compounds. To our knowledge, the only paper which has analysed the full Abakaliki data set is Eichner and Dietz (2003). The authors use an individual-based stochastic transmission model which takes into account the natural disease progression of smallpox, as well as the introduction of control measures, the population structure and the vaccination statuses of individuals within it. Parameter es- timation is then performed via maximum likelihood. However, one notable feature of this analysis is that it relies on an approximate likelihood, which in particular assumes that the likelihood contributions made by different in- fected individuals are mutually independent. The true likelihood of the ob- served data given the model parameters is practically intractable as it involves integrating over all possible unobserved events, and so Eichner and Dietz per- form a back-calculation. This involves reconstructing the outbreak backwards (or forwards, in the case of removal times) from the data and assumed knowl- edge of the disease stages, for example the latent period or infectious period. This relies on approximation however, since calculations do not take into ac- count that infectious pressure may vary during an individual's disease stage as other individuals are infected or recover. Particularly used for HIV analysis in the 1990s, similar methods can be found in Becchetti et al. (1993) and Brook- meyer (1991). The use of this approximation immediately raises the question 38CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA of how well it performs, and in particular how different the parameter esti- mates might be if the analysis was instead based on the true likelihood. We seek to perform a full Bayesian analysis for the Abakaliki data, avoid- ing approximations by using data-augmentation to produce an analytically tractable (and correct) likelihood. In Section 2.2 we will introduce the data, before dening the model in Section 2.3. Section 2.4 concerns a simulation study, performed to conrm that the method is working as required. Sec- tion 2.5 will describe the Bayesian inference and calculations to obtain a full likelihood expression. Following this, Section 2.6 will describe the MCMC performed. We use the true likelihood to estimate the parameters of interest, using a Bayesian framework, data augmentation and MCMC. Section 2.7 then includes the results of this analysis and Section 2.8 discussion of these. We interpret the posterior estimates of the parameters in the model as well as a variety of reproduction numbers; directly comparing them to those obtained by Eichner and Dietz in their analysis. In addition we perform a sensitivity analysis, model checking, and consider the results of the simulation study. We also estimate quantities derived via data-augmentation, such as who-infected- whom and the time of infection for each individual, which do not feature in the analysis of Eichner and Dietz. 2.2 The Data The data, as given in Thompson and Foege (1968), are structured as shown in Table 2.1, which displays information on the 32 cases of smallpox: when the infected individual's rash became apparent, their compound identier, FTC membership status and vaccination status. We have dened our timescale by setting day 0 as the date of the rst rash onset. All of the infected individuals lived in compounds; these are typically one- storey dwellings housing several families and built around a central court- yard. The composition of the affected compounds is provided in Table 2.2, 39CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA where the total numbers of vaccinated and non-vaccinated FTC and non-FTC members within each compound are displayed. FTC members were known to mix frequently with one another, whilst remaining rather isolated from the rest of the community. FTC members also refused vaccination, although many of them were vaccinated prior to joining the organisation. For use in Table 2.2, we dene quantities nc,FTCand nc,nonas the total number of FTC and non-FTC individuals residing in compound c, respectively. Note that on the 25th day after the rash of the initial infective became appar- ent, four FTC individuals from compound 1 (three vaccinated and one non- vaccinated) moved to compound 2. Table 2.1 and Table 2.2 show the composi- tion of the compounds after the move. In addition, quarantine measures were put in place in Abakaliki, but not until part way through the outbreak. The exact time these measures were introduced was not recorded. 2.3 Model Structure 2.3.1 Population Structure We wish to dene a model for smallpox outbreaks in the town of Abakaliki, using the information provided in the WHO report by Thompson and Foege (1968). Beginning with notation, consider Abakaliki a closed population with N=31200 individuals, labelled 0, . . , N\u00001. The population is partitioned by compound: either one of the nine listed in the WHO report or 'outside' meaning within the town but not the affected compounds, and by confession: either belonging to the Faith Tabernacle Church (FTC) or not. Individuals 0, 1, . . . , ncom\u00001 are those inside the compounds, where ncom=251 is dened as the number of people living within Any . . . , 9 is the compound of k, or ck=0 indicates that kis outside the compounds. Similarly, fkisk's confession (faith); FTC or non-FTC. These types may lead to 40CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Table 2.1: Smallpox cases in Abakaliki during 1967, from Thompson and Foege (1968). Compounds are listed after the move of cases 7 and 8 and two non-infectives, on day 25 from compound 1 to 2. Case number Day of rash onset Compound Confession Vaccination 0 0 1 FTC No 1 13 1 FTC No 2 20 1 FTC No 3 22 1 FTC No 4 25 1 FTC No 5 25 1 FTC No 6 25 1 FTC No 7 26 2 FTC Yes 8 30 2 FTC Yes 9 35 1 FTC No 10 28 4 FTC No 11 40 5 FTC No 12 40 1 FTC No 13 42 1 FTC No 14 42 1 FTC No 15 47 1 FTC No 16 50 5 FTC No 17 51 2 FTC No 18 55 1 FTC No 19 55 2 FTC No 20 56 6 Non Yes 21 56 5 FTC Yes 22 57 2 FTC Yes 23 58 7 FTC No 24 60 4 FTC No 25 60 2 FTC No 26 61 2 FTC No 27 63 8 Non Yes 28 66 3 FTC No 29 66 9 FTC No 30 71 5 FTC No 31 76 2 FTC Yes 41CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATATable 2.2: Composition of the compounds affected by smallpox in Abakaliki, Nigeria during 1967, from Eichner and Dietz (2003) Compound FTC Non-FTC Vaccinated Nonvaccinated nc,FTC Vaccinated Nonvaccinated nc,non 1 18 15 33 0 0 0 2 9 5 14 1 0 1 3 2 8 10 0 0 0 4 2 -i4 2 +i4 4 28 + i4 1 -i4 29 5 4 -i5 3 +i5 7 13 + i5 2 -i5 15 6 0 0 0 40 3 43 7 4 -i7 1 +i7 5 12 + i7 3 -i7 15 8 0 0 0 37 5 42 9 0 1 1 26 6 32 Sum 1-9 35 39 74 161 16 177 Outside 46 x 35/74 46 x 39/74 46 30903 x 161/177 30903 x 16/177 30903 Total 120 31080 We do not have complete vaccination status for all compounds, and so we use i4,i5,i7to allow for different possible congurations. Since the total number of vaccinated individuals in each compound is known as well as the total number of FTC and non-FTC, but not the confession of all vaccinated individuals, we are able to derive a system of linear constraints. Namely, i4+i5+i7=4,i42f0, 1g,i52f0, 1, 2gand i72f1, 2, 3g(the rst constraint as we know the total number of FTC and non-FTC individuals, and the latter three to ensure we do not allow negative numbers of people in any category). Note: this table displays the compound composition after the move of the four individuals from compound 1 to compound 2 on day 25. 42CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Figure 2.1: The structure of the population of Abakaliki as used in this study. FTC = member of the Faith Tabernacle Church, n-FTC = not a member of the FTC. Numbers in brackets represent the number of individuals within that category, after the move of four indi- viduals on day 25 as detailed in Section 2.2. differences in the mixing behaviour of individuals, though otherwise individ- uals are considered to be identical in their susceptibility to smallpox and their ability to infect others. Figure 2.1 shows the population structure of the town of Abakaliki during the epidemic. Within the population are the compounds as described in the WHO report. There are nine of these compounds, and within any one may reside individuals of confessions FTC and non-FTC. 2.3.2 Transmission Model We now describe a stochastic disease-transmission model for the spread of smallpox throughout the population of Abakaliki. This model is essentially the same as that described in Eichner and Dietz (2003), and is a variant of an SEIR (Susceptible-Exposed-Infective-Removed) model. Dening a time scale as in 43CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Table 2.1, where time zero is the initial infective's rash time, at any given time t, each individual in the population will be in any one of six states: susceptible, exposed, with fever, with rash, quarantined or removed. Any susceptible may become exposed, as described below, and enter the incubation (or latent) pe- riod. During this stage individuals are not yet infectious. They will next enter the fever stage of the disease, at which point they become able to infect others. During the rash stage which follows, they will remain infectious but at a po- tentially different rate. We dene the infectious period as the combined time spent in the fever and rash stages. Infectious individuals will either become removed (namely recovery or death, which we do not distinguish between) or isolated, this being the individual quarantined and henceforth unable to in- fect others. Quarantine procedures involve the removal of the individual from the population, these measures only being introduced part way through the outbreak at unknown time tq. Figure 2.2 is a visual representation of how any given individual may progress through the stages of susceptible, exposed, infectious with fever, infectious with rash (at the beginning of which their infectivity is changed) and nally either removal or quarantine; whichever comes rst. For j=0, ..., N\u00001, let ej, ij,rj,qj,tjdenote, respectively, the times of exposure, fever, rash, quarantine and removal for individual j. Ifjnever becomes infected, ej=ij=rj=qj= tj=\u00a5. We assume that the epidemic is initiated by a single exposed individ- ual, whom we label k. We dene the sets of these times as e(not including ek), i,r,qandt. The lengths of time spent in each disease progression stage for different in- dividuals are assumed random with specied distributions, and mutually in- dependent. The periods of time as identied in Figure 2.2 are THE ABAKALIKI SMALLPOX DATA Figure 2.2: Disease progression in the smallpox model. The top image rep- resents the infection of an individual who is removed through re- covery or death, and the bottom shows an infection of someone who is quarantined. Isolation is only possible once quarantine measures have been introduced at mean and standard deviation of the gamma distributed disease stage AforA=I,Fand R, all of which are assumed known. Additionally, tqdenotes the time at which quarantine measures are introduced. The values of the means and standard deviations have been taken from Eichner and Dietz (2003), as shown in Table 2.3. Once quarantine mea- sures are introduced, an individual may be put into isolation after a random delay following their rash onset date. Specically, we dene the quarantine time of individual jasqj=max(rj,tq) +G(1,1 4), as assumed by Eichner and 45CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Table 2.3: Durations of periods in the infection process for Abakaliki small- pox outbreak. Time until quarantine determined by the maximum of rash time and time quarantine measures were introduced, tq. Mean (days) Standard deviation (days) Period before fever mI=11.6 sI=1.9 From fever to rash mF=2.49 sF=0.88 From rash until recovery mR=16.0 sR=2.83 From rash to quarantine or from tqto quarantinemQ=2.0 sQ=2.00 Dietz (2003). This means that no quarantining occurs prior to time tq, after which it takes an average of two days for a detected individual to be placed in isolation, with standard deviation 2. Note also that an infected individual will have both a removal time and a quarantine time, for computational ease. Both quantities appear in the likelihood function, but in reality only the earlier of the two events takes place. The epidemic begins at time ekwith the exposure of the initial infective k. Re- call that the infectious period is dened in two parts: the fever period and the rash period, during each of which an individual will be infectious, but at potentially different rates. During their rash period, an individual jwill have contacts with other members of their compound who are of the same confession at times given by a Poisson process of rate lhper day. Individuals outside of the nine compounds do not have such contacts. In addition, FTC individuals will have contacts at rate lfper day with other FTC individuals and contacts at rate laper day with anybody in the population. Non-FTC in- dividuals are assumed to have contacts with anybody in the population at rate la+lfper day since no information on their close contacts is available. Dur- ing the fever period, the infections occur in exactly the same manner except that all rates are multiplied by factor bto account for the difference in infectiv- 46CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA ity. Typically, b<1. In each case, the individual actually contacted is chosen uniformly at random from the pool of potential individuals in question. For example, contacts made with the entire population are drawn from the N\u00001 other individuals. Note that this means that the individual-to-individual con- tact rate for such contacts isla N\u00001. Any contact from an infective to a susceptible results in immediate exposure of the susceptible. All of the Poisson processes describing contacts are assumed to be mutually independent In addition, a proportion of the population is vaccinated. Vaccination status of all but a few individuals within the compounds is assumed known, and the proportions of FTC/non-FTC vaccinated individuals outside the compounds is assumed equivalent to inside. However, this vaccination is not necessarily effective: each recipient of the vaccine is completely protected with probabil- ityv, or remains completely susceptible with probability 1 \u0000v. Although the total number of vaccinated individuals is known, we do not have complete in- formation on the composition of individuals with respect to vaccination status and FTC membership and so there are ve potential congurations of twelve individuals with unknown details to consider, as shown in Table 2.4. For each individual in the population we have a vaccination status, assumed known for most individuals, and a protection status, unknown. All individuals within the population remain living in their compounds, with the exception of four individuals who moved from compound 1 to compound 2 on the 25th day after the initial infection, two of whom later become infective. The epidemic continues until there are no infectious or exposed individuals remaining in the population, at which point each person will either still be susceptible, or will have been quarantined/removed. We do not allow for reinfection. 47CHAPTER 2: M AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATATable 2.4: Possible combinations of twelve individuals, labelled 183, 213, 214, 215, 217, 231, 232, 233, 234, 236, 237, 250, with un- known vaccination status Combination Compound FTC Non-FTC Vaccinated Nonvaccinated Vaccinated Nonvaccinated 14 213 183 5 215, 214 217, 231 7 232, 233, 234 236, 237, 250 24 213 183 5 215 214 217 231 7 232, 233, 234 236, 237, 250 34 213 183 5 215 214 217 231 7 234 232, 233 236, 237 250 44 213 183 5 214, 215 217, 231 7 234 232, 233 236, 237 250 54 213 183 5 214, 215 217, 231 7 234, 233 232 236 237, 250 48CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA 2.3.3 Infectious Pressure For an individual kwho is susceptible at time twe dene Lk(t)as the infec- tious pressure acting upon them at time t, so that P\u0000 kis infected in (t,t+dt]jkis susceptible at time t\u0001=Lk(t)dt+o(dt). From the model denition in Section 2.3, if both kand jare FTC and 0 otherwise, dc(j,k;t)= 1 if both kand jlive in the same compound at time tand are of the same confession, equalling 0 otherwise. Recall that N=31, 200 is the total population size, n=120 is the number of FTC individuals within the population, and nc,fj(t) is the number of individuals in j's compound of the same faith as jat time t, including jthemselves. Finally, Nin f(t)is the set of individuals infective at time t. From the population diagram in Figure 2.1, there are four different types of susceptible when considering infectious pressure received: categorising over confession (FTC or non) and location (within the compounds or outside). Table 2.5 summarises the contact rates of the different types of susceptible, from all potential types of infector. 49CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Susceptible Compound of infective jConfession of kfrom infective j. Here, w2f1, ..., 9gis any one of the affected compounds, and wcdenotes any affected compound other than w. In addition, N= size of the population, n= number of FTC individuals in the population (note this change in denition of nfor this chapter alone) and nc,fj(t)= number of individuals in the same compound and of the same faith as individual jat time t. Note: If jis in the fever stage, pressure is multiplied by the infectivity factor b. 50CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA 2.4 Simulation 2.4.1 Simulation Process We wish to simulate data from our model for smallpox outbreaks within the population of Abakaliki. This will allow us to perform a simulation study, as well as posterior predictive checking to assess model t. The method is shown in Algorithm 4. Within this algorithm, the infectious pressure upon each susceptible kat given time tis calculated using the expression for Lk(t) in Equation (2.3.1). Algorithm 4 Simulation code for smallpox outbreaks in Abakaliki Input: la,lf,lh,v,b,tq Output: e ,i,r,q,t 1. Randomly generate protection status for vaccinated individuals (vaccina- tion status known from the data), given vaccine efcacy v2(0, 1). Inside compounds: generate statuses individually fori=0toncom\u00001do Generate U\u0018U(0, 1) ifU<vand iis vaccinated then Individual iis protected end if end for Outside compounds: Generate the number of FTC/non-FTC protected indi- viduals Number and protected vaccinated, v) Number non-FTC and protected \u0018Bin(number non-FTC and vaccinated, v) 2. Set initial infective: k=0. Generate times for initial infective: ek,ik,rk=0,tkand BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA 3. Loop to simulate infections while number infectives or exposed > 0 do fori=0toN\u00001do inf(i)= sum of pressure from all infectives to susceptible i, Potential infection time tp(i)\u0018Exp(1 inf(i)), end for Take minimum potential time tpm=min(tp(i):iis the set of susceptible individuals), recording index jof the chosen individual. Take minimum tmin=min(tpmand other infection process events (infec- tive moves to rash period, removal etc.)). iftmin=tpmthen Infection takes place. Generate infection events ej=tpm(j),ij,rj,tjand qj. Set t=ej. else Infection does not take place, infection process event does. Set t=time of process event. end if end while To give some more detail on how the calculation of potential exposure times for those outside of the compounds is approached, only one time for FTC in- dividuals outside and one time for non-FTC individuals outside is required to be calculated, since all outside individuals of the same confession receive the same infectious pressure. The mean of the exponentially distributed potential exposure time must be multiplied by 1/ (number of FTC individuals outside ) or 1/ (number of non-FTC individuals outside )to include the required selec- tion of which individual is to be infected. Since these outside individuals are arbitrarily numbered, apart from being categorised by confession, we dene the rst outside FTC individual to be infected as number j=ncom+Fp+ NFp+1, the second j=ncom+Fp+NFp+2 and so on, with Fpand NFp dened as in Figure 2.3 as the numbers of FTC and non-FTC protected indi- 52CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA viduals, respectively. The case is similar for any non-FTC individuals outside who become infected, with the rst being numbered j=ncom+Fp+NFp+ Fnp+1, for Fnp equal to the number of unprotected FTC individuals outside. This is more computationally efcient since it does not require calculation of thousands of identical infectious pressures. This mechanism for outbreak simulation will be required in the later simula- tion study and model checking, but now we proceed to dene the Bayesian inference and likelihood expressions to be used in our analysis. Figure 2.3: Numbering of the Nindividuals within the population of Abaka- liki 2.5 Inference and Likelihood Expressions With the data introduced and the model dened, we may perform Bayesian inference for the unknown model parameters, given the data and augmenting the unknown event times for each infective as well as the unknown protec- tion and vaccination statuses. This is, to the best of our knowledge, the rst Bayesian analysis of the Abakaliki data considering all aspects of the data. 2.5.1 Preliminaries In order to derive an expression for the likelihood in our model, we rst dene some notation. 53CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Recall that the vaccination statuses of individuals in Abakaliki are known, with a small number of exceptions as detailed in Table 2.4. For those known only, dene s=fsiji20, .., N\u00001 and siknowngas the set of vaccination statuses of each individual, with sitaking value 1 for vaccinated iand 0 for unvaccinated i. Then, let F= (k,ek,tq,b,v,la,lf,lh,q,s) where q= (mI,sI,mF,sF,mR,sR,mQ,sQ), so that the components of q, are parameters that are assumed known, and Fcontains all of the model parameters, both those known and those to be estimated. Recall that we dened e,i,qandtas the unknown sets of exposure (not including ek), infection, quarantine and removal times, respectively. The tem- poral data r, as introduced in Section 2.2, consist of rash times for all infectives. For those individuals with unknown vaccination status only, we dene su= fsu iji20, .., N\u00001 and su iunknowng. The unknown protection status of each individual within the compounds is contained within p= (p0,p1, ...,pncom\u00001); where pi=1 for successfully vaccinated (protected) or pi=0 for unsuccess- fully vaccinated (unprotected) or not vaccinated at all. For individuals outside the compounds, dene (pncom, ...,pN\u00001)in the same way as for those inside. Finally, let p= ( p,pncom, ...,pN\u00001). For computational purposes, instead of separate protection statuses for each outside individual, we will in fact only require quantities xand y, where x=Number of FTC, vaccinated, unprotected but never infected individuals outside of the compounds, (2.5.1) y=Number of non-FTC, vaccinated, unprotected but never infected individuals outside of the compounds, (2.5.2) neither of which are known from the data. We separate over FTC membership status since these individuals will have different mixing behaviours. Since the 54CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA likelihood contribution from such outside individuals can be described using xand y, this allows for storage of only these two numbers rather than a pro- tection and a vaccination status for each of the 30,949 individuals in question. Dene g= (e,i,q,t,su,p), containing protection statuses for all Nindividuals, and g= (e,i,q,t,su, p), containing only the protection statuses for individuals within the compounds. Next, dene setsNof individuals with sub/superscripts as follows: in f =Becomes infected, n\u0000in f =Never infected, sus=Initially susceptible, i.e. unvaccinated or vaccinated but not protected, FTC =Member of Faith Tabernacle Church, n\u0000FTC =Not a member of Faith Tabernacle Church, oc=Outside the compounds, c=Inside the compounds. For example,Nc in fdenotes the set of individuals within the compounds who become infected. Now, for t\u0015ekand j=0, ..., N\u00001, dene Lj(t) = infectious pressure acting on individual jat time t, L(t) = infectious pressure acting on all individuals who are susceptible at time t =\u00e5 j2N sus j:ej>tLj(t), where L(t)can be subdivided into L(t) =LOC(t) +LCN(t) +LCC(t)with each term in the sum representing the overall infection pressure at time t 55CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA to those outside the compounds, to those inside the compounds who never become infected, and to those inside who do become infected, respectively. These Lterms can hence be dened as we denote of the data rgiven the model pa- rameters Fasp(rjF). This is practically intractable in all but trivial cases however, as we do not observe the complete infection process and so it is in- feasible to integrate over all possible infectious period parameters as the num- ber of infectives increases. However augmenting the data rwith gwe obtain instead the tractable likelihood p(r,gjF). An extension of the standard SIR model likelihood dened in Section 1.3.5, this likelihood is Tis the end of the epidemic, dened as the rst time at which no infec- tives or exposed individuals remain in the population. In addition, Lj(ej\u0000) = lim t\"ejLj(t), where ej\u0000represents the time just before exposure of j. The rst product term Lj(ej\u0000)denes the pressure on each infective just before their exposure and the exponential term e\u0000RT ekL(t)dtrepresents the pressure on sus- ceptibles over the entirety of the epidemic. Next are the densities fA(\u0001)of the exposure, fever, rash and time-to-quarantine periods, where fA, for A= (I,F, 56CHAPTER 2: M AND ABAKALIKI SMALLPOX DATA R,Q), is dened as the pdf of a G(mA,sA)distribution. Lastly, the nal term is the likelihood of the protection status arrangement. We wish to nd p(Fjr), but in order to make use of Equation (2.5.3), we use the augmented posterior density \u00b5p(r,gjF)p(F), so that the posterior density is the product of the tractable, augmented likeli- hood and the prior density p(F), divided by a normalising constant. Assuming independence a priori of the components of F, p(F) = p(k,ek,tq,b,v,la,lf,lh,q,s) =p(k)p(ek)p(tq)p(b)p(v)p(la)p(lf)p(lh)p(q)p(s). We assume that la,lfandlhhave gamma distributed priors, vhas a uniform prior on (0, 1)and band tqhave improper, uniform priors on (0,\u00a5). We set a discrete uniform prior for kover the number of infected individuals. In addi- tion, ekhas an improper uniform prior on (\u0000\u00a5,ik). Since qand sare assumed known, p(q)andp(s)are just point masses. Before continuing to the likelihood calculations, the notation required in this chapter is summarized in Table 2.6. 2.5.2 Integrating out Parameters xand y In its current form, our data augmentation scheme results in a likelihood in- volving the protection status of each of N=31, 200 individuals. It is possi- ble, however, to integrate out these parameters for all individuals outside of the compounds. This is essentially because the number of protected individ- uals is Binomially distributed, and also arises from the fact that individuals outside of the compounds do not contribute compound mixing terms to the likelihood; they may only differ in their FTC membership. Since this removes 57CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Table 2.6: Principal notation. Parameter Interpretation N Population size ncom Number of individuals within the compounds n Number of FTC individuals Nin f Set of ever infected individuals Na bSet of individuals with location aand status b (such as within the compounds and ever infected) la Global infection rate lf FTC infection rate lh Household infection rate b Infectivity factor for fever period v Vaccine efcacy tq Time quarantine measures introduced q Fixed parameters for disease stage lengths k Identity of initial infective ek Exposure time of initial infective s Vector of vaccination statuses (for all individuals) suVector of unknown vaccination statuses p Vector of protection statuses (for all individuals) p Vector of protection statuses (compound individuals only) F (k,ek,tq,b,v,la,lf,lh,q,s) e Vector of exposure times i Vector of fever times r Vector of rash times t Vector of removal times q Vector of quarantine times g (e,i,t,q,su,p) g (e,i,t,q,su, p) 58CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA almost 31,000 parameters, this provides a likelihood which is much faster to compute. In this section we will show that p(r,gjF) =p(r,g,x,yjF), where xand yare dened as in Equations (2.5.1) and (2.5.2). This rst step shows that the separate protection statuses for individuals outside the com- pounds can be summarised by just the total numbers of FTC and non-FTC vaccinated, unprotected but never infected individuals. We will then integrate outxand yas follows. We begin by expressing the likelihood as p(r,g,x,yjF) =p(r,gjx,y,F)p(x,yjF) (2.5.4) and out xand y, equivalent to summing in this case since they take discrete values, we target density p(F,gjr), independent of xand yas desired. 2.5.2.1 Removing protection statuses for individuals outside the compounds We now must prove that p(r,gjF) =p(r,g, x, yjF), in order to perform the integration detailed above. 59CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE +LCC(t)as in Section 2.5.1 but now with dependence on xand y. Then the only terms in Equation determined by the protection status of individuals outside of the compounds. It is possible to subdivide the like- lihood of the protection status over whether the individual is inside/outside and by whether they do or do not become infected as terms corresponding to individuals inside the compounds do not depend onxand y, and neither does the term concerning outside infectives, since their protection status is known. Also, there are only unknown vaccination statuses for individuals inside of the compounds and so we may disregard the su rterms. 60CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Let us then dene the expression the indicator functions collapse to just sras it is itself an indicator function, with value 1 for rvaccinated and 0 for rnon- vaccinated. The integral of LOCis equal to the sum over all infectives jof the pressure from jto any given FTC or non-FTC individual outside of the compounds (throughout all time (ek,T)), summed over all the initially susceptible FTC and non-FTC susceptible kduring the time interval (ek,T). We wish to express Equation (2.5.8) in terms of xand yand so, partitioning according to whether susceptibles become infected or not, see partitioned over the confession of the susceptibles: whether FTC or not. However, the data only indicate if individuals are vaccinated, not whether they are protected, since the vaccine may not have been effective. Of the four Yjkvalues in Equation (2.5.9), the numbers of initially susceptible FTC and non-FTC individuals outside that do become infective are known, but not the 61CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Figure 2.4: Tree diagram for protection status of individuals outside the com- pounds. Here inf = infected, n-inf = non-infected and sus= sus- ceptible. number of initial susceptibles that are never infected. Figure 2.4 displays the possible combinations of individuals in the latter two categories. So, the total number of initially susceptible, never infected individuals outside the compounds is given by jNoc fis the known number of vaccinated, never infective individuals outside, each one of whom is susceptible with probability 1\u0000v. Bin( n,p) represents a binomial distribution with number of trials nand success probability p. The number of boc n\u0000in the number of FTC individuals outside who are vaccinated but not infected and boc n\u0000in f,n\u0000FTCis the number of non-FTC indi- viduals outside are vaccinated but not infected. 62CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE jto a never infected FTC/non-FTC susceptible outside the compounds over all time (ek,T). This contribution is equal for all susceptibles k. Considering the protection status likelihood parts of Equation (2.5.10), note that (1\u0000v)N\u00001 \u00e5r=ncom r2N n\u0000in f(1\u0000pr)sr = (1\u0000v)x+y, since the sum is equal to the number of vaccinated but unprotected individuals outside who do not become infected. Hence vN\u00001 \u00e5 r=ncomprsr=vboc n\u0000in f\u0000x\u0000y, as the sum is equal to the number of vaccinated and protected individuals outside, which can be seen as equivalent to the number of vaccinated never infected individuals outside minus those who are unprotected. 63CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Splitting up the terms involving xand y, Equation (2.5.10) can be written in the = x, yjF)as claimed. None of the unknown protection statuses for outside individuals are now explicitly required, resulting in improved computational speed, and we may now sum this expression over xand yto obtain the overall likelihood p(r,gjF), which is faster still to compute. 2.5.2.2 Sum over xand y Considering Equation (2.5.11), the rst exponential term does not depend upon xoryand so we may disregard it for now. For the rest of the expression, recog- nise that the sum takes the form of a moment generating function (MGF) for the binomial distribution and hence use the fact that, for W\u0018Bin(n,p), = FOR THE ABAKALIKI SMALLPOX DATA for the full, tractable likelihood expression, combine the section from Equation (2.5.12) with the remaining parts of the original likelihood from Equa- tion (2.5.6), resulting in an overall log likelihood 0 otherwise. The log posterior density of interest is thus log(p(F,gjr,q))\u00b5log(p(r,gjF)p(F)) =log(p(r,gjF)) + + log(p(lh)). We have obtained a tractable likelihood expression which is sufciently fast to compute, and we may now perform MCMC; sampling from the posterior density to obtain estimates of model parameters. 2.6 MCMC In this section we will detail the MCMC algorithm used to update the model parameters and the augmented data. Within the MCMC algorithm, all of the 12 parameters are updated singly in a systematic order using Metropolis-Hastings updates, with the exception of the exposure, infection, quarantine and removal times which are updated in pairs. More complex updates could be considered, but since these single up- dates work well and lead to sufcient mixing, it does not appear necessary. 66CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Proposed values outside of the possible range for each parameter are imme- diately rejected (for example, all the infection rates must be positive). The acceptance probability is calculated using the full conditional distributions, as fully detailed in Appendix A, since calculation of the full likelihood is compu- tationally demanding. We obtain 100,000 samples in all cases, taken after an initial burn-in of 10,000 iterations and thinning to record every 10th iteration for sufcient indepen- dence in these samples. In each loop of the algorithm, rst the lvalues are individually updated, followed by v(vaccine efcacy), b(infectivity factor of fever infectious period) and tq(days until isolation procedures begin). For a number of randomly selected individuals, the pair of exposure and fever times, followed by the pair of quarantine and removal times, are then up- dated. This is followed by the protection status of a small number of indi- viduals within the compounds proposed to be changed. Finally, vaccination statuses sumust be updated. Whereas to update pwe randomly select any element of pand propose a change to it, with suwe consider the limited pos- sible number of unknown vaccination congurations for several individuals within the compounds, as shown in Table 2.4. The total number of vaccinated people in each compound is known, but not necessarily whether those vacci- nated are FTC or non-FTC, and so to update suwe randomly select one of the ve potential vaccination congurations from c=fciji=1, ..., 5g. The MCMC was coded in C, and takes on average 2.5 hours for 100,000 sam- ples to be obtained. A summary of the MCMC process used is given in Al- gorithm 5. The number of event times and protection statuses updated per iteration in the algorithm (5 and 15, respectively) were tuned to provide good mixing. We now explain each of the MCMC updates in more detail. To update any pa- rameter a, a candidate value is drawn from the proposal density. Any positive candidate avalue is accepted with probability p(a)q(aja) p(a)q(aja)^1, 67CHAPTER 2: M AND ABAKALIKI SMALLPOX DATA Algorithm 5 MCMC process for obtaining samples of the Abakaliki outbreak parameters. Input: r ,it=number th=degree of thinning Output: la,lf,lh,v,b,tq 1. Establish initial values of output parameters as well as event times, pro- tection statuses and unknown vaccination statuses. 2. fori=\u0000btoitdo forinner =0tothdo a) Update la b) Update lh c) Update lf d) Update v e) Update b f) Update tq g) forj=1to5do Randomly select an infected individual Update their exposure and infection times as a pair Update their quarantine and removal times as a pair end for h) forj=1to15do Randomly select an individual within the compounds Update their protection status end for i) Update the unknown vaccination status conguration, and corre- sponding protection statuses end for Record current output parameter values end for 68CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA where q(\u0001j\u0001)denotes the proposal density/mass function and p(\u0001)is the a- dependent full conditional distribution, provided in Appendix A. Considering each parameter individually: lvalues updated - infection rates: Candidate value la=la+x is proposed, where x\u0018N(0,s2 la), i.e. xis a Gaussian distributed random variable with mean 0 and xed variance s2 la. In practice, s2 lais tuned to provide reasonable mixing of the Markov chain. The probability of acceptance is given by: p(lajr,q,g,k,ek,tq,v,b,lf,lh,s) p(lajr,q,g,k,ek,tq,v,b,lf,lh,s)^1, with similar expressions for lfandlh. Using a randomly generated, uniform distributed number Ubetween 0 and 1, the proposed value is accepted or rejected under the given probability. Since we operate on a log scale, the candidate is accepted if log(U)<log(p(lajr,q,g,k,ek,tq,v,b,lf,lh,s)) \u0000log(p(lajr,q,g,k,ek,tq,v,b,lf,lh,s)). This process is carried out for la,lhandlfin turn. v value updated - vaccine efcacy: A very similar procedure is used to update v, with a candidate value suggested as a random Gaussian distributed variable added to the current vvalue. Provided this candidate lies between 0 and 1, it is accepted with probability p(vjr,q,g,k,ek,tq,b,la,lf,lh,s) p(vjr,q,g,k,ek,tq,b,la,lf,lh,s)^1. b value updated - infectivity factor: Next, bis updated using the same candidate selection process as for v. In this case, the probability of acceptance is p(bjr,q,g,k,ek,tq,v,la,lf,lh,s) p(bjr,q,g,k,ek,tq,v,la,lf,lh,s)^1. 69CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA tqvalue updated - time quarantine procedures introduced: In much the same way as before, a new value for tqis proposed, based on a random Gaussian dis- tributed amount added to its previous value, and accepted with probability p(tqjr,q,g,k,ek,b,v,la,lf,lh,s) p(tqjr,q,g,k,ek,b,v,la,lf,lh,s)^1. e,i,q,t values updated - exposure, infection, quarantine and removal times: A num- ber, typically in the range 5-10, of individuals per iteration of the algorithm are randomly selected to have their exposure, infection, quarantine and removal values updated. Candidate values are selected, with exposure and infection being accepted/rejected as a unit followed, by the pair of quarantine and re- moval since we expect these quantities to be correlated. Candidates for the period of time between start of infectivity and known rash start time, then exposure and start of infectivity are proposed as random gamma distributed values. They are accepted/rejected as a unit, before candidate val- ues for the time between rash and quarantine and also rash and removal are proposed and similarly judged as a unit. The process for each individual is as follows 1. Select an individual juniformly at random from the set Nin f, 2. Simulate F vG(mF,sF)and set ii=ri\u0000F, 3. Simulate I vG(mI,sI)and set ei=ii\u0000I, 4. Simulate R vG(mR,sR)and set ti=ri+R, 5. Simulate X vG(mQ,sQ)and set qi=max(ri,tq) +X. Making sure to keep track of the initial infective, the candidates for eiand ii are accepted with probability FOR THE ABAKALIKI SMALLPOX DATA After this, and regardless of the acceptance of the exposure and infection times, candidate times for tiand qiare considered similarly. The process is repeated for each of the selected infective individuals. Protection status updated: Similarly, a number of people in the compounds, again typically 5-10, are randomly selected to have their protection status changed. The change for each is accepted with probability p(pijr,F,e,i,q,t,p\u0000i,su) p(pijr,F,e,i,q,t,p\u0000i,su)^1. Only those individuals who are vaccinated and not infected are eligible to have their protection status changed. These updates are accepted/rejected sepa- rately rather than as a unit. Unknown vaccination status individuals updated: Finally, there are those people within the compound whose vaccination statuses are unknown. A new combi- nation of these is proposed, by selection of one of the aforementioned cvalues from 1 through 5 which represent the ve potential congurations of unknown vaccination status. Protection statuses of those affected are then updated ac- cordingly; set to 0 if an individual is proposed as non-vaccinated, and set to 1 independently with probability vif an individual is proposed vaccinated. Selecting one of ve possible congurations of unknown vaccination status uniformly at random, any given one is accepted with probability p(cijr,F,e,i,q,t, p) p(cijr,F,e,i,q,t, p)^1. 2.7 Results 2.7.1 Abakaliki Data With the full likelihood expressions obtained and MCMC scheme dened, we may now analyse the Abakaliki data. We seek to compare the results from our MCMC to those of Eichner and Dietz, and both can be found in Table 2.7. The posterior means, medians and credible intervals from MCMC are given 71CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA alongside the results of Eichner and Dietz. Figure 2.5 also contains density plots for the parameters of interest as well as the basic reproduction number, compared to Eichner and Dietz' maximum likelihood estimates (MLEs). In general, the results from MCMC appear very similar to Eichner and Dietz', particularly for the six model parameters. This is perhaps unexpected, and indicates that Eichner and Dietz's method may be fairly accurate despite its approximations. Our mean estimate of the basic reproduction number R0= (mR+bmF)(la+ lf+lh)is 7.96 for the whole infectious period, which means that in an entirely susceptible population an infected person will on average infect 7.96 others. This is slightly higher than Eichner and Dietz's estimate of 6.87. Similarly, our estimate of the reproduction number for the fever period RF=bmF(la+lf+ lh)is 0.53 compared to Eichner and Dietz's 0.164. In this case the difference can be explained by our larger estimate for infectivity factor b, which has a highly skewed posterior density. Table 2.8 gives estimates of a selection of reproduction numbers. Figure 2.6 contains density plots for these reproduction numbers. Dening RQas the re- production number once quarantine measures are in place (i.e. R0with mR= mQ=2.0) it is estimated at a mean of 1.459, interestingly meaning the epi- demic is still super-critical. Dening pairs of pre- and post- quarantine mea- sure reproduction numbers for spread only within compounds, for between FTC individuals and for in the wider population (i.e. RQa= (mQ+bmF)laand so on), we can see the impact of these different types of transmission. As we would expect, all reproduction numbers are greatly lowered post-quarantine compared to their pre-quarantine counterparts. However, we also see that (i) within compounds, the epidemic is super-critical both before and after tq; (ii) within the FTC membership, the epidemic changes from super- to sub-critical and (iii) in the wider population, the epidemic is always sub-critical. This would imply that what stops the outbreak spreading further is a combination of a depletion of susceptibles in the compounds and the fact that the global 72CHAPTER 2: M ODELLING AND BAYESIAN 10.1) and equal-tailed 95% credible intervals for the Abakaliki smallpox outbreak from the true likelihood approach, alongside the results of Eichner and Dietz (2003) for comparison. 100,000 MCMC samples were obtained. ABAKALIKI SMALLPOX DATA 0.00 0.05 0.10 0.150 5 10 15 20Global Infection Rate la0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.80 1 2 3 4Household Infection Rate lh0.00 0.05 0.10 0.15 0.200 5 10 15FTC Infection Rate lf 0.5 0.6 0.7 0.8 0.9 1.00 1 2 3 4 5 6Vaccine Efficacy v-0.5 0.5 1.0 1.5 2.0 2.5 3.00.0 0.5 1.0 1.5Infectivity Factor b35 40 45 50 55 60 65 700.00 0.04 0.08Time of Quarantine tq 5 10 150.00 0.05 0.10 0.15 0.20Basic Reproduction Number R0 Figure 2.5: Posterior densities of the six parameters of interest and the basic reproduction number, from the Abakaliki outbreak data. Red lines represent Eichner and Dietz' MLEs. Shown are 100,000 samples from an MCMC run. spread is sub-critical, rather than the quarantine procedure itself. We also consider the correlation between the model parameters. Figure 2.7 displays this, with a scatter plot and Pearson's correlation coefcient for each pair of parameters. The lack of correlation seen in the plot suggests that the six basic model parameters can indeed be individually estimated from the data, and our model is not over-parameterised. We lastly consider the posterior distribution of the exposure times for each in- fected individual, by taking the estimated exposure time for each infective at 74CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA 0 1 2 3 4 50.0 0.2 0.4 0.6 0.8 1.0Quarantine Reproduction Number RQ 0 1 2 3 4 50.0 0.4 0.8Global Reproduction Number Ra 0 1 2 3 4 50.0 0.2 0.4 0.6 0.8FTC Reproduction Number Rf 0 5 10 150.00 0.10 0.20Compound Reproduction Number Rh 0.0 0.2 0.4 0.6 0.8 1.00 1 2 3 4 5 6Global Quarantine Reproduction Number RQa 0.0 0.2 0.4 0.6 0.8 1.00 1 2 3 4 5FTC Quarantine Reproduction Number RQf 0 1 2 3 4 50.0 0.4 0.8 1.2Compound Quarantine Reproduction Number RQh Figure 2.6: Posterior densities of the reproduction numbers contained in Ta- ble 2.8, from the Abakaliki outbreak data. Shown are 100,000 sam- ples from an MCMC run. each iteration of the MCMC algorithm. These are shown in a heat map in Fig- ure 2.8. We see that generally there is small uncertainty in the exposure times, most of them following the same ordering as the rash times. This is likely due to the small variances assumed for the disease stage lengths. This plot also al- lows us to consider temporal features of the outbreak, such as the generations of infectives. We see two easily discernible generations at the start of the out- break (largely corresponding to those the initial infective infects, and then that generations' cases), and then two less discernible generations from around day 30 onwards. Visible are some clustered groups of individuals with very sim- ilar exposure times (and many estimated as infected by the same individual, 75CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE and equal-tailed 95% credible intervals for various reproduction numbers, where 100,000 MCMC samples are used. RQis the reproduction number for once quarantine measures are introduced. Rxis the reproduction number corresponding to the infection rate lx, where x=a,forh, and RQxis equivalent, but once quarantine measures are in place. as will be seen in Figure 2.9), which is more akin to a point-source outbreak where individuals are exposed to a highly infectious source for a short time, causing a sharp peak in cases. This highlights the high transmission potential of smallpox. 2.7.2 Source of Infection In addition to the results analysed so far, we are also able to estimate the most likely path of smallpox transmission for the Abakaliki outbreak, i.e. who in- fected whom. This is a novel analysis for the Abakaliki data, since Eichner and Dietz' maximum likelihood approach does not allow for it. Using our MCMC algorithm, we obtain samples from the posterior distribu- tion of the estimated infector of each jreceives in- fectious pressure Lj(t) =m \u00e5 k=1ak(t)at the time of their exposure, where ak(t) is the pressure from the kth of minfectives at time t, then the probability that 76CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA la0.2 0.4 0.6 0.80.190.100.5 0.6 0.7 0.8 0.90.36-0.1640 45 50 55 60 0.00 0.20-0.130.2 600.05 0.15 0.250.0 2.0tqScatterplot matrix for the model parameters Figure 2.7: Scatterplot matrix of the model parameters, including Pearson's correlation coefcient for each pair and, on the diagonal, the pos- terior densities of the parameters. individual kactually infected jisak(t) Lj(t). These samples can then be combined to nd the estimated probability that any given individual infected any other. Taking the individual estimated to have infected each person with the highest posterior probability, we obtain the estimated transmission pathway in Fig- ure 2.9. We see that compound 1 acts very much as the root of the outbreak, with initial infective 0 infecting many individuals within this compound. Later generations of compound 1 infectives then lead to the spread of infection into other areas; note that infective 8 was one of the individuals who moved from compound 1 to 2, and is estimated to have been the one to introduce the dis- ease into that compound. These ndings agree with those in Thompson and Foege (1968), who stated that all of the rst cases identied in compounds 2 through 9 except one could be traced to personal contact with a compound 1 infective. Figure 2.10 displays the uncertainty around the most likely infector of each individual, by plotting the posterior probabilities of each infective having in- 77CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA 0123456789101112131415161718192021222324252627282930-25 0 25 50 Time31 Figure 2.8: Heat map of the estimated exposure times of each infective, from 100,000 MCMC samples. fected every other. We see that for some infectives, the earlier ones especially, we can be far more certain of their source of infection, whereas in the mid- dle of the outbreak when new infections were being more rapidly discovered, the path of transmission is less easy to infer. This is as we might expect, and matches the analysis of the uncertainty around the exposure times. 78CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Estimated Transmission Pathway 01 23 489 11 1014 151622 567 121317 1819 C7C8 The estimated transmission pathway for the Abakaliki outbreak. Nodes represent infected individuals and the edge pointing to them represents the highest posterior probability among all pos- sible infectors. Individuals are clustered by compound. Note that individuals 7 and 8 moved from compound 1 to compound 2 dur- ing the outbreak. 2.7.3 Simulation Study To assess the performance of the MCMC algorithm, we now perform a sim- ulation study. Following the structure outlined in Section 2.4, we simulate a number of outbreaks (discounting any of nal size 1, which do occur with rel- ative frequency) using both the Eichner and Dietz parameter estimates and two alternatives. We then perform MCMC on this simulated data, to see how well it is able to recover the true values. We simulate 30 data sets for each set of parameter values, as simulating a larger number was found to have no 79CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA 012345678910111213141516171819202122232425262728293031 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 InfecteeInfector0.000.250.500.751.00ProbabilityProbability of Infection Source Figure 2.10: Heat map showing the posterior probabilities of individuals hav- ing infected others in the population of Abakaliki. considerable impact on the results, and run the MCMC algorithm for each. This results in 30 posterior means per set of parameter values, for which we calculate the mean of these means as well as 95% probability intervals. We compare the results from MCMC to the true values in Table 2.9. Density plots for the posterior mean values are given in Figures 2.11, 2.12 and 2.13. We see that the estimates are generally close to the true values, though with some overestimation. As we would expect, the estimates when la=0.4 are closer to the truth than for the Eichner and Dietz parameter values, since this causes larger outbreaks leading to more available information on the parame- ters. This is also the case, to some extent, when we increase tqto cause larger outbreaks, as we might expect. Table 2.10 shows the results of a single outbreak with much larger parameter values, yielding a large nal size. In this, we did not update the event times or protection statuses, but xed them to the values from the simulated data since otherwise computation was very slow. With a large outbreak we would hope 80CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA 0.00 0.05 0.10 0.15 0.20 0.25 0.300 4 8Global Infection Rate la0.2 0.4 0.6 0.80.0 2.0Household Rate lh 0.00 0.05 0.10 0.15 0.200 6 12FTC Infection Rate lf0.5 0.6 0.7 0.8 0.9 1.00 2 4Vaccine Efficacy v 0.0 0.5 1.0 1.5 2.0 2.50.0 0.8Infectivity Factor b0 50 100 1500.00 0.03Time of Quarantine tq Figure 2.11: Density plots for means of the posterior estimates of 30 simu- lations for the Eichner and Dietz parameter values. Red lines represent the true values used in the simulations. for estimates very close to the true values, which largely is the case except for some overestimation of lh. We expect that this might be due to a limit on the amount of information that can be gained about lh. Whereas for laand lfwe can learn more and more with larger outbreaks, since lhinteractions only occur between compound infectives we are limited on what we can learn. For a number of large outbreaks simulated, only around 30 out of around 700 infectives resided inside the compounds, and it was found that as the number of compound infectives increases, the estimation of lhdoes improve. Overall, these simulations suggest that the MCMC algorithm is performing well, as it is able to recover true parameter values from simulations with rela- tive accuracy. 2.7.4 Sensitivity Analysis We also perform a sensitivity analysis for model checking. This will assess the susceptibility of the results to changes in the underlying model assump- 81CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Table 2.9: Simulation study results. 30 simulations per set of parameter val- ues were created, and MCMC run on this simulated data. We pro- vide the mean estimate of the 30 posterior mean values and a 95% probability interval, where 100,000 MCMC samples were obtained. ParameterTrue ValueMean of Posterior Means95% Probability BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA 0.1 0.2 0.3 0.4 0.5 0.60 2Global Infection Rate la0.0 0.2 0.4 0.6 0.80.0 1.5Household Infection Rate lh 0.00 0.05 0.10 0.150 10 Infection Rate lf0.6 0.7 0.8 0.90 2 4 6Vaccine Efficacy v 0.0 0.5 1.0 1.5 2.0 2.50.0 0.8Infectivity Factor b40 45 50 55 600.00 0.10Time of Quarantine tq Figure 2.12: Density plots for means of the posterior estimates of 30 simula- tions for modied la=0.4. Red lines represent the true values used in the simulations. 0.00 0.02 0.04 0.06 0.08 0.10 0.120 15 30Global Infection Rate la0.1 0.2 0.3 0.4 0.5 0.60 2 4Household Infection Rate lh 0.10 0.15 0.20 0.25 0.300 4 0.95 1.000 3 6Vaccine v 1.0 1.5 2.0 2.5 3.00.0 0.6Infectivity Factor b100 200 300 4000.000 0.008Time of Quarantine tq Figure 2.13: Density plots for means of the posterior estimates of 30 simula- tions for modied tq=150 and lf=0.2. Red lines represent the true values used in the simulations. 83CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Table 2.10: Simulation study results for a single large outbreak of nal size 734. We provide the mean estimate over a single MCMC run of length 10,000, and the equal-tailed 95% credible interval. Parameter True Value this case the infectious period length parameters mI,mRand so on. We will vary these parameters governing the length of time spent in the different disease stages, and examine the impact on parameter estimation from MCMC. Figure 2.14 displays posterior densities for our parameters of interest over a range of infectious period mean durations. We vary mI,mFandmRand exam- ine the effect on the shape of the posteriors. As would be expected, when mR, the length of the rash period before removal, is reduced to make shorter aver- age infectious periods, the estimates of the infection rates increase to compen- sate. The estimates of the other three main parameters of interest are largely unchanged. Note that the estimation of R0is somewhat sensitive to the choice ofmR, likely an artefact of the relatively small number of cases, the quarantine procedure and the population structure. In a large and uninterrupted outbreak we would typically expect R0to be determined by the outbreak size, but that is not the case here due to these extra complexities of population structure and control measures. The values of mI,mFandmRhave been informed by the literature, but we are perhaps less certain about the values of mQandsQas these are data-specic and not recorded in the Thompson and Foege (1968) report. We see the results of varying mQandsQ, affecting the time taken to quarantine an infective, in 84CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Figure 2.15, and note that this change has very little impact on estimation. This similarity is reassuring since these values are those we are least certain of, and implies that even if the time taken to quarantine infectives is different to that which we assume, the effect on our results is minimal. 0.00 0.05 0.10 0.15 0.20 0.25 0.30 0.350515Global Infection Rate a0.0 0.2 0.4 0.6 0.8 1.001234Household Infection Rate h 0.00 0.05 0.10 0.15 0.20 0.250510FTC Infection Rate f0.4 0.5 0.6 0.7 0.8 0.9 1.00246Vaccine Efficacy v 0 1 2 3 40.01.02.0Infectivity Factor b35 40 45 50 55 60 650.000.06Time of tq m m F=3.00, m R=9.0 10 0.15 0.20Basic Reproduction Number R0 Figure 2.14: Posterior densities of the six parameters of interest and R0, when different mean durations of the infectious periods are used. 85CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA 0.00 0.05 0.10 0.15 0.20 0.25 0.30 0.350515Global Infection Rate a0.0 0.2 0.4 0.6 0.8 1.001234Household Infection Rate h 0.00 0.05 0.10 0.15 0.20 0.250510FTC Infection Rate f0.4 0.5 0.6 0.7 0.8 0.9 1.00246Vaccine Efficacy v 0 1 2 3 40.01.0Infectivity Factor b35 40 45 50 55 60 650.000.06Time of Quarantine tq Gamma(2,2) Gamma(0.5,0.5) Gamma(4,4) 5 10 Reproduction Number R0 Figure 2.15: Posterior densities of the six parameters of interest and R0, when the time taken to quarantine an infective, mQ, along with sQis varied. 86CHAPTER 2: M INFERENCE FOR THE ABAKALIKI SMALLPOX DATA 2.7.5 Posterior Predictive Checking As a nal piece of analysis, in order to assess how well our model ts the data we will perform posterior predictive checking. This involves taking samples of the basic model parameters from the posterior density, making sure to use a well mixed and thinned chain, and using our model to simulate a smallpox outbreak forwards in time from each. A well-performing model will lead to simulations similar to the Abakaliki outbreak. We use a number of measures to judge this similarity, namely comparing nal size, epidemic duration and incidence curves. We begin with nal size; the total number of infectives in each outbreak. Tak- ing 5000 sets of posterior estimates from a well mixed MCMC chain, we simu- late a smallpox outbreak from each and record the nal size. Figure 2.16 shows a histogram of these nal sizes where we see that, in this respect, the simula- tions are fairly similar to the true Abakaliki outbreak, but generally of slightly smaller nal size. The mean nal size is 23.5 compared to the Abakaliki out- break size of 32. This is somewhat surprising; since we allow for infections outside of the compounds, which were not seen in the data, we might expect the nal size of simulations to be larger on average. In the Abakaliki outbreak, however, it is important to note that two of the four individuals who moved compound were infective at the time of the move, and that these individuals were the rst cases seen outside of compound 1. If we consider only those simulations in which at least one of the moving individu- als was infective, we see an increase in the mean nal size to 29.27. Figure 2.17 compares this subset of the simulations to all of the simulations as a whole. We see that when we only consider simulations similar to the data in this respect, the nal size is much closer to that observed. This also supports our previous comment in Section 2.7.2 that the move of these two infected individuals was key in transmitting the disease outside of compound 1. We next consider epidemic duration, which we dene as the length of time be- 87CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Final size of 5000 outbreaks simulated from posterior estimates Final Size0 10 20 30 40 50 60 700 200 400 600 800Observed data Figure 2.16: Using 5000 posterior samples of the parameter estimates to simu- late outbreaks, a histogram displaying the nal size of each, com- pared to the observed Abakaliki data. tween the rst case detection (rash) time and the last. Figure 2.18 displays the duration of 5000 simulated outbreaks, compared to the observed data dura- tion. With a mean of 76.75 days, we see our simulated outbreaks are generally very similar in duration to the Abakaliki outbreak (of length 76 days), most likely due to the good estimation of tq. Note the slight peak for short outbreaks of length 0-10, caused largely by those which immediately went extinct. In the same manner as before, comparing the epidemic duration of the sub- set of outbreaks where infected individuals moved compound, we see a small increase in the mean. Figure 2.19 shows this, and it is interesting that in this case the subset of simulations provides a worse estimate of the observed epi- demic duration. However, we would indeed expect an increase in epidemic duration from the increased nal size of these simulations compared to all of the simulations as a whole. Figure 2.20 allows for examination of the correlation between nal size and epidemic duration for the simulated outbreaks. As would be expected, longer durations tend to be seen when there are larger outbreaks, with the two having 88CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Comparison of final size when an infected individual moves compound Final sizeFrequency 0 20 40 60 800 200 400 600 800Simulations with any individuals infected before move All simulations Figure 2.17: A comparison of nal size between all 5000 simulations and the subset of simulations where an individual who moves com- pound is infected during their move. The dashed line represents the mean nal size of all simulations, the dotted line represents the mean nal size of only those outbreaks where an infected in- dividual moves compound, and the solid black line represents the observed data. correlation of 0.57. The result for the true Abakaliki data does not appear distinctly different to that of the simulations. Table 2.11 provides a brief set of statistics for the simulated data sets compared to the Abakaliki outbreak, summarising the plots discussed so far. Note the difference in the percentage of outside infectives seen, which was not recorded in the Abakaliki outbreak but invariably occurs in simulations. Although the simulations do not appear similar to the data in this respect, it is noteworthy that Thompson and Foege (1968) claimed that 'there must have been some deaths which were very well concealed' within Abakaliki, and so it is cer- tainly not unquestionable that there were indeed infectives outside of the com- pounds who were just not recorded. Lastly, we wish to compare the cumulative number of cases at any given time in simulations to the Abakaliki data. However, this is difcult to do with out- 89CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Duration of 5000 outbreaks simulated from posterior estimates Duration (days)Frequency 0 50 100 1500 200 600 1000Observed data Figure 2.18: Using 5000 posterior samples of the parameter estimates to simu- late outbreaks, a histogram displaying the duration from the rst rash time to the last of each, compared to the observed Abakaliki data. breaks of different sizes, and so we take instead only those simulations of the same nal size as the data (32). Figure 2.21 displays the incidence curves of 4000 simulations of size 32, which we see are generally similar in shape to the data, perhaps with some right skew. This implies that the observed data are reasonably well captured by the behaviour of the model. To quantify this more exactly, we calculate a posterior predictive p-value for the discrepancy between simulations and the data, dened as the probability that a simulation Rrepis more extreme than the data Robs. Here, element Rjis equal to the jth rash time (where rash times are chronologically ordered as usual). We would wish for simulations to be more extreme around 50% of the time, so a p-value of 0.5 is optimum. In order to calculate the p-value, we must select a discrep- ancy measure D(R,F); a function of data Rand model parameters F. We use a chi-squared measure as detailed in Gelman et al. (1996), of the form D(R,F) =\u00e5 j\u0000 Rj\u0000E(RjjF)\u00012 Var(RjjF). Note that neither the mean nor the variance term are available analytically, 90CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Comparison of epidemic duration when an infected individual moves compound Duration (days)Frequency 0 50 100 1500 200 600 1000Simulations with any individuals infected before move All simulations Figure 2.19: A comparison of epidemic duration between all 5000 simula- tions and only those simulations where an individual who moves compound is infected before the move. The dashed line repre- sents the mean duration of all simulations, the dotted line rep- resents the mean duration of only those outbreaks where an in- fected individual moved compound and the solid black line rep- resents the observed data. and so we obtain these via simulation. Given F, we simulate until we have a suitably sized sample of outbreaks with 32 cases. The mean and variance of the jth rash time is then estimated directly from this sample. Next suppose that we have Msamples from the posterior, labelled F(1), . . . ,F(M). Repeatedly simulating until we obtain an outbreak with 32 cases, we use the ith sample of Fto obtain a simulated epidemic with rash times Rrepi. Then the posterior predictive obtained (for M=100), which is sufciently close to the optimum value of 0.5 to be accepted. Hence we conclude that the simulated 91CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA Table 2.11: Comparison of 4000 simulated outbreaks from posterior esti- mates, and the Abakaliki data over a range of criteria. * This value is calculated considering only outbreaks where at least one of the individuals who moves compound is infected by the time of their move Mean of Simulations Abakaliki Data Outbreak duration (days) 76.75 76 Final size 23.51 (29.27*) 32 Percentage of 19.99% 0% Percentage of FTC infectives 90.71% 93.8% outbreaks of size 32 are similar in this respect to the data, indicative of a good model t. A more accurate value could be obtained with larger values of M, but the procedure is highly time-consuming in practice due to the restriction on the nal size of simulations. Overall, posterior predictive checking has shown a good model t, indicating that our MCMC results are reliable. It has also highlighted some important as- pects of the data, such as further conrming the importance of the individuals who moved compound to the spread of the outbreak, and showing the large proportion of infectives outside the compounds in simulations, which may be cause for further work. 2.8 Discussion 2.8.1 Parameter Estimates Our estimates of the infection rates show clearly that the dominant mode of transmission within Abakaliki was between individuals in the same com- pound, in agreement with the ndings of Eichner and Dietz (2003). This is sup- ported by the estimated disease transmission pathway of Section 2.7.2 where 92CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA 0 20 40 600 50 100 150Scatterplot of final size against epidemic duration Final Size Duration of Epidemic (Days) Abakaliki Data Figure 2.20: For 1000 simulated outbreaks, a scatterplot of nal size against the duration of the epidemic. The black point provides the values from the Abakaliki outbreak. we see the majority of transmission events taking place within compounds. This is also in agreement with the original WHO report by Thompson and Foege (1968) who found that FTC membership did not appear to be the ma- jor transmission mechanism but rather that compound links and particularly family membership were dominant. Again similarly to Eichner and Dietz, we found the vaccine to have had around 81% efcacy. Our estimate for b, the factor for the change in infectivity during the fever period, was 0.5. Higher than that of Eichner of Dietz, this is likely due to the skewed shape of the posterior density but shows evidence that the modelling of smallpox with an SIR model that has been frequently seen in those citing the Abakaliki data may not be appropriate. The time quarantine measures were introduced was estimated to be between day 50 and 51. From our investigation, it seems that the introduction of con- trol procedures was somewhat important in preventing a much larger scale outbreak. Under the model assumptions alone, the quarantine reduced the average time spent in the rash period from 16 days to 2 days. However, inves- 93CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA 0 50 100 150 200 2500 5 10 15 20 25 30 35Incidence curve for 4000 outbreaks of size 32 Time (no. days)Cumulative number of casesAbakaliki Data Figure 2.21: The cumulative number of smallpox cases observed by each day is shown, for 4000 outbreaks of size 32 only. The black curve shows the incidence curve for the true Abakaliki outbreak. tigation of reproduction numbers for the outbreak led to further discoveries about this. 2.8.2 Reproduction Numbers We obtained a posterior mean estimate for R0of 7.96, higher than that found by Eichner and Dietz (2003) of 6.87 and even more so than other estimates for an SIR model where just FTC individuals are considered (see O'Neill and Roberts (1999), who estimate R0around 1). This highlights the high infectivity of smallpox as well as the importance of a detailed model taking population structure into account. Although R0is interpreted as the average number of secondary cases any given infective will cause in a fully susceptible population, in our case this is hard to analogize since the majority of transmission was within-compound and the pool of susceptible individuals in an infected compound depleted rapidly. To further consider the impact of control measures in a more relevant way, 94CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA we considered the reproduction numbers both pre- and post-quarantine pro- cedures being put in place. We obtained an RQ(reproduction number when quarantine measures are in place) value of 1.46; far lower than pre-quarantine but interestingly insufcient alone to stop large scale spread. We concluded that important must also have been the depletion of susceptible individuals within the affected compounds (which had a large proportion of FTC inhabi- tants), and a sub-critical epidemic elsewhere in the population. With respect to contacts between FTC individuals, it appears that the quarantine measures were key in minimising the disease spread, but for compound contacts it was the depletion of susceptible individuals which slowed the epidemic rather than quarantine. Despite this, introducing quarantine procedures at a later day in simulations was found to increase outbreak size somewhat, with av- erage nal sizes 24, 44 and 64 for tq=50, 100 and 200 respectively. With no quarantine procedures at all, we found the average nal size to be 86, high- lighting the sub-critical epidemic in the wider population and the considerable impact of the depletion of susceptible individuals within the compounds. As in Thompson and Foege (1968), we see that small pockets of poorly protected individuals who mix frequently together can facilitate outbreaks of smallpox even in a generally well-protected population. 2.8.3 Model Fit The tests we have performed indicate that the model ts the data fairly well. The model does invariably predict cases outside of the compounds, likely be- cause of the rather unrealistic assumption of homogeneous mixing in the en- tire population, and especially the assumption of homogeneous mixing of non- FTC individuals which there was no data available to inform. Thompson and Foege (1968) stated that the FTC community was largely isolated from the rest of the population with the exception of a few traders, and so a model in which just some fraction of FTC members had contact with the outside community might be more applicable, although more complex and not directly informed 95CHAPTER 2: M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA by any data. Something that might also be useful to consider, although again there is not sufcient data to support this, is the inclusion of age categories. Thompson and Foege (1968) state that there appeared to be a much larger proportion of susceptibles among children, and consequently a higher attack rate. Pre- school children in particular were largely susceptible, as many older children had been vaccinated in school despite their parents' beliefs. Even with avail- able data, however, it seems probable that a model accounting for age of the individual would be over-parameterised. 2.8.4 Accuracy of the Eichner and Dietz Likelihood Approxi- mation As we have seen, the results of our full Bayesian analysis are fairly similar to those of Eichner and Dietz (2003), indicating that their approximation method may be of use in other situations. Investigation of the Eichner and Dietz method reveals that the likelihood func- tion obtained is numerically but not analytically tractable, specically since it involves integrals which must be numerically evaluated. Although this suf- ces for maximum likelihood methods, as used by Eichner and Dietz for the Abakaliki outbreak, it is prohibitive for use within MCMC algorithms as the likelihood must be repeatedly evaluated at large computational cost. We also note that the distributions for the length of time in each disease stage used here have relatively small variances, meaning that the model is closely comparable to one in which the event times are assumed known. In this case, Eichner and Dietz's method provides the true likelihood since the distributions used to approximate unknown event times collapse to point masses around the true values. It is of interest, therefore, to develop approximate likelihood functions which are both useful for non-constant infectious periods and which are ana- lytically tractable. M ODELLING AND BAYESIAN INFERENCE FOR THE ABAKALIKI SMALLPOX DATA 2.9 Conclusions In this chapter we have completed a full Bayesian analysis of the Abakaliki smallpox data, and compared the results of this to those of Eichner and Dietz (2003). The parameter estimates found highlight the dominance of within- compound smallpox transmission as well as the impact on the end of the out- break of susceptible depletion within the compounds, rather than quarantine procedures alone. Novel results include estimates of the transmission path- way as well as analysis of the uncertainty around exposure times, and model checking has conrmed that the model ts well. Overall, we have seen that our parameter estimates are very similar to those of Eichner and Dietz. This indicates that analytically tractable approximate likelihood functions are of in- terest to investigate, in particular for situations where current methods strug- gle such as large populations and multi-level mixing. 97CHAPTER 3 Likelihood Approximation Methods 3.1 Introduction and Motivation As our investigation in Chapter 2 has shown, inference for disease outbreak data often deals with complex models and large amounts of missing data, re- quiring problem-specic analysis and computation. Although MCMC meth- ods have become considered somewhat the 'gold standard' for analysis of this kind of data, there are many problems associated with this (see e.g. De An- gelis et al., 2015, O'Neill, 2010, and references therein). Specically, there are issues with data dependency as well as more realistic models leading to more difcult analysis, especially in terms of computational burden. In this chap- ter, we begin by exploring a number of these problems, and then suggest new methodology which seeks to address them. A primary problem with the analysis of infectious disease data is that these data may be highly dependent. MCMC algorithms which require imputation of large amounts of missing data then often mix very slowly. Details of this are discussed in Kypraios (2007), where high posterior correlations between the infection times and the infectious period parameter are shown. Speci- cally, as the outbreak size period parameter g(assum- 98CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS ing exponential infectious periods for ease) and the sum of the infectious pe- riods B=\u00e5n j=1(rj\u0000ij)become more highly correlated a posteriori . our parameters of interest, a two-state Gibbs sampler may suffer mixing problems due to this dependency (see e.g. Roberts and Sahu, 1997). It be- comes increasingly difcult to update gand Bseparately, since one essentially determines the other. This is complicated even further by our DA-MCMC al- gorithm, which may only update a subset of the infection times per iteration rather than the whole sum B. To understand why this high correlation occurs, we may consider the full con- ditional distribution of g, as dened in Equation (1.3.10). Assuming a low-rate exponential prior, this full conditional distribution is roughly G(n+1,B). This therefore has variancen+1 B2, which tends to zero as ngoes to innity, since B is of order n. In other words, the larger ngets, the more gis determined by the value of B, and the correlation is stronger. Methods have been devel- oped to combat this problem, such as partially (or completely) non-centered parameterisations (see e.g. Neal and Roberts, 2005) which can lead to faster convergence of the Markov chain by, for example, proposing new infection times when updating grather than performing these independently. How- ever, these are not easily applicable to all MCMC samplers with all models (Papaspiliopoulos et al., 2003). As well as the potential introduction of mixing challenges in the MCMC, large amounts of missing data resulting from large populations/outbreaks require many, possibly costly, evaluations of the likelihood. A large population size also increases the time to calculate this likelihood since it includes a product over individuals, and DA-MCMC hence becomes highly computationally in- tensive. With the increasing ability to easily collect and store large data sets, as well as the growing interconnectedness of communities, there is a rising demand for realistic analyses of large scale outbreaks. Also, particularly in cases of real-time forecasting as is becoming more commonplace, the ability to perform estimation quickly and efciently will be key. These problems are 99CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS hence becoming more signicant, and there is a real need for the development of methodology which might solve them. Options for improving the computational speed of MCMC algorithms do ex- ist, such as the use of parallel computing, but since we require a record of the states visited by the Markov chain this is not particularly straightforward. Other methods (e.g. Rambaut et al., 2008) have partitioned the data and anal- ysed each section independently, but of course this ignores any correlation between the different sections. We hence propose that methods which include the entirety of the data whilst avoiding the need for data augmentation, or indeed MCMC entirely, could become useful tools for analysis. In Chapter 2, one key nding was the relative accuracy of Eichner and Di- etz' approximation method compared to standard MCMC methods, despite the lack of data augmentation. This indicates that the development of likeli- hood approximation methods may be useful for addressing our computational problems. DA-MCMC allows us to sample from the high dimensional proba- bility densities often involved in the analysis of infectious disease data, even though these may not be analytically written down. Conversely, these ap- proximation methods will seek to reduce this dimensionality by eliminating the articial parameters that are the augmented data, so that we may sample from the posterior directly. In this chapter we will introduce a series of likelihood approximations which attempt to tackle the problems we have discussed. The rst will be a gen- eralised version of Eichner and Dietz' method from Chapter 2, and the re- mainder will be a new series of approximation methods based on assuming independence in interactions between pairs of individuals. We name these Pair-Based Likelihood Approximations (PBLA). As we have seen in the pre- vious chapter, the true likelihood in these analyses is equal to the integral over all unknown event times of the augmented likelihood, which is itself a product over all individuals. In assuming that all pairs of individuals make independent contributions to the likelihood, we are essentially able to reduce 100CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS this high dimensional integral to a product of two dimensional integrals, each of which may be analytically calculated. The likelihood expression is then entirely tractable and we may approximately sample from it using standard MCMC, or even simply obtain parameter estimates with maximum likelihood estimation methods. This is similar in spirit to composite likelihood methods (see e.g. Varin et al., 2011 and particularly the pairwise likelihood in Cox and Read, 2004) in that we write the likelihood as a product over constituent parts, but as we will explain more thoroughly in Section 3.4.1, the similarity does not extend much beyond this. These Eichner and Dietz and Pair-Based Likelihood Approximation methods may then be used in situations requiring complex models with many parameters, for large populations and for large amounts of missing data, to combat the computational issues we have discussed. The chapter will proceed as follows. We begin by dening the general model and notation to be used for the likelihoods in this chapter in Section 3.2. The rst approximation, which will be introduced in Section 3.3, will be the gener- alization of Eichner and Dietz' approach from Chapter 2. This framework will be applied to the special cases of exponentially distributed infectious periods (Section 3.3.2) and gamma distributed infectious periods (with only positive integer valued shape parameters) (Section 3.3.3). In Section 3.4 we will then introduce and dene the series of Pair-Based Likelihood Approximations. For each approximation we include the general framework as well as specic cal- culations for given infectious periods. We conclude the chapter with a discus- sion of a numerical drawback of the PBLA method in Section 3.4.10, as well as an extension of the method to SEIR models in Section 3.4.11. 3.2 Model and Likelihood We begin by dening the stochastic epidemic model and basic approximate likelihood structure to be used in this chapter. For simplicity, we will at rst restrict our attention to the SIR model. At 101CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS any given time, every individual in a closed population of size Nwill be in one of three states: susceptible, infected or removed, and individuals will progress through the states in that order. Individuals in the population are labelled 1, 2, . . . , N, and we label the all individuals j=1, 2, . . . , n who become infected (where nis the nal size of the outbreak). For these individuals, ijdenotes their infection time and rjtheir removal time. The un- known initial infective, are unknown, and the data consist of removal times r=frj:j=1, 2, . . . , n, where r1<r2<\u0001\u0001\u0001<rng. Individuals that 1, 2, . . . , nare those who n,n+1, individuals who remain suscepti- ble at the end of the outbreak. Note that we require rj<rj+1strictly for all j=1, 2, . . . , n\u00001, which will be discussed further in Section 3.4.10. The outbreak begins with the infection of the initial infective k, at time ik, and continues until no infectious individuals remain. The infectious periods of different infectives are assumed independent and identically distributed, with probability density (or mass) function fI(\u0001jq), where fIhas parameter vector q. We do not allow for reinfection, so any individual who reaches the removed stage will remain there for the duration of the outbreak. During any individ- uali's infectious period, they will have contact with any other individual jat a time given by the point of a Poisson process of rate bij, where all such Poisson processes are assumed mutually independent. If a contact occurs with a sus- ceptible individual, this results in their immediate infection. Then we dene b=fbij:i,j2f1, 2, . . . Nggas a matrix of these contact rates. This allows for a wide range of possibilities for population structure: homogeneous mixing, multi-level mixing and network structures may all be incorporated. We may then also dene the concept of infectious pressure on any susceptible j, as the sum over all current infectives iofbij. A higher infectious pressure essentially represents an increased probability of individual jbeing infected, since more infectives may have potential contacts with them. 102CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS Augmenting the observed removal times with the unobserved infection times and the identity of the initial infective, as in Chapter 2, we dene the aug- mented likelihood as a product over individuals, but with new notation, as p(i,rjb,q,k,ik) = n \u00d5 j=1 j6=kcjyjfjfI(rj\u0000ij)! fkfI(rk\u0000ik) where of aand b, and hence rk^ij\u0000ik^ijrepresents the total length of time for which there is infectious pressure between individ- uals jand k. This new notation will be of practical use for the introduction of the likelihood approximation methods. Since the infection times and kare unobserved, we obtain the target likelihood by integrating over the infection times and the identity of the initial infective so that p(rjb,q) =Z p(i,rjb,q,k,ik)p(ik,k)didikdk, where we have assumed that ikandkare independent bandqa priori . Next, 103CHAPTER 3: we take expectations over all of the infection times (including ik), which are independent and identically distributed from fI(rj\u0000ijjq). However, it is difcult to evaluate the likelihood in this form using a Monte Carlo scheme, since in order to avoid the likelihood being equal to zero we require cj>0 for all individuals jexcept the initial infective. This means positive infectious pressure on all individuals at the moment they become infective. In practice, a large number of Monte Carlo simulations would lead to 'impossible' out- breaks, i.e. those which are inconsistent with the observed data since there is not a potential infector for all infectees. One way to proceed is to assume independence over j(our rst approxima- hence assuming that each individual's contribution to the likelihood is independent, for instance that the infectious pressure on some individual jwhen they are infected is independent of the infectious pressure on kwhen they are infected. This is not strictly true, since each quantity may be influ- enced by, for example, whether a third individual lwas able to place infec- tious pressure upon each of them. We might expect this approximation to be 104CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS most accurate when the infection times are relatively spread out compared to the length of the infectious periods, since there will be less uncertainty as to which individuals were able to infect others. There are a number of possible ways to make further approximations to the likelihood given in Equation (3.2.4), which we will explore in the remainder of this chapter. The rst will be a generalized version of Eichner and Dietz' method from the Abakaliki data analysis of Chapter 2. 3.3 The Eichner and Dietz Approximation 3.3.1 General Framework In the analysis of the Abakaliki smallpox data in Chapter 2, we compared our results from DA-MCMC to those of Eichner and Dietz (2003), who used a like- lihood approximation to perform maximum likelihood estimation. We found that the results using the true likelihood were very similar to those from the approximation, and this has motivated this chapter which aims to further de- velop these kind of approaches. Here, we will provide a full derivation and description of a generalized Eichner and Dietz (ED) likelihood, restricting our attention to a homogeneously mixing population and SIR model. Under this model, the contact rate between any pair of individuals is given byb N. Al- though Eichner and Dietz did not do this, we also assume that the initial in- fective is the individual whose removal time is rst ( r1) for simplicity. We do not include their infection process in the likelihood since they are assumed to have been infected before the start of the outbreak, though of course they are able to infect others. Considering the likelihood in the format which Eichner and Dietz use, we be- gin by considering the force of infection Lj(t)to which any individual jis exposed at time t. In the SIR case this is equal to the infection rateb Nmul- tiplied by the number of currently infective individuals. With the infection 105CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS times unobserved, the number of infectives at any time is unknown also, and so we incorporate the probability that each individual is infective at a given time. The force of infection is then given by Lj(t) =n \u00e5 k=1 k6=jb NI(rk,t), where I(rk,t)represents the probability that individual k, who is known to be removed at time rk, was infective at time t, and may therefore be expressed as I(rk,t) =1\u0000Zrk tfI(rk\u0000u)du fort<rk, and 0 otherwise. Recall that fI(\u0001jq)represents the probability density (mass) function of the infectious period distribution. Then, the likelihood for any given case jwith removal time rjis given by fI(rj\u0000t)dt. The rst term of infection events, the second exp\u0010 \u0000Rt \u0000\u00a5Lj(u)du\u0011 represents the likelihood of the avoidance of infection and the terms fI(rj\u0000t)provide the densities of the infectious periods, in much the same way as the general likelihood format introduced in Section 1.3.5. Similarly, the likelihood for any non-case jis given by Lnon(j) =exp\u0010 \u0000Z\u00a5 \u0000\u00a5Lj(u)du\u0011 . This is since all non-cases still received infectious pressure from infectives throughout the outbreak, although they were never infected. If u>rn, this integrand will be zero. Recalling that we do not include the infection of the initial infective, the com- bined ED likelihood of all observations is therefore given by pED(rjb,q) = n \u00d5 j=2Lcase(rj)! N \u00d5 j=n+1Lnon(j)! . This may easily be converted to the notation introduced in Section 3.2. Re- calling the quantity cj=\u00e5n k=1 k6=jbkj 1fkinfective Then the quantity Lj(t)is equivalent to E[cj(t)]: the expected infectious pressure acting on individual jat time t. Therefore, pED(rjb,q) to the yjterm from Equation (3.2.1). Eichner and of considering the value of rk^ij\u0000ik^ij(the amount of time there was infectious pressure between kand j) conditional on the value of ij, we integrate over all time uup to ij, considering if kis infective at each time. This may be considered as different ways of building the same quantity. The nal point to note is that, in term Lnon, Eichner and Dietz consider the likelihood contributions from the perspective of the non-infected individuals. As in, the product over all individuals who do not become infected of the infectious pressure that was placed upon them. Under the notation of Section 3.2, we used E[fj]where we considered the likelihood contribution from all infectives failing to infect non-cases instead. However, this is again two ways of expressing the same quantity. 107CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS So rather than writing this expression in terms of fjorLnonwe dene, for any individual product represents the likelihood contribution from infected in- dividuals, and the second product represents the contribution from those who were not infected. The two integrals contained in this likelihood might need to be evaluated numerically, depending on the choice of infectious period. It is important to note that this method is exact for constant infectious periods, but for any other choice of infectious periods it is an approximation, despite this not being explicitly mentioned in Eichner and Dietz (2003). We will now explore the use of this method with both exponential and gamma distributed infectious periods, deriving likelihood expressions in each case. 3.3.2 Exponential Infectious Periods We consider the special case of exponentially distributed infectious periods within the general Eichner and Dietz framework. As before, we use infection 108CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS rateb Nbetween individuals, where now the infectious period is exponentially distributed with rate g, and so has probability density function f(x) =ge\u0000gx, x>0. All other aspects of the model are as dened in Section 3.2. We dene ljas the contribution to the likelihood from any infected individual j(note that avoid evaluation of a large number of integrals, we reverse the order of the end of the outbreak, after which no infectious pressure is applied. This provides an expression for the likelihood contribution from an infective jwhich requires only one integration, although this is not analytically tractable and so must be calculated numerically. Moving on to non-infectives, the probability that any non-infected individual javoids infection is given by rj=e\u0000b N\u00e5n k=1Pk, where Pk=rk\u0000ikdenes the infectious period of infective k. Then the likeli- hood contribution from uninfected period of length1 gfor any infective k, of which there are n. Combining Equations (3.3.2) and (3.3.3), the overall likelihood expression us- ing this approximation method is given by pED(rjb,g) = n i=1 i6=je\u0000g(ri\u0000(t^ri)). As discussed, the the likelihood expression must be computed nu- merically, using a numerical integration technique of choice. In Chapter 4 we will perform a simulation study to assess the accuracy of the Eichner and Di- etz method, for which we will use a simple trapezium rule method since this is found to provide sufciently accurate results when compared with more complex techniques. 3.3.3 Gamma Infectious Periods As we will explore in Chapter 4, the ED method with exponential infectious periods struggles for small outbreaks or those with large numbers of unin- fected individuals, where the method does not appear to perform all that well compared to standard DA-MCMC. Hence, we also consider gamma dis- tributed infectious periods. As the shape parameter increases we would ex- pect the approximation to perform better, since we recall the method is exact for constant infectious periods. We continue with infection rateb Nbetween individuals, but now the infectious periods are gamma distributed with shape mand rate g, and so have proba- bility density function f(x) =gm G(m)xm\u00001e\u0000gx,x>0. We restrict our attention to positive integer valued m, so that the distribution is in fact Erlang. Again, the remainder of the model is dened as in Section 3.2. We begin with the likelihood expression from Equation (3.3.1). Substituting in the probability density function of the gamma distribution, the contribution to 111CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS the likelihood from any infected individual the inner integral and changing the order of sums and integration, we in the form of a gamma cumulative dis- tribution function (CDF) Fa,b(y), where a=p+1 and b=1, evaluated a\u00151, Fa,b(y) =1\u0000e\u0000bya\u00001 \u00e5 q=01 q!(by)q, which may be applied here since ptakes integer values only. Hence, sums have been ordered for computational efciency. As in the exponential case, this integral cannot be analytically evaluated. The likelihood contribution for uninfected individuals is infectious period of lengthm gfor any infective k, of which there are n. The overall likelihood expression with the ED approximation method for gamma 113CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS distributed infectious periods is given by pED(rjb,g) = n \u00d5 the exponential case, the integral in the likelihood must be calculated numerically. We again will use the trapezium rule for this, since more complex methods were found to provide only very limited improvement in accuracy. 3.3.4 Heterogeneous mixing and non-identically distributed infectious periods So far we have focused on populations which are assumed to be homoge- neously mixing and contain only individuals with identically distributed in- fectious periods. However, the Eichner and Dietz approximation method may be extended beyond this. In this section, we will provide likelihood expres- sions for the Eichner and Dietz approximation which allow for a heteroge- neously mixing population, as well as individuals with different infectious period parameters. 114CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS We assume now that the contact rate from any individual jto any individual kis given . . , Ngas the complete set of these contact rates. This allows for a heterogeneously mixing population model with any structure desired. We assume that each infected individual has the same infectious period distribution, but now allowing for different parameters. For example, rj\u0000ij\u0018Exp(gj)orrj\u0000ij\u0018G(mj,gj)for all infected individuals j. We will not repeat the likelihood calculations here since they are very similar to the homogeneous case, but the resulting likelihood expressions are as follows. Exponential Infectious Periods We assume that all infectious individuals jhave infectious pED(rjb,q) = n \u00d5 Infectious Periods For the Gamma case, we assume that all infectious individuals jhave L IKELIHOOD APPROXIMATION METHODS pED(rjb,q) not explore the computational implementation of this ex- tension to the method, the integrals in these likelihoods may be numerically integrated as before and then used, for example, for maximum likelihood esti- mation. 3.3.5 Conclusions We have dened the Eichner and Dietz likelihood approximation for both ex- ponential and gamma infectious periods, with a particular focus on homoge- neously mixing populations with identically distributed infectious periods but also extending the theory to heterogeneously mixing populations with non- identical infectious periods. Chapter 4 will include analysis of the method through simulation studies, and we will nd that the method performs fairly well for gamma distributed infectious periods, though less well for exponen- tial periods or outbreaks in large populations with only a very small or very large proportion of infectives. The method also relies on numerical integra- tion as the likelihood expressions cannot be analytically calculated, and this can be relatively slow to compute. Although the ED method would be useful in some situations, it would be benecial to develop further approximation 116CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS methods which are more widely applicable as well as offering an increase in computational speed. 3.4 Pair-Based Likelihood Approximations In this section we develop a series of new approximation methods which seek to avoid numerical integration as well as offer increased performance in a wider range of situations than the Eichner and Dietz method. We term these Pair-Based Likelihood Approximations (PBLA) since they will essentially con- sider the contribution to the likelihood from different pairs of individuals as independent, resulting in an approximate (but tractable) likelihood. These likelihoods will require no data augmentation or numerical integration to cal- culate: MCMC or maximum likelihood estimation may be performed directly, without the need for these further, potentially computationally costly, steps. We will derive the rst PBLA method in Section 3.4.1, which further versions will extend upon. In Section 3.4.2 we will apply PBLA I to exponential infec- tious periods and analytically derive the resulting likelihood expressions, and then in Section 3.4.3 we will do the same for gamma infectious periods. Sec- tion 3.4.4 similarly obtains these likelihood expressions, but using probabilistic arguments which provide more insight to the calculations. We then proceed to dene and derive further PBLA methods which we number accordingly: PBLA II in Section 3.4.5 and PBLA III in Section 3.4.6. Following this, we de- ne two further PBLA versions which offer increased computational speed, but may only be used in more specic situations. Section 3.4.8 describes a PBLA method which uses a central limit theorem to make further approxi- mations to the likelihood, but which requires homogeneous mixing and expo- nentially distributed infectious periods. Section 3.4.9 then describes the PBLA V method, which takes a further step in grouping the infectious pressure be- tween individuals, but will require that the pressure from any individual jto kis equal to the pressure from ktoj. After describing a numerical limitation 117CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS of the PBLA approach in Section 3.4.10, we then describe an extension of the PBLA approach to the SEIR model in Section 3.4.11. Since the PBLA methods as well as the ED approximation involve considerable amounts of notation, refer to Table 3.1 for a summary of this. Some of these quantities have already been dened, and some are to come in the following sections. 3.4.1 PBLA I: General Framework For the PBLA method, we will work again under the general model and like- lihood format dened in Section 3.2. Recall that the population is of size Nwith individuals labelled 1, 2, . . . , nbecome infected where n\u0014N. The contact rate from individual ito individual jis given by bij, contained in band allowing for heterogeneous mixing, and the infectious periods have length with distribution fI(\u0001jq). Infection times . . , n, where r1<r2<\u0001\u0001\u0001<rng, form the data. We work with labelled cases, such that ijand rjare the infection and removal time for individual j, respectively, for all infectives j. We will now derive the PBLA I likelihood expression, beginning with the ap- proximate likelihood we recall that the expectations are with respect to infection times iand ik, with kbeing the initial infective. As in the ED method, we make approximations to this likelihood in order to nd a tractable expression. The rst key assumption is that E[cjyjfj]\u0019E[cjfj]E[yj]. 118CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS Table 3.1: Table of commonly-used notation for the likelihood approximation methods, as used in chapters 3 and 4. Quantity Denition Description cj \u00e5n k=1 k6=jbkj 1fkinfective at of infection of j, evaluated at Bj tkj rk^ij\u0000ik^ijTime when there is infectious pressure from ktoj wjk tjk+tkjTime when there is infectious pressure between jand k, for rk<rj 119CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS Recalling the approximation describes our second key assumption. These assumptions seem most reasonable for infectious periods with low vari- ance, since if the infection times were known the expectations would reduce to known values. As discussed in Section 3.2, we would also expect the ap- proximations to perform better when the appearance of new infectives is rel- atively slow compared the expected length of the infectious periods, since we will have less uncertainty about which individuals placed infectious pressure upon which others. Compared to the ED method, our motivation has been to make additional approximations to the likelihood here, in order to nd an ex- pression which is not just tractable but also does not require numerical integra- tion. In the following sections, we will calculate these likelihood expressions for various models and infectious period distributions. SIR model with homogeneous mixing If we consider instead the simple case of an SIR model in a homogeneously mixing population, we dene k=1p(k)E[fkp(ikjk)] E[ckfk]E[yk], (3.4.4) since this expression no longer requires the calculation of the product term for each possible k, which is the most computationally demanding part. We see that the likelihood is written as an independent product over infectives. As was mentioned in Section 3.1, the PBLA approach is somewhat similar to the method of composite likelihoods, as often used in geostatistics and genet- ics (see e.g. Fronterr\u00e8 et al., 2017 and Larribe and Fearnhead, 2011). This tech- nique involves multiplying together a collection of component or marginal likelihoods to act as an estimator of the true likelihood. Although similar in spirit to PBLA, the methods are in practice quite different. To demonstrate this, we take a simple example with n=3 infectives. We assume knowledge of the initial infective as k=1 (i.e. p(1) = 1,p(2) = p(3) =\u0001\u0001\u0001=0) for simplicity, and set p(i1) = 1fi1<r1g; an improper uniform distribution over the 121CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS region (\u0000\u00a5,r1). Then, the PBLA likelihood will the of our approximation, the pairwise likelihood of Cox and Read (2004) bears the most resemblance to it of the different com- posite methods. The Cox and Read likelihood is written as a double prod- uct over all pairs of observations. For example, for Hence, for the with n=3 to be equivalent to a pairwise composite likelihood, we would need to be able to write it in the form ppair(q;y) =2 \u00d5 j=13 \u00d5 k=2f(yj,yk;q), where each frepresents the contribution to the likelihood for a given pair j,k. Returning to Equation (3.4.5), we see that, despite the outer product over j, the PBLA likelihood involves a sum over different pairs of infectives, and cannot be written as a double product as required. Although the idea of PBLA is 122CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS similar to that of composite likelihoods in breaking down the likelihood into contributions from individual pairs, in practice the two methods are certainly distinct. Returning to the PBLA likelihood calculations, for a given infectious period distribution, we may now explicitly calculate the likelihood, via calculation of E[cjfj]andE[yj]. We will explore the use of exponential and gamma distri- butions for the infectious periods, for which the likelihood expression will be analytically tractable. In terms of the initial infective and their infection time ik, we may select any prior distribution, including the improper distribution used in the previous example. 3.4.2 PBLA I: Likelihood Calculations for Exponential Infec- tious Periods We rst consider the case of exponentially distributed infectious periods, so that fI(rj\u0000ijjg) = ge\u0000g(rj\u0000ij). The likelihood as given in Equation (3.4.3) requires the calculation of two expressions; E[cjfj]andE[yj], details of which we will provide here. 3.4.2.1 ijand ikare independent. Then for a given jand k, this expres- sion will take one of two forms, determined by the values of rkand k6=jE\u0002 e\u0000bkj(rk^ij\u0000ik^ij)\u0003 . Any given will take the form E\u0002 e\u0000bkj(rk^ij\u0000ik^ij)\u0003=Zrk \u0000\u00a5Zrj \u0000\u00a5e\u0000bkj(rk^ij\u0000ik^ij)fI(rk\u0000ik)fI(rj\u0000ij)dijdik. The integral must then again be split into sections, dependent upon the or- dering of rjand rk. In the calculations that follow, we will write bkj=bfor simplicity. Case (i): rk\u0015rj In this case, ikare independent, and will calculate each integral separately. 125CHAPTER 3: L IKELIHOOD APPROXIMATION ijand ikare independent. We will again calcu- late these three integrals individually. (i) The rst integral expressions for E[cjfj]andE[yj]obtained, for any given choice of prior probability mass function p(k)and prior probability density func- tion p(ikjk)it is possible to explicitly calculate the approximate likelihood 128CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS p(rjb,q), Calculations for Gamma Infectious Periods In this section we provide the likelihood expression for the Pair-Based Like- lihood Approximation (version I) with gamma distributed infectious periods. Here, fI(rj\u0000ijjm,g) =gm G(m)(rj\u0000ij)m\u00001e\u0000g(rj\u0000ij). We will restrict shape pa- rameter mto integer values for all of the PBLA versions, so the distribution is in fact Erlang. As in the exponential case, we require expressions for E[cjfj] andE[yj]. Integration arguments may be made in much the same manner as the exponential case, and so we do not provide the full calculations here. These may instead be found in Appendix B. The resulting likelihood kand rate q, i.e. Fk,q(x) =1\u0000k\u00001 \u00e5 l=01 l!(qx)le\u0000qx. The expectation terms, which dene the expectation of a function of a gamma distributed variable, are given by E\u0002(r+X)ljX\u0018G(m,g)\u0003=l Arguments The likelihood expressions obtained in the previous sections can also be ex- plained via probabilistic arguments, which perhaps provide more of an in- tuition as to how the results arise. We will illustrate this here for the case 130CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS of exponentially distributed infectious periods, and similar arguments for the gamma distribution may be found in Appendix B. First, we provide a propo- sition which will be necessary for these arguments. Proposition 3.4.1. Let(W,F,P)be a probability space, for any sample space W, set of eventsFand probability function P. For a random variable X on (W,F,P)and event ofD, meaning E[ 1fAgX] =E[XjA]Z AdP =E[XjA]P(A), as required. Now we may proceed to the probability arguments for the PBLA I method. These arguments essentially work by moving backwards in time from individ- ualj's removal time rj, and considering all possible combinations of events. 131CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS 3.4.4.1 Exponential Infectious Periods Expression one: E[cjfj] We begin with the exponential case and consider the calculation of E[cjfj]. We have found that if we set Bj=\u00e5N l=n+1bjl, as in Equation (3.4.6), then we must calculate E\u0002 1fik<ij<rkge\u0000Bj(rj\u0000ij)\u0003 for all pairs of infectives jand k, Proposition 3.4.1 so that E\u0002 1fik<ij<rkge\u0000Bj(rj\u0000ij)\u0003=E\u0002 e\u0000Bj(rj\u0000ij)jik<ij<rk\u0003 P(ik<ij<rk), and begin with the case rk\u0015rj, which is shown in Figure 3.1. Case (i): rk\u0015rj Firstly, consider the term E\u0002 e\u0000Bj(rj\u0000ij)jik<ij<rk\u0003 . The expression e\u0000Bj(rj\u0000ij) is equal to the probability that there are no points in a Poisson process of rate Bj which runs backwards from time rjtoij. Since ij>ik,ijis the minimum of two independent exponentially distributed periods of rate grunning backwards from rj, and hence is exponentially distributed with rate 2 g. (Recall that we are working backwards in time, so the minimum corresponds to the closest event to rj). The probability that this event takes place before a point in the process of rate Bjis therefore simply2g 2g+Bj. Figure 3.1: Order of events if rk\u0015rj. Secondly, the probability that ik<ij<rk, with rkknown, may be considered in two parts. Firstly, moving backwards in time from rk, we require that rjis the rst event to occur or equivalently that rjoccurs before ik. This is given 132CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS by a Poisson process of rate grunning backwards in time from rktorjwith no points, and hence is of probability e\u0000g(rj\u0000rk). This is followed (still moving backwards in time) by the event ijoccurring before ik. Backwards from rj, the processes governing events ijand ikoccurring are given by two independent Poisson processes of rate g, and hence the probability of either occurring rst is simply1 2. Therefore P(ik<ij<rk) =1 2e\u0000g(rk\u0000rj). Combining these expressions, in Equation (3.4.7). Case (ii): rk<rj The case rk<rjis similar, and shown in Figure 3.2. The calculation of E\u0002 e\u0000Bj(rj\u0000ij)jik<ij<rk\u0003 may be explained as in the case rk\u0015rjexcept that the Poisson process runs backwards from rkrather than rj. The result is the same as in the case rk\u0015rj:E\u0002 e\u0000Bj(rj\u0000ij)jik<ij<rk\u0003=2g 2g+Bj. Figure 3.2: Order of events if rk<rj. The term P(ik<ij<rk)follows much the same reasoning as before, but now also requires no points in the Poisson process of rate Bjrunning backwards between rjand rk. This will have probability e\u0000Bj(rj\u0000rk). Then backwards from rkfollows the same argument as before but with rjand previous calculations in Equation (3.4.11). Expression two: E[yj] Next we consider the calculation E\u0002 e\u0000bkj(rk^ij\u0000ik^ij)\u0003 . For simplicity, we dene tkj=rk^ij\u0000ik^ijas the length of time infectious pressure is applied from ktoj. For ease of exposition, we write bkj=bin the calculations that follow. We begin by conditioning on the values of rjand rkas before. Case (i): rk\u0015rj In this case, tkj=8 >< >:ij\u0000ikifik<ij<rj, 0 otherwise. Then, conditioning on term in the sum individually, applying Proposi- tion 3.4.1 in METHODS where this situation is as displayed in Figure 3.1, except without the Bjprocess. Here, e\u0000b(ij\u0000ik)is equal to the probability of there being no points in a Poisson process of rate bbetween ijand ik. Working backwards from ij, this concerns the event that the Poisson process of rate gleading to ikhas a point before this one of rate b. This is hence of probabilityg g+b. The probability that ik<ij<rj is given in part by the probability that there are no points in a Poisson process of rate gfrom rkback to rj, which is e\u0000g(rk\u0000rj). This is multiplied by1 2, since backwards from rjthe infectious periods for jand kare both governed by Poisson processes of rate g, and so occur with equal probability. Figure 3.3: Order of events if Shown in Figure 3.3, the probability here follows exactly the same reasoning as in (i) and the expectation term collapses to 1. Figure 3.4: Order of events if rk\u0015rj. 135CHAPTER 3: Here simplies to 1. The probability that ij<rj<ik(this ordering of events is shown in Figure 3.4) is equal to one minus the probability of there being no points in a Poisson process of rate gbetween rkand rj, since ikcan occur either before or after rj. Combining the expressions from (i), (ii) and (iii), we obtain an expression equal to that found in Equation may calculate each term in the sum individu- ally. Figure 3.5: Order of events if rk\u0015rj. 136CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS (i) This case e\u0000btkj 1fij<ikg\u0003=E\u0002 e\u0000b(0)jij<ik\u0003 P(ij<ik) to the case rk\u0015rj. The expectation term reduces to 1, and the probability is equal to the probability of no points in a Poisson process of rate gbackwards from rjtork, followed by the equal chance of ijand ik occurring rst before rk. (ii) In this case, which is the same as shown in Figure 3.2 except without the same logic we have seen in previous cases; the expectation equal to the probability that the Poisson process governing ikhas a point before the process of rate b, and the probability the same as in case (i). Figure 3.6: Order of events if rk\u0015rj. (iii) The nal expectation, with timeline shown in Figure 3.6, is equal to E\u0002 METHODS where the expectation term is as before, and the probability is equal to 1 mi- nus the probability of there being no points in the Poisson process of rate g between rjand rk. Combining E\u0002 as in the previous integral calculations, in Equation (3.4.11). 3.4.4.2 Gamma Infectious Periods This same general method can be extended to the case of Gamma distributed infectious periods. Since the arguments are very similar we do not include them here, but they can be found in Appendix B. In the case of exponential infectious periods, our arguments were based upon the fact that the probabil- ity of an event occurring is independent of time. In the gamma case, we use the method of stages to split a G(m,g)time period into mexponentially dis- tributed sections, so that similar arguments may be used. The likelihood ex- pression obtained is equal to that found using integration arguments in Equa- tion (3.4.12). 3.4.5 PBLA II: derived the rst approximation PBLA I in detail, it is possible to fur- ther improve this method both in terms of computational speed and accuracy of estimation. In this section, we provide an alternative format for the likeli- 138CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS hood approximation to improve accuracy. Recall Equation (3.2.2) for the like- lihood, where the infectious separating out cjfjandyjas previ- ously, we rearrange for an Thus a(Bj,q)is the moment generating function of the infectious period of individual jevaluated at Bj, and gjis a probability density function in the sense that it integrates to 1. This amounts to a change of variable in the overall likelihood, and means that it is not necessary to specically calculate fj. 139CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS The i,ikwith probability density function \u00d5n j=1gj(rj\u0000ij). Alongside dening the prior probability mass/density to evaluate Egh \u00d5n j6=kEg[cj]Eg[yj], as before. We would expect PBLA II to outperform PBLA I since the absorption of the fjterms into the expectation means we do not need to evaluate or approxi- mate them. As we will see in sections 3.4.5.1 and 3.4.5.2, the resulting forms of the a(Bj,q)terms are simple and inexpensive to calculate for both expo- nential and gamma infectious periods, so this introduces only little additional computational burden by comparison. We may also again rearrange the likelihood for computational For the cases of exponential and gamma distributed infectious periods, we now describe the functions gj(rj\u0000ij)and a(Bj,q). 3.4.5.1 Exponential Infectious Periods For infectious periods exponentially distributed with rate gand infection rate APPROXIMATION special case of this: for infectious periods exponentially distributed Periods For infectious periods that are gamma distributed with shape m, rate g, and infection rate bkjfrom individual kto individual j, gj(rj\u0000ij)\u0018G(m,g+Bj), a(Bj,q) = g g+Bj!m . Again considering the special case of homogeneous mixing, for gamma dis- tributed infectious periods with shape mand rate g, and infection rateb N, we approximation of Eg[\u00d5j6=kcjyj]in PBLA II, an alternative and improved method to assuming independence between the two terms is to observe the number of 'cases' which must be considered in the calculation. Recall that, in Section 3.4.2.2 for the calculation of E[yj]with ex- ponential infectious periods, we needed to calculate double integrals for all possible values of rk^ij\u0000ik^ij, dependent on the orderings of rk,rj,ikand ij. In combining cjkwith yjkhere, the indicator function reduces the number of these orderings which are than PBLA II, since the cjandyj terms do not need to be assumed independent. We expect the real advantage of this approach will be the increase in computational speed, due to the re- duction of 'cases' to be considered as discussed. We will compare this method to the previous PBLA versions in Section 4.1.3, which will show that PBLA III offers considerable increased accuracy of estimation over PBLA I, but only marginal gains of accuracy over PBLA II. 3.4.7 PBLA III: Full Likelihood Expressions Before dening the next the PBLA method, we summarise this section by pro- viding the full likelihood expressions in the cases of exponential and gamma distributed infectious periods for PBLA III. We introduce a new variable to simplify dj=g+\u00e5N l=n+1bjl, for d=g+b N(N\u0000n)for homogeneous Homogeneous mixing The likelihood expression for the PBLA III likelihood with a homogeneously mixing population may be obtained simply from the PBLA I expressions by replacing gwith din the relevant likelihood components. The resulting likeli- hood is as that form this likelihood depend upon the distribution of the infectious periods as usual. These are given by: Exponential Infectious Periods Eg[yjk] =8 the case of a heterogeneously mixing population, the likelihood expression will be more complex. As dened in Section 3.2, the infection rate between in- dividuals jand kis now given by bjk. Following from this, we note that each expectation is with respect to a pair of infection times ij,ik, now with probabil- ity density functions gjand gkwhich depend on Bjand Bk, respectively. Each individual in the population is now effectively considered to have an infec- tious period with a different distribution. In the exponential case for example, for any pair ij,ikthe density functions will be Exp (dj)and Exp (dk). Although the required likelihood expressions may not be directly taken from the PBLA I calculations, very similar integration arguments may be followed, incorporat- ing these different density functions. 144CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS These likelihoods may also be extended to individuals whose infectious pe- riods have completely distinct parameters, for example rj\u0000ij\u0018Exp(gj)or rj\u0000ij\u0018G(mj,gj)for all jin the population. This is of interest since we do not require that all individuals in the population are modelled with the same infectious period distribution. We may, for example, model different groups (by age, gender, occupation etc.) with different infectious periods, according to their behaviour or characteristics. The overall likelihood expression remains in much the same format, pIII(rjb,q) by: Exponential Infectious this section we seek to make an approximation to the yjterm in the PBLA II likelihood, using moment generating functions and a central limit theorem. The motivation is to improve the speed of the method, making estimation feasible for even larger population sizes. This approximation will only hold for exponentially distributed infectious periods with homogeneous mixing, so we assume in this section that rj\u0000ij\u0018Exp(g)for all individuals j, and set infection rateb N. However, since we will apply this central limit theorem ap- proximation within the framework of PBLA II we apply the usual change of 146CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS variables as explained in Section 3.4.5, so that all expectations are with respect tog(rj\u0000ij)\u0018Exp(d). For simplicity, although all expectations are with re- spect to gin this section, we will not explicitly state this. To begin the derivation, we recall that in the denition of the true likelihood in Equation (3.2.3), we required the calculation of E\"\u0012n \u00d5 j=1 j6=kcjyjfj\u0013 . Rather than Eh \u00d5n j=1 j6=kyji =\u00d5n j=1 j6=kE[yj], and removing the dependency upon kas we will rearrange the likelihood as usual for computational efciency (see Equation (3.4.4)), we in- of a disease outbreak, showing reverse timescale tfor PBLA IV . Note that E\u0002 \u00d5n j=1yj\u0003 is then in the form of a moment generating function for \u00e5n j,k=1 j<kwjk, evaluated at\u0000b N. Therefore, if we can nd the distribution, or an approximation to the distribution, of \u00e5n j,k=1 j<kwjkwe will be able to replace the E\u0002 \u00d5n j=1yj\u0003 term with the corresponding expression for its moment generating function. In order to nd this approximation to the distribution, we rst require the following result: . , Yn\u00001are independent. Proof. To prove this result we work backwards in time, similarly to the proba- bilistic arguments in Section 3.4.4. We dene tas our where t=0 at r+ n(the moment just before rnin reverse time, see Figure 3.7). Then tincreases as we move backwards in time to i1(the 'end' of the outbreak, as after this time no infectious pressure is applied). We consider the reverse in- fectious process as a continuous time Markov process f(S(t),I(t)):t>0g, 148CHAPTER (S,I)!(S,I+1)deterministically, when a known removal event occurs. (3.4.18) The rst transition in Equation 3.4.18 then represents an infection event (since in reverse time this involves an individual moving from infective to suscep- tible), and the second a removal event (in reverse, corresponding to an indi- vidual moving into their infectious period). For example, the rst event which will occur in reverse time is rn, when we move from zero current infectives to one. Notably, we see that the number of susceptibles is not changed at any removal times. We generate infections according to our Markov process at rate dI(t), since ddetermines the length of the infectious period (under the PBLA II framework). We choose who gets 'infected' (i.e. who moves into their sus- ceptible period) uniformly at random from those currently infective. The key aspect here is that we want to count the total number of infectives and suscep- tibles present in the population at all times, moving backwards from the end of the outbreak. The quantity we wish to focus on is \u00e5n j,k=1 j<kwjk=R\u00a5 0S(t)I(t)dt, which is the total amount of infectious pressure applied, over all individuals and over all time. To construct this quantity in reverse time we dene T(t)as the total in- fectious pressure observed up to time t, so that T(t) =Rt 0S(u)I(u)du, and Tincreases at a deterministic rate Then T(E) =\u00e5n j,k=1 j<kwjk, where E=r+ n\u0000i1represents the end of the outbreak under reverse timescale t, after which there are no remaining infectives and hence no infectious pres- sure. Quantity Tis therefore a piecewise, linear, non-decreasing function of t, whose gradient changes are determined by the transitions of the Markov pro- cessf(S(t),I(t)):t>0g. The whole process will stop when S(t) = nati1, after which there will be no more increase in T. Between any two events (whether infections or removals), the process Twill increase at constant rate S(t)I(t), since S(t)and I(t)remain constant between 149CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS Figure 3.8: Timeline showing how total infectious pressure Tis built up, un- der scaled reverse timescale t\u0003. events even as tchanges. Noting that an increase of rate x, say, for ytime units, is equivalent to an increase of rate 1 for xytime units, we now perform a time scaling for t. We instead consider the construction of Tby running time at rate1 I(t)ifI(t)\u00151, and at rate 0 if I(t) =0. Under this new timescale, time effectively stops if the number of infectives is 0. This is desired since no new infections can occur, and we simply wait for the next deterministic removal event to restart counting time. This scaling results in new timescale t\u0003=t I(t). Now Tinstead increases at rate S(t). Since we have already shown that the number of susceptibles is unchanged by removal events, removals therefore also have no effect on the rate of increase of T. In the t\u0003timescale, the Markov process is dened by: (S,I)!(S+1,I\u00001)at rate difI(t\u0003)\u00151. Quantity Tis then formed by a series of stages wherein Tis increasing at rate S(t), for S(t)increasing by one at rate d. This occurs for n\u00001 infection events at times ij(when we get to nsusceptibles at i1, no infectious pressure is being placed, as previously discussed). Tis then the sum of a series of independent random exponential lengths of time, with rates d,d 2and so on, up tod n\u00001. Fig- ure are independent but non-identically dis- tributed, Theorem 3.4.2 may then be applied alongside the following central limit theorem, in order to approximate the E\u0002 \u00d5n j=1yj\u0003 term with a moment generating IKELIHOOD APPROXIMATION j<kwjk\u0000mn! converges in we use the following result, Theorem 2.1 in Barbour and Eagleson (1985): Lemma 3.4.4. in distribution as n !\u00a5to the standard normal distribution if 1.E\u0002jXjkj3\u0003<\u00a5for all n and the requirements of this lemma. For infectives jand k, pairs (j,k)are always 2-subsets of f1, 2, ..., ng. Hence, if we are able to show that f(wjk)has zero mean, nite variance s2and s\u00e5n j,k=1 j<kf(wjk)can be approximated by a standard normal distribution, and we may approximate E\u0002 \u00d5n j=1yj\u0003 with a normal mo- ment generating function. 151CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS By applying Theorem 3.4.2 with n=2, we know that wjk\u0018Exp(d). Therefore, using E[wjk] =1 d Var(wjk) =1 d2. Setting Xjk=wjk\u0000E\u0002 wjk\u0003=wjk\u00001 d, we then obtain a random variable with zero mean and nite variance. Let us next explore the necessary requirements of lemma (3.4.4). 1. Firstly, E\u0002jXjkj3\u0003=E\u0002jwjk\u00001 dj3\u0003<\u00a5since the rst term in Equation (3.4.19) into three sections based on the number of indices in common, so in Equation (3.4.20) for which there are two indices in common, i.e. i=kand j=l. There are (n 2)possibilities for 152CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS this, where each term takes the form of a second moment of an exponentially distributed variable with parameter d. terms in Equation (3.4.20) which have no indices in common. There are 3 (n 4)terms in this sum, where each rep- resents the expectation of two independent exponentially distributed variables parameter d. Hence, the terms in Equation (3.4.20) which have 1 index in common. We nd these slightly differently than the previous two cases, by grouping together all triplets of expectations with the same indices (i.e.E[w12w13],E[w12w23]andE[w13w23]). There will be (n 3)sets of such triplets. For each, with i<j<kwithout loss of generality, we seek E[wijwik] + E[wijwjk] +E[wikwjk] d2, and hence we obtain an expression for the second term of Equation (3.4.20), \u00e5n i,j,l=1 i6=j,i6=lE[wijwil] =4 d2(n n\u00003 is the number of pairs (k,l)where at least one of kand lis the same as iorj. Then, the terms inside the i,jsum are (n 2)choices for this pair (i,j). Now, s3=O(n6)from Equation (3.4.22), and (n 2)(2n\u00003)2=O(n4).Ais independent of n, so overall, e0 n= O(n\u00002) \u0000\u0000\u0000!n!\u00a50. We have therefore met all of 3.4.4, which implies that1 s\u00e5n j,k=1 j<kXjkd\u0000 !N(1, the distribution of \u00e5n j,k=1 j<kwjkasn!\u00a5. In order to implement this result, we must specically calculate the mean and variance of \u00e5n j,k=1 j<kwjk. These may be easily obtained APPROXIMATION METHODS Therefore, to implement the PBLA IV method we must replace the expression forE\u0002 \u00d5n j=1yj\u0003 with the moment generating function of a normal distribution, so that method does not involve the calculation of many sums over infec- tives, which are computationally intensive for large outbreaks, it provides a useful approximation for use under large outbreak sizes. However, it is cer- tainly more specic in its requirements, only having been derived for exponen- tial infectious periods and requiring large n. There is potential for the method to be extended to gamma distributed infectious periods, but the calculations are far more complex and we do not pursue them here. We will compare this central limit theorem approximation to the earlier PBLA versions in Chapter 4, but rst we dene our fth and nal PBLA method. 3.4.9 PBLA V We now consider an alternative expression for E[\u00d5j6=kcjyj]within the PBLA II framework. Under the previous PBLA methods, we would consider the infec- tious pressure from any individual jto any individual kindependently to the pressure from ktoj, despite one of these two quantities being necessarily zero (as one individual must have been infected before the other). Here we derive an expression which considers these two pairs together, hopefully resulting in improved approximation. Again, all expectations in this section are with respect to density function gj(rj\u0000ij)since we are in the PBLA II framework. This method will be applicable for both homogeneous and heterogeneous mix- ing, though we will require that bkj=bjkfor all kand j. 156CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS To begin, as before we split the expectation into two parts so the inner sum into cases, depending on if k=k, so up the pressure from jtokand from ktoj, without loss of generality setting k<j. Note that it is this last step which requires bkj=bjk. Splitting up the exponential in Equation (3.4.23), calculated, depending on the distribution of the in- fectious periods as usual. 157CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS 3.4.9.1 Homogeneous mixing Exponential Infectious Periods If we assume that the infectious periods are exponentially distributed and the population mixes homogeneously, the expectations in Equation (3.4.24) are simple to calculate. Using Theorem 3.4.2 and recalling that tkj+tjk=wjk for exponential infectious periods, it is known that tkj+tjk\u0018Exp(d)(since we are working within the framework of PBLA II including the change of vari- ables). It is also simple to show that tkj\u0018Exp(d), similarly. Therefore, both of the expectations in the expressions for E\u0002 \u00d5j6=kyj\u0003 take the form of moment generating functions for an exponentially distributed variable with mean d. Eh exp\u0000\u0000b N(tkj+tjk)\u0001i =d d+b N Eh 2 , are (n\u00001 2)terms in the product over kand j, and n\u00001 terms in the product over j6=k. Gamma Infectious Periods In the case of gamma distributed infectious periods and a homogeneously mixing population, the previous arguments using moment generating func- tions cannot be applied since we have no equivalent expression for the dis- tribution of wjk. However, we can still calculate the expectations in Equation 158CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS (3.4.24) using the same method as in Recall of these expectations may be explicitly calculated, either through direct integration or probability type arguments as before. Recombining these, we are able to obtain the expression E[e\u0000b N(tkj+tjk)] = expression for the kterms may be calculated similarly, and both substi- tuted into Equation (3.4.24). Although this form is not as simple as in the exponential case, it is still independent of the infection times and may be com- puted with relative speed. 3.4.9.2 Heterogeneous mixing As in the PBLA III calculations, these expressions may be extended to hetero- geneously mixing populations. We will not include these calculations as they follow much the same format as in previous sections, but the resulting expres- sions are as follows: 159CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS Exponential Infectious Periods For exponentially distributed Periods For such that rj\u0000ij\u0018G(mj,dj)forj= equivalent expressions may be obtained for the terms involving the initial infective. However, it is worthwhile to note that, in reality, when we calculate these quantities we make a small additional approximation in not considering the contribution of the initial infective to be different than that of any other infective. 3.4.9.3 Comparison with PBLA III Since PBLA V calculates the pressure from individual jto individual kcom- bined with the pressure from individual kto individual j, rather than assum- ing these are independent quantities, we would expect it to outperform the 160CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS previous PBLA versions. In practice, however, numerical investigation in Sec- tion 4.1.3 will reveal that the PBLA V method does not offer much improve- ment over PBLA III. Considering the homogenous mixing case, the only dif- ference is in the E[yjk]term. We recall under PBLA III that this is given by E[e\u0000btjk]E[e\u0000btkj]and under PBLA V is given by E[e\u0000b(tjk+tkj)]. In the expo- nential infectious periods case, for a given pair of individuals j,k, we set rj<rk without loss N(tjk+tkj)] =d b N+d, so the difference between these two quantities is given by b N 2(b N+d)e\u0000d(rk\u0000rj)\u0000b Nd 2(b N+d)2e\u0000d(rk\u0000rj)\u0000b N2 monotone decreasing function of rk\u0000rj, and hence the maximum occurs when rk=rj. The maximum difference in the expectation for any given pair j,kis therefore1 4\u0010 b N b N+d\u00112 . Under the kind of parameter values that we will explore in this thesis and commonly see in practice, this equates to a maximum difference of around 0.7% between the expectations under each method for pair j,k, a difference so small that it is very unlikely to have any signicant impact on estimation. 3.4.10 Equal Removal Times Recall that in our initial denition of the model in Section 3.2, we required that all removal times are ordered such that r1<r2<\u0001\u0001\u0001<rn; each much be strictly greater than the previous. The exact likelihood will be 0 if any removal times are equal, since in continuous time no two removal times will be the same with probability 1 . In terms of PBLA, it can be found that the method fails to work well when there are equal removal times within the data, i.e. 161CHAPTER 3: L IKELIHOOD . , n):rj=rk. In this section we demonstrate how this issue arises. Take a simple example with three infectives. We dene r= (1, 2,x)and as- sume a pairs of individuals, with exponentially dis- tributed infectious periods with mean g. We will explore the effect on the PBLA III likelihood as xvaries from below, to equal to, to greater than r2=2. First, Figure 3.9 displays the (b,g)likelihood surface over a range of values ofx, for a population size of 10. We see that as xapproaches r2=2 from both above and below, the maximum point on the contour increases in both thebandgdirections. If we plot the x=2 surface for increasingly large (b,g) values, we see that the maximum tends off towards (\u00a5,\u00a5). To demonstrate the specics of the likelihood calculation, we continue to focus on PBLA III with exponentially distributed infectious periods (the arguments being similar for other PBLA versions and for gamma infectious periods), as well as homogeneous mixing. Recall that the likelihood under this method is simplicity, we must consider expressions Eg[yjk]andEg[ 1fik<ij<rkgyjk], when rk=rj. For a given where d=g+\u00e5N l=n+1bjlwas obtained from the change of variables in PBLA II. 162CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS -35-30-25-20-15-10 5 10 15 205101520Beta-gamma likelihood surface, for x = 1.5 bg -35-30-25-20-15-10 5 10 15 205101520Beta-gamma likelihood surface, for x = 2.5 bg -18-16-14-12-10-8 5 10 15 205101520Beta-gamma likelihood surface, for x = 1.8 bg -18-16-14-12-10-8 5 10 15 205101520Beta-gamma likelihood surface, for x = 2.2 bg -16-14-12-10-8-6 5 10 15 205101520Beta-gamma likelihood surface, for x = 1.9 bg -16-14-12-10-8-6 5 10 15 205101520Beta-gamma likelihood surface, for x = 2.1 bg -12-10-8-6-4-2 5 10 15 205101520Beta-gamma likelihood surface, for x = 2 bg Figure 3.9: Likelihood surfaces for band gunder approxima- where r= (1, 2,x)and xvaries. This demonstrates the im- pact on estimation of equal removal times. N=10 in all cases. 163CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS If we set equal removal times rk=rj, our expression reduces to E[yjk] =1\u0000b N 2(b N+d)=2d+b N 2(d+b N). This is clearly bounded by 0 and 1, as we would expect for a probability. As g andbtend to innity the expression tends to 0, as we would hope for in this likelihood. Therefore, the E[yj]section of the likelihood behaves appropriately asrk\u0000rj\u0000 !0. Consider next rj=rk, E\u0002 1fik<ij<rkgyjk\u0003=d combined relevant likelihood term for pair j,ksuch that rk=rj, recalling that a(Bj,q) =g d, N. Then as b!\u00a5andg!\u00a5, so will d!\u00a5. Hence our entire likelihood expression will tend to innity as both bandgdo. This is in agreement with what have seen in the three removal example in Figure 3.9, and demonstrates why the PBLA method may not be used with equal removal times. Fortunately, in practice it sufces to slightly jitter equal removal times in order to perform the approximation. For any pair j,ksuch that rj=rk, we simply set rk=rk+efor some small eof much lower order of magnitude than the removal times. This avoids the problem of equal removal times without changing the data any impactful amount, and may be extended to any larger number of equal removals, for example for daily or weekly collected data. 164CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS 3.4.11 Extension to the SEIR model So far in this chapter, our analysis has focused on application of approximation methods to only the SIR model. However, it is possible to extend the PBLA methods for use with an SEIR model. We conclude this chapter with a brief exploration of this, and the next chapter will also include an application in Section 4.3. We dene the SEIR model similarly to the SIR case: at any given time, every individual in the closed population of size Nwill be in one of four states: susceptible, exposed, infectious or removed. During an individual's exposed period, they are infected but not yet infectious. Then, for j=1, 2, . . . , n,ej denotes the time exposure of individual j,ijdenotes their infection time, and rjtheir removal time. The exposure 2, . . . , ngare unknown, and the data still ordered removal times r=frj:j=1, 2, . . . , n, where r1<r2<\u0001\u0001\u0001<rng. The outbreak begins with the infection of the initial infective k, at time ik, and continues until no infectious individuals remain. We do not allow for reinfec- tion. During any individual i's infectious stage, they will have contact with any other individual jat times given by the points of a Poisson process of rate bij, where all such Poisson processes are assumed mutually independent. Any contact with a susceptible individual results in their immediate infection. Then b=fbij:i,j2f1, 2, . . . Nggprovides a matrix of these contact rates, which may again be dened to incorporate a wide range of population structures. For a given outbreak of any disease, the infectious periods will have proba- bility density (or mass) function fI(\u0001jqI), where fIhas parameter vector qI. We must also now dene the lengths of the exposed periods, which we state as having probability density (or mass) function fE(\u0001jqE). First, however, we will restrict our attention to xed length exposed periods. 165CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS 3.4.11.1 Fixed length exposed periods For both exponential and gamma infectious periods, it is possible to revisit all of the PBLA calculations using an SEIR model with xed length exposed periods. The integrals may all be similarly calculated to achieve expressions forE[cj],E[yj]etc. However, we may bypass these by noting some key facts about the way the exposed period will affect our arguments. Take, for example, E[yj]. Recall that this represents the expected probability that individual javoids infection until the time they become infected, now ej. Hence, E[yj]\u0019n \u00d5 k=1 k6=jE[exp\u0000\u0000bkj(rk^ej\u0000ik^ej)\u0001]. However, with xed length infectious periods, say of length c, we may state that ej=ij\u0000c, for j21, k=1 k6=jE[exp\u0000\u0000bkj(rk^(ij\u0000c)\u0000ik^(ij\u0000c))\u0001]. All of the integration arguments will therefore be the same as in the SIR case, but with ijshifted by ctime units. This will result in the same nal expres- sions as before, but with rjreplaced with rj\u0000c. Interpretively, the probability arguments relating the time some infective kputs infectious pressure on j, for instance, will still apply, but will be shifted ctime units earlier to represent the infection of jatejrather than ij. We use this to write down the likelihood expressions for both exponential and gamma distributed infectious periods directly. Likelihood expressions for xed length exposed periods As with the SIR model, for PBLA III the likelihood will be of the required APPROXIMATION periods We may wish to extend the SEIR case to random length exposed periods. We now dene cjas the exposed period of individual j, (cj=ij\u0000ej). Then each cj takes a random value from fE(\u0001jqE), and for certain distributions fEit may be possible to obtain a likelihood expression. By taking the expectation over all cjof our likelihood expressions from Section 3.4.11.1, for example, we make similar arguments by conditioning on cj's value, for each individual j. 168CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS For example, for number of xed values, it may be possible to compute this integral directly as a sum. Similarly, if we assume that cj\u0018Exp(r)(i.e. fE(cjjr) =re\u0000rcj), as well as exponential infectious periods, for example, we can also calculate the integral using the expression from Section 3.4.11.1 similar calculations for the other likelihood terms required, depending on the PBLA version used ( E[cjfj]and so on). We note that this resulting expression for E[yjk]is not particularly simple how- ever, and it will be similarly so for the other likelihood terms, unlike the SIR or xed exposed period cases. The expressions with gamma distributed in- fectious and exposure periods prove even more complex. This approach also certainly brings more approximation into the model, and an important ques- tion would be whether this affects the accuracy of the method. 169CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS In reality, however, we will usually choose to x cjto the same value for all j, as in Section 3.4.11.1. With random length exposure periods, we are trying to estimate two quantities ( randg) from one piece of data (the removal time), which is problematic. Further exploration of the random exposure periods approach is certainly possible, but this will be beyond the scope of this work. 3.5 Conclusions In this chapter, we have explored two new likelihood approximation methods for use in infectious disease modelling: the Eichner and Dietz method, as in- troduced in Section 3.3 as a generalisation of that used in Eichner and Dietz (2003), and a new series of PBLA methods, as introduced in Section 3.4. A summary of the different PBLA methods can be found in Table 3.2. A general theme of the approximations has been assuming independence between the interactions of individuals in the population, particularly in the PBLA method which assumes that all pairs of individuals make independent likelihood con- tributions. The overall aim was to obtain approximate likelihood expressions which do not require data augmentation, to avoid issues of correlation in miss- ing data as well as computational issues which occur when using large data sets with DA-MCMC. The ED and PBLA methods may all be used within stan- dard MCMC without data augmentation, since the likelihood expressions are independent of the infection times, or MLEs for the parameters of interest may also be obtained through any choice of optimisation scheme. Explicit likelihood expressions have been derived for all of the approximation methods explored, for both exponential and gamma distributed infectious pe- riods (in all cases where possible). We chose to focus on these distributions since they are widely used within the infectious disease modelling commu- nity and offer simple, interpretable likelihood expressions, but of course it may also be possible to extend the methods to other infectious period distri- butions of choice. As well as deriving the PBLA expressions analytically with 170CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS full integration arguments, we have also provided probabilistic arguments for these (for PBLA I at least, though other PBLA versions may be obtained sim- ilarly). This has hopefully provided further understanding of how the likeli- hood expressions are obtained, and the contextual meaning of the approxima- tions made. We have focused on the application of the approximation methods to the stan- dard SIR model until Section 3.4.11, which discussed their use with SEIR meth- ods. This has really been limited so far to exposure periods of xed length, but there is scope to extend this to random length exposure periods in the future. We also explored another limitation of the PBLA method in Section 3.4.10; that we require all non-equal removal times for the method to approximate well. Although it is possible to avoid this problem by simply jittering removal times slightly, this of course introduces some more approximation to the model in terms of the order in which the removals are jittered. For data sets with large numbers of equal removal times, it is possible that this might have a signicant impact, and so the amount of jittering applied must be carefully considered so as not to impact analysis. We have found that there are a large number of approximations which may be made to the true likelihood to result in a tractable likelihood expression, and a number of these have been explored with the different PBLA versions. We next wish to compare these different versions to explore if any offer accuracy or computational advantages. Although we have theoretically dened our approximation methods, another key issue is of course their practical imple- mentation and performance as compared to existing methods. We will explore these points in Chapter 4, rstly with a series of simulation studies to compare the different methods both with each other and with standard DA-MCMC, and then with application to a number of real-life data sets. 171CHAPTER 3: L IKELIHOOD APPROXIMATION METHODS Table 3.2: Table summarising the PBLA methods and associated assumptions explored in Chapter 3. All PBLA versions follow the initial approx- imation of independence over individuals, as in Equation 3.2.4. Method Description PBLA IThe basic PBLA method. As well as the basic k=1 k6=jE\u0002 e\u0000bkj(rk^ij\u0000ik^ij)\u0003 . PBLA IIApplies a change of variable to the expectations, so they are with respect to i,ik now with probability density function \u00d5n j=1gj(rj\u0000ij). Essentially, all instances ofgin the likelihood are replaced with djfor individual j. This removes the need to calculate the fjterms, as well as the assumptions (in (1) and (2)) associated with this calculation. PBLA IIIBuilds upon PBLA II by combining the expectations of cjandyj, rather than assuming these are independent (2). This simplies the calculations required, and avoids the introduction of unnecessary approximation. PBLA IVOnly applicable for exponential infectious periods and large outbreak sizes, this method extends PBLA II by using a central limit theorem to form an approximation to the yjterms. Rather than making assumption (3), we instead assume fact that the sum over all pairs of individuals of the time infectious pressure is placed between them is approximately normally distributed for large n. PBLA VAlso extending PBLA II, this method considers the infectious pressure from any individual jto any other individual kin combination with the pressure from kto j, rather than assuming these are independent. Instead of making assumption (3), this provides an alternative expression for the yjterm such Method Simulation Studies and Applications In Chapter 3 we introduced the generalized Eichner and Dietz (ED) likelihood approximation, as well as the Pair Based Likelihood Approximation (PBLA). This chapter will involve application of these approximation methods, rstly in a series of simulation studies to evaluate the performance of the methods, and then to a variety of real data sets where we compare analysis using the PBLA method to existing published analyses. For easy reference, Table 3.1 provides a summary of the notation used in the likelihood approximations, and a summary of the different PBLA methods can be found in Table 3.2. In Section 4.1 we will assess the likelihood approximation methods through a series of simulation studies. We rst seek to compare the accuracy of the approximation methods, both with each other and with standard DA-MCMC techniques. This will be explored in Section 4.1.1, for both exponential and gamma infectious periods. Section 4.1.2 will then include a more detailed com- parison of the ED and PBLA methods only, using a larger number of simula- tions to more accurately assess their performance and which situations lead to either outperforming the other. In Section 4.1.3 we then use an additional sim- 173CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS ulation study to compare the different PBLA methods as dened in Chapter 3. However, we wish to assess not just the approximation methods' accuracy in parameter estimation, but also their computational speed. This will therefore be explored in Section 4.1.4. Although we use simulated data to compare various versions of the approxi- mation methods, of course it is also of interest to know how likelihood approx- imations perform with real data, compared to existing techniques. In sections 4.2, 4.3 and 4.4 we apply the PBLA method to various real data sets, encom- passing a range of population structures, sizes and models for the infection process. In Section 4.2 we analyse data concerning respiratory disease on the island of Tristan Da Cunha. We investigate how the PBLA method performs with a multi-type SIR model, comparing our estimates to a previous analysis by Hayakawa et al. (2003). Section 4.3 describes analysis of the West African Ebola virus outbreak of 2014. Here, we wish to compare the PBLA method to a previ- ous analysis in Althaus (2014), who used a model featuring a time-dependent infection rate. Although this is not possible in the PBLA framework, we ex- plore a proxy-time-dependence in the form of a heterogeneously mixing pop- ulation where the infection rate is a function of the removal time. We also demonstrate the use of the PBLA method with an SEIR model, and highlight the importance of having data on a completed outbreak for the PBLA approach to approximate the true likelihood well. In Section 4.4 we consider data from the 2001 UK Foot and Mouth livestock epidemic. Here we use a heterogeneous mixing model with a spatial component, where the infection rate between any two farms will depend on the geographical distance between them as well as other covariates. This range of analyses, both using simulated and real data, will highlight the strengths and the weaknesses of the likelihood approximation methods, which we summarise in Section 4.5. 174CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 4.1 Simulation Studies 4.1.1 Comparing ED, PBLA and DA-MCMC To assess the Eichner and Dietz and PBLA methods, we rst perform a simu- lation study comparing both to DA-MCMC, as this represents a gold standard for Bayesian analyses. We therefore compare the parameter estimates from the ED and PBLA methods to those from DA-MCMC, rather than to the true values the outbreaks were simulated from. For both exponential and gamma distributed infectious periods, we simulate 12 outbreaks under a variety of parameter values and population sizes, and perform parameter estimation for each using DA-MCMC, and MCMC with the ED and PBLA likelihoods. We compare the resulting parameter estimates to evaluate the likelihood approx- imation methods, found in Section 4.1.1.1 for the exponential case and 4.1.1.2 for the gamma case. 4.1.1.1 Exponentially Distributed Infectious Periods For the homogeneously mixing SIR model with exponentially distributed in- fectious periods, we will now apply the ED and PBLA methods to 12 simu- lated data sets of varying population and nal sizes. We compare the ability of the approximations to recover the true parameter values against standard DA-MCMC. Each data set is a simulated outbreak from the given parameters, where in each simulation we start with one initial infective. For any simulations of nal size 1, we discard and re-simulate. For analysis, we use MCMC with both the ED and PBLA likelihoods, as well as performing standard DA-MCMC. For the ED likelihood, the integral involved in the calculation of the likelihood (as given in Equation (3.3.4)) must be computed numerically. In this study we use a simple trapezium rule method for this, which was found to provide suf- 175CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS ciently accurate results when compared with more complex techniques. We set the lower limit of the integral to signicantly less than the expected value of the initial infection time. Since this time is when infectious pressure begins to be applied, we can hence be condent that our numerical integration region is capturing the entire epidemic process. We selected 1000 as the lowest num- ber of trapezia for which increasing this number did not impact the likelihood values at the degree of accuracy used in the analysis. All PBLA analysis is performed with the PBLA III method, since this is applicable for both expo- nential and gamma infectious periods and we expect it to perform better than PBLA I or II (we will explore this further in Section 4.1.3). For all MCMC anal- yses we take 10,000 samples after an initial burn-in period of 500. We perform Gaussian random walk updates for ED and PBLA, where the variances of the proposed parameter values have been tuned to result in a well-mixing chain. We use independent low rate (10\u00004) exponential priors for the parameters b andg. The results of the simulation study, ordered by population size, are given in Table 4.1. These consist of posterior medians for infection rate band removal rateg, under each method. Table 4.2 contains the corresponding results for the estimation of R0. As we can see from Table 4.1, prediction using ED and PBLA with exponential infectious periods is much more similar to DA-MCMC for some data sets than others. Generally, the ED approximation estimates are much less similar to DA-MCMC than the PBLA estimates. This is especially true for smaller out- breaks such as simulation 2, where the ED estimates are almost double those from DA-MCMC. PBLA, however, has obtained relatively similar estimates to DA-MCMC in this case. Both methods seem to consistently overestimate both band g, but in almost all cases we see that PBLA offers estimates closer to DA-MCMC than ED. Both methods do seem to struggle when the proportion of infectives is high. We will discuss this further in Section 4.1.2, but we see here that for simula- 176CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Table 4.1: Estimates of infection rate band removal rate gfor 12 simulated data sets using standard DA-MCMC, the ED approximation and PBLA, for an SIR model with exponential 10 and 12 (where the proportion of infectives is highest), the esti- mates are most dissimilar to DA-MCMC. This is also true for ED with very small outbreaks, though we see PBLA estimates well in these situations, such as simulation 2. In practice, we will less often be concerned with very small outbreaks, but further consideration why the methods struggle for larger out- breaks would be of use and will follow in Section 4.1.2. We lastly note that the population size does not appear to have a signicant impact on estimation, just the proportion of infectives within it. In terms of R0, Table 4.2 shows that the ED and PBLA methods are both much better able to estimate R0than band gindividually. Both no longer consis- tently overestimate, with estimates generally very similar to those obtained with standard MCMC. It seems that both approximation methods are unable to estimate band gwell in all cases for exponential infectious periods, but are able to maintain their ratio to result in a reasonable R0estimate. In cases 177CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Table 4.2: For the 12 simulated data sets in Table 4.1, this table includes the estimates of R0using standard DA-MCMC, the ED approximation and PBLA only R0is of interest rather than the individual infection and removal rates, this highlights that the approximation methods might be especially of use. 4.1.1.2 Gamma Distributed Infectious Periods We test the approximation methods with gamma distributed infectious peri- ods in the same way as the exponential case. To ensure the analysis is com- parative across the two methods, we simulate 12 data sets with the same R0 values and population sizes as the exponential data sets. We set shape param- eter m=5, keeping bthe same as the exponential outbreaks and setting gto keep R0constant. As in the exponential case, we will use the trapezium rule to compute the numerical integral in the ED likelihood (with the number of trapezia set to 1000 and the lower limit of the integral signicantly less than the expected value of the initial infection time), and use version III of PBLA. 178CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Table 4.3: Estimates of infection rate band removal rate gfor 12 simulated data sets using standard DA-MCMC, the ED approximation and PBLA, for an SIR model with exponential infectious periods. Shape parameter m=5 all MCMC algorithms, we take 10,000 samples after an initial burn- in period of 500, and for ED and PBLA we perform Gaussian random walk updates with low rate (10\u00004) exponential priors for bandg. The results of this are given in Table 4.3, again ordered by population size. The posterior medians obtained from DA-MCMC may be compared to the posterior medians from MCMC with the ED and PBLA likelihoods. We also give the results of R0estimation in Table 4.4. Table 4.3 shows that, in the case of gamma distributed infectious periods, both ED and PBLA generally estimate the parameters much more closely compared to DA-MCMC than in the exponential case. PBLA, however, continues to of- fer closer estimates to DA-MCMC than ED in almost all cases. Again, this is especially true for smaller outbreaks such as simulations 4 and 12, where the PBLA estimates are similar to DA-MCMC but the ED estimates are con- 179CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS siderably larger. The results in Table 4.3 suggest, as in the exponential case, that the total population size does not impact the accuracy of estimation of the approximation methods, but rather the proportion of infectives. In terms of cases where the proportion of infectives is high such as simula- tions 3, 7 and 10, both PBLA and ED estimates are far closer to those from DA-MCMC than in the exponential case. We also no longer see consistent overestimation of the parameters, and again PBLA tends to provide better es- timation than the ED method. Considering Table 4.4 which includes the estimates of R0for the gamma infec- tious period simulations, we see that R0estimation is generally similar when using the approximation methods or DA-MCMC. Again, the ED and PBLA methods are better able to estimate R0than band gindividually. Despite the improvement in bandgestimation as compared to the exponential case, the estimation of R0is interestingly very similar with gamma infectious peri- ods and exponential. Even for very small or large outbreaks, the R0estimates using the approximation methods are very close to those from DA-MCMC, without any consistent over- or under-estimation. 4.1.1.3 Conclusions Overall, from this simulation study we have seen that the PBLA and ED meth- ods perform much more similarly to DA-MCMC for gamma infectious periods than exponential. For very small proportions of infectives, the ED method es- pecially struggles, and for very large proportions of infectives both methods struggle, to obtain similar estimates to DA-MCMC. However, generally for gamma infectious periods with roughly 20 \u000080% of the population infected, both methods (and particularly PBLA) estimate the parameters well. The ba- sic reproduction number R0is also generally estimated well by both methods, under both exponential and gamma distributed infectious periods. We have highlighted that, especially for large outbreaks where DA-MCMC is 180CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Table 4.4: For the 12 simulated data sets in Table 4.3, this table includes the estimates of R0using standard DA-MCMC, the ED approximation and PBLA with exponential infectious periods. IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS particularly cumbersome in terms of both mixing and speed (we will further explore this in Section 4.1.4), and even more so where inference about the re- production number is key, either ED or PBLA may offer a useful alternative. PBLA also seems to offer better estimation than ED overall, though we will explore this further in the following section. Although this section has sufced as an introductory exploration of the per- formance of the approximation methods, it is important to note that in this study we have only simulated one outbreak from each set of parameter val- ues. These outbreaks therefore might not necessarily represent what is typical. In our second study, we will simulate a larger number of outbreaks per set of parameter values, and look at the average performance of the ED and PBLA methods. 4.1.2 A more in-depth study comparing PBLA and the Eichner and Dietz approximation We continue the simulation studies with a more in-depth comparison of the Eichner and Dietz and PBLA III approximations, in order to more clearly demon- strate the differences in performance between them. Although in Section 4.1.1 we compared PBLA and the ED method (to DA-MCMC) for a single simula- tion under different sets of parameter values, here we simulate a large number of outbreaks for each set of values. We present this rst for exponentially dis- tributed infectious periods, and then for gamma. 4.1.2.1 Exponential Infectious Periods Here we describe a comparison of the Eichner and Dietz likelihood approxi- mation and Pair-Based Likelihood Approximation (version III) for exponential infectious periods. A selection of parameter values are chosen, varying the in- fection rate band the removal rate gas well as the population size N, which in turn influence the nal size nand determine the reproduction number R0. We 182CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS choose a wide range of parameter values, to best explore the accuracy of the methods in different situations. For each set of parameter values to be tested we simulate a large number of outbreaks, ranging from 200 to 1000 depend- ing on the computational demands of the population/outbreak size. For each simulation, we then maximise both the ED and PBLA likelihoods. We provide density plots of the distribution of the MLEs obtained from each simulation for comparison of the two methods, and investigate the impact of varying the parameter values. Note that these are not true densities since the MLEs do not exactly represent samples from a probability distribution, but the plots sufce for visualisation purposes. 0 2 4 6 8 10 120.00 0.05 0.10 0.15 0.20 0.25bDensityPBLA E+D 0 2 4 6 8 100.0 0.1 0.2 0.3 0.4 0.5gDensityPBLA E+DBeta and Gamma estimation, for N=100 and 1000 simulations 0.0 0.5 1.0 1.50.0 0.5 1.0 1.5 2.0 2.5bDensityPBLA E+D 0.0 0.5 1.0 1.50 1 2 3 4 5 gDensityPBLA E+DBeta and Gamma estimation, for N=100 and 1000 simulations Figure 4.1: To compare the impact of varying band g, these gures show densities of MLEs from both the ED and PBLA III approximation methods with exponential infectious periods. Data are from 1000 simulations with N=100 and true values b=3,g=2 in the rst plot and b=0.3,g=0.2 in the second. Varying parameters bandgtogether 183CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS To compare varying values of rates bandgwhilst keeping Nand R0constant, we must vary band gwhilst keeping their ratio equal. Figure 4.1 contains density plots of the maximum likelihood estimates for 1000 simulations under two sets of values of bandg. There is no clear difference in estimation per- formance between the two, despite a 10 times reduction in the true values of both bandgbetween the rst and second plots. The accuracy of parameter estimation is not considerably changed; at least as long as population size N remains constant. We see that the PBLA method estimates both parameters much more closely, in both cases. 0 2 4 6 80.0 0.2 0.4 0.6bDensityPBLA E+D 0 1 2 3 40.0 0.4 0.8 1.2gDensityPBLA E+DBeta and Gamma estimation, for N=500 and 500 simulations 0 2 4 6 8 100.0 0.1 0.2 0.3 0.4 bDensityPBLA E+D 0 1 2 3 4 5 60.0 0.2 0.4 0.6 gDensityPBLA E+DBeta and Gamma estimation, for N=40 and 1000 simulations Figure 4.2: To compare the impact of varying N, these gures show densities of MLEs from both the ED and PBLA III approximation methods with exponential infectious periods. Data are from 500 simula- tions with N=500 and 1000 simulations with N=40, respec- tively, where in both the true values are b=1.5,g=1. Varying population size N When we vary the value of Nalone, we nd that this also does not greatly 184CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS affect the estimation of either method. Figure 4.2 shows no signicant differ- ence between the two plots, despite the fact that they use values N=500 and N=40, respectively. The only difference seems to be that for larger Nthere is slightly less variance in the distribution of the MLEs obtained. Again, we see that the PBLA method better estimates both bandg. A different number of simulations has been used in each case due to computational restraints, but this was not found to signicantly impact the analysis. 0 2 4 6 80.0 0.2 0.4 0.6bDensityPBLA E+D 0 1 2 3 40.0 0.4 0.8 1.2gDensityPBLA E+DBeta and Gamma estimation, for N=500 and 500 simulations 0 2 4 6 8 100.0 0.2 0.4 0.6bDensityPBLA E+D 0 2 4 6 80.0 0.1 0.2 0.3 0.4 0.5 0.6gDensityPBLA E+DBeta and Gamma estimation, for N=500 and 500 simulations Figure 4.3: To compare the impact of varying R0, these gures show densities of MLEs from both the ED and PBLA III approximation methods with exponential infectious periods. Data are from 500 simula- tions with N=500, and true values b=1.5,g=1 in the rst plot and b=0.5,g=1 in the second. This leads to R0values of 1.5 and 0.5, respectively. Varying basic reproduction number R0 Recall that reproduction number R0=b grepresents the average number of secondary cases a given infective causes in an entirely susceptible population. 185CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS We see that varying this can have a considerable impact on the efcacy of our approximation methods. In the rst plot in Figure 4.3, the true value of R0is 1.5, leading to an average proportion of 0.5 of the individuals in the population infected. The parameters bandgare set as 1.5 and 1, respectively. We see again that estimation of both parameters is fairly good. The PBLA method performs better than ED. We compare this to the second plot in Figure 4.3, which shows the density of estimates when R0is smaller, at 0.5. We see that estimation for bandgis similarly good to R0=1.5, and for the ED method is improved. It appears that for up to at least half of the population infected, both methods are able to estimate the true parameter values fairly well, with PBLA providing slightly more accurate results. On the other hand, the rst plot in Figure 4.4 shows the density of estimates when R0=3, resulting in an average proportion of 0.95 of individuals be- coming infected. We see much less accuracy in estimation for both methods, with the ED approximation now obtaining the closest results but generally both methods failing to acquire an accurate estimate. This is also seen in the second plot in Figure 4.4 where R0=2 (an average of 77% of individuals in- fected), though here the ED method no longer performs signicantly better. Further testing indicates that the drop in accuracy for both methods occurs gradually as the proportion of infectives increases, from around 0.6, and that neither method is consistently better under these conditions for exponential infectious periods. We will discuss this further with our concluding remarks. Comparing accuracy of R0prediction As well as considering the methods' accuracy in estimating bandg, we may consider the accuracy of R0estimation. This is found to be similar for varying b,gand Nin that there is little impact on accuracy, but again both meth- ods struggle when the true value of R0is large. Figure 4.5 shows densities for the estimates of R0across a large number of simulations when R0=1.5 and R0=3. We see that for R0=1.5, leading to approximately half of the 186CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 0 2 4 6 8 100.0 0.1 0.2 0.3 0.4 0.5bDensityPBLA E+D 0 2 4 6 80.0 0.2 0.4 0.6 0.8gDensityPBLA E+DBeta and Gamma estimation, for N=500 and 200 simulations 0 2 4 6 80.0 0.1 0.2 0.3 0.4 0.5 0.6bDensityPBLA E+D 0 1 2 3 40.0 0.2 0.4 0.6 0.8 1.0gDensityPBLA E+DBeta and Gamma estimation, for N=1000 and 200 simulations Figure 4.4: To further compare the impact of varying R0, these gures show densities of MLEs from both the ED and PBLA III approximation methods with exponential infectious periods. Data are from 200 simulations with N=500 and N=1000, respectively, as well as true values b=3,g=1 in the rst plot and b=2,g=1 in the second. This leads to R0values of 3 and 2. population infected, R0is estimated fairly well by the mean of the MLEs, and particularly by the ED method, though there is some interesting bimodality observed. However when R0is increased to 3, resulting in on average 0.95 of the population infected, the estimation of both methods is considerably worse (perhaps PBLA being slightly more robust to this, though arguably estimation is so poor that this is meaningless). Overall, and despite this, in all cases where estimation is generally good, the ED method is seen to offer slightly improved estimation for R0. Concluding remarks We have found that for both the ED and PBLA methods with exponential in- 187CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 0.5 1.0 1.5 2.0 2.50.0 0.5 1.0 1.5 2.0R0, for N=100 and 1000 simulations R0DensityPBLA E+D 1.5 2.0 2.5 3.0 3.50 5 10 15 20R0, for N=500 and 200 simulations R0DensityPBLA E+D Figure 4.5: To compare R0estimation, these gures show densities of MLEs from both the ED and PBLA III approximation methods with ex- ponential infectious periods. Data are from, respectively, 1000 simulations with N=100, b=1.5 and g=1, and 200 simula- tions with N=500, This leads to R0values of 1.5 and 2.5. fectious periods, varying bandgwhilst maintaining their ratio or varying N does not have a signicant effect on the accuracy of the methods. However, the size of reproduction number R0, does have a big impact on their efcacy. Around half of the population infected appears optimum for both methods, with PBLA consistently outperforming ED. However, when the average pro- portion of infectives increases to above around 0.6, both methods become lim- ited in their efcacy, with estimates far further from their true value. The sit- uation is similar when considering estimation of R0. Both methods seem to perform well except in cases where the proportion of infectives in the popula- tion is very high, in which case the accuracy of estimation rapidly deteriorates. 188CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS In general, the ED approximation appears to estimate R0more closely, though perhaps less so for larger true R0values. PBLA, on the other hand, estimates both bandgmuch more closely than the ED method, and so, for exponential infectious periods at least, may be seen as a considerable improvement. It seems feasible that the limited performance when a large proportion of the population is infected is due to the yterm in the likelihood (recall e.g. Equa- tion (3.2.1) which denes the different likelihood terms), concerning the avoid- ance of infection until an infective's exposure. This term involves the most ap- proximation under both ED and PBLA, and further analysis indicates that as the proportion of infectives varies, E[yj]varies greatly also. Returning to the PBLA I structure for comparison of the different elements of the likelihood, we nd that for outbreaks where around half of the population is infected (R0=1.5) the yterm is of size roughly half of the fterm. As we increase R0, leading to a larger proportion of infectives, yincreases in relation to f. For example, R0=3 yields yfour times larger than f, and R0=5 yields ytwenty times larger than f(for N=100). This implies that as we increase R0, both methods have a higher contribution from more highly approximated terms, and hence poorer estimation would be expected. 4.1.2.2 Gamma Infectious Periods Next we consider a comparison of the likelihood approximation methods for gamma infectious periods, with shape parameter mand rate parameter g. We expect the methods to perform better in this case since as shape parameter m increases, if the mean is xed then the infectious periods become less variable. There is hence less uncertainty in the expectations over pairs of infection times, and so we would expect the approximations to be closer to the truth. Again a range of parameter values are explored, and we simulate here at least 500 out- breaks in each case. We compare the accuracy of the methods by considering density plots of the MLEs obtained. Varying parameters bandgtogether 189CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS First we vary bandgtogether, whilst keeping R0constant. Figure 4.6 displays this for three decreasing sets of bandgvalues, with mxed at 2. We see that, as in the exponential case, a ten and then a hundred times reduction in both b andghas little impact on the accuracy of estimation; there is almost no visible difference between the densities. Both methods perform well here, with no considerable difference between the two in terms of accuracy. Varying population size N Figures 4.7 and 4.8 explore varying N, with xed shape m=2. As in the exponential case, we note that as the total population size increases, the mean estimated values of band gdo not change signicantly, but the variance of these estimates decreases. Even for small values of N, both methods are able to estimate bandgwell (with slight overestimation of g), and PBLA continues to offer very similar estimation to the ED method. We also investigate the impact of varying Non the bias and mean squared error (MSE) of our bandgestimates. Figures 4.9 and 4.10 show the bias and mean squared error, respectively, where we test with shape parameter mequal to 2 and 8. We see that an increase in population size leads to a reduction in both bias and mean squared error. Since the mean squared error is equal to the variance plus the squared bias of an estimate, this agrees with what we noted when investigating the estimates of band gobtained. The PBLA method generally seems to provide less biased estimates of the parameters, with similar mean squared error to the ED method. 190CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS DensityPBLA ED 0510152025300.000.020.040.060.080.10 DensityPBLA EDBeta and Gamma, for N=50 1.0 2.0 3.00.00.20.40.60.81.0 DensityPBLA ED 0.00.51.01.52.02.53.00.00.20.40.60.81.0 DensityPBLA EDBeta and Gamma, simulations 0.300246810 DensityPBLA ED 0.10 0.20 0.300246810 DensityPBLA EDBeta and Gamma, for N=50 and 1000 simulations Figure 4.6: To compare the impact of varying band g, these gures show densities of MLEs from both the ED and PBLA III methods with gamma infectious periods. Data are from 1000 simulations with N=50 and shape m=2 in all cases, where the true values are b=12 and g=10,b=1.2 and g=1, and b=0.12 and g=0.1, respectively. 191CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 0.0 1.0 2.0 3.00.00.10.20.30.40.50.60.7 DensityPBLA ED 0.00.51.01.52.02.53.00.0 0.2 0.4 0.6 DensityPBLA EDBeta and Gamma, for N=15 and 1000 simulations 0.0 1.0 2.0 3.00.00.20.40.60.81.01.21.4 DensityPBLA ED 0.00.51.01.52.02.53.00.00.20.40.60.81.01.21.4 DensityPBLA EDBeta and Gamma, for N=100 and 1000 simulations Figure 4.7: To compare the impact of varying N, these gures show densities of MLEs from both the ED and PBLA III methods with gamma infectious periods. Data are from 1000 simulations with shape m=2,b=1.2 and g=1. In the upper plots N=15 and in the lower plots N=100. 192CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 0.0 1.0 2.0 3.00.0 0.5 1.0 1.5 2.0 DensityPBLA ED 0.00.51.01.52.02.53.00.0 0.5 1.0 1.5 DensityPBLA EDBeta and Gamma, for N=250 and 500 simulations 0.0 1.0 2.0 3.00.00.51.01.52.02.5 DensityPBLA ED 0.00.51.01.52.02.53.00.00.51.01.52.02.5 DensityPBLA EDBeta and Gamma, for N=500 and 500 simulations Figure 4.8: To compare the impact of varying N, these gures show densities of MLEs from both the ED and PBLA III methods with gamma infectious periods. Data are from 500 simulations with shape m= 2,b=1.2 and g=1. In the upper plots N=250 and in the lower plots N=500. 193CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES 01002003004005000.05 0.15 0.25 NBiasPBLA ED 01002003004005000.250.300.350.400.450.50 NBiasPBLA EDEstimated Bias for Beta and Gamma, for varying values of N where m=2 01002003004005000.10 0.00 0.10 0.20 NBiasPBLA ED 01002003004005000.0 0.5 1.0 NBiasPBLA EDEstimated Bias for Beta and Gamma, for varying values of N where m=8 Figure 4.9: These gures show the bias in estimating parameters bandgasN varies, for both the PBLA and ED methods. Shown are estimated values with shape parameter mequal to 2 and 8, where in all cases 1000 outbreaks were simulated. 194CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 01002003004005000.10.20.30.40.5 NMSEPBLA ED 01002003004005000.10.20.30.40.5 NMSEPBLA EDEstimated MSE for Beta and Gamma, for varying values of N where m=2 01002003004005000.100.150.200.250.30 NMSEPBLA ED 0100200300400500234567 NMSEPBLA EDEstimated MSE for Beta and Gamma, for varying values of N where m=8 Figure 4.10: These gures show the mean squared error in estimating param- eters bandgasNvaries, for both the PBLA and ED methods. Shown are estimated values with shape parameter mequal to 2 and 8, where in all cases 1000 outbreaks were simulated. 195CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS DensityPBLA ED 0.00.51.01.52.02.53.00.00.20.40.60.81.0 DensityPBLA EDBeta and ED 01234560.00.10.20.30.4 DensityPBLA DensityPBLA ED 024680.0 0.1 0.2 0.3 DensityPBLA EDBeta and Gamma, for N=50 and 1000 simulations Figure 4.11: To compare the impact of varying m, these gures show densities of MLEs from both the ED and PBLA III methods with gamma infectious periods. Data are from 1000 simulations with N=50 andb=2. In the upper plots the true values are m=g=1, in the middle plots m=g=2 and in the lower plots m=g=3. 196CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND 01234560.00.10.20.30.40.50.60.7 DensityPBLA ED 0 5 10 150.000.050.100.150.200.25 DensityPBLA EDBeta and Gamma, for N=50 and 1000 simulations 01234560.0 0.2 0.4 0.6 DensityPBLA ED 051015200.00 0.05 0.10 0.15 DensityPBLA EDBeta and Gamma, for N=50 and 1000 simulations 01234560.00.10.20.30.40.50.60.7 DensityPBLA ED 0510152025300.00 0.05 0.10 0.15 DensityPBLA EDBeta and Gamma, for N=50 and 1000 simulations Figure 4.12: To compare the impact of varying m, these gures show densities of MLEs from both the ED and PBLA III methods with gamma infectious periods. Data are from 1000 simulations with N=50 andb=2. In the upper plots the true values are m=g=5, in the middle plots m=g=8 and in the lower plots m=g=10. 197CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Varying shape parameter m=g Figures 4.11 and 4.12 display the effect varying shape parameter m, whilst maintaining g=mto keep a constant mean infectious period. We would expect both methods to improve for increased msince the infectious period becomes closer to constant. We see that even for m=2, both methods ap- proximate bandgwell, and almost exactly for m\u00153. Though both methods perform very similarly for larger values of shape m, PBLA offers considerably improved estimation over the ED method for smaller m. As with varying N, we investigate the impact of varying m, for a xed R0, on the bias and mean squared error of our estimates. Figures 4.13 and 4.14 show the estimated bias and mean squared error, respectively, with R0xed to 1.6 and 4. We see that as we increase m(so the infectious periods tend closer to constant), in consequence the bias and mean squared error greatly reduce for both approximation methods. In agreement with what we have seen so far, it seems that moving from m=1 to m=2 provides the largest improvement, especially in the mean squared error, and then larger mvalues do not alter this so greatly. The PBLA and ED methods have very similar bias and mean squared error for larger m, though both are considerably lower with PBLA for smaller values of the shape parameter. Varying basic reproduction number R0 Figures 4.15 and 4.16 show the effect of varying R0on estimation. This is achieved by varying bwhilst keeping all other parameters xed, including xed mean and variance of the infectious period. We see that in the rst plot of Figure 4.15 where only on average 8 out of 80 individuals were infected, both methods estimate bandgwell on average, but with a fairly large vari- ance. In the second plot of Figure 4.15 where the proportion of infectives has increased to almost half, the estimation is still good, but with much lower vari- ance. There is no signicant difference between the performance of the two methods. Then, as we saw in the exponential case, in both plots in Figure 4.16 (where the average number of infectives has increased to 78 and 80 out of 80, 198CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS respectively), the estimation of both bandghas worsened, by both methods fairly equally. Concluding remarks We see a marked improvement in the performance of both approximation methods with gamma distributed infectious periods compared to exponential, even for just shape m=2. In almost all of the examples we have explored, both bandgare estimated very closely, and the PBLA and ED methods perform very similarly. As for exponential infectious periods however, both methods continue to struggle when the proportion of infectives is close to one. Considering the error involved in estimation under both methods, we have seen that larger values of shape parameter mand population size Nlead to lower bias and mean squared error. Since these methods are intended for large populations, this should be benecial. We have seen that the PBLA method offers lower bias and mean squared error than the ED method, especially for lower shape parameter values. In terms of the time taken to run the analysis under both methods, the compu- tational speed is of course affected by the computational parameters chosen. For example, we must choose the number of trapezia to be used in the numer- ical integration for the ED method. For k=1000 trapezia (any larger num- ber having been found not to signicantly increase the accuracy), m=8 and N=100, the PBLA method is roughly four times faster than the ED method. AsNincreases up to 1000, PBLA is still faster though only now by a factor of two. Indeed, for all N\u00151000 tested, the PBLA method remains approximately twice as fast as the ED approach. This highlights the benets of the PBLA method: we have avoided numerical integration and provided an approxima- tion method which is more computationally efcient than the ED method, at no apparent cost of accuracy. We will analyse this more fully in Section 4.1.4. 199CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 2 4 6 8100.00.20.40.60.81.0 mBiasPBLA ED 2 4 6 8100.20.40.60.81.01.2 mBiasPBLA EDEstimated Bias for Beta and Gamma, for varying values of m where R 0=1.6 2 4 6 8100.0 0.5 1.0 1.5 mBiasPBLA ED 2 4 6 8100.5 1.0 1.5 mBiasPBLA EDEstimated Bias for Beta and Gamma, for varying values of m where R 0=4 Figure 4.13: These gures show the bias in estimating parameters bandgas m=gvaries, for both the PBLA and ED methods. Shown are estimated values with R0xed to 1.6 and 4, N=80, and where in all cases 1000 outbreaks were simulated. 200CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 2 4 6 8100.0 0.5 1.0 1.5 mMSEPBLA ED 2 4 6 8100.5 1.0 1.5 2.0 mMSEPBLA EDEstimated MSE for Beta and Gamma, for varying values of m where R 0=1.6 2 4 6 810012345 mMSEPBLA ED 2 4 6 81001234 mMSEPBLA EDEstimated MSE for Beta and Gamma, for varying values of m where R 0=4 Figure 4.14: These gures show the mean squared error in estimating pa- rameters band gasm=gvaries, for both the PBLA and ED methods. Shown are estimated values with R0xed to 1.6 and 4, N=80, and where in all cases 1000 outbreaks were simulated. 201CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 0.00.10.20.30.40 2 4 6 DensityPBLA ED 0.00.51.01.52.02.53.00.00.20.40.60.81.01.2 DensityPBLA EDBeta and ED 0.00.51.01.52.02.53.00.00.20.40.60.81.01.2 DensityPBLA EDBeta and Gamma, for N=80 and 1000 simulations Figure 4.15: To compare the impact of varying R0, these gures show den- sities of MLEs from both the ED and PBLA III methods with gamma infectious periods. Data are from 1000 simulations with N=80 and shape m=5. In the upper plots the true values are b=0.16 and g=1, and in the lower plots b=0.31 and g=1. This leads to R0values of 0.8 and 1.55, respectively, with the av- erage number of infectives in these simulations being 8 and 39. 202CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS DensityPBLA ED 0.00.51.01.52.02.53.00.00.51.01.52.02.5 DensityPBLA EDBeta and ED 0.00.51.01.52.02.53.00.00.51.01.52.02.5 DensityPBLA EDBeta and Gamma, for N=80 and 1000 simulations Figure 4.16: To compare the impact of varying R0, these gures show den- sities of MLEs from both the ED and PBLA III methods with gamma infectious periods. Data are from 1000 simulations with N=80 and shape m=5. In the upper plots the true values are b=0.8 and g=1, and in the lower b=1.5 and g=1. This leads toR0values of 4 and 7.5, respectively, with the average number of infectives in these simulations being 78 and 80. 203CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 4.1.3 A Comparison of PBLA versions The simulation studies in sections 4.1.1 and 4.1.2 have compared the ED and PBLA methods in terms of parameter estimation, and found that, in general, PBLA offers more accurate estimates. However, so far we have only focused on PBLA version III. In this section, we now perform a brief comparison of the different PBLA versions, with both exponential and gamma infectious periods as usual. Similar to the study in Section 4.1.2, we will simulate a large number of outbreaks for a selection of sets of parameter values, and perform parameter estimation using PBLA methods I through V (where applicable). 4.1.3.1 Exponential Infectious Periods Considering exponential infectious periods rst, we simulate 1000 outbreaks for three sets of parameter values with increasing population size N. In all cases, we use true values b=1.5,g=1.0, with N=15, 100 and 250. In each simulation we begin with one initial infective, and we discard and resimulate any simulations of nal size one. Since in this study we are only comparing different versions of PBLA, for which maximum likelihood estimation is ap- plicable, we will perform parameter estimation using the ' optim ' function in R to obtain MLEs. Figure 4.17 includes densities of the estimates of bandgusing PBLA versions I through V , for these increasing values of the population size N. Most of the methods perform similarly when Nis small, but for larger Nthe later PBLA versions offer considerable improvement over PBLA I. We see that a population size of N=15 is perhaps not large enough for the central limit theorem approximation in PBLA IV to hold, since there is bimodality in the density for g. In terms of computational speed, PBLA IV is the fastest version to run, and seems to do so at little cost of accuracy in all but small population sizes. This particularly highlights this method as a strong alternative to DA-MCMC with 204CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 0 2 4 60.0 0.1 0.2 0.3 DensityPBLA I PBLA II and Gamma Estimates, for m=1, N=15 and 1000 simulations 0 2 4 60.00.10.20.30.40.50.6 DensityPBLA II and Gamma Estimates, for m=1, N=100 and 1000 simulations 0 2 4 60.00.20.40.60.8 DensityPBLA PBLA II PBLA III PBLA II PBLA III IV PBLA VBeta and Gamma Estimates, for m=1, N=250 and 1000 simulations Figure 4.17: To compare the different PBLA versions, these gures show den- sities of MLEs for 1000 simulations over a range of population sizes with exponentially distributed infectious periods, where b=1.5 and g=1. Note: PBLA II curve is almost exactly hind PBLA V . 205CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS the true likelihood when computation times are slow, so long as the population size is large enough for the CLT to hold. PBLA II and III, although slower than IV , are more widely applicable since they have no requirement for a large population size. 4.1.3.2 Gamma Infectious Periods Moving on to gamma distributed infectious periods, we again simulate 1000 outbreaks for a series of different parameter values in order to perform param- eter estimation using each of the PBLA versions. Simulation and estimation is performed as in the exponential case. We do not include PBLA IV in this sec- tion, since it is not suitable for gamma infectious periods. For all sets of parameter values tested we nd that PBLA II, III and V perform very similarly, and all offer better estimation than PBLA I. Figures 4.18, 4.19 and 4.20 display densities from 1000 simulations over a range of values for b, g,mand N, under all of which we may make these same conclusions. Note that in these gures, PBLA versions II, III and V are so similar that the curves are almost indistinguishable. As we have seen in the previous simulation studies, all of the PBLA versions somewhat struggle when the proportion of infectives is very large, as in the g estimation in Figure 4.20 where R0=4. This strengthens the proposition in Section 4.1.2.1 that the contribution from non-infective individuals (contained inyterm) is key to the accuracy of the PBLA method, especially since most of the approximation is in the infective-to-infective pressure term. PBLA V provides very similar estimation to PBLA II and III in all the cases we have examined. We might have expected it to perform better since we consider the infectious pressure from any individual jto individual ktogether with the pressure from ktoj, rather than looking at these independently. As discussed in Section 3.4.9.3, it seems that this has little impact however. Re- gardless, PBLA V is considerably faster than PBLA II or III, so similar perfor- 206CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 0.00.51.01.52.02.53.03.50.0 0.5 1.0 1.5 DensityPBLA I PBLA II PBLA III PBLA V 0.00.51.01.52.02.53.00.0 I PBLA II III PBLA VBeta and and Estimates, for m=2, N=500 and 1000 simulations Figure 4.18: To compare the different PBLA versions, these gures show den- sities of MLEs for 1000 simulations with gamma distributed in- fectious periods. Respectively, true b=1.2,g=1 and N=100, andb=1.2,g=1,N=500. In both plots, m=2. Note: PBLA II, III and V are almost exactly aligned. 207CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 0.00.51.01.52.02.53.00.00.20.40.60.81.0 DensityPBLA I PBLA II PBLA III PBLA I PBLA II III PBLA VBeta Estimates, for m=8, N=15 and 1000 simulations 0.00.51.01.52.00.0 0.5 1.0 1.5 DensityPBLA I PBLA II PBLA III PBLA V 0.00.51.01.52.02.53.00.0 I PBLA II III PBLA VBeta and Gamma Estimates, for m=2, N=100 and 1000 simulations Figure 4.19: To compare the different PBLA versions, these gures show den- sities of MLEs for 1000 simulations with gamma distributed in- fectious periods. Respectively, true b=1,g=5,m=8 and N=15, and b=0.8,g=1,N=100 Note: aligned. 208CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 01234560.0 0.5 1.0 1.5 DensityPBLA I PBLA II PBLA III PBLA V 0123450.0 I PBLA II III PBLA VBeta and Gamma Estimates, for m=2, N=100 and 1000 simulations Figure 4.20: To compare the different PBLA versions, this gure shows den- sities of MLEs for 1000 simulations with gamma distributed fectious periods, where b=2,g=1,m=2 and N=100. Note: PBLA II-V are almost exactly aligned. mance means it could still be benecial to implement this version. 4.1.3.3 Conclusion In summary, we have found that, for both exponential and gamma distributed infectious periods, any of PBLA methods II through V offer similar perfor- mance, and improvement over PBLA I. For exponential infectious periods, PBLA IV may be considered a good choice since it offers comparable estima- tion at the lowest computational cost, so long as the population size is not too small. Otherwise, for gamma infectious periods, PBLA III and V provide the fastest computation time and closest estimation. Under the range of parame- ter values tested, each of methods II through V results in estimates close to the true values, though we continue to see these struggle when the proportion of infectives is very large. Future work could include the development of further PBLA versions which work better under these circumstances. 209CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 4.1.4 Computation time So far we have compared the likelihood approximation methods to DA-MCMC in terms of the accuracy of parameter estimation. Although this is of course important, so is the computation time involved. If approximation methods do not offer an improvement over standard DA-MCMC with the true likelihood, then there will of course be less motivation to use them. In this section we perform a comparison of the computation time required for the PBLA method with MCMC, as compared to DA-MCMC. After our ndings in sections 4.1.2 and 4.1.3, that PBLA generally outperforms the ED method and that PBLA III offers a good balance of computation time and wide applicability compared to the other PBLA versions, we will restrict our attention here to PBLA III. 4.1.4.1 Method For this study, we will compare the time taken to obtain MCMC samples using both PBLA III with MCMC and standard DA-MCMC. We simulate a number of outbreaks with increasing population sizes N, using gamma distributed in- fectious periods with shape parameter m=1 (corresponding to exponential infectious periods), m=2 and m=5. In all cases, we set infection rate pa- rameter b=1.5 and removal rate g=m, to result in an R0value of 1.5. We simulate a single outbreak for each of N=20, 50, 100, 200, 500, 1000 and 2000, for each set of (b,g,m)values. We assume one initial infective for each simulation, and re-simulate any outbreaks of nal size one. We then perform parameter estimation for bandgusing PBLA with MCMC and standard DA-MCMC, assuming shape parameter mis xed. We record the time taken to obtain a xed number of samples nsfrom the MCMC algorithms, where all parameters are updated at each iteration of the algorithms. For PBLA this is just bandg, whereas for DA-MCMC we also update all infection times at each iteration. For PBLA we perform random walk updates, with low rate (10\u00004) exponential priors. All analysis is coded in C and performed on the 210CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS same machine. In reality, both methods would require a burn-in period for the Markov chain to move into equilibrium. The choice of initial values of the parameters there- fore impacts the samples obtained. However, since DA-MCMC requires impu- tation of initial infection times but PBLA only requires initial bandgvalues, there is no fair way to compare this burn-in between the two methods. We hence start all algorithms suitably tuned, with the chains already in equilib- rium so that the comparison is fair regardless of the initial values selected. We could perform a simple comparison of the time taken to obtain a xed number of MCMC samples, but as discussed in Section 3.1 a motivating factor in using likelihood approximation methods is the high dependence between the infection times and g, when using DA-MCMC. This may cause slow mix- ing of the Markov chain. We therefore seek some measure of computation time which includes the computational burden involved in obtaining independent samples. Effective sample size (ESS) is one such measure which may be used, and is popular as an MCMC diagnostic (see e.g. Brooks et al. (2011) and Kass et al. (1998)). If we have obtained a number nsof dependent samples from our MCMC, the ESS estimates the number of independent samples that this corre- sponds to (so in a completely independent chain, the ESS is equal to ns). The ESS is dened as ESS=ns 1+2\u00e5\u00a5 k=1r(k), where r(k)is the autocorrelation at lag k. In practice, we truncate the innite sum to the rst lag kwhere r(k+1)<0.05. Therefore, as an overall measure of the speed at which independent samples may be obtained, we compare the Effective sample size per second (ESS s\u00001) of the PBLA MCMC and DA-MCMC algorithms, for both band g. This is dened simply as the ESS divided by the time taken to obtain those samples. 211CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 4.1.4.2 Results Table 4.5 contains the results of this study, for m=1, 2 and 5. For repro- ducibility, we also include the number of samples obtained for each N, and the values used for the tuning parameters sbandsg, which are the variances of the Gaussian proposals for bandg. The number of samples nsdecreases asNincreases due to the greater computational burden of large populations, but since all chains are well-mixed when samples begin being collected this should not be impactful. Highlighted in the table are the lowest Nvalues tested for which PBLA offered a greater ESS s\u00001than DA-MCMC. Plots of the ESS s\u00001against Nare provided in Figures 4.21, 4.22 and 4.23, for m=1, 2 and 5, respectively. These are plotted on a log scale for ease of exposition. As we can see from Table 4.5 as well as Figures 4.21, 4.22 and 4.23, as the population size Nincreases, eventually PBLA will result in a greater ESS per second compared to DA-MCMC. In the case of exponential infectious periods (m=1), PBLA is faster the DA-MCMC even for N=50. As mincreases, only after larger population sizes does it become computationally preferable. This is since the structure of the PBLA III likelihood requires multiple loops over m, and so the larger this is the longer the likelihood takes to compute, compara- tively. The gures suggest that as the population size continues to increase, so does the computational advantage of PBLA compared to DA-MCMC. 4.1.4.3 Discussion As in Section 4.1.1, this computation time study uses only one simulation per set of parameter values, so it may be that some simulations are not entirely representative of the average. Although this is important to note, it is reason- able to suppose that the results give a good overview of the difference in com- putation time between DA-MCMC and PBLA MCMC. Interestingly, we have seen overall in this chapter so far that for larger values of m, the PBLA method offers increased performance in terms of estimation, but does require larger 212CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Table 4.5: Effective sample size per second obtained from DA-MCMC and PBLA MCMC, for a range of population sizes N. Values sbandsg are the variances of the Gaussian proposals 20 16 10000 (783.56, 680.59) 1.0 0.6 (468.18, 42 3000 0.6 83 3000 (4.74, 4.46) 0.8 0.5 (9.46, 9.97,) 200 130 3000 (1.07, 1.03) 0.4 0.1 (3.99, 3.71,) 500 240 3000 (0.109, 0.108) 0.2 0.2 11 10000 (1210.83, 861.07) 1.0 1.0 34 3000 1.0 75 3000 1.0 1.0 (0.89, 200 106 3000 (1.89, 1.70) 0.4 0.4 (0.86, 0.82) 500 193 1000 (0.26, 0.24) 0.1 0.1 (0.15, 0.14) 1000 587 1000 (0.0089, 0.0086) 0.1 0.1 (0.015, 16 10000 (257.91, 142.46) 1.0 1.0 (15.05, 12.77) 50 36 3000 (33.84, 24.34) 2.0 5.0 (1.77, 1.77) 100 70 3000 (5.87, 4.43) 0.5 1.0 (0.59, 0.57) 200 122 1000 (1.52, 1.17) 0.4 1.2 (0.13, 0.13) 500 194 1000 (0.23, 0.20) 0.1 0.5 (0.05, 0.05) 1000 565 1000 (0.00873, 0.00815) 0.1 0.1 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 0 500 1000 1500 2000620246Effective sample size per second for , with m=1 Nlog(ESS s1)PBLA DAMCMC 0 500 1000 1500 for , with m=1 Nlog(ESS s1)PBLA DAMCMC Figure 4.21: Plots of the log effective sample size per second of bandg, ob- tained from PBLA MCMC and DA-MCMC for population size Nand xed shape parameter m=1. Note: the lines are for visualisation purposes, only Nvalues at the marked points were tested. 214CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 0 500 1000 1500 2000620246Effective sample size per second for , with m=2 Nlog(ESS s1)PBLA DAMCMC 0 500 1000 1500 for , with m=2 Nlog(ESS s1)PBLA DAMCMC Figure 4.22: Plots of the log effective sample size per second of bandg, ob- tained from PBLA MCMC and DA-MCMC for population size Nand xed shape parameter m=2. Note: the lines are for visualisation purposes, only Nvalues at the marked points were tested. 215CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 0 500 1000 1500 20006420246Effective sample size per second for , with m=5 Nlog(ESS s1)PBLA DAMCMC 0 500 1000 1500 for , with m=5 Nlog(ESS s1)PBLA DAMCMC Figure 4.23: Plots of the log effective sample size per second of bandg, ob- tained from PBLA MCMC and DA-MCMC for population size Nand xed shape parameter m=5. Note: the lines are for visualisation purposes, only Nvalues at the marked points were tested. 216CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS population sizes to be faster than DA-MCMC. However, since it is large out- breaks which most motivate the use of likelihood approximations, this should not be a problem in practice. We also recall that this comparison has only in- cluded the speed of obtaining samples from an already well-mixed chain. This ignores the time taken to reach equilibrium, for which PBLA should be faster since it does not require updates of the infection times, though as discussed this is difcult to compare. There is potential to increase the speed of the PBLA MCMC algorithm even further with future work. As well as being naturally parallelisable since the likelihood involves computation of the contributions from different pairs of individuals independently, the PBLA likelihood may also be used with max- imum likelihood estimation, removing the need for MCMC altogether. For more details, we will explore an application using maximum likelihood esti- mation in Section 4.3. Even without these potential extensions, we have shown that for the larger population sizes for which PBLA is intended, it offers an im- provement in computational speed compared to DA-MCMC. Combined with the comparable estimation which we have seen in sections 4.1.1 and 4.1.2, there is evidence that PBLA is a useful tool for analysis. 4.2 Applications: Tristan Da Cunha respiratory dis- ease data With the simulation studies complete, we now explore the application of like- lihood approximations to real data. In the three analyses which follow we will use the PBLA III method for approximation, since it offers accurate estimation at relatively low computational cost, as well as being applicable to the widest range of models explored. We begin with a data set from the remote South Atlantic island of Tristan Da Cunha. Known as the most remote inhabited island in the world, and with 217CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS almost zero immigration, Tristan Da Cunha is particularly of interest since the population is actually approximately closed. Its remoteness means that epidemics are almost always introduced from an external source such as the arrival of ships (Shibli et al., 1971), with the population too small to reason- ably allow for reinfection. From 1963 to 1968, medical ofcers continually studied respiratory infections on the island in detail. These data have been analysed several times, including Hammond and Tyrrell (1971), Shibli et al. (1971), Becker and Hopper (1983), Hayakawa et al. (2003) and Xu et al. (2016). There were seven major outbreaks during the study period, but we focus on a particular outbreak from 1967, modelling the population with three types of individuals as categorised by age, and comparing our results to Hayakawa et al. (2003). 4.2.1 Data and Model 4.2.1.1 Data Between October and November of 1967, 40 of the island's 255 inhabitants were infected with a respiratory disease. We consider the population segre- gated into three groups: (1) infants, aged 0-4, (2) children, aged 5-14, and (3) adults, aged 15 and above (at the time, children on Tristan Da Cunha attended school between the ages of 5 and 15). One case was unidentied, so we reduce the population size to 254. To introduce the data, the population size is given by N=254, of which n=40 become infected. The initial population size of each group is N1=25,N2=36 and N3=193, with the total number of cases for each group given by n1=9, n2=6 and n3=25. The data contain the total number of cases identied each day, which we take to be equal to removal times. Table 4.6 displays this as daily data for simplicity, though for the PBLA method we convert it into an individual-based format. To do this (referring to Table 4.6), we set the removal time of the rst infective as 1.0, the removal time of the second infective as 8.0 218CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Table 4.6: Removal data from the 1967 respiratory disease outbreak on Tristan Da Cunha (from Hayakawa et al. (2003), and originally Becker and Hopper (1983)). Age groups dened as: infants aged 0-4, children aged 5-14, and adults aged 15 and above. Number of removals Day Infants Children Adults 1 0 0 1 8 0 0 1 10 0 1 1 11 3 1 0 12 1 1 2 13 3 0 3 15 1 1 1 16 0 1 4 17 0 0 1 18 1 1 1 19 0 0 3 20 0 0 2 21 0 0 1 22 0 0 2 29 0 0 1 30 0 0 1 Total 9 6 25 and so on. To avoid the problems of equal removal times discussed in Section 3.4.10, we jitter all equal removals by increments of 0.1, which was found to have minimal impact on the likelihood values. 4.2.1.2 Model We may next dene the model to be used, which is the same as that in Hayakawa et al. (2003) for comparability. We assume that Tristan Da Cunha forms a closed population of Nindividuals labelled 1, 2, . . . infected ( n\u0014N). All individuals categorised by age into one of groups 1, 219CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 2 and 3, as dened above in section 4.2.1.1. We also assume external infection of the initial case. We will use a simple SIR stochastic transmission model for the disease, dened along much the same lines as previous models we have explored in this thesis. At any given time, each individual in the population will be either in state S (susceptible), state I (infective), or state R (removed). For all infectives . . , n, let ijand rjdenote, respectively, their time of infection and removal. Any susceptible individual may become infected, as will be described below, and enter the I stage at which point they are able to infect others. They will later become removed (corresponding to detected) and enter the R stage. At this point, they are unable to cause infections and, since the length of the outbreak was too short to reasonably allow reinfection, are considered removed from the population. The outbreak begins with the infection of the initial case kat time ik, and ends when there are no infectives remaining in the population. The infection r=frj:j=1, 2, . . . , n, where r1<r2<\u0001\u0001\u0001<rng. During their infectious period, any infective will have a contacts with an individual from group iat times given by points of a Poisson process of rate bi, where all Poisson processes are assumed mutually independent. That is to say, all in- dividuals are equally infectious, but individuals in group ireceive infectious pressure bito reflect their differing susceptibility to the disease. Any contact between an infective and a susceptible is assumed to result in immediate infec- tion. The lengths of the infectious periods of different individuals are assumed mutually independent and exponentially distributed with parameter g. Hayakawa et al. (2003) used data augmentation and MCMC to estimate in- fection rates, infectious period parameters and reproduction numbers for this outbreak. We t the same model but use the PBLA method with MCMC in order to compare our results. 220CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Table 4.7: Gamma prior distributions for the infection parameters in the Tris- tan Da Cunha outbreak, as in Hayakawa et al. (2003). Mean Variance b10.001 100 b20.001 100 b30.001 100 g 0.1 100 4.2.2 Results As in the simulation studies, we wish to compare PBLA to standard DA- MCMC by considering the difference in estimation of the model parameters. Under the Tristan Da Cunha model, these parameters are the infection rates for each age group b1,b2andb3, and infection rate g. We will also consider es- timation of the basic reproduction number R0=b1N1+b2N2+b3N3 g. We perform MCMC with the PBLA III likelihood, and compare this to the DA-MCMC re- sults from Hayakawa et al. (2003). The PBLA MCMC was coded in C and em- ploys individual Gaussian random walk updates, with 100,000 samples taken after a burn-in of length 10,000. To maintain comparability, we used the same gamma distributed prior distributions as Hayakawa et al. (2003), with param- eters given in Table 4.7. The results of the analysis are shown in Figure 4.24. Plotted are histograms of MCMC samples from the PBLA likelihood for the model parameters as well asR0. These samples are compared with the dotted lines in the gures, which represent the mean posterior estimates from Hayakawa et al. (2003). Table 4.8 contains the mean parameter estimates for both methods for comparison. We see that the PBLA method provides estimates close to those of Hayakawa et al. (2003), despite not requiring the data augmentation of their analysis. This provides evidence that the PBLA method is an effective approximation, even for a multi-type epidemic model. 221CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 050001000015000 0.00 0.01 0.02 0.03 b1CountHistogram posterior 0.0 0.5 1.0 1.5 2.0 gCountHistogram of posterior for g 050001000015000 0.0 0.5 1.0 1.5 2.0 2.5 R0CountHistogram of posterior for R 0 Figure 4.24: Histograms of parameter estimates for the Tristan Da Cunha data using the PBLA III approximation method. Dotted lines repre- sent the mean estimates using DA-MCMC from Hayakawa et al. (2003). 222CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Table 4.8: Mean parameter estimates for the the Tristan Da Cunha data using PBLA with MCMC and DA-MCMC (from Hayakawa al. 4.3 Applications: West African Ebola virus data In our next analysis, we consider a data set from the 2014 Ebola virus epi- demic in West Africa. The most widespread outbreak of the disease to date, the epidemic saw a case fatality of above 70% (of laboratory conrmed cases, see reference for Centers for Disease Control and Prevention (Accessed 2018- 03-11)). This was mainly centred on the nations Guinea, Sierra Leone and Liberia, though minor outbreaks and isolated cases were also seen elsewhere across West Africa as well as the USA, UK, Spain and Italy. The outbreak was identied in Guinea in December of 2013, spreading to Liberia and then Sierra Leone over the next few months. As the number of infected cases began to rise, the Ebola outbreak gained much attention as the introduction of public health interventions failed to stop the increase in both cases and deaths. There were 28,652 ofcially recorded cases in the outbreak (from December 2013 to April 2016), though we will focus on a smaller data set across only Guinea, Sierra Leone and Liberia, recorded from March 2014 to February 2016. This data set was obtained from the Centers for Disease Control and Pre- vention (Accessed 2018-03-11), though was originally collected by the World Health Organisation. We wish to compare analysis using the PBLA method to that from Althaus (2014), who used an ODE model with the Ebola data, to estimate transmission parameters for the disease. We wish to follow Althaus' 223CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS model as closely as possible to compare the results of their analysis with those using PBLA. Althaus described SEIR transmission dynamics with a set of ordi- nary differential equations; these were solved numerically and, assuming the cumulative numbers of cases and deaths to be Poisson distributed, maximum likelihood estimates for the parameters of interest were obtained. As we will see, this model is very different to those we have considered so far for PBLA, and so adjustments will need to be made to approximate it closely. It will be interesting to see how PBLA performs under these different conditions. An important note is that we will use Althaus' model for comparison, but with a different data set than in the original paper. Althaus' data set was also obtained from the World Health Organisation, but since the paper was pub- lished in 2014 it does not contain data on the complete outbreak. Complete data is not required for Althaus' method, but is for the PBLA approach that we have adopted (in the sense that the entire length of the outbreak must have occurred, we may of course have unobserved event times). We will explore this in Section 4.3.3, but rst we perform analysis with both methods on the same, larger data set. 4.3.1 Data and Models 4.3.1.1 Data The Ebola outbreak data for Guinea, Sierra Leone and Liberia are given in Ta- ble 4.9. These have been adapted from the Centers for Disease Control and Pre- vention (Accessed 2018-03-11), though are originally from the World Health Organisation (Accessed 2017-11-27). This data set covers a much longer time frame than that used in the Althaus paper: from March 2014 to February 2016, which is the entire length of the outbreak for which detailed data was col- lected for these nations. We will consider both the Althaus method and PBLA method with this larger data set, to explore whether the parameter estimates are similar given a completed outbreak. 224CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Both the data available from the Centers for Disease Control and Prevention (CDC) and the model used in Althaus' original analysis are not directly ap- plicable to the PBLA method. They require some adaptation, but in order to make the most accurate assessment of PBLA we will adapt both, and re-run Althaus' analysis in its most comparable form. The original analysis was ob- tained from Althaus' Github repository (Accessed 2017-11-27)). The data as given in Table 4.9 are in this modied form. The data consist of the number of deaths per day (conrmed, probable and suspected to be from Ebola), for each of the three countries. Although the data are shown in daily format for brevity, the PBLA method of course requires them as individual-based. The original Althaus data contain some days where the total number of observed cases decreases (presumably due to identica- tion error), which our individual-based model cannot include. Hence we have modied the data to ignore any decreases in the number of cases. Althaus' original analysis required imputation of both the cases identied per day and the deaths per day, whereas PBLA requires removal data. Case iden- tication, of course, does not equal removal unless quarantine is immediate. We know from Althaus (2014) that control measures were put in place with the appearance of the index case. The date of this was identied as 2nd December 2013 by Baize et al. (2014), with the initial death being a one year old boy who lived in a village in Guinea and died December 6th 2013. However, details of the control measures are not provided and so we cannot be sure that quaran- tine was indeed immediate. On the other hand, taking the deaths data as the removals ignores all non-fatal cases. To remedy this issue, we choose to use the deaths data only in both analyses. Although this means we are discarding some of the available data, this will ensure that the PBLA parameter estimates remain comparable to those using Althaus' method. Our motivation here is to assess PBLA through comparison with Althaus' method, rather than perform a detailed data analysis. Our assumptions about, and adaptations of, the data are therefore not critical for this exercise. 225CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS The Althaus model takes longitudinal data as input, i.e. it considers the status of the system (the cumulative number of observed deaths in this case) at a dis- crete set of observed times. However, the PBLA method assumes that the time provided is the exact removal time for each individual. For example, from Table 4.9, that twelve individuals were infected on April 7th in Guinea, when in fact they probably became gradually infected since the last observation ve days previous. To incorporate this into the data, for the PBLA method we evenly distribute all observed cases over the time period since the last obser- vation. For computational reasons, we also scale the removal times by a factor of1 1000for the PBLA analysis. Without this, some exponential expressions in the likelihood are too small to be calculated in R. Our parameter estimates in Section 4.3.2 will be scaled back up to be comparable to those from the Althaus method. 4.3.1.2 Model: Althaus analysis Since we will be adapting the model used in Althaus (2014) for comparibility with the PBLA method, we will briefly describe this modied model. Further details can be found in the original paper. The Ebola transmission will follow an SEIR model. As usual, susceptible in- dividuals S enter the exposed class E upon infection, before moving to class I, and becoming able to infect others, at rate s. With the deaths data as removals, individuals are moved to class R upon death at rate g. This may be described by the following set of ordinary differential equations: 226CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Table 4.9: WHO data concerning deaths in the West African Ebola epidemic of 2014, adapted from the Centers for Disease Control and Preven- tion (Accessed 2018-03-11). Details of the adaptation of the data are given in Section 4.3.1.1. Number of deaths Day Guinea SL Liberia 25/03/14 59 0 0 26/03/14 60 0 0 27/03/14 66 0 6 31/03/14 70 0 6 01/04/14 80 0 6 02/04/14 83 0 6 07/04/14 95 0 7 10/04/14 101 0 14 17/04/14 122 0 14 21/04/14 129 0 14 23/04/14 136 0 14 30/04/14 146 0 14 05/05/14 155 0 14 14/05/14 157 0 14 23/05/14 174 0 14 27/05/14 174 4 14 28/05/14 186 5 14 02/06/14 193 6 14 05/06/14 215 7 14 10/06/14 236 7 14 11/06/14 241 19 14 18/06/14 264 49 24 24/06/14 270 49 34 02/07/14 303 99 65 07/07/14 305 101 75 08/07/14 307 127 84 14/07/14 309 142 88 16/07/14 309 192 105 21/07/14 310 206 116Number of deaths Day Guinea SL Liberia 24/07/14 314 219 127 28/07/14 319 224 129 233 156 03/08/14 346 252 227 04/08/14 358 273 255 08/08/14 367 298 294 12/08/14 373 315 323 13/08/14 377 334 355 15/08/14 380 348 355 19/08/14 394 365 466 21/08/14 396 374 576 22/08/14 406 392 624 28/08/14 430 METHOD SIMULATION STUDIES AND APPLICATIONS Number of deaths Day Guinea SL SIMULATION STUDIES AND APPLICATIONS Number of dI dt=sE\u0000gI dR dt=gI. The averages of the latent and infectious period lengths are xed to estimates from an outbreak of the same Ebola subtype in Congo in 1995 (Chowell et al., 2004), that is exposed period average length1 s=5.3 days and infectious pe- riod average length1 g=5.61 days. The infection rate b(t), a function of time t which is normalised such that t=0 corresponds to the rst recorded death in the data for each country, is given here by b(t) =b0e\u0000k(t+t0), for constants b0,kandt0, to be estimated. We dene parameter t0as the time of infection of the initial infective in the given country. For Guinea, Althaus xes this to the known date of the start of the outbreak in the country: December 2nd 2013. For Sierra Leone and Liberia, this parameter is estimated. 229CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS We set the total population size for each country to be 106, as in the origi- nal analysis. Parameter estimates for b0,kandt0are obtained via maximum likelihood estimation, assuming the cumulative number of deaths is Poisson distributed. 4.3.1.3 Model: PBLA analysis In order to ensure our analysis is comparable to that of Althaus, we use the most equivalent model possible for the PBLA analysis. We t an SEIR model which is, so far as possible, the stochastic analogue of that described in Section 4.3.1.2 above. We assume that each of the three countries form a closed population of N= 106individuals labelled 1, 2, . . infected, in Guinea, Sierra Leone and Liberia. We assume that the initial case in each country was externally infected. The SEIR transmission model will be much the same as for Althaus' analysis, though dened stochastically. At any given time, each individual in the popu- lation will be either in state S (susceptible), state E (exposed), state I (infective), or state R (removed). For each individual j=1, 2, . . . , n,ej,ijand rjdenote, respectively, of exposure (unknown), infectivity (unknown), and re- moval (known). Any susceptible individual may become exposed and enter the latent E stage during which they are infected, but not yet infectious. They next enter the I stage at which point they become able to infect others. They last become removed and enter the R stage, during which they are unable to cause new infections and are considered removed from the population. The outbreak begins with the initial case kentering their infectious period at time ik, since this is the point at which infectious pressure begins to be applied, and ends when there are no exposed or infective individuals remaining in the population. The exposure consist 230CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS of removal times 2, . . . , n, where their infectious period only, any infective jwill have a contact with any other individual kat a time given by the point of a Poisson process of rate bjk, where all Poisson processes are assumed mutually independent. Any con- tact between an infective and a susceptible is assumed to result in immediate infection. We also assume that the infectious periods are mutually indepen- dent and exponentially distributed with known parameter g=1 5.61so that the infectious periods are of mean length 5.61 days, as well as the latent periods being of xed length1 s=5.3 days. Since the PBLA framework does not allow for an infection rate dependent upon time as in Althaus' analysis, we dene bjkas a proxy-time-dependent infection rate: bjk=b0e\u0000k(Tjk+t0). Here, Tjkapproximates the midpoint of the time period for which there is in- fectious pressure between individuals jand k, which under the PBLA method is the only time we consider quantity bjk. For infective jand individual kwho For all individuals kin the population who did not become infected, we dene Tjk=rj\u00001 2g, which again approximates the midpoint of the time period for which infec- tive jput infectious pressure on k. There are many other possible versions of Tjkthat could be considered, representing different stages through the time at which there is pressure between jand k, but a brief investigation of the most extreme possibilities revealed that this choice did not signicantly impact the results. 231CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Inbjk, we scale the infection rates by xing t0to the corresponding estimates from the Althaus analysis for the outbreak start date in each country. This leads to a heterogeneously mixing population where we only need to estimate quantities b0and k. Although we could use MCMC with the PBLA likelihood to nd parameter estimates, in this case we will optimise the likelihood, using the optim function in R. This results in even faster computation, and is comparable to the MLEs obtained with Althaus' method. 4.3.2 Results With both models dened, we may progress to comparing results from both methods of analysis. Table 4.10 provides the MLEs of b0and kobtained under each method and for each of the three countries. We see that the estimates obtained are, in general, very similar under both models/methods. In the Althaus analysis we also estimate t0, and then use the respective estimate for each country in the PBLA likelihood. This corresponds to t0=113, 58, and 0 in Guinea, Sierra Leone and Liberia, respectively. Figure 4.25 contains prole likelihoods for parameters b0and kusing the PBLA log-likelihood, where the red lines provide the corresponding MLE from the Althaus method. Figure 4.26 then shows contour plots for these parameters, with the Althaus MLEs shown by the black points. We see again that both methods provide similar estimation, indicating that the PBLA approximation is performing well. This also indicates that the proxy-time-dependent infec- tion rate used with PBLA is a good approximation to the original rate used in the Althaus analysis. 4.3.3 Original Althaus data analysis As we have discussed, one fundamental difference between the Althaus method and PBLA is that the Althaus method uses the data in a longitudinal format, 232CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 0.0 0.1 0.2 for b0and kunder the PBLA log-likelihood, using the full CDC data. Red lines display the corresponding MLEs using the Althaus method. 233CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 4.26: Contour plots for b0and kunder the PBLA log-likelihood, using the full CDC data. Black points indicate the corresponding MLEs using the Althaus method. 234CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Table 4.10: MLEs for the West African Ebola outbreak, using the full CDC data with the Althaus and PBLA as part of this, as- sumes that we have observed all removals until the end of the outbreak. This is not necessary for the Althaus method which simply checks the status of the population at some discrete set of times, whether or not the last time repre- sents the end of the outbreak. In order to avoid use of incomplete outbreak data we have performed the analysis so far with the larger data set from the CDC. Next, however, we will re-perform the analysis with the original Althaus data to demonstrate what happens to the PBLA likelihood when it is applied to an incomplete outbreak. 4.3.3.1 Data and models The data are given in Table 4.11, adapted from Althaus (2014) though again originally from the World Health Organisation (Accessed 2017-11-27). The data consist of the number of deaths per day (conrmed, probable and sus- pected to be from Ebola), for each of the three countries. We make the same adaptations to the data as before. We ignore any decreases in the observed number of deaths, with this modication already applied to the data set given in Table 4.11. We also take only the deaths data, scaled by a factor of1 1000for the PBLA analysis as before, and smooth out the deaths equally over the re- gion during which they may have occurred. Again, for the PBLA analysis we 235CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS convert these data to an individual based format. Comparing the CDC data in Table 4.9 to the Althaus data in Table 4.11 over the region which they both include, we see that the two data sets are generally very similar, but with some small differences. Notably, we see that the dates have been shifted by one or two days. This may be explained as the Althaus data providing the date on which the death was predicted to have happened, and the CDC data providing the date on which the WHO report was pub- lished. Since the scale is equivalent in both cases (just shifted) and we will use the same data set with both methods of analysis, we make no attempt to align the two. Using the same models as in Section 4.3.1 for both the Althaus and PBLA anal- ysis, we may now obtain parameter estimates and investigate the impact of an incomplete outbreak. 4.3.3.2 Results To begin our investigation we plot the observed cumulative deaths in the Al- thaus data over time, and seek to compare this to Althaus' model simulation for the same period. As discussed in Section 4.3.1.2, Althaus assumes the ob- served number of deaths is Poisson distributed with parameter equal to the expected number of deaths from the ODE model. As in, with mean and vari- ance equal to this expected number of deaths. We therefore t the correspond- ing curve of Althaus' ODE model estimates (for each day in the outbreak) over the observed data, along with error bars to display this assumed variability. These plots are given in Figure 4.27 for each of the affected countries. We include two plots for Liberia, the rst over a shorter time where we can com- pare the behaviour of the Althaus simulation over the time frame of the out- break, and the second where we consider the entire simulated outbreak. We see that, in general, the behaviour of the simulations is very similar to that observed during the course of the observed outbreak, but that for Guinea and 236CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Table 4.11: WHO data concerning deaths in the West African Ebola epidemic of 2014, adapted from Althaus (2014) though originally from the CDC. Details of the data adaptation are given in Section 4.3.3.1. Number of deaths Day Guinea Sierra Leone Liberia 22/03 29 0 0 24/03 30 0 0 25/03 1 0 0 26/03 2 0 0 27/03 4 0 0 28/03 4 0 0 31/03 10 0 0 01/04 3 0 0 04/04 3 0 0 07/04 9 0 0 09/04 6 0 0 11/04 5 0 0 14/04 2 0 0 16/04 14 0 0 17/04 7 0 0 20/04 7 0 0 23/04 5 0 0 01/05 8 0 0 03/05 6 0 0 05/05 2 0 0 07/05 1 0 0 10/05 0 0 0 12/05 13 0 0 18/05 5 0 0 23/05 0 0 0 27/05 10 5 0 28/05 7 0 0 29/05 0 1 0 01/06 15 0 0 ............Number of deaths Day Guinea Sierra Leone Liberia ............ 03/06 7 0 0 05/06 11 0 0 06/06 0 1 0 15/06 37 39 0 16/06 1 0 24 17/06 0 3 0 20/06 6 0 0 22/06 0 0 10 30/06 33 50 31 02/07 2 2 10 06/07 2 26 9 08/07 2 15 4 12/07 0 52 17 14/07 1 3 1 17/07 0 9 10 20/07 4 13 11 23/07 5 5 2 27/07 20 9 27 30/07 7 19 71 01/08 12 21 28 04/08 5 13 27 06/08 4 12 12 09/08 6 17 29 11/08 4 19 32 13/08 3 14 58 15/08 0 0 53 16/08 14 17 0 18/08 2 9 110 20/08 10 18 48 Total 406 392 624 237CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 0 100 200 300 4000100 300 500Time series of Guinea deaths data Time (days)Cumulative number of deathsObserved data Althaus simulation ErrorH 0 50 100 150 2000100200300400Time series of Sierra Leone deaths data Time (days)Cumulative number of deathsObserved data Althaus simulation ErrorH 0 50 1500200400600Time series of Liberia deaths data Time (days)Cumulative number of deathsObserved data Althaus ErrorH 0 600 800 10000e+00 4e+05 8e+05Time series of Liberia deaths deathsObserved data Althaus simulation ErrorH Figure 4.27: Cumulative observed deaths in each country overlaid with equivalent estimations from the Althaus simulation method, with error bars displaying the assumed variability. Dashed lines show the end of the observed data. 238CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Liberia, there are many more future deaths predicted. This is particularly true for Liberia where, under the parameter values as estimated, it is predicted that all 106individuals will eventually be infected in an outbreak spanning around a year. This might indicate that the PBLA method will not result in similar pa- rameter estimates to the Althaus method for this shorter dataset, since for that to occur in Liberia, for example, under the PBLA assumption of a completed outbreak we would expect to have seen a nal size much closer to N. Further investigating this, we proceed to our full analysis using both the PBLA and Althaus methods with the original Althaus data. Table 4.12 contains pa- rameter estimates for b0and k. We again estimate t0in the Althaus analysis, and then use these in the PBLA analysis. For this data, t0was estimated as 110, 15 and 57 for Guinea, Sierra Leone and Liberia, respectively. Figure 4.28 dis- plays b0and kfor each country using the PBLA method, and Figure 4.29 displays corresponding contour plots for these parameters, comparing the results to the MLEs from the Althaus method in each case. As we can see from the table as well as the plots, the parameter estimates from PBLA are somewhat similar to the Althaus estimates, but certainly not as close as when using the larger data set. Estimation is fairly similar for Sierra Leone, but for Guinea and particularly Liberia (where we saw the least complete out- break), we are not so able to accurately estimate the parameters. For Liberia especially, we note that the kestimate is considerably different and that, from Figure 4.29, the contour is very flat for b0. We may conclude that the assumption of a complete outbreak is especially important when using the PBLA method, since under an incomplete outbreak the method is far less able to achieve accurate parameter estimation. However, as we have seen, with the larger, complete data set PBLA offers very similar performance to the Althaus method. 239CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES APPLICATIONS 0.00.10.20.30.40.53800 3600 3400 3200 3000 b0log likelihood 0.000.010.020.030.040.055500 5000 4500 4000 3500 3000 klog likelihoodParameter Estimates for Guinea deaths data 0.00.20.40.60.81.03400 3200 3000 b0log likelihood 0.000.010.020.030.040.052850 2800 2750 2700 2650 klog likelihoodParameter Estimates for Sierra Leone deaths 0 3 45000 PBLA log-likelihood, Althaus data. Red lines display the corresponding MLEs from the Althaus method. 240CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS 4.29: Contour for b0and kunder the PBLA log-likelihood, using the Althaus data. Black points indicate the corresponding MLEs using the Althaus method. 241CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Table 4.12: Parameter estimates for the West African Ebola outbreak. The t0 estimates from the Althaus method were used in the 2001 UK Foot and Mouth outbreak data The nal application to be explored concerns data from the 2001 UK Foot-and- Mouth disease (FMD) epidemic. FMD is a viral infection which affects mainly hoofed livestock (cows, sheep, pigs), but has also been known to affect animals such as antelope and hedge- hogs as well as, occasionally, humans. Although FMD is rarely fatal, it causes signicant drops in the dairy production of cattle, as well as slow weight gain and blisters which may cause lameness (Alexandersen et al., 2003). The disease is highly infectious, and may be spread not just through animal-animal con- tact but also contact with farming equipment, vehicles and feed. There is hence considerable focus on containment of outbreaks, so as to avoid large economic loss through trade restrictions and culling. This containment involves vaccina- tion strategies and strict monitoring of farms (Grubman and Baxt, 2004). There are difculties in vaccination, however, due to large variation between differ- ent serotypes of the disease, with no cross-protection between these (Brown, 1992). 242CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS The 2001 UK outbreak of FMD had a signicant impact on the country, see- ing widespread culling as well as non-farming related impacts such as the cancellation of sporting/leisure events and the postponement of the general election. The entire outbreak saw more than 2000 identied cases, and around 10,000,000 cattle and sheep were eventually culled to stop the outbreak with a total estimated cost of \u00a38 billion to the economy. The Department for Environment, Food and Rural Affairs (DEFRA) collected detailed information on the FMD outbreak, which was released on their web- site ( www.defra.gov.uk ) in 2003. There have been numerous mathematical analyses of this data, including Morris et al. (2001), Ferguson et al. (2001) and Diggle (2006). We will focus on the analysis of data from Cumbria and the sur- rounding area, which was the county most severely affected by the outbreak. We will compare our analysis with that of Kypraios (2007), who used a true likelihood-based approach to infer infectivity and susceptibility parameters. We will use the PBLA III method, with the same SIR and heterogeneous mix- ing model as Kypraios (2007) for comparison. This will involve a spatial com- ponent in the infection rate, so that the contact rate between farms depends on the geographic distance between them. We will rst describe this data set, and then fully dene the model to be used in this analysis. 4.4.1 Data and Model 4.4.1.1 Data The data we will use are the same as those used in Kypraios (2007). These were made available by Kypraios who obtained them from the le \"DataFor- ModellersOct03.xls\" which was previously available on the DEFRA website but has since been removed. In our previous analyses, the individuals in the population have all been humans, but in this analysis each individual repre- sents a Cumbrian farm. The data include dates of culling of all infected farms, 243CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Figure 4.30: Geographical locations of Cumbrian and surrounding farms in- cluded in the 2001 Foot and Mouth disease dataset. Red points represents infected farms and green points represent those that were not infected. which we take to be equal to removal data in the same way as Kypraios (2007). The infection times are then unknown. As well as the removal data, DEFRA made available the geographic location of all Cumbrian farms, given as xand ycoordinates of each. Figure 4.30 shows a plot of these. Some farms in the data are actually in the counties surrounding Cumbria, but we include these in the analysis for consistency with Kypraios (2007). Information was also available on the total numbers of cows and sheep on each farm, which we will incorporate. There was additional data on the num- bers of pigs, goats and deer on each farm, but to maintain comparability with 244CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Kypraios (2007) we ignore these, and also exclude any farms with no cows or sheep. This results in a total of N=5378 farms, of which n=1021 were culled. Some of these were culled without knowledge of their infection status, say if they were considered to have had dangerous contacts. However, no information is available as to which farms these were, and so we consider all cullings as the removal of infected cases, as in Kypraios (2007). 4.4.1.2 Model The model used for analysing the FMD data will be the same as in Kypraios (2007) to allow for the best comparison of the PBLA method, and we briefly describe this here. We assume a closed population of Nfarms labelled 1, . . , nbecome infected and where the initial case is assumed to have been infected externally. We use an SIR model as dened in Section 3.2, so that at any time t, each farm will be either susceptible (S), infective (I) or removed (R). . , n,ijand rjdenote their infection and removal, respectively. The initial case k(unknown) becomes infected at ik, starting the outbreak. This then ends when no infectives remain in the population. Infection times r=frj:j=1, 2, . . . , nwhere r1<r2<\u0001\u0001\u0001<rng, in addition to the geographical location and the number of cows and sheep of each farm. A heterogeneously mixing population structure is assumed, such that the in- fection rate from farm ito farm jis given by bij. Therefore, during their in- fectious period an infective iwill have a contact with an individual jat a time given by the point of a Poisson process of rate bij, where all such Poisson pro- cesses are assumed mutually independent. Contacts between an infective and a susceptible are assumed to result in immediate infection. We assume that 245CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS the infectious periods are independent and gamma distributed, with shape parameter mand rate parameter g, so that rj\u0000ij\u0018G(m,g). We also assume that the shape parameter is known and xed to m=4. To incorporate the different aspects of the data, the infection rate bijis overall infection rate. Param- eters eand xrepresent the relative infectiousness and susceptibility, respec- of cows to sheep, where nc iand ns iare the known numbers of cows and sheep on farm i. The level of linearity (or sub-linearity) of the infectiv- ity/susceptibility of each farm to the number of animals is given by z. Lastly, K(i,j)is a Cauchy kernel determining the spatial aspect of the infection rate. With r(i,j)dened as the Euclidean distance between farms iand j,vis then the parameter dening this spatial component. Kypraios (2007) discusses the use of other potential measures of distance than the Euclidean distance (for example the minimum walking distance), but as usual we keep our model as similar as possible to theirs for comparability. We hence have a six parameter model, with parameters (b0,g,v,e,x,z)which we wish to obtain estimates for. We will perform maximum likelihood estima- tion and MCMC with the PBLA likelihood, and compare the results to those obtained in Kypraios (2007) via DA-MCMC. 4.4.2 Results We perform parameter estimation using the PBLA likelihood with both maxi- mum likelihood estimation and MCMC, which we may compare with the re- sults of a partially non-centered DA-MCMC algorithm from Kypraios (2007). We use the same gamma-distributed prior distributions for the model param- 246CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Table 4.13: Prior distributions used for FMD data analysis. For each param- eter, we use a gamma distributed prior with shape parameter m and rate parameter l. these are given in Table 4.13. MCMC was coded in C, and 50,000 samples were obtained for each parameter. We performed Gaussian random walk updates for each of the six parameters separately. Max- imum likelihood estimation was performed in R using the NLM (Non-Linear Minimisation) optimisation package. The posterior distribution has many lo- cal maxima and is of course six dimensional, leading to a challenging maximi- sation problem, but upon testing of a variety of maximisation functions, NLM was found to perform best. Table 4.14 contains the MLEs and MCMC posterior means obtained using the PBLA likelihood, in addition to the posterior means from Kypraios' DA- MCMC. Figure 4.31 contains for each of these six model pa- rameters, when the other parameters are xed to their MLEs. These are com- pared to the posterior means from Kypraios (2007). Lastly, Figure 4.32 shows trace plots for the PBLA MCMC samples alongside the DA-MCMC samples used in Kypraios (2007). We see that generally estimation is very similar be- tween PBLA and DA-MCMC, the only parameter with potentially signicant underestimation being v. In the MCMC trace plots, both methods seem to be exploring the same areas of the parameter space, except for vandg. It is interesting that the areas of high density for gunder each method appear so 247CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS Table 4.14: MLEs and posterior means for FMD data model parameters using the PBLA likelihood, compared with DA-MCMC posterior means from Kypraios (2007). NOTE: the b0estimate was not provided in Kypraios (2007), but was obtained from the author. 0.318 0.315 0.32 distinct in Figure 4.32, when in Table 4.14 and Figure 4.31 the estimates appear fairly similar. One other notable conclusion is the similarity in the MLEs and MCMC means using the PBLA likelihood, highlighting that maximum like- lihood estimation methods are able to obtain very similar estimates, but at a much smaller computational cost. With ve of the model parameters ( b,v,e,x,z) involved in dening the overall infection rate bij, we also consider how well the PBLA method estimates this as a whole compared to DA-MCMC. Figure 4.33 includes histograms of bij estimates, obtained from the MCMC samples. Since bijobviously depends on the pair of farms (i,j), we have selected six such pairs at random. For each pair, we then calculate bijusing the set of parameter samples at each iteration of the MCMC algorithm, for both PBLA MCMC and DA-MCMC. As we can see from Figure 4.33, PBLA tends to underestimate bijslightly, though in general is fairly similar to DA-MCMC. Combined with the underestimation of gamma, this is similar to what we saw in Section 4.1; that although PBLA often results in some underestimation of bandg, estimation of their ratio ( R0) will usually still be good. For the pairs (i,j)in Figure 4.33, Figure 4.34 includes 248CHAPTER 4: L likelihood 0.000 0.002 0.004 0.006 8 107200 6800 6400 log likelihood 0 2 4 6 8 106900 6600 6300 log likelihood 0.0 0.2 0.4 0.6 0.8 1.030000 20000 10000 log likelihoodProfile Likelihoods for Foot and Mouth Model Parameters Figure 4.31: Prole likelihoods for the FMD model parameters. All parame- not being proled are xed to their PBLA MLEs. Dotted lines mark the MLE for the parameter in question, and green lines pro- vide posterior mean estimates from Kypraios (2007). 249CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION Plots for Foot and Mouth Model Parameters Figure 4.32: Trace plots of MCMC samples for the six FMD model parame- ters, PBLA MCMC (red) and (green). DA- MCMC samples were not provided in Kypraios (2007), but were obtained from the author. Red horizontal lines mark the PBLA MCMC posterior mean and green horizontal mean, for each parameter. 250CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS i = estimates of bijfor the FMD data using MCMC samples, for six randomly selected pairs of farms (i,j). Red bars are PBLA MCMC samples, and green are from DA-MCMC. the corresponding estimates of Rij 0=bij g. As a reproduction number this is less interpretable than R0for a homogeneously mixing epidemic, since it depends on the given pair (i,j)(and hence does not represent the overall infectivity of the disease). However, for our purposes here we demonstrate that the ratio of bandgis estimated well. Overall, PBLA offers generally similar estimation to DA-MCMC for the FMD data, despite the approximation involved. 4.5 Conclusions In this chapter we have assessed the performance of the ED and, more thor- oughly, the PBLA methods, using both simulated and real data. 251CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS i = 605 = 807Density of Rij 0=bij gfor the FMD data using MCMC samples, for six randomly selected pairs of farms (i,j). Red bars are PBLA MCMC samples, and green are from DA- MCMC. 252CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS The simulation studies of Section 4.1 highlighted where the likelihood approx- imation methods provide similar estimation to DA-MCMC. We saw in Section 4.1.1 that generally the PBLA III method provides similar estimation to DA- MCMC, and outperforms the ED method. Both methods perform better with gamma distributed infectious periods than exponential, though they struggle when very large or small proportions of the population are infected. This was corroborated by our ndings in Section 4.1.2, where we suggested that the poor performance of PBLA when the proportion of infectives is large may be due to the yterm in the likelihood. This term involves the most approxima- tion, and becomes much larger compared to the other terms when the propor- tion of infectives is high. In this section, we also conrmed our ndings that the values of b,gand Ndo not affect the accuracy of the approximation meth- ods, as well as that both methods perform considerably better with gamma infectious periods compared to exponential, even for shape parameter values as low as m=2. In Section 4.1.3 we compared the performance of the different PBLA versions as dened in Chapter 3. Under both exponential and gamma infectious pe- riods as usual, we assessed the ability of each the PBLA versions I through V to recover true parameter values from simulated data. We found that for exponential periods where PBLA IV is applicable, this offers the fastest op- tion at comparable accuracy to the other versions (so long as the outbreak is large enough for the central limit theorem approximation to hold). Otherwise, PBLA III offered consistently good estimation. For gamma infectious periods, PBLA III and V were found to be preferable. We concluded the simulation studies with an analysis of computation time in Section 4.1.4. Here we found that for larger population sizes, PBLA offers improved computation time, compared to DA-MCMC. The larger the value of shape parameter mfor gamma distributed infectious periods, the larger a pop- ulation size is required for PBLA to be faster. As the population size increases, PBLA offers greater and greater computational advantage over DA-MCMC, 253CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS which is particularly useful in practice since there is most motivation for us- ing likelihood approximations for larger populations. Sections 4.2, 4.3 and 4.4 explored the application of the PBLA method to a va- riety of real data sets. We began with a study of respiratory disease on the island of Tristan Da Cunha. Data from this island have received considerable attention from the epidemic modelling community, since Tristan Da Cunha represents an (approximately) closed population on which detailed informa- tion has been recorded on outbreaks and the structure of its population. We compared analysis of an outbreak from 1967 using PBLA to that of Hayakawa et al. (2003), who used DA-MCMC. This involved a model where the infec- tion rate differed with age, with individuals categorised into one of three age groups. We found that the PBLA method resulted in parameter estimates very similar to DA-MCMC. Section 4.3 concerned analysis of data from the 2014 Ebola virus outbreak in West Africa, specically in Guinea, Sierra Leone and Liberia. This outbreak re- ceived much attention worldwide, especially due to Ebola's high fatality and lack of cure. We compared analysis using the PBLA method with maximum likelihood estimation to that of Althaus (2014), who used an ODE model com- bined with maximum likelihood estimation. Since these methods are innately different (for instance, the ODE model requires daily data rather than individ- ual based), some adjustments to the data were required. We also introduced a proxy-time-dependent infection rate to best match the time dependent rate used in Althaus (2014). This replaces time with an estimate of the mid-point of the period during which there is infectious pressure between any individ- uals jand k, since this is the only period in which we require the infection rate to be dened. Analysis was performed on data concerning the entirety of the outbreak in Guinea, Sierra Leone and Liberia obtained from the CDC, though we compared this with analysis using Althaus' original data set which did not include the end of the outbreak. This demonstrated the need of com- plete data for the PBLA method to perform well. When complete data was 254CHAPTER 4: L IKELIHOOD APPROXIMATION METHOD SIMULATION STUDIES AND APPLICATIONS used however, PBLA offered very similar estimates to Althaus (2014), despite the considerable approximations and adjustments to the model that were re- quired. The nal application was explored in Section 4.4, and this involved analysis of data from the 2001 UK Foot and Mouth disease epidemic. We compared analysis using PBLA with both MCMC and maximum likelihood estimation to analysis with DA-MCMC in Kypraios (2007). We used the same model as Kypraios, which involved the use of PBLA with a spatial likelihood com- ponent in which the infection rate depends on the geographical distance be- tween each pair of farms. We found that both maximum likelihood estimation and MCMC with the PBLA likelihood resulted in similar parameter estimates, which also generally well agreed with those from DA-MCMC. 255CHAPTER 5 Conclusions 5.1 Overview Bayesian statistics has received much attention within the stochastic epidemic modelling community over the past three decades. It allows incorporation of data and prior knowledge into statistical models and, combined with data augmentation techniques, allows for analysis of data which are only partially observed. Although DA-MCMC has become a standard tool for computa- tional analysis of partially observed disease outbreak data, it often suffers from a number of problems. High posterior correlation between unknown infection times and the infec- tious period parameters, especially for larger outbreak sizes, can lead to slow mixing of the Markov chain. Current methods for handling this issue have limitations, for example non-centred parameterisations are limited in their ap- plicability, and thinning of the Markov chain, although reducing the autocor- relation between successive samples, increases the number of iterations of the algorithm that need to be implemented to result in the same overall sample size. This can be problematic for likelihoods which are computationally de- manding to compute, particularly, for example, for large population sizes. There is a growing demand for fast, often real-time, analyses, particularly with the increasing use of mathematical modelling by more applied scientists and 256CHAPTER 5: C ONCLUSIONS public health ofcials. There is hence considerable motivation to develop com- putational methods for Bayesian analysis of stochastic epidemic data which overcome these problems. In this thesis, we have explored existing methods for analysis and introduced a series of novel likelihood approximation meth- ods. 5.2 Abakaliki data analysis Chapter 2 described an analysis of the Abakaliki smallpox data. Despite this data set receiving much attention in the epidemic modelling literature, this is the rst Bayesian analysis of the full data to have been completed. We used DA-MCMC to estimate key transmission parameters, which we compared to a previous analysis by Eichner and Dietz (2003). We also performed model assessment using simulation based methods, and our Bayesian approach al- lowed us to perform novel estimation of the infection pathway. We found that the parameter estimates using DA-MCMC were very similar to those in Eich- ner and Dietz (2003), despite the fact that they used an approximate likelihood. This motivated the rest of this thesis, in exploring the development of further approximation methods. The analysis of the Abakaliki data set was largely self-contained, but there are some potential directions for future work. There could be benet in the use of model assessment tools other than the simulation-based approach taken in Section 2.7, since we cannot be condent that the choice of summary statistics is entirely appropriate. For example, when comparing the incidence curves of simulated outbreaks to the true data, we chose to restrict our attention to only simulations of the same nal size as the data, despite the fact that the vast majority of simulations were not of this size. Lau et al. (2014) suggest model diagnostic tools for spatio-temporal transmission models, which apply classi- cal techniques within a Bayesian framework. These use non-centred parame- terizations to construct residuals for model assessment, and could potentially 257CHAPTER 5: C ONCLUSIONS be applied within the Abakaliki model framework. Further work could also involve adaptation of the model used for analysis. Whilst the disease progres- sion model used was relatively representative of smallpox in reality, future work could involve implementation of a more realistic mixing structure for the 30,000 people outside of the affected compounds, rather than assuming homogeneous mixing. Although for our analysis we wanted to use Eichner and Dietz' model to ensure comparability, such steps could be taken if further analysis of the Abakaliki outbreak was performed. 5.3 Likelihood Approximation Methods The second part of this thesis focused on likelihood approximation methods for infectious disease data. Chapter 3 rst explored a generalised version of the Eichner and Dietz approximation method from Chapter 2, and then intro- duced a series of new approximation methods called PBLA. These essentially assumed independence between the likelihood contributions of different pairs of individuals, in order to obtain a likelihood expression independent of the unknown infection times. These expressions then do not require data augmen- tation for use with MCMC algorithms, and may also be used for maximum likelihood estimation. We explored various different versions of the PBLA likelihood, aiming to offer e.g. improved accuracy (PBLA II/III) or improved computational speed for certain infectious period distributions (PBLA IV). After dening these approximation methods in Chapter 3, Chapter 4 gave ex- amples of their application. We compared parameter estimation using the ED approximation, the various PBLA methods and standard MCMC in a series of simulation studies. Here we identied the situations, in terms of infectious pe- riod distribution, population sizes and outbreak sizes, in which the methods well approximate DA-MCMC with the true likelihood, as well as comparing the computation time required. The second half of Chapter 4 then described the application of the PBLA method to three real data sets. We compared pa- 258CHAPTER 5: C ONCLUSIONS rameter estimation with PBLA to existing published analyses, each with spe- cic modelling requirements. We found that, in general, PBLA offered very similar parameter estimation to the previous analyses. This highlights the po- tential of the method to be used successfully in practice, particularly by ap- plied scientists for whom fast inference is key. Analysis of the computation time required for PBLA compared to standard MCMC revealed that, particu- larly for increasingly large population sizes, PBLA may offer comparable accu- racy in estimation at a substantially lower computational cost. One key hurdle to overcome in the adoption of PBLA by applied scientists might be its limited accessibility compared to currently employed methods such as ABC, which are perhaps easier to interpret. However, there is scope to create a package for implementing PBLA which does not require such an in-depth knowledge of the theory behind it, and we propose that this would help achieve wider adoption of the method. There is considerable potential for future development of the PBLA method. In Chapter 3 we explored various versions of the PBLA likelihood, but it would certainly be possible to nd further versions offering improved estimation. Re- calling the true likelihood dened in Section 1.3.5, a key aspect of the current PBLA versions we have explored is that they separate the L1term (Equation (1.3.3)) from the L2term (Equation (1.3.4)), despite the fact that they both de- scribe the infection component of the likelihood. A future PBLA version might try to combine these terms, in order to obtain a more accurate approximation. Another aspect of the true likelihood is that the product term will be zero for an 'impossible' outbreak, that is an outbreak for which each infectee does not have a potential infector at their time of infection. The PBLA likelihood does not have an explicit equivalent term. This can allow, for exponential infectious periods for example, the estimate of the removal rate gto become too large. Future PBLA versions might seek to further constrain the infection times in order to avoid this. The PBLA method may also be extended in terms of its framework. So far 259CHAPTER 5: C ONCLUSIONS we have focused on exponential and gamma infectious periods, but it may also be possible to calculate the likelihood terms for other distributions. In Section 3.4.11 we discussed the extension of the PBLA method to SEIR models, but found that for non-xed latent periods this did not result in particularly simple expressions. It may be possible, however, to extend PBLA to SEIR or other compartmental models using slightly different techniques. Lastly, there is potential to extend PBLA for use with non-xed population size models. These arise in, for example, analysis of hospital infection data where the total population of a ward varies over time (see e.g. Worby et al., 2016). As discussed, we have compared PBLA to DA-MCMC in Section 4.1.4 and found that for larger population sizes with both exponential and gamma dis- tributed infectious periods, PBLA offers a larger effective sample size per sec- ond than DA-MCMC. However, there is scope to improve the efciency of the PBLA method even further. For example, since PBLA calculates the contri- bution from different pairs of individuals independently, it is naturally paral- lelisable. This may increase the computational advantages of the method, at no cost of accuracy. In turn, this could help establish PBLA as a serious alter- native to existing approaches such as MCMC and ABC, for ensuring fast and efcicient analysis. 260APPENDIX A Appendix for Abakaliki data analysis: full conditional distributions In order to implement the MCMC algorithm for analysis of the Abakaliki smallpox data described in Chapter 2, the full conditional distribution (the distribution of a single parameter conditional on all of the others) of each pa- rameter is required. We use the full conditionals since sampling from the full posterior is computationally demanding. The parameters to be updated are tq, la,lf,lh,v,b, p,suand the exposure, fever, removal and quarantine times, and we provide the log full conditionals for each here up to proportionality. In the following, recall log (L)dened in Equation 2.5.12. We include an ad- ditive constant cin the log full conditionals, since the full conditionals are multiplicatively proportional to the DATA For any We update the exposure times eas detailed above, but this may in turn alter the exposure time of the initial infective ek, or indeed kitself if a different 263APPENDIX A: A PPENDIX FOR ABAKALIKI DATA ANALYSIS :FULL CONDITIONAL DISTRIBUTIONS individual becomes the initial infective. We do not include the full conditional distribution for this, but in practice we simply update kand ekas required by theeupdate. 264APPENDIX B Appendix for PBLA: likelihood calculations for gamma infectious periods In this appendix we derive the likelihood expressions for the Pair Based Like- lihood Approximation (version I) with Gamma distributed infectious periods, using both integration and probabilistic arguments. We recall that we dene gamma distributed infectious periods such that fI(rj\u0000ijjm,g) =gm G(m)(rj\u0000 ij)m\u00001e\u0000g(rj\u0000ij), and we restrict shape parameter mto integer values. As in the exponential case, we will derive expressions for E[cjfj]andE[yj], rst using the full integration method and then with probabilistic arguments. B.1 Integration method , so we must calculate the expectation for all pairs j,k. As in the exponential 265APPENDIX B: A PPENDIX FOR PBLA: LIKELIHOOD CALCULATIONS FOR 1fkinfective at ijge\u0000Bj(rj\u0000ij)\u0003 =Zrk \u0000\u00a5Zrj assumed that ijand ikare independent. For a given jand k, this integral will take one of two forms, determined by the values of rkand y=rj\u0000ij. Then the inner integral is proportional to a gamma CDF, which we denote as Fk,q(x). Since we take only positive integer values for the shape parameter, the distribution function can be expressed as Fk,q(x) =1\u0000k\u00001 \u00e5 l=01 l!(qx)le\u0000qx, (B.1.2) for shape 266APPENDIX B: A PPENDIX FOR PBLA: LIKELIHOOD CALCULATIONS FOR GAMMA INFECTIOUS PERIODS (i) The rst integral is given by Zrj \u0000\u00a5(rk\u0000ik)m\u00001e\u0000g(rk\u0000ik)dik=Z\u00a5 rk\u0000rjym\u00001e\u0000gydy =(1\u0000Fm,g(rk\u0000rj))G(m) gm. (B.1.3) (ii) The the integral takes the form of the expectation of(rk\u0000rj+Y)m\u00001, where Yis gamma distributed with shape l+1 and rate 2g+Bj. This expression is we 267APPENDIX B: A PPENDIX FOR PBLA: LIKELIHOOD CALCULATIONS FOR GAMMA INFECTIOUS PERIODS Case (ii): rk<rj Taking now As in the case rk\u0015rj, this takes the form of a CDF for the gamma distribution, and so using Equation (B.1.2) split this into two integrals. (i) The rst integral is the rst term proportional to a gamma PDF and the 268APPENDIX B: A PPENDIX FOR PBLA: LIKELIHOOD CALCULATIONS FOR GAMMA INFECTIOUS PERIODS second to an expectation as in the rk\u0015rjcase, the equation 0e\u0000gyym\u00001dik G(m)(g+Bj)mfrom Equation (B.1.6), the sec- ond integral is equal to gm (g+Bj)mFm,g+Bj(rj\u0000rk). (B.1.8) Combining Equations (B.1.7) and (B.1.8), GAMMA INFECTIOUS PERIODS Then, combining Equations (B.1.5) and (B.1.9), we obtain the full k=1 k6=jE\u0002 e\u0000bkj(rk^ij\u0000ik^ij)\u0003 . take the form E\u0002 e\u0000bkj(rk^ij\u0000ik^ij)\u0003=Z Z e\u0000b(rk^ij\u0000ik^ij)fI(rj\u0000ij)fI(rk\u0000ik)dijdik, where bkj=b, for simplicity. Again we split this integral into sections, condi- tional upon the values of rjand rk. Case As in otherwise. 270APPENDIX B: A PPENDIX FOR PBLA: LIKELIHOOD CALCULATIONS FOR GAMMA INFECTIOUS PERIODS Then, to before, E\u0002 e\u0000b(rk^ij\u0000ik^ij)jrk\u0015rj\u0003=Zrj \u0000\u00a5Zij \u0000\u00a5e\u0000b(ij\u0000ik)fI(rj\u0000ij)fI(rk\u0000ik)dikdij +Zrj assumed that ijand ikare independent. We have switched the order of integration for the gamma case since it results in simpler calcula- tion. We will calculate each integral individually. CALCULATIONS FOR GAMMA INFECTIOUS PERIODS where to the expectation of (rk\u0000rj+y)lfor a G(m, 2g)distributed random variable CALCULATIONS FOR GAMMA INFECTIOUS PERIODS (ii.1) Splitting this into two integrals, we rst take in the calculations for E[cjfj], that the in- tegral is proportional to the expectation of (rk\u0000rj+y)l, where yis FOR GAMMA INFECTIOUS PERIODS Overall, adding together Equations (B.1.10) independent, and we will calculate each integral PBLA: LIKELIHOOD CALCULATIONS FOR rkZrk \u0000\u00a5e\u0000b(rk\u0000ik)fI(rj\u0000ij)fI(rk\u0000ik)dikdij =g2m G(m)2Zrj rk(rj\u0000ij)m\u00001e\u0000g(rj\u0000ij)G(m) (g+b)mdij, since the integral is proportional to the PDF of a gamma distribution. the denition of the gamma CDF from Equation (B.1.2). (ii) The second integral PBLA: LIKELIHOOD CALCULATIONS FOR to the expectation of (rj\u0000rk+ y)m\u00001, where yis gamma distributed, PBLA: LIKELIHOOD CALCULATIONS FOR GAMMA INFECTIOUS PERIODS where y=rk\u0000ik. Then, using the fact the integral is proportional to a gamma CDF integral is proportional to the expectation of(rj\u0000rk+y)m\u00001, where yis gamma distributed, FOR GAMMA INFECTIOUS PERIODS Recombining the two integrals, we obtain overall Again, we may now calculate the likelihood for any given choice of prior probability mass function for the initial infective and prior probability den- sity/mass function for the initial infective's infection time. In summary, 278APPENDIX B: A PPENDIX FOR PBLA: LIKELIHOOD LIKELIHOOD CALCULATIONS FOR GAMMA INFECTIOUS PERIODS B.2 Probabilistic method We are able to obtain the same likelihood expression using probabilistic argu- ments. In the case of exponential infectious periods, we argued using the fact that the probability of an event occurring is independent of time. Here we use the method of stages to split a G(m,g)time period into mexponentially distributed sections, so that similar arguments may be used. Expression one: E[cjfj] Consider rst E[cjfj]. We must, for any k, calculate E\u0002 e\u0000Bj(rj\u0000ij)1fik<ij<rkg\u0003 , where Bj=\u00e5N l=n+1bjl. We split this into cases de- pending on which is greater, rkorrj. Case (i): rk\u0015rj We begin by noting that, given ij<rj<rk, there are 3 possible locations for ik since the rst term takes the form of a Gamma moment generating func- tion. The second term represents the probability of there being no points in a Poisson process of rate Bjbetween ijand rjas well as mexponential gstages for individual kin(rj,rk)(given by the indicator function). Fm,g(\u0001)represents a gamma CDF with parameters mandg. Although not written for simplicity, all the terms here are of course conditional on rk\u0015rj What remains is to calculate the nal expectation term in the expression above, 280APPENDIX B: A PPENDIX FOR PBLA: LIKELIHOOD CALCULATIONS FOR PERIODS namely E\u0002 e\u0000Bj(rj\u0000ij)1fij<ik<rjgjrk\u0015rj\u0003 . Figure B.1: Forrk\u0015rj. We proceed as in the exponential case by working backwards in time from the nal event rk. We condition on the number of G(m,g)stages for individual kin each time period. Specically, we assume m\u00001\u0000pstages in the period (rj,rk), pin the period (ik,rj)and one nal stage exactly at ik. Clearly p2(0, ..., m\u00001). This is shown in (rj,rk)) = e\u0000g(rk\u0000rj)gm\u00001\u0000p (m\u00001\u0000p)!(rk\u0000rj)m\u00001\u0000p, since the number of stages that occur follows a Poisson distribution with pa- rameter g. Next, moving in reverse time from rj, we must also consider G(m,g)stages for individual j. Since a total of mof these must occur between ijand rj, we split them such that loccur in remaining m\u0000loccur in (ij,ik), where l2(0, ..., m\u00001). Therefore, for the period (ik,rj)we must allocate pstages for individual kand lstages for individual j. The number of ways to allocate the pstages among a total of l+pis simply given by (l+p p). For time period (ij,ik), only stages for jcontinue to occur and hence we do not need to order these. The last part to consider is the e\u0000Bj(rj\u0000ij)term in the expectation. Note that this is equal to the probability of there being no points in a Poisson process of rate Bjin(ij,rj), and so we must condition on all stages of our infectious 281APPENDIX B: A PPENDIX FOR PBLA: LIKELIHOOD CALCULATIONS FOR GAMMA INFECTIOUS PERIODS processes for jand koccurring before a point in this Bjprocess. We require l+p+1 stages in (ik,rj)(including the stage for kwhich occurs exactly at ik). Since there is an infectious process for koccurring with rate gand another for jwith rate g, which are independent, we may sum them to a Poisson process occurring with rate 2 g. Hence, the probability of l+p+1 stages occurring before a Poisson process of rate Bjis given by\u0010 g 2g+Bj\u0011l+p+1 . Similarly, in (ij,ik) we require m\u0000lstages for jbefore any events in the Poisson process of rate Bj (events for kare no longer occurring), which is given by\u0010 g g+Bj\u0011m\u0000l together with the rest of expression from Equation (B.2.1), the same expression found via direct integration methods in Equation (3.4.12). 282APPENDIX B: A PPENDIX FOR PBLA: LIKELIHOOD CALCULATIONS FOR GAMMA INFECTIOUS PERIODS Case (ii): rk<rj Moving on to the case rk<rj, we again calculate E\u0002 e\u0000Bj(rj\u0000ij)1fik<ij<rkg\u0003 . The arguments required are similar here, for example we now consider the possible locations of ijrather than ik: 1fik<ij<rkg+1fij<ik<rkg+1frk<ij<rjg=1. Then, as before with e\u0000Bj(rj\u0000ij)1fij<ik<rjgjrk<rj\u0003 , though now clearly the conditioning argument is reversed for jand k. We condition again on the number of stages of G(m,g), this time for individual j. We set m\u0000lstages in in Figure B.2. Figure B.2: Forrk<rj. As opposed to the previous case rk\u0015rj, here the term e\u0000Bj(rj\u0000ij)corresponds to there being no points in a Poisson process over the whole time period. Hence, through the aggregation of Poisson processes, the probability of l\u0000pstages 283APPENDIX B: A PPENDIX FOR PBLA: LIKELIHOOD CALCULATIONS FOR GAMMA INFECTIOUS PERIODS for individual jin(rk,rj)is equal to the probability of l\u0000pstages of a Poisson process of rate g+Bj. This is given by e\u0000(g+Bj)(rj\u0000rk)(g+Bj)l\u0000p (l\u0000p)!(rj\u0000rk)l\u0000p. In addition, we require these l\u0000pstages to occur before any points in the Bj Poisson process, the probability of which is given by\u0010 g g+Bj\u0011l\u0000p . For the time period (ik,rk), we require pstages for jas well as mstages for k. The number of ways to allocate j's stages among m\u00001 for kis therefore (m+p\u00001 p)(m\u00001 since the nal stage exactly at ikmust clearly be for individual k. The probability of all m+pstages occurring before any points in the Bj Poisson process is\u0010 g 2g+Bj\u0011m+p . Lastly, for time period (ij,ik)we have the remaining m\u0000lstages for individual k. The probability that these all occur before any points in the Bjprocess is similarly given by\u0010 284APPENDIX B: A PPENDIX FOR PBLA: LIKELIHOOD CALCULATIONS FOR the result of Equation (3.4.12). Expression two: E[yj] Secondly, we use probability arguments to obtain our expression for E[yj]. Recall that E[yj] E\u0002 e\u0000bkjtkj\u0003 , where tkj=rk^ij\u0000ik^ ij. Again, for ease of exposition we write bkj=bin this section. We condition as usual on which of rjis greater. Case (i): rk\u0015rj LIKELIHOOD CALCULATIONS FOR GAMMA INFECTIOUS PERIODS Taking the rst case in Equation (B.2.5), we must calculate E\u0002 e\u0000b(ij\u0000ik)1ik<ij\u0003=E\u0002 e\u0000b(ij\u0000ik)jik<ij\u0003 P[ik<ij]. (B.2.6) is shown in Figure B.3. Figure B.3: Forrk\u0015rj, case 1. Along similar lines to the calculation of E[cjfj], we start by working back- wards from rk. We condition on the number of stages of G(m,g)for individual kwhich occur in each time period. Specically, we assume l\u0000pstages given by P(l\u0000pstages in (rj,rk)) = (l\u0000p)!(rk\u0000rj)l\u0000p, since number of stages in (rj,rk)is Poisson distributed with parameter g. Next, we must consider the period (ij,rj), where we must allocate the remain- ingpstages of G(m,g)forkas well as the total mstages of G(m,g)forj. We construct this as a Poisson process of rate 2 g, choosing an individual korj at each stage event with probability1 2. This occurs with overall probability (1 2)m+p. In addition we require the number of ways to allocate the pstages among the total m\u00001+p(since the last event in the total mforjmust occur at ij). This is given by (m\u00001+p p). Finally we consider time period (ik,ij). We have m\u0000lstages remaining for k, which must all occur before a Poisson process of rate b(as given by the expectation in (B.2.6)), giving\u0000g g+b\u0001m\u0000l. 286APPENDIX B: A PPENDIX FOR PBLA: LIKELIHOOD CALCULATIONS FOR GAMMA INFECTIOUS PERIODS Combining all of the constituent parts, we Equation (B.2.5), we calculate E[1\u00021ik>ij] =P[ik>ij] =1\u0000P[ik<ij]. This probability is the same as that calculated in the rst case of Equation (B.2.5), and is rk<rj 287APPENDIX B: A PPENDIX FOR PBLA: PERIODS Now for rk<rj, tkj=8 >>>>>< >>>>>:rk\u0000ikifrk<ij<rj, write bkj=bfor ease of exposition. For the rst of these three cases, E\u0002 e\u0000b(rk\u0000ik)1rk<ij<rj\u0003=E\u0002 e\u0000b(rk\u0000ik)]E[1rk<ij<rj\u0003 , since time period rk\u0000ikis independent of the event rk<ij<rj. The rst term is equal to the probability that mstages of a Poisson process of rategoccur before a Poisson process of rate b, given by\u0010 g g+b\u0011m . The second term is equal to the probability that, working back in time from rj,ijoccurs before rk. This is given by Fm,g(rj\u0000rk). Combining these arguments, E\u0002 e\u0000b(rk\u0000ik)1rk<ij<rj\u0003=\u0010g g+b\u0011m PPENDIX FOR PBLA: LIKELIHOOD CALCULATIONS FOR GAMMA INFECTIOUS PERIODS Figure B.4 shows the timeline for this case, and the calculations are similar to those seen previously. We condition on there being m\u00001\u0000pstages for individual jin the period (rk,rj), with p+1 further stages in (ij,rk)for p2(0, 1, . . m). The m\u00001\u0000pstages in (rk,rj) is equal to e\u0000g(rj\u0000rk)gm\u00001\u0000p (m\u00001\u0000p)!(rj\u0000rk)m\u00001\u0000p. Moving back to the previous time stage (ij,rk), we require p+1 stages for individual jas well as setting lstages for individual k, for l2(0, 1, . . . , m\u00001). These form a Poisson process of rate 2 g, the probability of which occurring is (1 2)p+l+1. The number of ways to allocate pstages for jamong the lfork(since the last event must necessarily be for jatij) is given by (l+p p). Lastly we consider time period (ik,ij). Here we have m\u0000lremaining stages fork, to occur before a Poisson process of rate b. The probability of this is\u0010 g g+b\u0011m\u0000l . =1\u0000E\u0002 e\u000001ik<ij<rk\u0003\u0000Fm,g(rj\u0000rk), where the term E\u0002 e\u000001ik<ij<rk\u0003 the second case above, given (B.2.10), with b=0. 289APPENDIX B: A PPENDIX agreement with Equation (3.4.12), and so overall the whole likelihood expression agrees with that obtained via integration arguments. 290Bibliography H. Abbey. An examination of the Reed-Frost theory of Human Biology , 24(3), 1952. I.M. Longini, and M. Haber. A generalized stochastic model for the analysis of infectious disease nal size data. Biometrics , 47(3):961-974, 1991. S. Alexandersen, Z. Zhang, A.I. Donaldson, and A.J.M. Garland. The Patho- genesis and Diagnosis of Foot-and-Mouth Disease. Journal of Comparative Pathology , 129:1-36, 2003. C.L. Althaus. Estimating the reproduction number of Ebola virus (EBOV) dur- ing the 2014 outbreak in West Africa. PLoS Currents Outbreaks , 6, 2014. R.M. Anderson and R.M. May. Directly transmitted infections diseases: control by vaccination. Science , 215(4536):1053-1060, 1982. R.M. Anderson and R.M. May. Infectious diseases of humans . Oxford University Press, 1991. H. Andersson and T Britton. Stochastic epidemic models and their statistical anal- ysis. Springer, 2000. C. Andrieu and J. Thoms. A tutorial on adaptive MCMC. Statistical Computing , 18:343-373, 2008. N.T.J. Bailey. The mathematical theory of infectious diseases and its applications . Charles Grifn and Company LTD., 1975. 291BIBLIOGRAPHY N.T.J. Bailey and A.S. Thomas. The estimation of parameters from population data on the general stochastic epidemic. Theoretical Population Biology , 2:253- 270, 1971. S. Baize, D. Pannetier, Rieger, L. Koivogui, N. Magassouba, B. Soropogui, M. S. Sow, S. Ke\u00efta, H. De Clerck, A. Tiffany, G. Dominguez, M. Loua, A. Traor\u00e9, M. Koli\u00e9, E. R. Malano, E. M\u00e9ly, H. Raoul, V Caro, Pahlmann, Van Herp, and S. G\u00fcn- ther. Emergence of Zaire Ebola virus in Guinea. The New England Journal of Medicine , 371:1418-1425, 2014. F.G. Ball, D. Mollison, and G. Scalia-Tomba. Epidemics with two levels of mixing. The Annals of Applied Probability , pages 46-89, 1997. F.G. Ball, T. Britton, and P .D. O'Neill. Empty condence sets for epidemics, branching processes and and sums of dissoci- ated random variables. Advances in Applied Probability , 17(1):147-162, 1985. M. Barth\u00e9lemy, A. Barrat, R. Pastor-Satorras, and A. Vespignani. Dynamical patterns of epidemic outbreaks in complex heterogeneous networks. Journal of Theoretical Biology , 235:275-288, 2005. M.S. Bartlett. Some evolutionary stochastic processes. Journal of the Royal Sta- tistical Society Series B , 11:211-229, rates. Statistical Science , 8(2):82-119, 1993. N.G. Becker. Estimation for an epidemic model. Biometrics , 32:769-777, 1976. N.G. Becker. Analysis of infectious disease data . Routledge, 1989. 292BIBLIOGRAPHY N.G. Becker. Uses of the EM algorithm in the analysis of data on HIV/AIDS and other infectious diseases. Statistical Methods in Medical Research , 6(1): 24-37, 1997. N.G. Becker. Modeling to inform infectious disease control . Chapman and Hall/CRC, 2015. N.G. Becker and T. Britton. Statistical studies of infectious disease incidence. Journal of the Royal Statistical Society Series B , 61(2):287-307, 1999. N.G. Becker and J. L. Hopper. Assessing the heterogeneity of disease spread through a community. American Journal of Epidemiology , 117(3):362-374, 1983. J.M. 1994. M.G. Blum and V .C. Tran. HIV with contact tracing: a case study Bayesian computation. Biostatistics Bayesian inference for stochastic epidemic models with time-inhomogeneous removal rates. Journal of Mathematical Biology , 55: 223-247, 2007. T. Britton and N.G. Becker. Estimating the immunity coverage required to prevent epidemics in a community of households. Biostatistics , 1(4):389-402, 2000. T. Britton and for stochastic epidemics in pop- ulations with structure. Scandinavian Journal of Statistics , 29(3): 375-390, 2002. T. Britton, P .D. O'Neill, and T. Kypraios. Inference for Epidemics with Three Levels of Mixing: Methodology and Application to a Measles Outbreak. Scandinavian Journal of Statistics , 38(3):578-599, 2011. T. Britton, T. House, A.L. Lloyd, D. Mollison, S. Riley, and P . Trapman. Five challenges for stochastic epidemic models involving global transmission. Epidemics , 10:54-57, 2015. 293BIBLIOGRAPHY R. Brookmeyer. Reconstruction and future trends of the AIDS epidemic in the United States. Science , 253(5015):37-42, 1991. S. Brooks, A. Gelman, G. Jones, and X.L. Meng. Handbook of Markov Chain Monte Carlo . CRC Press, 2011. E. Brooks-Pollock, G.O. Roberts, and M.J. Keeling. A dynamic model of bovine tuberculosis spread and control in Great Britain. Nature , 511:228-231, 2014. F. Brown. New approaches to vaccination against foot-and-mouth disease. Vaccine , 10(14):1022-1026, 1992. S. Cauchemez and N.M. Ferguson. Likelihood-based estimation of continuous-time epidemic models from time-series data: application to measles transmission in London. Journal of the Royal Statistical Society In- terface , 5:885-897, 2008. Centers for Disease Control and Prevention. Ebola Previous Case Counts. https://www.cdc.gov/vhf/ebola/outbreaks/2014- west- africa , Accessed Fenimore, and J.M. Hyman. The basic reproductive number of Ebola and the effects of pub- lic health measures: the cases of Congo and Uganda. Journal of Theoretical Biology , 229(1):119-126, 2004. G. Chowell, P . Diaz-Duenas, J.C. Miller, Alcazar-Velazco, J.M. Hyman, P .W Fenimore, and C. Castillo-Chavez. Estimation of the reproduction number of dengue fever from spatial epidemic data. Mathematical Biosciences , 208: 571-589, 2007. D. Clancy and P .D. O'Neill. Bayesian estimation of the basic reproduction number in stochastic epidemic models. Bayesian Analysis , 3:737-758, 2008. D.R. Cox and N. Read. A note on pseudolikelihood constructed from marginal densities. Biometrika Fran\u00e7ois. Approximate Bayesian Computation (ABC) in practice. Trends in Ecology and Evolution , 25(7):410-418, 2010. D.J. Daley and J. Gani. Epidemic modelling: Univer- sity Roberts, J.V . Ross, and M.C. Vernon. Networks and the Epidemiology of Infectious Disease. Interdisciplinary Perspectives on Infectious Diseases , 2011. D. De Angelis, A. M. Presanis, P . J. Birrell, G. S. Tomba, and T. House. Four key challenges in infectious disease modelling using data from multiple sources. Epidemics , 10:83-87, 2015. N. Demiris and P .D. O'Neill. Bayesian inference for epidemicswith two levels of mixing. Scandinavian Journal of Statistics , 32(2):265-280, 2005. A.P . Dempster, N.M. Laird, and D.B. Rubin. Maximum Likelihood from In- complete Data via the EM Algorithm. Journal of the Royal Statistical Society, Series B , 39(1):1-38, 1977. P .J. Diggle. Spatio-temporal point processes, partial likelihood, foot and mouth disease. Statistical Methods in Medical Research , 15(4):325-336, 2006. M. Eichner and K. Dietz. Transmission potential of smallpox: estimates based on detailed data from an outbreak. American Journal of Epidemiology , 158(2): 110-117, 2003. A. Eto, T. Saito, H. Yokote, I. Kurane, and Y. Kanatani. Recent advances in the study of live attenuated cell-cultured smallpox vaccine LC16m8. Vaccine , 33(45):6106-6111, 2015. Donnelly, Anderson. The foot-and-mouth epi- demic in Great Britain: Pattern of spread and impact of interventions. Sci- ence, 413:542-547, 2001. 295BIBLIOGRAPHY N.M. Gani, B.T. Grenfell, R.M. An- derson, and S. Leach. Planning for smallpox outbreaks. Nature , 425:681-685, 2003. J.A.N. Filipe and G.J. Gibson. Studying and approximating spatio-temporal models for epidemic spread and control. Philosophical Transaction of the Royal Society B , 353:2153-2162, 1998. C. Fronterr\u00e8, E. R. Gani and S. Leach. Transmission potential of smallpox in contemporary publications. Nature , 414:748-751, 2001. A.E. Gelfand and A.F.M. Smith. Sampling-based approaches to calculating marginal densities. Journal of the American Statistical Association , 85(410):398- 1996. A. Gelman, X.L. Meng, and H. Stern. Posterior predictive assessment of model tness via realized discrepancies. Statistica Sinica , Data Analysis 3rd edition, 2013. S. Geman and D. Geman. Stochastic Relaxation, Gibbs Distributions, and the Bayesian Restoration of Images. IEEE Transactions on Pattern Analysis and Machine Intelligence , 6:721-741, 1984. J. Geweke. Evaluating the accuracy of sampling-based approaches to the cal- E. Estimating Parameters in Stochastic Compart- mental Models using Markov Chain Methods. IMA Journal of Mathematics Applied in Medicine and Biology , 15:19-40, 1998. W.R. Gilks, S. Richardson, and D. Spiegelhalter. Markov Chain Monte Carlo in practice . CRC Press, 1995. A. Golightly, D.A. Henderson, and C. Sherlock. Delayed acceptance particle MCMC for exact inference in stochastic kinetic models. Statistics and Com- puting , pages 1-17, 2014. M.J. Grubman and B. Baxt. Foot-and-Mouth Disease. Clinical Microbiology Reviews , 17(2):465-493, 2004. H. Haario, E. Saksman, Containing Science , 298:1428-1432, 2002. J. Hammond and D.A.J. A of common-cold epi- demics Da Cunha. Journal of Hygiene (Cambridge) , 69(3):423-433, 1971. W. Hastings. Monte carlo sampling using markov chains and their applica- tions. Biometrika , 57:97-109, 1970. Hayakawa, and P .S.F. Yip. Bayesian inference for a stochastic epidemic model with uncertain numbers of susceptibles for sev- eral types. Australian and New Zealand Journal of Statistics , 45(4):491-502, 2003. J.A.P . Heesterbeek and K. Arita. The Smallpox Threat: A Time to Reconsider Global Policy. Biosecurity and Bioterrorism: Biodefense Strategy, Practice, and Science , 12(3):117-121, 2014. R.M. Huggins, P .S.F. Yip, and E.H.Y. Lau. A note on the estimation of the initial number of susceptible individuals in the general epidemic model. Statistics and Probability Letters , 67:321-330, 2004. R.E. chain Monte Carlo in practice: a roundtable discussion. The American Statistician , 52(2):93-100, 1998. M.J. Keeling and K.T.D. Eames. Networks and epidemic models. Journal of the Royal Statistical Society Interface , 2(4):295-307, 2005. W.O. Kermack and A.G McKendrick. A contribution to the mathematical the- ory of epidemics. Proceeding of the Royal Society A , 115:700-721, 1927. epi- demics and a new class of semi-parametric time series models. 2007. T. Kypraios. A note on maximum likelihood estimation of the initial num- ber of susceptibles in the general stochastic epidemic model. Statistics and Probability Letters , 79(18):1972-1976, 2009. T. Kypraios, P . Neal, and D. A tutorial introduction to Bayesian infer- ence for stochastic statistical genetics. Statistica Sinica , 21:43-69, 2011. E.H.Y. Lau and P .S.F. Yip. Estimating the basic reproductive number in the general epidemic model with an unknown initial number of susceptible in- dividuals. Scandinavian Journal of Statistics , 35:650-663, 2008. 298BIBLIOGRAPHY M.S.Y. Lau, G. Marion, G. Streftaris, and G.J. Gibson. New model diagnostics for spatiotemporal systems in epidemiology and ecology. Journal of the Royal Society Interface , 11, 2014. P .M. Lee. Bayesian statistics: an introduction . John Wiley and Sons, 2012. A.L. Lloyd. Realistic Distributions of Infectious Periods in Epidemic Models: Changing Patterns of Persistence and Dynamics. Theoretical Population Biol- ogy, 60(1):59-71, 2001. A.G. McKendrick. Applications of mathematics to medical problems. Proceed- ings of the Edinburgh Mathematical Society , McKinley, A.R. Cook, in epidemic out likelihoods. The Biostatistics , Bayesian inference epidemic Statistics Modeling potential re- sponses to smallpox as a bioterrorist weapon. Emerging Infectious Diseases 7: 959-969, 2001. N. Metropolis, A.W. Rosenbluth, M.N. Rosenbluth, A.H. Teller, and E. Teller. Equations of state calculations by fast computing machines. Journal of Chem- ical Physics , 21(6):1087-1092, 1953. D. Mollison. Epidemic Models: Their Structure and Relation to Data . Cambridge University Press, 1995. R.S. Morris, J. Wilesmith, M.W. Stern, R.L Sanson, and M.A. Stevenson. Pre- dictive spatial modelling of alternative control strategies for the foot-and- mouth disease epidemic in Great Britain. Veterinary Record , 149:137-145, 2001. 299BIBLIOGRAPHY P . Neal and G. Roberts. Statistical inference and model selection for the 1861 Hagelloch measles epidemic. Biostatistics , 5(2):249-261, 2004. P . Neal and G. Roberts. A case study in non-centering for data augmentation: Stochastic epidemics. Statistics and Computing , 15:315-327, 2005. M.E.J. Newman. Spread of epidemic disease on networks. Physical Review E , 66(1), 2002. S.W.B. Newsom. Pioneers in infection control: John Snow, Henry Whitehead, the Broad Street pump, and the beginnings of geographical epidemiology. Journal of Hospital Infection , 64:210-216, 2006. C. Oh. Improved estimation of the initial number of susceptible individuals in the general stochastic epidemic model using penalized likelihood. The Scientic World Journal , 2014, 2014. P .D. O'Neill. Introduction and snapshot review: Relating infectious disease transmission models to data. Statistics in Medicine , 29(20):2069-2077, 2010. P .D. O'Neill and N.G. Becker. Inference for an epidemic when susceptibility varies. Biostatistics , 2:99-108, 2001. P .D. O'Neill and G.O. Roberts. Bayesian inference for partially observed stochastic epidemics. Journal of the Royal Statistical Society Series A , 162:121- 283, 1999. O. Papaspiliopoulos, G. Roberts, and M. Sk\u00f6ld. Non-centered parameterisa- tions The genomic and epidemiological dynamics of human influenza A virus. Nature , 453(7195):615-619, 2008. 300BIBLIOGRAPHY J. Ray and Y.M. Marzouk. A Bayesian method for inferring transmission chains in a partially observed epidemic. Proceedings of the Joint Statistical Meetings , pages 3-7, 2008. G.O. Roberts and S.K. Sahu. Updating Correlation Structure, Block- ing and Parameterizationfor the Gibbs Sampler. Journal of the Royal Statisitcal Society Series B , 59(2):291-317, 1997. G.O. Roberts, A. Gelman, and W.R. Gilks. Weak convergence and optimal scaling of random walk Metropolis algorithms. Annals of Applied Probability , 7(1):110-120, 1997. D. Rubin. Bayesianly justiable and relevant frequency calculations for the applied statistician. Annals of Statistics , 12(4):1151-1172, 1984. R. Shanmugan. Spinned Poisson distribution with appli- cation. Health Science , 14:299-306, S. Gooch, H.E. Tyrrell. Common colds Tristan Da Cunha. Journal of Hygiene (Cambridge) , 69(2):255-262, 1971. S.A. Sisson, Y. Fan, and M.M. Tanaka. Sequential Monte Carlo without likeli- hoods. Proceedings of the National Academy of Sciences , 104(6):1760-1765, 2007. J.E. Stockdale, P .D. O'Neill, and T. Kypraios. Modelling and of A.G. and S.A. Sisson. Using Approximate Bayesian Computation to estimate tuberculosis transmission parameters from genotype data. Genetics , 173(3):1511-1520, 2006. 301BIBLIOGRAPHY M.A. Tanner and W.H. Wong. The Calculation of Posterior Distributions by Data Augmentation. Journal of the American Statistical Assosiation , 82(398): 528-540, 1987. S. and P .Donnelly. Inferring coalescence times from DNA sequence data. Genetics , 145(2):505-518, 1997. D. Thompson and W. Foege. Faith Tabernacle smallpox epidemic. Abakaliki, Nigeria. World Health Organization , 3:1-9, 1968. L. Tierney. Markov Chains for Exploring Posterior Distributions. The Annals of Statistics , 22(4):1701-1728, 1994. T. Toni, D. Welch, N. Strelkowa, A. Ipsen, and M.P .H. Stumpf. Approximate Bayesian computation scheme for parameter inference and model selection in dynamical systems. Journal of the Royal Statistical Society Interface , 6:187- 202, 2009. C. Varin, N. Read, and D. Firth. An overview of composite likelihood methods. Statistica Sinica , 21:5-42, 2011. C.J. Worby, P .D. B.S. Cooper. Reconstructing transmission trees for communicable diseases using densely sampled genetic data. Annals of Applied Statistics , 10(1):395-417, 2016. World Health Organisation. The Independent Advisory Group on Public Health Implications of Synthetic Biology Technology Related to Smallpox. World Health Organization , WHO/HSE/PED/2015, 2015. World Health Organisation. WHO Ebola data and statistics. http://apps. who.int/gho/data/node.ebola- sitrep , Accessed 2017-11-27. F. MCMC for temporal epidemics via parameter Statistics and Data Analysis , 80:240-250, 2014. 302BIBLIOGRAPHY X. Xu, T. Kypraios, and P .D. O'Neill. Bayesian non-parametric inference for stochastic epidemic models using Gaussian Processes. Theoretical Population Biology , 17(4):619-633, 2016. P .S.F. Yip. Estimating the initial relative infection rate for a stochastic epidemic model. Biostatistics , 36:202-213, 1989. 303 "}