{"title": "Redefining tumor classification and clinical stratification through a colorectal cancer single-cell atlas", "author": "Ateeq M Khaliq; Zeyneb Kurt; Miles W Grunvald; Cihat Erdogan; Sevgi S Turgut; Tim Rand; Sonal Khare; Jefferey A Borgia; Dana M Hayden; Sam G Pappas; Henry R Govekar; Anuradha R Bhama; Ajaypal Singh; Richard A Jacobson; Audrey E Kam; Andrew Zloza; Jochen Reiser; Daniel V Catenacci; Kiran Turaga; Milan Radovich; Sheeno Thyparambil; Mia A Levy; Janakiraman Subramanian; Timothy M Kuzel; Anguraj Sadanandam; Arif Hussain; Bassel El-Rayes; Ameen A Salahudeen; Ashiq Masood", "url": "https://www.biorxiv.org/content/10.1101/2021.02.02.429256v1", "hostname": "biorxiv.org", "description": "Colorectal cancer (CRC), a disease of high incidence and mortality, exhibits a large degree of inter- and intra-tumoral heterogeneity. The cellular etiology of this heterogeneity is poorly understood. Here, we generated and analyzed a single-cell transcriptome atlas of 49,859 CRC cells from 16 patients, validated with an additional 31,383 cells from an independent CRC patient cohort. We describe subclonal transcriptomic heterogeneity of CRC tumor epithelial cells, as well as discrete stromal populations of cancer-associated fibroblasts (CAFs). Within CRC CAFs, we identify the transcriptional signature of specific subtypes that significantly stratifies overall survival in more than 1,500 CRC patients with bulk transcriptomic data. We demonstrate that scRNA analysis of malignant, stromal, and immune cells exhibit a more complex picture than portrayed by bulk transcriptomic-based Consensus Molecular Subtypes (CMS) classification. By demonstrating an abundant degree of heterogeneity amongst these cell types, our work shows that CRC is best represented in a transcriptomic continuum crossing traditional classification systems boundaries. Overall, this CRC cell map provides a framework to re-evaluate CRC tumor biology with implications for clinical trial design and therapeutic development. ### Competing Interest Statement The authors have declared no competing interest.", "sitename": "Biorxiv", "date": "2021-02-03", "cleaned_text": "ABSTRACT Colorectal cancer (CRC), a disease of high incidence and mortality, exhibits a large degree of inter- and intra-tumoral heterogeneity. The cellular etiology of this heterogeneity is poorly understood. Here, we generated and analyzed a single-cell transcriptome atlas of 49,859 CRC cells from 16 patients, validated with an additional 31,383 cells from an independent CRC patient cohort. We describe subclonal transcriptomic heterogeneity of CRC tumor epithelial cells, as well stromal populations of cancer-associated fibroblasts (CAFs). Within CRC CAFs, we the transcriptional signature of specific subtypes that significantly stratifies overall survival in more than 1,500 CRC patients with bulk transcriptomic data. We demonstrate that scRNA analysis of malignant, stromal, and immune cells exhibit a more complex picture than portrayed by bulk transcriptomic-based Consensus Molecular Subtypes (CMS) classification. By demonstrating an abundant degree of heterogeneity amongst these cell types, our work shows that CRC is best represented in a transcriptomic continuum crossing traditional classification systems boundaries. Overall, this CRC cell map provides a framework to re-evaluate CRC tumor biology with implications for clinical trial design and therapeutic development. Main Colorectal cancer (CRC) is the third most commonly diagnosed cancer and a leading cause of cancer-related mortality worldwide [1](#ref-1), [2](#ref-2). Approximately 50% of patients experience disease relapse following curative-intent surgical resection and chemotherapy [3](#ref-3), [4](#ref-4). Despite the high incidence and mortality of advanced CRC, few effective therapies have been approved in the past several decades [5](#ref-5). One barrier to the development of efficacious therapeutics is the biological heterogeneity of CRC and its variable clinical course [6](#ref-6). While landmark studies from The Cancer Genome Atlas (TCGA) have defined the somatic mutational landscape within CRC, several studies have shown that stromal signatures, including fibroblasts and cytotoxic T cells, are likely the main drivers of clinical outcomes [7](#ref-7)- [12](#ref-12). These findings suggest that the clinical phenotypes of CRC and by extension, its tumor biology, is shaped by a complex niche of heterotypic cell interactions within the tumor microenvironment (TME) [8](#ref-8)- [12](#ref-12). Bulk gene expression analyses by several independent groups have identified distinct CRC subtypes [13](#ref-13)- [15](#ref-15). Reflecting both the tumor and TME, an international consortium published the Consensus Molecular Subtypes (CMS), which proposed four distinct subtypes of CRC [13](#ref-13), [14](#ref-14), [16](#ref-16). Unfortunately, the association between CMS and meaningful therapeutic response to specific agents have shown inconsistent results across studies and CMS lacks a concordance between primary and metastatic CRC tumors, limiting its utility thus for in clinical decision making [17](#ref-17)- [24](#ref-24). As a result, an improved CMS classification or an alternative classification system is required to improve clinical utility. To overcome the limitations of bulk-RNA sequence profiling, we utilized single-cell RNA sequencing (scRNA-seq) to more thoroughly evaluate the CRC subtypes at the molecular level, including within the context of the currently defined CMS classification. We dissected heterotropic cell states of tumor epithelia and stromal cells, including a cancer-associated fibroblast (CAF) population. The CAF population's clinical and prognostic significance became apparent when CAF signatures were applied to large, independent CRC transcriptomic cohorts. RESULTS We profiled sixteen primary colon tissue samples and eight adjacent non-malignant tissues (24 in total) using droplet-based, scRNA-seq. Altogether, we captured and retained 49,589 single cells after performing quality control for downstream analysis ( [Fig. 1a](#F1), supplementary table 1). All scRNA-seq data were merged and normalized to identify robust discrete clusters of epithelial cells (EPCAM+, KRT8+, and KRT18+), fibroblasts and myeloid cells (LYZ+) using canonical marker genes. Additionally, each cell type compartment was analyzed separately. Cluster v0.4.1 and manual review of differentially expressed genes in each subcluster were studied to choose the best cluster resolution without cluster destabilization (see methods) [25](#ref-25). Cell population designation was chosen by specific gene expression, and SingleR was also utilized for unbiased cell type recognition (see methods) [26](#ref-26)- [29](#ref-29). In addition to cancer cells, we identified diverse cell phenotypes, B cell phenotypes (na\u00efve, memory, germinal and [29](#ref-29). For validation, we additionally profiled 31,383 high-quality, single cells from an independent cohort using stringent criteria to corroborate our findings (see methods) [30](#ref-30). Thus, a total of 81,242 high-quality cells were profiled to produce a single-cell map of 40 colorectal cancer patients. The results of the primary CRC cohort (49,859 single-cells) are available at the Colon Cancer Atlas ( [www.websiteinprogress.com](http://www.websiteinprogress.com)). Malignant colon cancer reveals tumor epithelial cell subclonal heterogeneity and stochastic behavior We detected 8,965 tumor and benign epithelial cells (EPCAM+, KRT8+, and KRT18+) and, on reclustering, produced (designated C1 to C17) ( [Fig. 2a](#F2) and Supplementary Table 2). Clusters were chiefly influenced by colonic epithelial markers, including those for Some tumor-derived clusters (C7, C8, and C13) did not express known colon epithelial markers, potentially representing a de-differentiated state of plasticity ( [Supplementary Fig. 2b](#F7)) [31](#ref-31). Each distinct tumor-derived cluster predominantly patient-specific, reflecting a high degree of inter-patient tumoral cell heterogeneity. In contrast, epithelial populations derived from non-malignant tissue samples from multiple patients clustered together, a pattern observed in previous studies confirming both normal tissue homeostasis and limited sample batch effects ( [Fig. 2a](#F2)) [32](#ref-32), [33](#ref-33). We next aimed to identify gene expression programs shared across these clusters using hallmark pathway analysis [34](#ref-34). A strong overlap was observed for multiple pathways such as activation of inflammatory, epithelial-mesenchymal transformation (EMT), immune response, and metabolic pathways stable (MSS) CRC tumors, considered clinically separate entities, demonstrated similar pathway program activation within the tumor epithelial populations. Each cluster also showed activation of unique pathways such as activation of angiogenesis However, MSI-H tumors differed from MSS tumors based on immune cell infiltration ( [Extended Data Fig. 1](#F19)). Since intratumoral heterogeneity is recognized as a key mechanism contributing to drug resistance, cancer progression, and recurrence, we next focused on dissecting potential transcriptomic states to identify heterogeneity within each patient's tumor [35](#ref-35)- [38](#ref-38). We found that each tumor specimen contained 2-10 distinct tumor epithelial clusters ( [Fig. 2c](#F2)). Gene set variation analysis (GSVA) was performed on cells from individual tumor samples and illustrated the sub-clonal transcriptomic heterogeneity within each specimen ( [Supplementary Fig. 2c](#F7)) [39](#ref-39). Clusters identified in individual pathway analysis demonstrated the up-or down-regulation of crucial metabolic and oncogenic pathways between samples, suggesting wide phenotype variations between cells from the same tumor [40](#ref-40). Given the evidence of intratumoral epithelial heterogeneity, we next performed trajectory inference using pseudotime analysis to identify potential alignments or lineage relationships (i.e., right versus left-sided CRC), CMS classification, or MSI status ( [Fig. 2d](#F2)) [41](#ref-41), [42](#ref-42). This analysis also served as control for inter-patient genomic heterogeneity and provided an orthogonal strategy to confirm the transcriptomic trends we identified. We detected five molecular states (S1n/t to S5n/t) with malignant and normal epithelial cells intermixed along a joint transcriptional trajectory. This observation is consistent with prior studies demonstrating that CRC cells recapitulate normal colon epithelia's multilineage differentiation process as each transcriptional state's pathway activation in both normal and tumor cells was related to normal colon epithelial function of nutrient absorption or maintaining colon homeostasis ( [Supplementary Fig. 3](#F8) and Supplementary Table 3) Additionally, tumor cells showed upregulation of embryogenesis (S2t), consistent with previous findings that tumor cells revert to their embryological states in cancer development (Supplementary Table 4) [45](#ref-45). Interestingly, there were no significant associations with anatomic location, CMS classification, or MSI status within our dataset or an independent dataset of 31,383 single cells ( [Supplementary Fig. 4](#F9)) [30](#ref-30). Hence, in our analysis, CRC development mainly represents a hijacking of the normal epithelial differentiation program, coupled with the acquisition of additional cancer-related exhibit diverse phenotypes, and specific subtypes are associated with poor prognosis We next focused on CRC TME subpopulations. High-quality 819 fibroblasts were re-clustered into eight clusters, and then phenotypically classified into two major subtypes to assess for further CAF heterogeneity. These phenotypic subtypes were found 4) [47](#ref-47). This fibroblast cluster dichotomy was also observed in the independent CRC patient scRNA-seq dataset of 31,383 matrix) and vCAF (vascular) fibroblast subtypes, respectively, as previously described in a mouse breast cancer model [48](#ref-48). Most clusters were found in multiple patients, albeit in varying proportions, signifying shared patterns in CAF transcriptomic programs between patients. Fibroblasts derived from MSI-H tumors were distributed similarly throughout these clusters. CAF-S1 exhibited high chemokine expressions such as enzymes (LOXL1 and LOX) [48](#ref-48). To determine this population's functional significance, we compared the CAF-S1 population transcriptomes to those described recently in breast cancer, lung cancer, and head and neck cancer [49](#ref-49). We recovered five CAF subtypes, within the CAF-S1 population, including ecm-myCAF and matrisome; CST1+, myCAF are known to correlate with immunosuppressive environments and are enriched in tumors with high regulatory T lymphocytes (Tregs) and depleted CD8+ lymphocytes. Additionally, these subtypes are associated with primary immunotherapy resistance in melanoma and lung cancer [49](#ref-49). The CAF subtype is vessel-associated, with hypoxia potentially contributing to invasion and metastasis, as has been shown in another study [48](#ref-48). CAF-S4 clustered into the immature phenotype [Fig. 3c](#F3) and Supplementary [50](#ref-50). Given the correlation between CMS4 and fibroblast infiltration, we next sought to test the existence of CAF-S1 and CAF-S4 signatures in bulk transcriptomic data and their association with clinical outcomes [15](#ref-15). To this end, we interrogated and carried out a meta-analysis of eight colorectal cancer transcriptomic datasets comprising 1,584 samples. We detected a strong and positive correlation between specific gene expressions characterizing each CAF subtype in CRC, pancreatic ( [Fig. 4](#F4)) (see methods for datasets). The gene signatures were specific to each CAF-S1 and CAF-S4, thus confirming their existence in colorectal cancers and other tumor types. We found high CAF-S1 and CAF-S4 signatures associated with poor median overall-survival and early cancer recurrence (HR>1, p<0.05), irrespective of CMS in three independent CRC datasets ( [Supplementary Fig 7](#F12)). Additionally, CAF signatures stratified the CMS4 subtype into high- and low-risk overall survival in all datasets, thus identifying additional heterogeneity and providing prognostication in this aggressive patient subgroup ( [Fig. 4b-d](#F4)). Here, using scRNA-seq, we show for the first time that high CAF infiltration in CRC is associated with poor prognosis across all molecular subtypes, and which further stratifies the CMS4 subgroup into high and low-risk clinical phenotypes in CRC cohorts. Single-cell RNA sequencing reveals heterogeneity beyond Consensus Molecular Subtypes in colorectal cancers and offers therapeutic opportunities The lack of association between tumor epithelia and CMS classification, as well as the survival differences between high- and low-risk CAF signatures across CRC molecular subtypes suggest CRCs are much more heterogeneous than the traditional classification systems have indicated (e.g. those systems defined by somatic alterations, epigenomic features, and bulk gene expression data) [13](#ref-13), [14](#ref-14), [51](#ref-51), [52](#ref-52). Among these the widely adopted CMS classification, which reflects both the malignant cell phenotypes and the TME, classified CRC transcriptomic signatures [15](#ref-15). To test our hypothesis, we estimated every cell type fraction using single-cell data from eight pooled datasets (>1,500 samples) with a machine-learning algorithm, CIBERSORTx [53](#ref-53). When we compared epithelial, immune, and stromal cell populations among the CMS subtypes, we did not detect a distinct pattern of tumor, immune, or stromal cell signatures across the different CMS subtypes. Each CMS subtype was enriched in these cell types in varying proportions but without a clear distinctions between the four subtypes, suggesting a lack of clear separation among the CMS subsets at the single-cell resolution ( [Fig. 5a-b](#F5)). Upon analysis of four independent bulk RNA datasets, there was significant discordance in terms of cell phenotype enrichment with respect to each CMS subtype across the datasets except CMS4 which had predominant stromal enrichment ( [Supplementary Figs. 8-11](#F13)) [54](#ref-54). These discordant results could be due to intra-patient CMS heterogeneity, intratumoral variation in tumor purity, stromal and immune cell infiltration, and CMS's inability to address tumor/TME-to-tumor/TME variability, among others [16](#ref-16). Thus, novel approaches that consider these factors are required to stratify patients for optimal biomarker and therapeutic development. Based on the above findings, we postulate that CRC is more accurately represented in a transcriptomic continuum previously proposed by Ma et al. [55](#ref-55). The authors analyzed bulk transcriptomic data using a novel computational framework in which clustering methods (k-medoid, and in a transcriptomic continuum [56](#ref-56)- [58](#ref-58). They further carried out principal component analysis and robustly validated two principal components, PC Cluster Subtype Scores 1 and 2 (PCSS1 and PCSS2, respectively). We reasoned that using single-cell data could deepen our understanding of how each cell phenotype contributes to the CRC tumor microenvironment using continuous scores that inform CRC diversity beyond binning CRC into traditional classifications. We evaluated every cell fraction (epithelial, stromal, and immune components) from our data with the Ma et al. algorithm on eight pooled bulk transcriptomic datasets, focusing on PCSS1 and PCSS2, since these were validated in the original study ( [Fig. 5c-d](#F5)). On projecting single-cell expression profiles on quadrants corresponding to each of the four CMS, we noted a lack of separation of all cell phenotypes between CMS subtypes suggesting that CRC exists in a transcriptomic continuum [55](#ref-55). To test continuous scores reproducibility, we analyzed four bulk transcriptomic datasets separately; we found that transcriptional shifts were reproducible across datasets for all major cell types ( [Supplementary Figs. 8-11](#F13)). The continuous scores showed no reliability in classifying CRC into immune-stromal rich (CMS1/CMS4) or immune-stromal desert (CMS2/CMS3) subtypes as proposed previously [21](#ref-21). Thus, confirming continuous scores rather than discrete subtypes may improve classifying CRC tumors and across independent datasets, correlating with the CMS4 subtype. Thus, our analysis identified CAF-S1 as a cell of origin for biological heterogeneity in CMS4 subtypes associated with poor prognosis (Supplementary table 5). DISCUSSION In the present study, we evaluated the CMS classification of CRC that have been developed by bulk RNA-seq through single-cell resolution transcriptomic analysis. We find that stromal cells engender a more significant contribution to biological heterogeneity. Although previous studies employing bulk transcriptomics have demonstrated that the degree of stromal infiltration is associated with prognosis and a small scRNAseq study utilizing 26 fibroblasts demonstrated poor survival among CAF-enriched CRC tumors especially the CMS4 subtype. Here, using much larger sample set of 1,182 high-quality fibroblasts, we identify the CAF-S1 subtype to be the cell of origin associated with poor prognosis across all CRC CMS subtypes and not just CMS4 [59](#ref-59). Further, we developed a novel signature of CAF infiltration and demonstrate that CMS4 can be stratified into risk groups associated with good or poor median overall survival. These findings are significant since the CMS4 subtype, is primarily stromal-driven and is enriched in more than 40% of metastatic CRC samples from patients with worse outcomes [22](#ref-22). We also identified CAF-S1 subtypes associated with certain biological functions in other cancers, including the ecm-myCAF and TGF-myCAF subtypes (responsible for immunotherapy resistance in NSCLC and melanoma), and CAF-S4s known to play a role in inducing cancer cell invasion [49](#ref-49), [50](#ref-50). Thus, targeting CAFs to remodel the tumor microenvironment may lead to improved and much-needed therapeutic development for metastatic CRC patients [22](#ref-22), [23](#ref-23). Targeting of CAFs in solid tumors is being explored in multiple clinical trials with variable results [60](#ref-60)- [62](#ref-62). Such studies likely failed to address CAF heterogeneity and their complex interactions with the other cells of TME. Our study suggests that CRC may be intricately entwined with the stroma, and therefore may be amenable to stromal targeted combinatoric approaches, including monoclonal antibodies that abrogate CAF-S1 function. In future studies, the treatment of CRC patients should involve stroma targeted therapies and take the above aspects into consideration [60](#ref-60), [63](#ref-63). The scRNA-seq or bulk-RNA-seq signatures corresponding to CAF-S1 and CAF-S4 may serve as suitable biomarkers for tumors that are reliant on this axis. Immunotherapy responses in MSS CRC, which comprise almost 95% CRC, are lacking; CAF subpopulations within the TME may be suppressing immune responses in these tumors [64](#ref-64). Based on our analysis, we speculate that targeting CAF-derived chemokines and cytokines via biospecific antibodies, vaccines, or even cell-based therapies, may enhance current checkpoint blockade strategies [60](#ref-60). Functional validation and clinical studies will be required to confirm the clinical utility of targeting these CAF populations in CRC. More importantly, our study's single-cell resolution enables us to investigate whether tumor cell transcriptomes, and by extension, biological phenotypes, are the primary determinant of CMS classification. Based on our findings, it appears that bulk analysis may have been confounded by varying tumor microenvironment population enrichment, and that tumor cells within each patient do not segregate into static phenotypes but rather exhibit considerable plasticity. In contrast, the single-cell analysis uncovered the complex and mixed cellular-phenotypes among each cell specific subpopulation, which projected in a transcriptomic continuum across CMS subtypes. These findings were further supported by scRNA-seq CMS classification analysis that assigned each CRC sample to multiple CMS subtypes thereby suggesting CMS heterogeneity in each CRC tumor [21](#ref-21), [65](#ref-65). These findings may also explain why CMS-defined populations of tumors have not been readily observed in transcriptomic data from independent CRC cohorts [22](#ref-22), [54](#ref-54). Our data indicate that attempts to divide CRC phenotypes into the current discrete subtypes may undermine optimal patient stratification in the clinical trial setting. Intriguingly, by applying two independent algorithms, we demonstrate that CRC tumors and their ecosystems exist in a transcriptomic continuum and not only show tumor-to-tumor variability (as proposed by Ma et al.) but also demonstrate tumor/TME-to-tumor/TME transcriptional variability at the single-cell resolution [55](#ref-55). The continuous scores are reproducible across transcriptomic datasets, thus allowing robust identification of patient subtypes. This may help to optimize CRC treatment in future studies. In conclusion, our study lends strong support to the tumor biology models proposed by Ma et al. (and other groups) and represents a conceptual shift in our understanding of CRC pathogenesis, clinical management, and therapeutic development. Future studies will need to consider tumor-TME to tumor-TME heterogeneity which will be critical for optimizing biomarkers and treatment strategies for CRC. AUTHOR CONTRIBUTIONS A.M. devised, supervised the study, and wrote the manuscript. A.M.K. performed data analyses, wrote the manuscript, and created figures. Z.K. performed data analyses and wrote the manuscript. M.W.G. aided in analysis, wrote the manuscript, and generated figures. A.S. supervised study and wrote manuscript. C.E. and S.S.T. helped with bulk transcriptomic analysis. D.M.H, H.R.G., A.R.B helped with sample collection. All other authors contributed substantially to data interpretation, and manuscript editing. All authors read and approved this manuscript. CODE AVAILABILITY The code generated and utilized in the completion of this publication will be available in a Github repository specific to this project. DATA AVAILABILITY Sequencing data deposition is currently in progress. Ten bulk transcriptomic datasets were accessed from the Gene Expression Omnibus (GEO) database ( [https://www.ncbi.nlm.nih.gov/geo/](https://www.ncbi.nlm.nih.gov/geo/)). COMPETING INTERESTS A.M. and J.A.B. received research funding from Tempus lab. A.S. receives research funding from Bristol-Myers Squibb; Pierre Fabre. Further, A.S. holds patent PCT/IB2013/060416, 'Colorectal cancer classification with differential prognosis and personalized therapeutic responses' and patent number 2011213.2 'Prognostic and Treatment Response Predictive Method.' METHODS Patient and tissue sample collection Patients with resectable untreated CRC who underwent curative colon resection at Rush University Medical Center (Chicago, IL, USA) were included in this Institutional Review Board (IRB)-approved study. CRC specimens from 16 patients including nine Caucasian, six African American and one Asian patient with corresponding 8 adjacent normal tissue samples were processed immediately after collection at Rush University Medical Center Biorepository and sent for scRNA-seq. Thus our scRNA-seq atlas represent diverse patient population. The study was conducted in accordance with ethical standards and all patients provided written informed consent. Droplet based scRNA-seq - 10\u00d7 library preparation and was performed using 10X Genomics Tumors and non-malignant samples dissociated through in DAPI-FACS buffer (PBS, 0.04% BSA). Samples were sorted and viable singlets were gated on the basis of scatter properties and DAPI exclusion. Approximately 3000 cells were pelleted and resuspended in PBS, and cells underwent single cell droplet-based capture on 10X Chromium instruments according to the 10X Genomics Single Cell Platform protocol. Transcriptome libraries post-fragmentation, and A-tailing double-sided size selection, and adaptor ligation also followed the manufacturer's protocol. Illumina NextSeq 550 was used for library sequencing and data were mapped and counted using Cellranger-v3.1.0 (GRCh38/hg38). scRNA-seq data quality control, gene-expression quantification, dimensionality reduction, and identification of cell clusters Cell Ranger was utilized to process the raw gene expression matrices per samples and all samples from multiple patients were combined in R package (v3.6.3 2020-02-29] -- \"Holding the Windsock\"). Seurat in this integrative multimodal analysis [66](#ref-66). Genes detected in fewer than three cells and cells expressing less than 200 detected genes were filtered out and excluded from analysis. In addition, cells expressing > 25% mitochondria were removed. Cell cycle scoring was performed, (for the S phase and the G2M phase) and the predicted cell cycle phases were calculated. Doublet detection and any higher-order multiplets that were not dissociated during sample preparation were removed via the DoubletFinder (v2.0.2) package using default settings [67](#ref-67). Following quality control one non-malignant colon sample (B-cac13) was discarded due to poor data quality. Finally, 49,859 cells remained and were utilized for downstream analysis. We adopted the general protocol described in Stuart et al. (2019) to group single cells into different cell subsets [66](#ref-66). We employed the following steps: clustering the cells within each compartment (including the selection of variable genes for each dataset based on a variance stabilizing transformation [VST]), canonical correlation analysis (CCA) to remove batch effects among the samples, reduction of dimensionality, and projection of cells onto graphs [68](#ref-68), [69](#ref-69). Principal component analysis (PCA) was carried out on the scaled data of highly variable genes [70](#ref-70). The first 30 principal components (PCs) were used to cluster the cells and to perform a subtype analysis by nonlinear dimensionality reduction (t-SNE) and to construct Uniform Manifold Approximation and Projection (UMAP) for cell embeddings [71](#ref-71), [72](#ref-72). We identified cell clusters under the optimal resolution by a shared nearest neighbor (SNN) modularity optimization-based clustering method. We implemented the FindClusters function of the Seurat package, which first calculated k-nearest neighbors and constructed the SNN graph. We implemented the original Louvain algorithm (algorithm = 1) for modularity optimization. Additionally, we utilized Clustree (v0.4.3) and manual review for identifying the best clustering resolution [25](#ref-25). Major cell type detection and data visualization To identify all major cell types, we evaluated differentially expressed markers in each identity cell group by comparing them to other clusters using the Seurat FindAllMarkers function. We used positively expressed genes with an average expression of >/= 2-fold higher in that subcluster than the average expression in the rest of the other subclusters. We used known marker genes, which have the highest fold expression in that cluster with respect to the other clusters. We also utilized SingleR ((v0.99.10, R Package), which leverage large transcriptomic datasets of well-annotated cell types and manual annotation for cell-type identification [32](#ref-32), [73](#ref-73)- [75](#ref-75). Depending on the presence of known marker genes the clusters were grouped as: epithelial cells and CD8B), and B cells (MZB1), 32,48,73,76-80. The cells were eventually assembled into DGE matrices within each compartment, containing all six cell types. Major-cell type subclustering and data visualization Each major cell type, including epithelial cells, endothelial cells, T cells, B cells, myeloid cells, and fibroblasts was reclustered and reanalyzed to study each compartment at a higher resolution to detect granular cellular heterogeneity in CRC. Clustree (v0.4.3) and manual review were utilized for optimal cluster detection. For cell annotation of each cell type, we utilized published literature gene expression signatures and manual review of differential genes among clusters. Additionally, we again utilized SingleR (v0.99.10, R Package) for unbiased cell annotation. Interestingly, reclustering of major compartments individually also detected clusters expressing hybrid markers as well as cell clusters expressing markers from distinct lineages (such as T cell clusters expressing B cells); these were removed and excluded for further analysis. We utilized UMAP for visualization purposes. For validation, we analyzed 65,362 cells from 23 patients and applied the same quality control metrics as outlined above, retaining 31,383 high-quality single cells for further analysis [30](#ref-30). These high-quality cells were analyzed utilizing the same pipelines and parameters as that for our primary cohort ( [Supplementary Figs. 4-5](#F9) and [12-13](#F9)). The InferCNV (v1.2.1) package was used with default paramets to identify the evidence for somatic large-scale chromosomal KRT18+) [81](#ref-81). Non-malignant epithelial cells were used as control group. Trajectory analysis We used Monocle v.2 (v2.14.0), a reverse graph embedding method to reconstruct single-cell trajectories in tumor and non-malignant epithelium [82](#ref-82). In brief, we used UMI count matrices and the negbinomial.size() parameter to create a CellDataSet object in the default setting. We grouped projected cells on UMAP in default settings for visualization of monocle results. We defined the cumulative duration of the trajectory to show the average amount of transcriptional transition that a cell undergoes as it passes from the starting state to the end state. The cells were also ordered in pseudotime to explain the transition of cells from one state to another. Pathway-Gene set variation analysis (GSVA) Pathway analysis was performed on the 50 hallmark gene sets downloaded from Molecular Signatures Database (v7.2). We used GSVA (v1.34.0), a non-parametric, unsupervised method to estimate the gene set variations and evaluation of pathway enrichment, and pathway scores were calculated for each cell using standard settings [34](#ref-34), [39](#ref-39). DNA and bulk RNA library construction DNA and bulk RNA sequencing was performed as previously described [83](#ref-83). One hundred nanograms of DNA from each tumor was mechanically sheared to an average size of 200 bp. Using the KAPA Hyper Prep Pack, DNA libraries were packed, hybridized into the xT probe package, and amplified with the KAPA HiFi HotStart ReadyMix. For uniformity, each sample needed to have 95% of all targeted base pairs sequenced to a minimum depth of 300x. One hundred nanograms of RNA per tumor sample was heat fragmented to a mean size of 200 base pairs in the presence of magnesium. Using random primers, the RNA was used for first-strand cDNA synthesis, followed by second-strand synthesis and A-tailing, adapter ligation, bead-based cleanup, and amplification of the library. After library planning, the IDT xGEN Exome Test Panel was hybridized with samples. Streptavidin-coated beads and target recovery were carried out, accompanied by amplification using the KAPA HiFi library amplification package. The RNA libraries were sequenced on an Illumina HiSeq 4000 using patterned flow cell technology to achieve at least 50 million reads. Detection of somatic variation on DNA sequencing data The tumor and normal FASTQ files were paired. For quality management measurement, FASTQ files were evaluated using FASTQC and matched with Novoalign (Novocraft, Inc.) [83](#ref-83), [84](#ref-84). SAM files were generated and converted to BAM files. The BAM files were sorted, and duplicates were marked. Single nucleotide variations (SNVs) were called after alignment and sorting. For discovery of copy number alterations, the de-duplicated BAM files and the VCF generated from the variant calling pipeline were processed to computate read depth and variance of heterozygous germline SNVs between the tumor sample and normal sample. Binary circular segmentation was introduced and segments with strongly differential log2 ratios between the tumor and its comparator were chosen. From a combination of differential coverage in segmented regions and estimation of stromal admixture provided by analysis of heterozygous germline SNVs, an estimated integer copy number was determined Microsatellite instability status Probes for 43 microsatellite regions were developed using Tempus xT assay [83](#ref-83). Tumors were categorized into three groups by the MSI classification algorithm as described by Tempus: microsatellite instability-high (MSI-H), microsatellite stable or microsatellite equivocal (MSE). MSI screening for paired tumor-normal patients used reads mapped to the microsatellite loci with at least 5 bps flanking the microsatellite. The sample was graded as MSI-H if there was a >70% chance of MSI-H classification. If the likelihood of MSI-H status was 30-70%, the test findings were too ambiguous to interpret and those samples were listed as MSE. If there was a <30% chance of MSI-H status, the sample was called MSS. Additionally, IHC results were used to classify tumors into MSS or MSI molecular subtypes. Both of these modalities were concordant and produced the same results. Bulk RNA-seq and microarray analysis We downloaded and pooled a non-small cell lung cancer dataset (GSE33532 [92](#ref-92)) to validate our findings from the single cell compartments by deconvoluting the bulk gene expression profiles into pseudo single-cell resolutions. We used Affy (v1.64.0) for the data analysis and for exploration of Affymetrix oligonucleotide array probe level data [93](#ref-93). Batch correction was carried out using the removeBatchEffect (v3.42.2) function of the LIMMA program and CMScaller for the CMS classification (see [87](#ref-87), GSE33113 [89](#ref-89), clinical outcome analysis [94](#ref-94), [95](#ref-95). Correlation patterns in bulk gene expressions for CAF compartments To identify the top correlated CAF-marker genes within the combined eight and individual four bulk gene expression sets, we first transformed the bulk gene expression sets with log2transformation. Next, marker genes with an average log2 FC>/= 0.5 and p<0.05 obtained from the SC analysis of CAF-S1 and CAF-S4 compartments were separately intersected with the bulk gene expression sets. Genes with an average Spearman correlation score greater than 0.8 were kept as the CAF signatures within the bulk gene expression. Heatmaps illustrating the correlation patterns within and between the CAF compartments were prepared with the heatmap.2 function from ggplot package (v3.1.1) utilizing the Pearson correlation coefficient. Heatmaps illustrating the correlation patterns within and between the CAF compartments were prepared using the ggplot package (v3.1.1) utilizing the Pearson correlation coefficient [96](#ref-96). The Cox proportional hazard regression model was used to examine the significance of 20 cell types from scRNA-seq in bulk expression data. Each cell type's marker genes with an average logFC>1 and adjusted P<0.05 were intersected with the bulk expression datasets separately. We only kept the marker genes with a high correlation with each other in bulk, which provides an average correlation score of > 0.8. The average bulk expression of each cell type's remaining marker genes was calculated and used in the hazard regression model as the representative of this cell type. For analysis of relationships with patient outcome, univariate models were calculated using Cox proportional hazard regression (coxph function from survival R package) [97](#ref-97). Deconvoluting public bulk gene expression profiles into pseudo single-cell expressions We used CIBERSORTx v1 to estimate composition of various cell populations in pooled eight microarray datasets [53](#ref-53). Signature gene matrices were created using the expression profiles of 49,859 cells as the reference single cell profile. We ran the 'hires' module with default parameters except for the 'rmbatchBmode,' and the bulk-mode batch correction argument was set to true. After the deconvolution process, we normalized the gene expressions according to the cell fractions in each sample and calculated each gene's Z-transformed expression values. The average normalized expression of each cell type across all samples was plotted with the heatmap.3 R function of the GMD package (v0.3.3) [98](#ref-98). A signature matrix highlighting marker genes of the different cell types was prepared with a heatmap.2 R function of ggplot (v3.1.1). We also applied subtyping of colorectal cancer (CMS Classification) We used R package CMScaller(v0.9.2), a nearest template prediction (NTP) algorithm, for the classification of gene expression datasets [95](#ref-95). We set the permutation number to 1000 to predict the CMS classes of the samples in the GEO datasets with a p-value < 0.05. We ran CMScaller with default parameters. Continuous subtype discovery using scRNA-seq analysis Bulk mRNA expression profiles of the combined and batch adjusted in total, were deconvoluted into the pseudo single-cell expression profiles via CIBERSORTx utilizing the expression data consisting of 2o different cell types from our scRNA-seq dataset [53](#ref-53). We transformed the deconvoluted expression matrix with log2 transformation. The principal components cluster subtype scores (PCSSs) of the CMS subtypes among the 1584 samples, were determined separately for each cell type using an algorithm published by Ma et al [55](#ref-55). To obtain the PCSSs, the average loading vectors were used. The results obtained for 20 cell types were projected on the first two PCSSs (PCSS1 and PCSS2) as they were validated by Ma et al. in their analysis using 18 datasets. We also analyzed reproducibility of continuous scores. Statistics and reproducibility All statistical analyses and graphs were created in R (v3.6.3) and using a Python-based computational analysis tool. Schematic representations were made using the Inkscape ( [https://inkscape.org/](https://inkscape.org/)) software. Dim plots, bar plots and box plots were generated using the dittoSeq (v1.1.7) package with default parameters [99](#ref-99). Violin plots were generated using the patchwork (v1.1.0) package and ggplot2 (v3.3.2) package in R with default parameters. Heatmaps were generated using Morpheus.R with default parameters [100](#ref-100), [101](#ref-101). ANOVA and pair-wised t-tests for the CMS classes across the deconvoluted expression profiles were performed in R using the ggpubr R (v0.4.0) package [102](#ref-102). The Box and Whisker plots were generated using the boxplot function of the R base package at default parameters. The mean of the log2 transformed deconvoluted expression value of the samples in each CMS group was demonstrated with a horizontal straight line within each box. The length of a boxplot corresponds to the interquartile range (IQR), which is defined as the range between the first and third quartiles (Q1 and Q3), whereas the whiskers are the upper and lower extreme values of the data (either data's extremum values, or the Q3+1.5*IQR and Q1-1.5*IQR values, whichever was less extreme). Survival analysis Survival curves were obtained according to the Kaplan-Meier method survfit (v3.2-7), and differences between survival distributions were assessed by Log-rank test. The patients were divided into two groups (high/poor and low/good risk) according to their median expression values (survminer (v0.4.8)). The surv_cutpoint function uses the maximally selected rank statistics and implements standard methods for the approximation of the null distribution of maximally selected rank statistics (maxstat (v0.7-25). The proportional hazard assumption was tested to examine the fit of the model for survival of the samples in four GEO the deconvoluted bulk mRNA expressions. For analysis of the relationships with patient outcome, multivariate models were calculated using the Cox proportional hazard regression (coxph survival R package) [97](#ref-97). ACKNOWLEDGEMENTS This study was supported by the startup fund provided to A.M. by the Rush University Medical Center; the OCM grant to A.M by Rush University Cancer Center. Part of A.H.'s time was supported by a Merit Review Award (I01 BX000545) from the Medical Research Service, Department of Veterans Affairs. We would also like to thank Dr. Levi Waldron for sharing code from his publication entitled, \"Continuity of transcriptomes among colorectal cancer subtypes based on meta-analysis.\" Above all we want to thank our patients who participated in this study and their families. REFERENCES - 1. [](#xref-ref-1-1) - 2. [](#xref-ref-2-1) - 3. [](#xref-ref-3-1) - 4. [](#xref-ref-4-1) - 5. [](#xref-ref-5-1) - 6. [](#xref-ref-6-1) - 7. [](#xref-ref-7-1) - 8. [](#xref-ref-8-1) - 9. - 10. - 11. - 12. [](#xref-ref-12-1) - 13. [](#xref-ref-13-1) - 14. [](#xref-ref-14-1) - 15. [](#xref-ref-15-1) - 16. [](#xref-ref-16-1) - 17. [](#xref-ref-17-1) - 18. - 19. - 20. - 21. [](#xref-ref-21-1) - 22. [](#xref-ref-22-1) - 23. [](#xref-ref-23-1) - 24. [](#xref-ref-24-1) - 25. [](#xref-ref-25-1) - 26. [](#xref-ref-26-1) - 27. - 28. - 29. [](#xref-ref-29-1) - 30. [](#xref-ref-30-1) - 31. [](#xref-ref-31-1) - 32. [](#xref-ref-32-1) - 33. [](#xref-ref-33-1) - 34. [](#xref-ref-34-1) - 35. [](#xref-ref-35-1) - 36. - 37. - 38. [](#xref-ref-38-1) - 39. [](#xref-ref-39-1) - 40. [](#xref-ref-40-1) - 41. [](#xref-ref-41-1) - 42. [](#xref-ref-42-1) - 43. [](#xref-ref-43-1) - 44. [](#xref-ref-44-1) - 45. [](#xref-ref-45-1) - 46. [](#xref-ref-46-1) - 47. [](#xref-ref-47-1) - 48. [](#xref-ref-48-1) - 49. [](#xref-ref-49-1) - 50. [](#xref-ref-50-1) - 51. [](#xref-ref-51-1) - 52. [](#xref-ref-52-1) - 53. [](#xref-ref-53-1) - 54. [](#xref-ref-54-1) - 55. [](#xref-ref-55-1) - 56. [](#xref-ref-56-1) - 57. - 58. [](#xref-ref-58-1) - 59. [](#xref-ref-59-1) - 60. [](#xref-ref-60-1) - 61. - 62. [](#xref-ref-62-1) - 63. [](#xref-ref-63-1) - 64. [](#xref-ref-64-1) - 65. [](#xref-ref-65-1) - 66. [](#xref-ref-66-1) - 67. [](#xref-ref-67-1) - 68. [](#xref-ref-68-1) - 69. [](#xref-ref-69-1) - 70. [](#xref-ref-70-1) - 71. [](#xref-ref-71-1) - 72. [](#xref-ref-72-1) - 73. [](#xref-ref-73-1) - 74. - 75. [](#xref-ref-75-1) - 76. - 77. - 78. - 79. - 80. - 81. [](#xref-ref-81-1) - 82. [](#xref-ref-82-1) - 83. [](#xref-ref-83-1) - 84. [](#xref-ref-84-1) - 85. [](#xref-ref-85-1) - 86. [](#xref-ref-86-1) - 87. [](#xref-ref-87-1) - 88. [](#xref-ref-88-1) - 89. [](#xref-ref-89-1) - 90. [](#xref-ref-90-1) - 91. [](#xref-ref-91-1) - 92. [](#xref-ref-92-1) - 93. [](#xref-ref-93-1) - 94. [](#xref-ref-94-1) - 95. [](#xref-ref-95-1) - 96. [](#xref-ref-96-1) - 97. [](#xref-ref-97-1) - 98. [](#xref-ref-98-1) - 99. [](#xref-ref-99-1) - 100. "}