{"title": "PDF", "author": "PDF", "url": "http://www.csun.edu/~dorsogna/mwebsite/papers/STP-1ren.pdf", "hostname": "PDF", "description": "PDF", "sitename": "PDF", "date": "PDF", "cleaned_text": "Journal of Statistical Physics https://doi.org/10.1007/s10955-018-2128-4 Exact Steady-State Distributions of Multispecies Birth-Death-Immigration Processes: Effects of Capacity on Diversity Renaud Dessalles1,2\u00b7Maria D'Orsogna1,3\u00b7Tom Chou1,4 Received: 14 May 2018 / Accepted: 30 July 2018 \u00a9 Springer Science+Business Media, LLC, part of Springer Nature 2018 Abstract Stochastic models that incorporate birth, death and immigration (also called birth-death and innovation models) are ubiquitous and applicable to many problems such as quantifying species sizes in ecological populations, describing gene family sizes, modeling lymphocyte evolution in the body. Many of these applications involve the immigration of new species into the system. We consider the full high-dimensional stochastic process associated with multispecies birth-death-immigration and present a number of exact and asymptotic results at steady state. We further include random mutations or interactions through a carrying capac- ity and nd the statistics of the total number of individuals, the total number of species, the species size distribution, and various diversity indices. Our results include a rigorous anal- ysis of the behavior of these systems in the fast immigration limit which shows that of the different diversity indices, the species richness is best able to distinguish different types of birth-death-immigration models. We also nd that detailed balance is preserved in the sim- ple noninteracting birth-death-immigration model and the birth-death-immigration model with carrying capacity implemented through death. Surprisingly, when carrying capacity is implemented through the birth rate, detailed balance is violated. Keywords Birth-death-immigration processes \u00b7Multispecies \u00b7Steady-state probability distributions \u00b7Diversity \u00b7Mutations 1 Introduction In recent years, stochastic Birth-death-immigration (BDI) models have emerged as effective descriptions of the evolution of multi-species populations. BDI models assume that each indi- B Tom Chou tomchou@ucla.edu 1Department of Biomathematics, University of Universit\u00e9 Paris-Saclay, University, Northridge, CA 91330, USA 4Department of Mathematics, University of California, Los Angeles, CA 90095-1555, USA 123R. Dessalles et al. vidual belongs to a given \"species\" and undergoes a classical birth-death process; offspring populate the same species as their parent, while new species are introduced via immigrationand/or mutation. The body of work on BDI models in the mathematical, ecological and bio-logical literature is rich, and many results have been independently discovered in the contextof different disciplines. Arguably, the rst BDI model can be traced to [ 22] who described the evolution of different alleles in a genetic population. Later, similar tools were applied to ecol-ogy in the context of the \"Neutral Theory of Biodiversity\" [ 18,23,26,34], where BDI models were used to study the abundance distribution of island populations that undergo continuousimmigration from the mainland. BDI models have also been used under the name birth, deathand innovation models by Karev et al. [ 21] to describe gene domain family size in genomes. Here, each domain is part of a family, and can be duplicated or deleted; new domains of newfamilies can be added to the genome via horizontal gene transfer. Desponds et al. [ 10]a n d Lythe et al. [ 25] have instead employed BDI formalisms to study lymphocyte populations in an organism. T-cells expressing the same surface receptor are assumed to belong to the same\"clone\" (the species). Each T-cell can divide, generating receptor-identical daughter cells,and die through apoptosis. In this context, immigration is represented by the export of newna\u00efve T-cells from the thymus. Due to the large number of theoretically possible T-cell clono-types that can be generated, with estimates ranging from 10 15-1020[27], one can assume that each new export almost surely generates a new clone rather than contribute to an existingclonotype. Another application of BDI models arises in the study of microbiota populationsin the gut of metazoa [ 31]. Finally, counting \"clones\" is also used in stochastic models of nucleation, where a high- or innite-dimensional distribution function can be used to describestates comprised of certain numbers of clusters (the \"clones\") of specic size [ 8,12,13]. In the rest of this paper, we will use both \"individuals\" (or \"particles\") and \"species\" to describethe two types of quantities (individuals of a given species and the number of species of agiven size) in all of the above-mentioned examples. Note that we will focus exclusively on \"neutral\" BDI representations in the sense of the Neutral Theory of Biodiversity [ 4,18], that is all individuals within a population are subject to the same birth and death rates so that there is no tness difference in the population. Ourrst model is the simple BDI (sBDI) model where each individual evolves independentlyof all others and where the only possible processes are birth, death and immigration. Thesecond model (BDIM) further includes mutations, whereby the dynamics of each individualis still uncoupled from that of others, but where new species can arise via mutations. Thelast model (BDICC) includes a carrying capacity on the death rate to represent the sharing oflimited resources. In this case, the dynamics of each individual is coupled to that of others,and the overall mathematical analysis is more complex. Thus, for simplicity, when includinga carrying capacity term, we exclude mutations. The three major BDI processes we willanalyze are depicted in Fig. 1. Since measures of diversity in a population are also of signicant interest in ecology [7,9,29], we will also analyze species diversity through three commonly used indexes [ 28]: the species richness (the total number of species in the system), Shannon's entropy, andSimpson's diversity index, and we will contrast and compare these quantities among thedifferent models. The goal of this paper is to provide an accessible, yet rigorous, theoretical analysis of each of the three types of BDI models outlined above. In particular, we determine the conditionsfor the existence of an equilibrium distribution and derive analytical expressions for thesteady state distributions of the total number of individuals, the numbers if clones of eachsize, the total number of species in the system, as well as the expected species diversitiespredicted by model. Some results presented here can be recovered from previous work. 123Exact Steady-State Distributions of Multispecies Birth... (a) (b) (c) Fig. 1 Schematic of various birth-death-immigration processes. Three distinct variants are considered, including asimple birth-death-immigration (sBDI) without mutation, constants, bbirth- death-immigration mutation (BDIM) where r,are constants and mutation rate /epsilon1> 0, and c birth-death-immigration without mutation but with carrying capacity (BDICC) where ris constant and =(N)is an increasing function of total population N. We will also analyze a variant of the BDICC model, the BDICC-bis model, where is constant but the growth r=r(N)is assumed to be a decreasing function of the total population N More precisely, time-dependent versions of our sBDI model can be found in Karlin and McGregor [ 22], Travar\u00e9 [ 33], Lambert [ 23] and one particular version the BDIM model (with somatic mutations) is described in [ 23]. In each case, it is possible to recover the steady state distributions of the total population and the total number of species by evaluating the innite-time limits of their results. Our work provides a number of additional results in the steady state limit: (i) the the- oretical analysis of an interacting BDI model with carrying capacity is new, to the best ofour knowledge; (ii) we provide \"full probability distributions\" that completely describe theproperties of each model and that can be used to derive general quantities of interest, (inparticular, the moments of the species counts); (iii) we analytically quantify diversity indicespredicted by each model; (iv) we provide systematic quantitative comparisons between themodels and (v) we derive simpler limiting forms of our results in the large immigration ratelimit. A summary of all our results can be found in Table 1in the general case and in Table 2 for the fast immigration limit. The interested reader will nd more details of the methods andthe proofs of the derivation of these expressions in the Mathematical Appendix. 2 Basic Denitions In this section we outline some general assumptions and introduce the mathematical nota-tion to describe our three BDI models. First, we assume new individuals immigrate to thesystem following a Poisson point process of rate , i.e. the time interval between succes- sive immigration events is given by a random variable exponentially distributed with rate . Each arriving individual will dene a new species not yet present in the system. The randomvariable representing the total number of individuals in the system will be denoted by Nand the total number of species by C. We consider both \"particle-count\" and \"species-count\" representations ( n iandckrespectively) of the system: in the particle count representation, ni (with 1 iC) represents the number of individuals in the ith species; in the species-count representation, ck(with k1) represents the number of species having exactly kindividuals. In principle, there can be species with innite population and hence both niand the index 123R. Dessalles et al.Table 1 Table summarizing our analytical results Simple birth-death-immigration model (sBDI)Birth-death-immigration model with mutation (BDIM)Birth-death-immigration In each case, the quantities CandNimplicitly depend on the vector /vectorcthrough Eq. ( 1). *Indicates a sufcient condition, for a necessary and sufcient condition, see [ 2, Chapter 1]. The functions fk(x),S1(N)=/summationtextN1 k=0(+rk)1andS2(N)=/summationtextN1 k=0(+rk)2are dened in entries of the rst row 123Exact Steady-State Distributions of Multispecies Birth... Table 2 Table summarizing model results in the fast immigration limit dened by =/tildewide/Omega1,/Omega1 Simple birth-death-immigrationmodel 1 H/log/Omega1andSare expanded to the rst nontrivial term kare unbounded. The sequence of all numbers (ni)iC, the innite vector /vectorc=(ck)k1,a s well as NandC, N=C/summationdisplay i=1ni=/summationdisplay indicator function such that I(x,y)=1i fx=yand 0 otherwise. Effectively, the rst relation in Eq. ( 1) will count the number of species that carry kindividuals. The second relation describes the total number of clones Cthat are present in the system, while Nis the total number of particles in the system. For many applications CandNare large. For example, in humans, the richness of naive T-cells C106-1010[24,25]. The particle-count and species-count representations are related since a given sequence (ni)iCcorresponds to a unique vector /vectorc(determined via the rst relation in Eq. ( 1)). However, given a vector /vectorcone can determine the sequence (ni)iConly up to permutations of the species identities. More information is intrinsically contained in (ni)iCthan in /vectorc. As mentioned, we will also be interested in the statistics of the population diversity, as described by, e.g., Shannon's entropy Hand Simpson's diversity index S. These quantities can be dened using either the diversity exist, we have chosen the \"Gini-Simpson\" index [20] with replacement, also known as the probability of interspecic encounter [ 19], Gini- Martin, or Blau indices [ 15], so that more diverse populations have a higher value of S.O u r choice also allows for analytic derivations not available for other diversity indices. 123R. Dessalles et al. We shall analytically derive, whenever possible, probability distributions over all the quan- tities dened above. Our results will be limited to distributions in steady state. Henceforth,we will dene probabilities of a quantity Xhaving a value xasP(X=x), but we will interchangeably also use the imprecise notation P(X)when no ambiguity exists. After determining results in steady state for each of the three neutral BDI models (sBDI, BDIM, and BDICC ) we will also analyze the asymptotically large immigration limit. Thisregime may relevant to applications where the per-individual immigration rate is higher thantheir birth and death rates, such as in the case of lymphocyte production and maintenance.In particular, we will assume the immigration rate that denes the Poisson point process described above to be proportional to a scaling factor /Omega1(i.e., the immigration rate /tildewide/Omega1 with/tildewidebeing a proportionality constant) and then study the /Omega1 limit. We will show that as/Omega1increases, the above quantities also diverge, however, their scaled values N//Omega1, C//Omega1 and(c k//Omega1)k1 will be shown to converge in distribution. For example, the convergence in distribution of N//Omega1to a given constant limit /lscriptwill be denoted N//Omega1D /Omega1/lscriptand, when /lscriptis a constant, the convergence can be characterized by for any > 0,lim /Omega1P(|N//Omega1/lscript|< )=1( 3 ) (for a more general denition of the convergence in distribution where /lscriptis an arbitrary random variable, see [ 5, Chapter 5]). This type of convergence implies that E[N//Omega1] /Omega1/lscriptand var [N//Omega1] /Omega10. 3 Simple Birth-Death-Immigration Model (sBDI) We start with the neutral and independent simple birth-death-immigration model (sBDI) where individuals are assumed to be identical, subject to the same birth, death and immi-gration rates (neutral), and where the dynamics of each individual is independent of that ofothers (independent). Mutations are not included. One of the most immediate applications ofthis sBDI model is within the study of island biodiversity [ 18,34] where individuals follow classical birth and death processes, and new species are introduced to the island via immi-gration. The ensuing species abundances are then determined. The main ingredients of thesBDI model are depicted in Fig. 1a and include (i) immigration, in which an individual of a new species is added to the system at rate , (ii) birth, in which each individual gives birth to an offspring of the same species at rate r, and (iii) death, where each individual dies and is removed from the system at rate . 3.1 Derivation of Steady State Statistics We now determine the steady-state probability distribution P(N)of the total number of individuals Nin the simple BDI model and the full probability distribution P(/vectorc) P(c1,..., ck,...) at steady-state. This quantity will lead us to the derivation of the marginal steady-state probability distributions P(ck)andP(ni)in the individuals and species count representations, respectively. From P(/vectorc)we will also be able to obtain the probability dis- 123Exact Steady-State Distributions of Multispecies Birth... tribution species Cat steady-state. Finally, Shannon's entropy and Simpson's diversity index will be calculated. The total number of particles Nis a random variable that follows a birth and death process with non-constant rates +rNandN, respectively. The properties of this birth and death process are known (see for instance M\u00e9l\u00e9ard [ 2]); in particular for a nite steady state to exist the condition r< must hold. This constraint implies that death dominates reproduction so that the number of individuals Ndoes not diverge at long times. At steady state, and for r< , detail balance leads to the following condition NP(N)=(+(N1)r)P(N1). (4) This equation can be solved a negative binomial distribution with parameters /randr/,a n d mean and variance E[N]=/ 1r/,var[N]=/ (1r/)2. (6) Equation ( 5) does not resolve how the subpopulations are distributed within the different species. To determine this distribution we must derive the distribution P(/vectorc)over the species- count vector /vectorc=(c1,..., ck,...) by explicitly writing down all possible BDI events their relative by kindividuals the total clone population is kck, within which each cell can duplicate or die with rate ror. The overall birth and death rates for all clones of size kare thus given by rkc kandkck, respectively. We can thus write for every k2, (k1)ck1P(c1,..., ck1,ck,...)=k(ck1)rP(c1,..., ck1+1,ck1,...), (7) and for k=1, c1P(c1,c2,...)=P(c11,c2,...). (8) As shown in Appendix C.1 for the more general case of the BDICC model, by recursion of Eq. ( 1). The prefactor is simply the normalization in Eq. ( 10) corresponds to the N=0 case in Eq. ( 5) since the state with no individuals present in the population can only be represented by theconguration /vectorc=(0,0,...) . We can now use Eq. ( 9) to determine the distribution for the total number of species C. To do this, we consider its moment generating function M C()dened as terms in the last summation in Eq. ( 12) we can easily see that the terms within the sum dene the probability P(c1,..., ck,...) of another simple independent BDI model with immigration rate e. Thus, from normalization, the sum in Eq. ( 12) is equal to one. By writing MC()in the form MC()=exp/bracketleftbigg/parenleftbig e1/parenrightbig rlog/parenleftbigg1 1r//parenrightbigg/bracketrightbigg , which is a moment generating function of a Poisson random variable with parameter (/r)log[1/(1r/)](see . P(ck)for the number of species ckwith kindividuals regardless of all others. By using Eq. ( 11), separating out the ckterms, we which is a Poisson distribution with mean and variance E[ck]=var[ck]= r1 k/parenleftbiggr /parenrightbiggk . (16) Next, we determine the marginal distribution of the number niof individuals belonging to species i. By taking the mean of the rst relation in Eq. ( 1), we nd E[ck]=E/bracketleftBiggC/summationdisplay i=1I(ni,k)/bracketrightBigg non-interacting, the random variables (ni)iCare indepen- dent and identically distributed (iid) and are also independent of C. Thus, for every 1 iC we can write E[I(ni,k)|C]=E[I(n1,k)]=P(n1=k) for which P(n1=k)is still undetermined. The above relation yields E[ck]=E[C]P(n1=k), (17) in which E[ck]andE[C]are determined by Eqs. ( 16)a n d( 14). Since all nivalues are identically distributed and P(ni=k)=P(n1=k), we [ 14] with parameter r/.N o t e that although the distribution P(N)for the total population Ndepends on the immigration rate, the distribution in Eq. ( 18)i sindependent of. This is because each immigration event necessarily introduces a new species but does not influence the dynamics of a species alreadypresent. Once introduced, the evolution of any species depends solely on its birth and deathrates rand. Finally, we can use Eq. ( 11) to determine the expected Shannon's entropy and Simpson's diversity index, as dened in Eq. ( 2). Using a similar procedure to the one used to determine P(c k), we isolate the ckterm in the denition of P(/vectorc)and nd the same form in terms of ck1. Note that we can write the mean of ckf(N), for any function f(N),a s E[ckf(N)]=1 k r/parenleftbiggr /parenrightbiggk By nd the respective expressions for of Nis known and given by Eq. ( 5), we can use Eq. ( 19) to numerically compute E[H]andE[S]. For completeness, we also derive results for the sBDI process with a nite number of clones Qthat each carry a nite immigration rate into the system. In Appendix A.1, we use the detailed balance conditions to derive explicit steady state probability distributions overthe particle count vector n i, the species count vector ck, and the number of clones in the sample C. 3.2 Fast Immigration Limit We now consider the large immigration limit of the sBDI model. While at steady-state the distribution of the number of individuals in each species P(ni),g i v e nb yE q .( 18), is indepen- dent of , the distributions P(N),P(C)andP(ck)do depend on the total immigration rate as indicated in Eqs. ( 5), (13)a n d( 15), respectively. Since immigration always introduces a new species, the per clone immigration rate is zero. To study the large immigration regime in which each clone has a nite immigration rate, we assume /tildewide/Omega1 scales as the parameter /Omega1 , which can be thought of as the total number of different clones that can immigrate into the system per unit time. Increasing will introduce new individuals and new species to the system, so one can intuitively conclude that the total population Nand number of species C, as well as the number of species with kindividuals ck, will also increase. We also show that, as /Omega1increases, the scaled values N//Omega1,C//Omega1andck//Omega1converge in distribution to a constant, as described in Eq. ( 3), with average values rigorous proof is given in Appendix A.2. Moreover, we can also write the convergence in distribution of the scaled Shannon's entropy H/log/Omega1and Simpson's diversity index S, H log/Omega1D /Omega11a d SD /Omega11, as also derived in Appendix A.2. We can now use the scaling results above to infer that E[H] log/Omega1=1O(/Omega11),E[S]=1O(/Omega11). 3.3 Interpretation of Results All distributions computed above depend on two nondimensional quantities: u/rand v1/r(with 0 v< 1). var [C]/var[N]are 123Exact Steady-State Distributions aThe ratios E[C]/E[N]and var [C]/var[N]as a function of v=r/. This ratio is independent of the immigration rate and can be explicitly determined by our theoretical results. b-dAnalytical results for the total richness E[C], Shannon's entropy E[H]and Simpson's index E[S], respectively, h E[C]andE[H]increase with /r,r/,a n dE[N]. Simpson's index E[S]has a similar behavior only if E[N]=uv/(1v)is greater than 10 \"immigration-invariant\" in the sense that they depend only on v=r/and are independent of the immigration rate and/or u. These ratios are plotted in Fig. 2a. For systems where the immigration rate is difcult to estimate, such quantities can be useful probes of the system.For example, E[C]/E[N]represents the relative abundance of species with respect to the total number of individuals in the system. By construction, this ratio cannot exceed unity.The limiting case of E[C]/E[N]1 corresponds to a completely heterogeneous system where every individual belongs to a different species while E[C]/E[N]0 corresponds to homogeneous systems where the entire population is dominated by very few species. In Fig. 2b-d we show the respective heat-maps of E[C],E[H]andE[S]as a function ofu=/randv=/r, along with level-sets of These gures have been generated using Eqs. ( 13)a n d( 19) and show that both E[C]andE[H]increase with u,v ,a n dE[N]. In our plots, E[S]is not strictly monotonic despite the expectation that E[S], as a measure of diversity, would follow the same trend as E[C]andE[H]. However, this qualitative discrepancy occurs only in the small E[N]regime where there is a high probability that there are no individuals in the system and diversity loses its meaning. In the extreme limit of N0, we nd C0a n d H0, but S1, giving rise to the nonmonotonic pattern forE[S]. 4 Birth-Death-Immigration Model with Mutation (BDIM) In this section we consider a birth-death-immigration Model with Mutation (BDIM). Muta- tion events are particularly relevant in ecology as they lead to speciation within populations[23], and in studies of gene domain family evolution [ 21]. In the BDIM process, we still assume individuals and species are non-interacting and that birth, death, immigration, andmutation rates do not depend on the state of the system. We allow an individual of a givenspecies to mutate and give rise to a new, yet unrepresented, species. Mutations are assumedto be neutral in that an individual arising from mutation maintains the same birth and deathrates as the rest of the population. We start by allowing mutations only in offspring arising immediately after their birth, as illustrated in Fig. 1b. For each birth event there is a probability /epsilon1(with 0 /epsilon11) that the offspring is mutated, representing a completely new species. This mechanism is applicableto e.g., bacterial populations where DNA replication can induce a gene mutation that will becarried by the newborn cell. The subsequent theoretical analysis will be carried out withinthe framework of a single mutation at birth as described here. However our mathematical 123R. Dessalles et al. treatment is not limited to this specic case and, in Sect. 4.4, we will apply the same tools to study other relevant scenarios such as \"somatic\" mutations that can occur any time duringthe lifetime of an individual, and \"double\" (or \"symmetric\") mutations where both parentand offspring mutate upon birth. 4.1 Derivation of Steady State Statistics In Sect. 3, we were able to use reversibility and detailed balance to determine P(/vectorc),t h e probability for a given species-count conguration /vectorc=(c1,..., ck,...) to occur. The intro- duction of makes the system irreversible and analytically evaluating P(/vectorc)becomes prohibitively complex. We can nonetheless exploit some general features of the BDIM model, such as neutrality and independence, to extract results such as the mean andthe variance of Candc k. The evaluation of other quantities such as the mean of the diversity indices E[H]andE[S]will require numerical simulations. Our theoretical analysis relies on two important features of the model: Because mutations do not affect overall birth or death rates but only the species to which newborns belong, the distribution for P(N)remains identical to the one derived in Eq. ( 5) for the simple BDI model. Hence, in the BDIM model, the overall growth rate due toimmigration and birth is still +Nrand the overall death rate is still N. The resulting P(N)is independent of mutation events and Eq. ( 5) still holds. The marginal distribution P(n i)of the number of particles niof species istill follows a logarithmic series distribution as in Eq. ( 18), but with the replacement rr(1/epsilon1). Intuitively, this can be understood by noting that under mutation a new individual isintroduced into the n ipopulation with rate r(1/epsilon1)instead of r, since the \"remainder\" r/epsilon1is the rate at which a new individual in a new species arises. The dynamics of the ni individuals thus remains unchanged, provided the birth rate is modied to r(1/epsilon1)to account for the diminished births within the given species. In Appendix B.1 we provide amore rigorous justication of this argument. Also, in Fig. 6of Appendix B.1 we plot the probability distribution for the number of individuals in a given species as determinedfrom simulations of the BDIM model, compare our ndings to the expected logarithmicdistribution, and show good agreement between the two. Thus, both theoretically andnumerically, we verify that P(n i)follows a logarithmic series distribution 0 P(ni)=1 ni/parenleftbiggr(1/epsilon1) /parenrightbiggni1 log[1r(1/epsilon1)/ ]. (20) Once the P(ni)andP(N)distributions are known for the BDIM model we can use Eq. ( 1) and the fact that the (ni)iCare iid and independent of Cto express the mean of the third relation of Eq. ( Distributions of Multispecies Birth... Using the moment generating function of N, we can similarly determine the variance of C as shown in (/r)+log/parenleftbigg 1r(1/epsilon1) /parenrightbigg +1/bracketrightbigg . (22) Finally, the mean of the rst relation in Eq. ( 1). Since all the (ni)iCare iid ck, we also use the denition in the rst relation in Eq. using Eq. ( 20) to take the mean of this expression, and recalling that niis independent ofnj/negationslash=iandC,w e n d E[ckc/lscript]=I(k,/lscript)E[ck]+E[C(C1)]P(ni=k)P(ni=/lscript), var[ck]=E[ck]+var[C]E[C] E[C]2E[ck]2. (24) These expressions are also valid for the sBDI model, but since Candckare Poisson-distributed in that case, var [C]=E[C]and var [ck]=E[ck](see below). We can use Eqs. ( 20), (23), (21), and Appendix B.2 to further develop the second eh a v e var[ck]=E[ck]+/epsilon1(/)( r/) (1r/)2k2/parenleftbiggr(1/epsilon1) /parenrightbigg2(k1) . 4.2 Fast Immigration Limit We now study the large immigration limit of the BDIM model. As done in Sect. 3.2we set =/tildewide/Omega1 and consider the /Omega1 limit. Since the dynamics of N//Omega1remain unchanged in the BDIM model compared to the dynamics in the simple BDI model, we recover convergencein distribution for N//Omega1towards the constant /tildewide/(r)as/Omega1 . Following the same procedures illustrated in Appendix A.2 for the simple BDI model, and using the momentgenerating functions of Candc kwe can also prove the convergence in distribution of 1+N1N1 NP(N)(c) Fig. 3 Comparison of various diversity indices between the sBDI model and the BDIM model at varying values of mutation probability /epsilon1. For both models, we set =1,=1, and r=0.9.aTotal richness Cas determined d( 22).bExpected Shannon's entropy E[H], determined with simulations of the model with mutation at division. cExpected Simpson's diversity index E[S], determined with simulations of the model with mutation at division. In each case, mutation increases diversity (black curves) relative to thatof the sBDI model (blue dot-dashed lines). The maximum diversity is obtained in the limit where mutationalways occurs (i.e. /epsilon1=1) and all individuals belong to different species such that C=N(red dashed lines) (Color gure online) Finally, the convergence in distribution of the scaled Shannon's entropy H/log/Omega1and Simp- son's n d SD /Omega11. 4.3 Interpretation of Results and Comparison with sBDI Model In this subsection we compare features of the sBDI and BDIM models. Note that only three parameters are necessary to characterize all results obtained in both models: u/r0, vr/ ( 0v1),a n d0 /epsilon11. the total richness C, Shannon's entropy H, and Simpson's index Sas dened in E[C]was Eqs. ( 21)a n d( 22), while E[H]andE[S]were found from simulations. The expected diversity indices for the simple BDI model are shown by the dashed red horizontal lines. As can be seen from Fig. 3, all measures of diversity in the BDIM model increase with /epsilon1and reach their maximum at /epsilon1=1 (shown by the blue dot-dashed lines) when all individuals give rise to mutant offspring. Upon setting /epsilon1=1, and assuming a nonzero population N,E q .( 2) yields C=N,H=logNandS=(N1)/N, mirroring the fact that each species only has one individual. By noting that H=0a n d S=1f o the probability distribution of Ng i v e ni nE q .( 5). For general /epsilon1in the BDIM model, since we cannot analytically determine the probability for the species-count vector /vectorc, we cannot derive explicit formulae for E[H]andE[S]as we did for the simple BDI model in Sect. 3. However, we can estimate both E[H]andE[S]by approximating ckwithE[ck]in Eq. compare these approximations with results obtained from numerical simulations in Fig. 7 in Appendix B.1. As can be seen our analytical estimates become more accurate as the averagenumber of individuals E[N]=/(r)increases, that is, for /greatermuchand/greaterorsimilarr.F o r E[N]5, both estimates for Shannon's entropy and Simpson's diversity index fall within 10% of their simulated values. 4.4 Alternative Mutation Mechanisms The BDIM model, as described above, assumes that mutations occur with probability /epsilon1during each birth event. We can very easily adapt the mathematical reasoning used in Sect. 4.1to characterize other types of mutation processes. Note that if mutation events add more speciesto the system, but do not change the overall birth and death rates of the population, the total-population distribution P(N)will remain unchanged from the expression found in Eq. ( 5) for the simple BDI model. This will be the case for the two alternative mutation mechanismsdescribed below. Somatic mut ation: Each individual may spontaneously mutate at constant rate > 0 over its lifetime, giving rise to an individual of a new species. Such a birth-independent mutation might be a reasonable model for e.g., DNA damage or epigenetic changes in a cell. Inthis scenario, for a given n ipopulation, new individuals are added to the same ispecies at rate rniand removed at rate (+)nisince mutation events will effectively transfer an individual from a given species to a new one. Hence, the distribution for P(ni)should remain a logarithmic series distribution as in Eq. ( 18) but with parameter r/(+). All theoretical results found in Sect. 4.1remain the same in this case provided we replace /epsilon1/(+). Double mut ation: Both parent and offspring may spontaneously mutate at birth, as for example in symmetric stem cell differentiation. More generally, we can assume that oneof the two individuals mutates to a new species with probability /epsilon1 1and that both mutate into two new species with probability /epsilon12. In this case, for a given nipopulation, new individuals are added at rate r(1/epsilon11/epsilon12)nito species iand removed at rate (+r/epsilon12)ni. The number of individuals in species ishould thus still be logarithmically distributed as in Eq. ( 18), but with parameter r(1/epsilon11/epsilon12)/(+r/epsilon12). All theoretical results found in Sect. 4.1remain the same, provided we replace /epsilon1(r/epsilon12+(/epsilon1 1+/epsilon12))/(r/epsilon12+). 5 Birth-Death-Immigration Model with Carrying Capacity (BDICC) In the third and nal model analyzed in this paper, we include an important interaction within the total population\u2014a carrying capacity that is typically used to represent resource limi-tations. The more individuals present in a system, the more they need to share resources,potentially affecting survival or reproduction rates. The carrying-capacity concept is ubiq-uitous in ecology such as for species on an island with nite resources that limit the totalpopulation. Other applications may include lymphatic growth which is known to be induced 123R. Dessalles et al. by several molecules, in particular cytokines [ 32] that may become insufcient to sustain further proliferation of T-cells if the population becomes too large. We rst consider a carrying capacity on the death rate of each individual and derive analytical results; more general cases will be addressed via numerical simulations. As shownin Fig. 1c, the only difference between our BDI model with carrying capacity (BDICC) and the sBDI model is that the death rate now depends on the total number of individuals in thesystem N. We assume that (N)is an increasing function with Nas dwindling resources led by population increases will also increase the death rate. It is important to remark thatpopulations described by the BDICC model do not evolve independently. Since the dynamicsof each individual now depends on that of all others, there is a global, but \"neutral\" interaction.In contrast to the two previous models, the number of individuals in each species (n i)iC, can no longer be considered an independent random variable so that E[ck]/negationslash=E[C]P(n1=k). The equality of the quantities on the left and right hand sides above was used in the previous analysis to determine Eqs. ( 17)a n d( 23) and is no longer applicable to the BDICC model. 5.1 Derivation of Steady State Statistics We rst consider the dynamics of the total number of individuals Nand study how P(N)is modied in the BDICC model. In this case, the overall population still undergoes a birth anddeath process with rates +rNand(N)N, respectively. The properties of birth and death process with non homogeneous rates are known [ 2]. In particular, in the case of an increasing function (N)>0, the conditions for the existence of a steady state is lim N(N)>r. More general conditions for the existence of a steady-state conguration have been detailed in the case of a non-increasing death rate (N)[2]. If a steady-state exists, then P(N)can be found using detailed balance, similar to what was done in Sect. 3 P(N)= 1 Z,r,N=0, 1 Z,r1 N!N1/productdisplay (k+1). To determine P(/vectorc),P(C)and P(ck), we rely on reversibility of the system and detailed balance. Interestingly, while a non-constant death rate (N)preserves detailed balance, a non-constant growth function r(N)does not strictly obey detailed balance. We will come 123Exact Steady-State Distributions of Multispecies Birth... back to this point further in the discussion, in Sect. ( 5.3.2 ). For now, we consider (N)and constant rand write all possible transitions of the system as was done in Sect. 3.1 written in Sect. 3.1by virtue of (N)with N=/summationtext k1kck. By assuming ck1+1,ck1,...) , (27) fork2, while for k=1 the following holds (N)c1P(c1,c2,...)=P(c11,c2,...). (28) We follow the same procedure as in Sect. 3.1and iterate Eq. ( 7)u s i n gE q dw h e r e Z,ris the normalization constant that can be obtained by evaluating P(N=0)in Eq. ( be found in Appendix C.1. We can now use the expression for P(/vectorc)in Eq. ( 29) to evaluate the moment generating argument of the sum in the above expression is the same as in Eq. ( 30) provided ewe can write MC()=Ze,r Z,r, for any < 0. We can now differentiate MC()with respect to and take the limit 0 to nd the following expressions for the mean and the variance We can use the above expressions and P(N)as determined in Eq. ( 26) to evaluate the mean and variance of C. Note that setting a uniform (N)=in Eqs. ( 29)a n d( 30) reduces the results to those of the sBDI model (Sect. 3.1). We can r/)k1/k, as previously determined in Sect. 3.1. We can also verify that for any function Once again, setting (N)=a constant allows us to recover the results in Eq. ( 19)f o rt h e sBDI model. 5.2 Fast Immigration Limit To analyze the large immigration limit, =/tildewide/Omega1,/Omega1 , we need to assume a specic form for the death rate. For a given /Omega1, we take the death rate as a function of N//Omega1: (N)=/tildewide(N//Omega1). The reason behind this scaling is that we want to keep (N)at the same order of magnitude as/Omega1increases. As in the previous models, we will show that E[N]diverges as /Omega1increases, but the random variable N//Omega1will be shown to converge in distribution to a constant. As a consequence, the death rate /tildewide(N//Omega1) will also converge in distribution to a constant. Given/tildewide(x)is continuous and strictly increasing, and that lim xr//tildewide(x)< 1, one can show that there exists a unique, positive solution nto the xed-point equation n/tildewide(n)=/tildewide+rn. (36) 123Exact Steady-State Distributions of Multispecies Birth... In Appendix C.2, we show that for every > 0, P(|N//Omega1n|> )/Omega10, thus proving that N /Omega1D /Omega1n(37) in which nis dened by Eq. ( 36). The proof of this convergence is analogous to the one in [11, Proposition 4]). Intuitively, ncan be identied with the steady-state solution to the deterministic approximation of the dynamics of n(t)N(t)//Omega1 given by dn(t) dt=/tildewide+rn(t)/tildewide(n(t))n(t). Using the convergence of Eq. ( 37), we can show convergence in distribution convergences are given in Appendix C.3, but one can also verify them by inspecting Eqs. ( 31)a n d( 33) respectively to determine the convergence of E[C//Omega1]andE[ck//Omega1]using convergence of N//Omega1ton. Even though the dynamics of all niare coupled through the death rate P(ni=k)=P(nj=k)for all i,jCandk1. to determine the convergence of niin the/Omega1 a logarithmic-series distribution with param- eterr/(n). Finally, we can use the convergence in distribution of both N//Omega1andck//Omega1, to determine the convergence in distribution for the rescaled Entropy H/log/Omega1and Simpson's n d SD /Omega11. These convergence results are identical for all three models and their proofs are similar to the ones for the sBDI model as described in Appendix A.2. 5.3 Interpretation and Analysis of Results 5.3.1 Comparison with the sBDI Model To properly compare the sBDI and BDICC models, we x their immigration rates and birth rates rto be the same. For the BDICC model, we use a linear death rate function (N)=1Nand tune both 1and the constant death rate in the sBDI model to yield the same average total number of individuals E[N]. In Fig. 4we plot the distributions P(N)andP(C)as well as the average E[ck]in a low immigration regime ( =0.2a n d r=0.99) for both the sBDI and the BDICC models. We 123R. Dessalles et al. 0 10 20 30 40 50 N0.000.050.100.150.20Distribution P(N) E[N]=2 0 .00 std[N]=4 4 .72 E[N]=2 0 .00 std[N]=4 .47sBDI BDICC BDICCbis(a) E[C]=0 .91 30 40 50 k0.000.050.100.150.20E[ck]sBDI BDICC BDICCbis(c) Fig. 4 Comparison of the sBDI model with the two carrying capacity models (BDICC with carrying capacity on the death rate and BDICC-bis with carrying capacity on birth the rate) for slow immigration (parametersare chosen such as E[N]=20 in both cases: =0.2,r=.99,=1f o rt h es B D I ; =0.2,r=.99, (N)=0.0475 Nfor the BDICC). aTheoretical distributions P(N)for of the from 26). Contrary to the sBDI model, the BDICC model is dominated by only one species ( C/similarequal1) with around 20 individuals (the peak of E/bracketleftbig ck/bracketrightbig arises at k/similarequal20). This attribute is completely missed in a mean-eld approximation to E/bracketleftbig ck/bracketrightbig [16]. Negligible differences between the BDICC and BDICC-bis models are observed (Color gure online) adjusted for the sBDI model and 1for the BDICC model so that E[N]=20 in both cases. Clear differences emerge. First, since (N)is proportional to the existing population Nin the BDICC model, very rarely will the population reach vanishingly small levels: as N0 so will (N)0 allowing birth and immigration to replenish N. This is in contrast to the sBDI model where is a constant independent of N. Another feature of a low immigration rate is that it allows one species to \"invade the niche\" of the BDICC model before the arrival of another species. The result is that onlyone species ( C/similarequal1) represents the whole population and E[c k]has a peak around k E[N]=20. This exclusion effect does not arise in the sBDI model since the presence of species already in the system does not influence the dynamics of the newly arriving ones.These exclusionary interactions are also the origin of the peak observed in Fig. 4c. Note that this difference is not only due to the sBDI model's high probability of extinction ( N=0): we checked that the distributions of the sBDI model, conditioned on N>0, also fail to display the exclusionary effect where one clone dominates. Direct mean-eld approximations,E[c kc/lscript]E[ck]E[c/lscript], lead to monotonic decreasing E[ck][16], completely missing the peak around the carrying capacity ( k20). Global carrying capacity interactions can also have a signicant influence on Shannon's entropy and Simpson's diversity index. The qualitative differences between the two models diminish as the immigration rate increases. This conrms our theoretical analysis through which we showed that the sBDI andthe BDICC models follow similar trends as increases. If we x of the sBDI model and 1in the BDICC model such that lim /Omega1E[N//Omega1]remains the same for both models, we nd that N//Omega1,C//Omega1andck//Omega1converge to the same constants in the two models and that niconverges to the same the log-series distribution as well. 5.3.2 Carrying Capacity on Birth (BDICC-bis Model) Our BDICC model included an interaction only through the death rate (N). This choice, as opposed to, say, r(N)was made because the detailed balanced assumption can be shown to hold between all pairs of states, rendering our analytic results for the probability distribution P(/vectorc)exact. 123Exact Steady-State Distributions of Multispecies Birth... Alternatively, one can impose an interaction through a population-dependent birth term. It is well-known that even if the mean populations are equal, models using (N)yield different higher order statistics from those using r(N)[1]. The interacting model with constant, but a growth rate r(N)is dubbed the BDICC-bis model. For the BDICC-bis model, the equilibrium distribution of Ncan still be determined as P(N)= 1 Z,,N=0, 1 Z,1 N!N1/productdisplay k=0+r(k)k ,N1, with Z,a normalizing constant. However, as shown in Sect. C.5 of the Appendix the BDICC-bis model with population-dependent growth is no longer reversible when enu-merated by the species counts c kand we cannot use detailed balance properties to exactly determine the probability distribution P(/vectorc). Consequently, neither means nor variances of ck andCcan be determined. We thus perform numerical simulations by setting r(N)=r1/N, while keeping , uniform. We compare results of the BDICC-bis model to those of the sBDI model ( ,r,uniform) and the previous BDICC model ( ,r,(N)=1N). As in Sect. 5.3we consider a low immigration rate =0.2, set =1, and adjust the parameter r1so that E[N]is the same across the three models. Results for the BDICC-bis model are plotted as the bluedashed curves in Fig. 4. Observed trends for the P(N)andP(C)distributions within the BDICC and the BDICC-bis models are similar, as well as for E[c k]. Shannon's entropy and Simpson's diversity index also remain E[H]=0.25 and E[S]=0.15 for the BDICC-bis model, and E[H]=0.26 and E[S]=0.16 for the BDICC model. 5.3.3 Quasi-steady State and Reflecting Boundary Conditions When =0 in the BDICC model, the N=0 state is a perfect sink. In the absence of immigration, a system cannot escape from the \"absorbing\" N=0s t a t e .H o w e v e r ,i nt h e deterministic limit, the N=0 state is unstable while the nite-population state with N individuals is stable (for (N)=1N,N=r/1). Even though the true steady-state of the stochastic problem is N=0, it may take an exponentially long time for a population initially at NNto become extinct. Therefore, given a system initiated with a large population NN, we expect that a quasi-steady state is established before extinction. To nd distributions associated with the long-lived quasi-steady state of the BDICC model, we modify the absorbing boundary condition at N=0 to a reflecting boundary condition by simply preventing the last individual from dying by setting (N=1)=0. We can now compute the steady state distribution of Nusing detailed balance to nd P(N)=P(1)1 N!N1/productdisplay k=1+rk (k+1), with P(1)being the probability of having one individual. Contrary to the BDICC model with an absorbing boundary condition, we can no longer recurse the detailed balance equationsdown to N=0, since the last individual cannot die (in other words 0 N0.000.050.100.15Distribution P(N) 109108107106 Fig. 5 Comparison of P(N)for the BDICC model with absorbing and reflecting boundary conditions in the small limit. For both submodels, r=0.995 and (N)=0.0498 N, leading to a carrying capacity of N20. The thick black curve corresponds to the quasi-steady state for =0 computed by using a reflecting boundary condition approximation (Eq. ( 38)). The colored curves correspond to the steady-state distribution of the absorbing model using different values of .W h e n =0, the standard absorbing BDICC model leads to an equilibrium \"vacuum\" or \"extinct\" state (dark blue), while the BDICC model approximated with reflectingboundary condition leads to a the quasi-steady state importance of the quasi-steady state is most discernible in the 0 limit where initial conditions determine long-lived congurations. With absorbing boundary conditions, the equilibrium state is the trivial empty state even if it is deterministically unstable. However, by using a reflecting boundary condition on the total population, we can approximate thelong-lived quasi-steady state 0 otherwise .(39) In this limit, only one species survives and occupies the whole system before nal extinction at exponentially long times. Intuitively, without immigration, new species cannot be introduced in the system, and with probability 1 there will be at some point only one individual in the system. This single-species population persists for a long time before nal extinction. This long time persistenceis approximated by the reflecting boundary condition that prevents true extinction. Notethat this limit is related to species extinction and coarsening in a multispecies Moran model 123Exact Steady-State Distributions of Multispecies Birth... with xed population size [ 3]. The distributions P(N)for absorbing and reflecting boundary conditions are compared in Fig. 5for small . 6 Summary and Conclusions In this paper we analyzed three stochastic, neutral birth-death-immigration (BDI) models: and BDI with carrying capacity (BDICC).Where possible, we derived analytical expressions for the steady-state distribution P(N)of the total population and the steady-state distribution P(C)for the total number of species in the system. In many cases, we were also able to derive expressions for the steady-statedistributions of individual subpopulations P(n i)andP(ck), given in terms of cells counts ni and species counts ck, respectively. All three models (sBDI, BDIM, and BDICC) analyzed show similar species abundance distribution functions. In particular, we nd that the number of individuals in one speciesn ifollows a strict log-series distribution P(ni), or, in the case of the BDICC model, can be approximated by one. The prediction that species could follow this type of distributiondates to the early days of theoretical ecology. For example, after analyzing insect abundancesin the eld, Fisher et al. [ 14] proposed that the distribution of insect species in an area should follow a geometric or, possibly, a log-series distribution. The log-series distributionhas since been widely used in theoretical ecology [ 4,26,34], but has also been challenged. For instance Preston [ 30] speculated that actual species abundances would be better described by a log-normal, or possibly a Poisson log-normal distribution [ 6]. Within immunology, the abundance of T-cell clones appears to follow a power-law distribution, incompatible with alog-series distributions [ 10]. The log-series characteristic of our BDI models can be linked to their neutrality, i.e. that replication and death rates are independent of the given species. We also evaluated diversity metrics such as Shannon's entropy and Simpson's diversity index and provided expectations and variances of a number of quantities. Stochastic simu-lations were also performed and matched with our analytical results. Our analytical resultsare summarized in Table 1, while Table 2lists the same results in the large immigration regime. Interestingly, we show that in the fast immigration limit, the diversity indices Hand Sconverge to values independent of the model, but the richness Cconverges to values that are model-dependent. Only the richness can distinguish the different processes in the fastimmigration limit, implying that in this limit it is a more useful diversity metric. Finally, we conrmed the consistency of detailed balance for a carrying capacity model in which the global interaction is implemented through the death rate (BDICC) but demonstratedthat detailed balance is violated if carrying capacity is effected through the birth rate (BDICC-bis model). Nonetheless, this asymmetry generates almost no qualitative difference in thestatistical properties when comparing the two models using equal mean total populations. Many related applications motivate us to extend our work towards non-neutral BDI models. We expect that lifting the neutrality condition will typically generate longer tails in speciesabundance distributions. Acknowledgements This work was supported in part by an INRA Contrat Jeune Scientique Award (RD) and by the National Science Foundation through grants DMS-1814364 (TC) and DMS-1814090 (MD). The authors also thank Song Xu for clarifying discussions. 123R. Dessalles et al. A.1: Finite Number of Species So far, we have assumed immigration events introduce completely new species to the system, regardless of the existing population structure. Within the context of island biodiversity, thisassumption corresponds to the mainland hosting an unlimited number of species, so thatindividuals who emigrate to the island are always part of a new species. Mathematically, weare assuming that each species immigrates only once. In this Appendix, we consider an alternative model where the number of mainland species Qis nite. In this case, the probability that a newly immigrated individual belongs to species i(with 1 iQ)i s1/Qand the number of species in the island cannot exceed Q. As a consequence, the total number of species CQ, and the number of species with k individuals c kQfor all k. The dynamics of the total number of individuals Nremains unchanged with respect to the sBDI model, as the type of species immigrating from the mainland does not affect overallbirth or death rates. Therefore, the distribution for P(N)remains identical to the one derived in Eq. ( 5) for the simple BDI model. We can now determine the distribution of /vectorcin the alternative model using the same approach taken for the sBDI model. Transitions are givenby the birth process rate is effectively augmented by /Q, due to the possibility of a new individual immigrating into an existing species. Conversely, the corresponding immigrationrate for new species is decreased by C/Q. Also note that the limit Q reduces the current model to the original sBDI. Using detailed balanced equations, similarly as in thesBDI model, this distribution satises all the required transition equations. Yet, contrary to the sBDI model, it is more difcult to determine the distributions of C,ckandnibased on this formulation; in particular the factor Q!/(QC)!prevents us from applying the same mathematical procedure used in the sBDI case. We can however take a different route, namely invoking neutrality and the independence of the system, to deduce the distributions of Candck. Since each species behaves independently from all others, we can consider the number miof individuals in the ithspecies (with 1 i Q) independently from the rest. Note that miis a random variable that can be zero when there are no individuals of species ipresent in the system. The quantity miis the counterpart to ni 123Exact Steady-State Distributions of Multispecies Birth... introduced for the sBDI model with the caveat that nirepresents the number of individuals of a species actually present on the island (i.e. P(ni=0)=0). In the current model nican be expressed as a function of mivia P(ni=k)=P(mi=k|mi>0) fork1, (40) describing the distribution of the ithspecies provided that at least one of its individuals is on the island. The random variable mifollows a birth and death process: its birth rate is /Q+rmiand its death rate is mi.T h e/Qrate corresponds to immigration, the rate rmicorresponds to actual reproduction. We already determined the steady state distribution of this process in Eq. ( 5), yielding a negative binomial ckwith kindividuals and the total number of species Ccan be expressed as a function of follows ck=Q/summationdisplay i=1I(mi=k)and C=Q/summationdisplay i=1I(mi>0). Since all P(C)=/parenleftbiggQ binomial respective parameters QandP(mi=k)forck,a n d Q and 1P(mi=0)forC. Note that this approach does not allow us to determine the diversity indices HandS. A.2: Convergences in the Large Immigration Regime In this section, we will prove the convergence of N//Omega1, C//Omega1,/parenleftBigc1 /Omega1,c2 /Omega1,.../parenrightBig ,and H/log/Omega1 in the large immigration regime dened by =/tildewide/Omega1,/Omega1 . Proposition 1 The scaled total number of individuals N //Omega1converges in distribution to the constant/tildewide/(r). 123R. Dessalles et al. Proof The denition of the convergence in distribution described in Eq. ( 3) is equivalent to the convergence of its moment generating function. One is left with showing that for any < 0,lim /Omega1E/bracketleftBig eN//Omega1/bracketrightBig =/tildewide r (see for instance [ 5, Chapter 5]). Since NNegBinom (/tildewide/Omega1/r,r/)for which the moment generating function is known, we have for any < 0: E/bracketleftBig eN//Omega1/bracketrightBig =/parenleftbigg1r/ 1e//Omega1r//parenrightbigg/tildewide/Omega1/r . Upon taking the proposition. /intersectionsq/unionsq Proposition 2 The scaled total number of species C //Omega1converges in distribution to C /Omega1D /Omega1/tildewide rlog/bracketleftbigg1 1r//bracketrightbigg . Proof The proof is similar to Proposition 1. /intersectionsq/unionsq Proposition 3 For each k >0,ck//Omega1converges in distribution to ck /Omega1D /Omega1/tildewide r(r/)k k. Proof For any vector /vectorcandk1, we have that ck=C/summationdisplay i=1I(ni,k). Consider the moment generating function of the random variable ck.F o ra n y < 0, Since niare identical and independently distributed and independent of C, and since their distributions do not depend on the parameter /Omega1, /Omega1C/parenleftbig e//Omega11/parenrightbig A, /Omega1C eck//Omega1/bracketrightbig =E/bracketleftbigg exp/bracketleftbigg C /Omega1(r/)k k log(1r/)/bracketrightbigg/bracketrightbigg . Finally, since we have already shown that C//Omega1converges in distribution (Proposition 2 above), distribution as H log/Omega1D /Omega11. /Omega1/Omega1 NlogNlogk log/Omega1, where converges in distribution as SD /Omega11. 123R. Dessalles et al. series identity r/ (1r/)2=/summationdisplay k=1k/parenleftbiggr /parenrightbiggk and hence show that the second term vanishes as /Omega1 and deduce the result with Mutation (BDIM) B.1: Distribution of the Number of Individual in One Species We propose an argument for a Log-series distribution of any species k=P(ni=k) when all species are independent of each other. There are several ways to interpret k.F i r s t consider the explicit dynamics of each species. Denote by mq(t)the number of individuals of species qat time tand dene aqas the time of arrival (by convention, we order the species such as a0=0<a1<a2< ... )a n d dqits \"lifespan\", i.e. the species will be extinct at time aq+dq(see the example in Fig. 8a). Note that the index qindicates the order of arrival (and not the species identity index iused in the main article), and that the distribution of the times aqis not specied and can be adapted to any rate of species creation (either by immigration or by mutation). The evolution of each species is independent of each other,and each of them denes an identically distributed birth-death process characterized by thefollowing transitions /braceleftBigg m qmq+1a t r a t e mqr(1/epsilon1), mqmq1a t r a t e mq.(41) Due to the r< assumption, this process will become extinct almost surely [ 2, Chapter 2] and the lifespan dqof each species is nite (Figs. 6and7). In the main article, we interpreted kas the number of individuals in a given species at steady state, that is to say, we considered the T limit k=lim TP/parenleftbig mJT(T)=k/parenrightbig where JTis the index of a randomly sampled species among those that exist at time T; i.e., JTis uniformly chosen among all the species qsuch .50E[N]=2 u=1 0 .00 .67E[N]=5 0 u=1 0 .00 .83 E[N]=2 .00 u= 100 v=0 .17E[N]=5 0 .00 u= 100 .00 .33E[N] = 100 .00 u= 100 .00 v=0 .50E[N] = 200 .00 u= 100 .00 v=0 .67E[N] = 500 .00 u= 100 .00 v=0 .830.00 .20 .40 .60 .81 .0 Mutation probabilityLog-series distrib Simulations Increasing u=/rIncreasing v=r/ Fig. 6 Distribution of the number of individuals in one species niunder different parameter choices. Dots represent simulations for various values of u=/r,v=r/,(r=1) and /epsilon1; solid lines depict logarithmic distributions with parameter r(1/epsilon1)/ . As expected, the logarithmic distributions match the simulations ni, and the distributions of nido not depend on u However, there is another way to interpret k. Consider all species that exist or have existed up to time Tand then randomly select one of them, species IT. The number of individuals in species ITat a randomly chosen time ITbetween the introduction of the species (at time aIT) and the extinction (at time aIT+dIT) is denoted mIT. In this picture, we can characterize kaccording to k=lim TP/parenleftbig mIT(IT)=k/parenrightbig . (42) The main difference between the two approaches is that, in the rst case, we sample among the species that exist at a precise time Tbefore taking T , while in the second case, we sample among all the species that existed before time T(before taking T ). For a xed time T, the last species introduced in the system is given by QT=argmax .5E[N]=2 u=1 0 .0 .7E[N]=5 0 u=1 0 .0 .8 E[N]=2 .0 u= 100 v=0 .2E[N]=5 0 .0 u= 100 .0 .3E[N]=1 0 0 .0 u= 100 .0 v=0 .5E[N]=2 0 0 .0 u= 100 .0 v=0 .7E[N]=5 0 0 .0 u= 100 .0 v=0 .8 Increasing u=/rIncreasing v=r/ Fig. 7 Accuracy of and Simpson's index (as dened in Eq. ( 25)). We plot the ratio of the estimates of Shannon's entropy and Simpson's index and their respective values measured via simulation for different u=/r,v=r/(by taking r=1), and different /epsilon1. The estimates become more accurate as E[N] increases: the error is below 10% for any parameters u,v,/epsilon1such that E[N]is larger than 5 All species that exist or have existed before time Tare in the set {0,..., QT}. Note that since aqare increasing in q, lim T QT= .A sp e rE q .( 42), we have to sample one species among the set {0,..., QT}. One key point is that the random selection is not uniform: there is a higher chance of selecting species with longer lifespans. If ITis the index of the randomly chosen species, we can write P(IT=q)=I(qQT)dq/summationtextQT j=0dj. The rst term I(qQT)ensures that the species qexists before time Twhile the second term proportionally weights the probability of sampling according to their lifespans. Con- 123Exact Steady-State Distributions of Multispecies Birth... 0.0 0.5 1.0 of individualsm(s)(b) Fig. 8 aA representative trajectory of three immigrated species. The q-th species is introduced at time aq and extinguishes at time aq+dq.bConstruction of the process m(dened in Eq. ( 43)) by species/parenleftbig mq/parenrightbig qN ditioned on species IThaving been sampled, we then randomly chose a time ITuniformly distributed between aITandaIT+dIT. Proposition 6 The dk=k1/summationdisplay q=1dqand(t)=argmax q q/summationdisplay j=0dj<t . The process mis simply the stacking of all the processes mqin the sense that the process m(t)fortbetween dqanddq+1will be equal to the process mq(s)fors=tdq+aq between aqand its extinction time aq+dq(see the example on Fig. 8b). eh a v e lim TP/parenleftbig mIT(IT)=k/parenrightbig =lim TP(m(T)=k). Finally, we have to determine the steady state of the process m. Since the transitions of the process mare a simple birth-death process /braceleftBigg mm+1a t r a t e mr(1/epsilon1) mm1a t r a t e mI(m>0)., (44) we have that its equilibrium distribution is a logarithmic series distribution with parameter pr(1/epsilon1)/ (by imposing equations of detailed balance). /intersectionsq/unionsq B.2: Moments of C The third relation of Eq. ( 1) yields the following expression for the moment generating function of N: E/bracketleftBig eN/bracketrightBig =E/bracketleftBiggC/productdisplay i=1eni/bracketrightBigg , for any < 0. Since all the (ni)iCare identical and independently distributed and indepen- dent of C,w distribution over n1is a log-series distribution with parameter eliminating for/prime,E q .( 45) becomes an expression for the moment generating function of C, E/bracketleftBig e/primeC/bracketrightBig = 1r/ 1r 1(1p)e/prime p /r . By differentiating this expression, we can determine the 22). C: BDI Model with Carrying Capacity C.1: Steady State Distribution of /vectorc To determine P(/vectorc), the probability of occurrence of the species-count state /vectorc, rst consider a nite K=argmaxi(ci>0). As explained in the main text, if the system is reversible, one instance of Eq. ( 27)i uniquely corresponds to the state N=0 and the above expression holds for Karbitrarily large, that P(/vectorc)=1 Z,r,/parenleftBig r/parenrightBigC rN that this steady-state distribution satises the detailed balanced conditions connecting 7 The random variable N //Omega1converges in probability to the real nwhich is the only solution of the xed point Eq. (36). To prove this Theorem, rst i v e nb yE q .( 36)w h e r e x= nis the only real solution to f(x)=1. With these denitions, the probability distribution over the following lemma: Lemma 8 The function f is strictly decreasing and there exists a /Omega1for which /Omega1/Omega1, (fk)k1is a decreasing sequence. Proof The decrease of the function fis a direct implication of the increase of /tildewide.F o r ,(fk)k1 we have (k+1)(/tildewide/Omega1+r(k1))k(/tildewide/Omega1+rk)=/tildewide/Omega1r, which is positive for large enough /Omega1.S i n c e/tildewideis increasing, fk fk+1=/tildewide((k+1)//Omega1) /tildewide(k//Omega1)(k+1)(/tildewide/Omega1+(k1)r) k(/tildewide/Omega1+rk)>1. /intersectionsq/unionsq To prove Theorem 7,w eh a v et os h o wt h a t > 0, P/parenleftbig/vextendsingle/vextendsingleN//Omega1n/vextendsingle/vextendsingle>/parenrightbig /Omega10 that is to say, we have to show that P/parenleftbig N//Omega1 > n+/parenrightbig /Omega10, (48) P/parenleftbig N//Omega1 < n/parenrightbig /Omega10. (49) The proofs of convergence for both limits above are very similar so we will focus on the proof of Eq. ( 48). To simplify notation, we dene a/Omega1,/Omega1(n+),( w h e r e \u00b7is the ceiling function). Since the distribution of Nis known, we have /summationtext n=a/Omega1,exp/parenleftbig/summationtextn k=1logfk/parenrightbig the convergence of Eq. ( 48). Proposition 9 In the /Omega1 limit, holds /summationdisplay n=a/Omega1,exp/parenleftBiggn/summationdisplay k=1logfk/parenrightBigg /Omega1exp a/Omega1,1/summationdisplay k=1logfk 1 1f(n+) Birth... The second term of the decomposition can be as Asfis a strictly decreasing function (cf. Lemma 8), and since nis the only point where f(n)=1, it follows that f(n+)<1. Therefore, the sum over n/summationdisplay k=a/Omega1,logfk /Omega11 1f(n+) /intersectionsq/unionsq With the previous Proposition, it is enough to prove that the ratio /summationtexta/Omega1,1 to prove the convergence of Eq. ( 48). Proposition 10 The sum a/Omega1,1/summationdisplay n=0exp diverges. Proof since fis decreasing, we have that fa/Omega1,1<1forsmall enough. Therefore, we conclude the divergence a/Omega1,/summationdisplay n/prime=1/parenleftbigg1 fa/Omega1,1/parenrightbiggn/prime /Omega1 and proof of the proposition. /intersectionsq/unionsq 123R. Dessalles et al. With this Proposition, we have proven the convergence of Eq. ( 48). The convergence of Eq. ( 49) can be proved using exactly the same methods by considering b/Omega1,=/Omega1(+n) instead of a/Omega1,. C.3: Convergence of C/\u00c4 Theorem 11 The scaled total number of species C the only real solution of the xed point Eq. (36). Proof One has to /tildewide+r(x1)//Omega1/parenrightBig is decreasing in x, we can bound the sum with its lower and upper integral expanding the above expression, we nd that both bounds converge to ni Proposition 12 The marginal probability over each particle count n iconverges according to P(n1=k) /Omega11 k/parenleftbiggr /tildewide(n)/parenrightbiggk1 log[1r//tildewide(n)]. any i,jC, for any k1,P(ni=k)=P/parenleftbig nj=k/parenrightbig . We =E/bracketleftBiggC/summationdisplay i=1E[I(ni,k)|C] C/bracketrightBigg =E[E[I(n1,k)|C]]=P(n1=k). This expectation E/bracketleftBigck C/bracketrightBig =E/bracketleftbiggck 5, Chapter 5]) to E/bracketleftbig g/parenleftbigck of Detailed Balance in the BDICC-bis Model with Birth-Mediated Carrying Capacity Here, we consider a birth-death-immigration model with carrying capacity but contrary to the BDICC model presented in Fig. 1c, the carrying capacity is on the birth rate r(N),a n d the death rate is a constant. By analogy with the BDICC analysis, we nd a sufcient condition for a steady state to exist lim Nr(N)< . The distribution P(N)of the total number of individuals by If we assume detailed balance between pairs of states with maximum clone size K, we can recurse the relations ckkP(c1,..., ck1,ck,...)=r(N)(k1)(ck1+1)P(c1,..., ck1+1,ck1,...) for Z,C N/producttextNC n=1r(Nn)/producttext i=1icici!. (50) Using these chosen pairs of states to impose detailed balance, we nd a unique distribution P(/vectorc).H o w e v e r ,t h i sf o r mo f P(/vectorc)will not obey detailed balance between all pairs of states. For example, balancing the transitions (c1,c2,...)c1/arrowrighttophalf/arrowleftbothalf (c11,c2,...) would also require c1P(c1,c21,...)=P(c11,c21,...). 123Exact Steady-State c1P(c1,c21,...) P(c11,c21,...)=r(C1) r(N1)/negationslash=1 N/negationslash=C. Remarkably, the analogous exercise for the BDICC model where =(N)does satisfy detailed balance between all pairs of states and the P(/vectorc)we derived for the BDICC model, Eq. ( 29), is exact. References 1. Allen, L.J.S.: An Introduction to Stochastic Processes with Applications to Biology. Taylor and Francis, Boca Raton (2010) 2. Bansaye, V ., M\u00e9l\u00e9ard, S.: Birth and death processes. In: Stochastic Models for Structured Populations, Mathematical Biosciences Institute Lecture Series, pp. 7-17. Springer, Cham (2015) 3. Baxter, Biosci. 209, 124-170 (2007) 4. (1974) Chiu, C.-H., Wang, Y .-T., Walther, B.A., Chao, A.: An improved nonparametric lower bound of species richness via a modied Good-Turing frequency formula. Biometrics 70, 671-682 (2014) 8. accelerated in mass-conserving J.A.: Estimating terrestrial biodiversity through extrapolation. Philos. Trans. R. Soc. B 345, 101-118 (1994) 10. Desponds, J., Mora, T., Walczak, A.M.: Fluctuating distribution Natl. Sci. V ., Robert, P.: A stochastic analysis of autoregulation of gene Biol. D'Orsogna, M.R., Zhao, B., Chou, Combinatoric heterogeneous stochastic self-assembly. (2013) 14. Fisher, Corbet, A.S., Williams, C.B.: The relation between the number of species and the number of individuals in a random sample of an animal population. J. Anim. Ecol. 12, 42-58 (1943) 15. Gibbs, J.P., Martin, W.T.: Urbanization, technology, and the division of labor: international patterns. Am. Sociol. Rev. 27, 667-677 (1962) 16. Goyal, S., Kim, S., Chen, I.S.Y ., Chou, T.: Mechanisms of blood homeostasis: lineage tracking and a neutral model of cell populations in rhesus macaques. BMC Biol. 13(1), 85 (2015) 17. Grimmett, G., Stirzaker, D.: Probability and Random Processes. Oxford University Press, Oxford (2001)18. Hubbell, S.: The Unied Neutral Theory of Biodiversity and Biogeography (MPB-32) (Monographs in Population Biology). Princeton University Press, Princeton (2001) 19. Hurlbert, S.H.: The nonconcept of species diversity: A critique and alternative parameters. Ecology 52, 577-586 (1971) 20. Jost, L.: Entropy and diversity. Oikos Berezovskaya, F.S., Eugene V .: Birth and death of protein domains: a simple model of evolution explains power law behavior. BMC Evolut. Biol. 2, 18 (2002) 22. Karlin, S., McGregor, J.: The number of mutant forms maintained in a population. In: Proceedings of the Fifth Berkeley Symposium on Mathematics, Statistics and Probability, vol. 4, pp. 415-438 (1967) 23. Lambert, A.: Species abundance distributions in neutral models with immigration or mutation and general lifetimes. J. Math. Biol. 63, 57-72 Estimating T-cell repertoire diversity: limitations of classical estimators and a new approach. Philos. Trans. R. Soc. B 370, 20140291 Theor. Biol. 389, 214-224 123R. Dessalles et al. 26. MacArthur, R.H., Wilson, E.O.: The Theory of Island Biogeography. Princeton University Press, Princeton (2016) 27. Miles, J.J., Douek, D.C., Price, D.A.: Bias in the T-cell repertoire: implications for disease pathogenesis and vaccination. Immunol. Cell 89, 375-387 (2011) 28. Morris, E.K., Caruso, T., Buscot, F., Fischer, M., Hancock, Christine, Maier, Tanja S, Meiners, Torsten, M\u00fcller, Caroline, from the German Biodiversity Exploratories. Ecol. Evol. 4(18), 3514-3524 (2014) 29. Palmer, M.W.: The estimation of species richness by extrapolation. Ecology 71, 1195-1198 (2003) 30. Preston, F.W.: The commonness, and rarity, of species. Ecology 29(3), 254-283 (1948) 31. Sala, C., Vitali, S., Giampieri, E., Valle, I.F., Remondini, next generation sequencing data. BMC Bioinform. 17, S16 (2016) 32. Tan, J.T., Dudl, E., LeRoy, E., Murray, R., Sprent, Jonathan, Weinberg, Kenneth I., Surh, Charles D.: IL-7 is critical for homeostatic proliferation and survival of T cells. Proc. 33. Travar\u00e9, S.: The genealogy of the birth, death, and immigration process. In: Feldman, M.W. (ed.) Mathe- matical Evolution Theory, pp. 41-56. University ISBN 0-691-08502-1 olkov, I., Banavar, J.R., Hubbell, S.P., Maritan, A.: Neutral theory and relative species abundance in ecology. Nature 424(6952), 1035-1037 (2003) 123 "}