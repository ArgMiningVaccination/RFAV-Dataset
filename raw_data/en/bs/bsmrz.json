{"title": "PDF", "author": "PDF", "url": "http://econ.msu.edu/seminars/docs/PY%20epidemic%20network_Nov%2010%202020.pdf", "hostname": "PDF", "description": "PDF", "sitename": "PDF", "date": "PDF", "cleaned_text": "Matching Theory and Evidence on Covid-19 using a Stochastic Network SIR Model\u0003 M. Hashem Pesaran University of Southern California, USA, and Trinity College, Cambridge, UK Cynthia Fan Yang Florida State University November 10, 2020 Abstract This paper develops an individual-based stochastic network SIR model for the empirical analysis of the Covid-19 pandemic. It derives moment conditions for the number of infected and active cases for single as well as multigroup epidemic models. These moment conditions are used to investigate identi cation and estimation of recovery and transmission rates. The paper then proposes simple moment-based rolling estimates and shows them to be fairly robust to the well-known under-reporting of infected cases. Empirical evidence on six European countries match the simulated outcomes, once the under-reporting of infected cases is addressed. It is estimated that the number of reported cases could be between 3 to9times lower than the actual numbers. Counterfactual analysis using calibrated models for Germany and UK show that early intervention in managing the infection is critical in bringing down the reproduction numbers below unity in a timely manner. Keywords : Covid-19, multigroup SIR model, basic and e\u00a4ective reproduction num- bers, rolling window estimates of the transmission rate, method of moments, calibration from Alexander Chudik, Cheng Hsiao, Ron Smith, and participants at the 2020 IAAE webinar series. We would like to thank Mahrad Sharifvaghe for helping us compile the data, and Minsoo Cho for helping with the literature review. Correspondence to: C.F. Yang, Department of Economics, Florida State University, 281 Bellamy Building, Tallahassee, FL 32306, USA. E-mail: cynthia.yang@fsu.edu.1 Introduction Since the outbreak of Covid-19, many researchers in epidemiology, behavioral sciences and eco- nomics have applied various forms of compartmental models to study the disease transmission and potential outcomes under di\u00a4erent intervention policies. The compartmental models are a major group of epidemiological models that categorize a population into several types or groups, such as susceptible (S), infected (I), and removed (or recovered, R). Compartmental models owe their origin to the well-known SIR model pioneered by Kermack and McKendrick (1927), and have been developed in a number of important directions, allowing for multi-category (multi-location), a variety of contact networks and transmission channels. In this paper we follow the individual-based modelling approach and develop a stochastic network SIR model in which individual-speci c infection and recovery processes are modelled, allowing for group heterogeneity and latent individual characteristics that distinguish individuals in terms of their degrees of resilience to becoming infected. The model is then used to derive individual-speci c conditional probabilities of infection and recovery. In this respect our modelling approach is to be distinguished from the individual-based models in epidemiology that specify the transition probabilities of individuals from one state to another. In modelling the infection process we consider an individual\u0092 s contact pattern with others in the network, plus an individual-speci c latent factor assumed to be exponentially distributed. The time from infection to recovery (or death) is assumed to be geometrically distributed. The individual processes are shown to aggregate up to the familiar multigroup SIR model. We allow for group heterogeneity and, in line with the literature, assume contact probabilities are homogeneous within groups but could di\u00a4er across groups. We then derive the probabilities of individuals within a given group being in a particular state at a given time, conditional on contact patterns, exposure intensities, and unobserved character- istics. These conditional probabilities are aggregated up to form a set of moment conditions that can be taken to the data on the number of infected and active cases both at the aggregate and group (or regional) levels. We make use of the moment conditions to investigate the identi cation 1of the underlying structural parameters and most importantly show that, whilst one can not dis- tinguish between average contact numbers and the degree of exposure to the virus upon contact, it is nevertheless possible to identify the basic and e\u00a4ective reproduction numbers from relatively short time series observations on infections and recoveries. Using Monte Carlo simulations, the small sample properties of the proposed estimator are shown to be satisfactory, with a high degree of precision even when using 2or3weeks of rolling observations. Most importantly, they are quite robust to the well-known under-reporting of infected cases. Equipped with daily estimates of the transmission rates we are then able to calibrate our epidemic model and investigate its properties under di\u00a4erent network topology, population sizes, and group numbers, as well as di\u00a4erent types of interventions that are aimed to alter the transmission rates through policy. We also apply our estimation approach to examine how well the outcome of the proposed epidemic model matches the Covid-19 evidence in the case of six European countries (Austria, France, Germany, Italy, Spain, and United Kingdom) from March to October 15,2020. We provide rolling estimates of the transmission rates and related e\u00a4ective reproduction numbers using the recorded infected cases and show that the estimates are fairly robust to the under-reporting of the number of infected cases. We then use the estimated transmission rates to calibrate our SIR network model parameters across the six countries. The stochastically simulated outcomes are shown to be reasonably close to the reported cases once the under-reporting issue is taken into account. We estimate that the number of reported infected cases could be 3to9times lower than the true number of infections across the six European countries under consideration. It is also of interest that our model allows us to capture the second surge of Covid-19 cases that European countries began to experience starting August 2020. Finally, the paper develops a new way of using the modelling of epidemics for counterfactual inference. We use the calibrated model to investigate the potential outcomes if the lockdown in Germany had been delayed for one or two weeks; and if the lockdown in the UK had started one or two weeks earlier. Such counterfactual analyses can be achieved by shifting the estimated transmission rates forward or backward. We show that early intervention is critical in managing the infection and controlling the total number of infected and active cases. 2The problem of how to balance the public health risks from the spread of the epidemic with the economic costs associated with lockdowns and other social-distancing mandated policies will not be addressed in this paper. However, the proposed network SIR model with its individual- based architecture is eminently suited to this purpose. The proposed model can be combined with behavioral assumptions about how individuals trade o\u00a4 infection risk and economic well being, thus generalizing the aggregate framework proposed in Chudik, Pesaran, and Rebucci (2020) to individual-based SIR models. The rest of the paper is organized as follows. Section 2 reviews the related literature. Section 3 introduces the basic concepts and the classical multigroup SIR model. Section 4 lays out our individual based stochastic model on a network. Section 5 explains the calibration of our model to basic and e\u00a4ective reproduction numbers. Section 6 documents the properties of the model. Sections 7 and 8 discuss the estimation of the transmission rate and recovery rate, respectively. Section 9 presents the calibration of the model to Covid-19 evidence and counterfactual analy- ses, and Section 10 concludes. The Online Supplement provides some technical derivations and presents additional simulation results. 2 Related literature Our modelling approach relates to two important strands of the literature on mathematical mod- elling of infectious diseases, namely the classical SIR model due to Kermack and McKendrick (1927) and its various extensions to multigroup SIR models, and the individual-based network models. The multigroup SIR model allows for a heterogeneous population where each compart- ment (S, I or R) is further partitioned into multiple groups based on one or more factors including age, gender, location, contact patterns, and a number of economic and social factors. One of the earliest multigroup models was pioneered by Lajmanovich and Yorke (1976), who developed a class of SIS (susceptible-infected-susceptible) models for the transmission of gonorrhea. Subse- quent extensions to the multigroup SIR model and its variants include Hethcote (1978), Thieme (1983, 1985), Beretta and Capasso (1986), and many others. Reviews of multigroup models can be 3found in Hethcote (2000) and Thieme (2013). In contrast, we do not model the progression of epi- demics at the compartment level; instead, we develop an individual-based stochastic model from which we derive a set of aggregate moment conditions. Interestingly, we are able to show that the multigroup SIR model can be derived as a linearized-deterministic version of our individual-based stochastic model. Our analysis also relates to the more recent literature on mathematical models of epidemics on networks, whereby the spread of the epidemic is modelled via networks (or graphs), with nodes representing single individuals or groups of individuals and links (or edges) representing contacts. The adoption of networks in epidemiology has opened up a myriad of possibilities, using more realistic contact patterns to investigate the impact of network structure on epidemic outcomes, and to design network-based interventions. Kiss, Miller, and Simon (2017) provide a systematic treatment of this literature, with related reviews in Miller and Kiss (2014) and Pastor-Satorras et al. (2015). Being based on individual outcomes, our approach is more closely related to the individual- based models surveyed by Willem et al. (2017) and Nepomuceno, Resende, and Lacerda (2018). These models consider the transition probability of individuals from one state (S,I,R) to another (Rocha and Masuda, 2016). In contrast, as noted in the introduction, we do not model the transi- tion probabilities, but rather we model the contact probabilities and unobserved individual-speci c probability of becoming infected, and then derive individual-speci c transition probabilities. Like the individual-based models, our approach also allows for considerable group heterogeneity and has the advantage that aggregates up to the multigroup SIR model. In order to calibrate the average number of contacts in our model, we drew upon the literature on social contact patterns relevant to the transmission of respiratory infectious diseases. Before the outbreak of Covid-19, large-scale social contact surveys have been conducted in many countries aiming to guide e\u00a4ective policies on infectious disease control and prevention.1The POLYMOD study of social contacts in eight European countries by Mossong et al. (2008) is a notable land- 1Summaries of these social contact surveys are provided by Hoang et al. (2019) and Supplementary Table S1 of Leung et al. (2017). 4mark.2Many similar surveys have been conducted since. Among them, the contact studies in Hong Kong (Leung et al., 2017) and Shanghai (Zhang et al., 2019) provide valuable information about the pre-Covid social contacts in China. Most of these studies summarize contact patterns based on age groups, contact locations (e.g. households, schools, workplaces), and time schedule (e.g. weekday or weekend) that can be utilized in a multigroup epidemiological models. With the outbreak of Covid-19, a few recent articles reported signi cant changes in contact patterns. For example, Zhang et al. (2020a) nd that the median number of daily contacts in Wuhan went down from 7in normal times to 2after the Covid-19 outbreak. The median number of daily contacts in Shanghai fell from 10to2. Jarvis et al. (2020) nd that the average daily number of contacts declined from 10:8in normal times to 2:8immediately after the lockdown in the UK. In all these three cases, the contact number by age \u0087 attened after the outbreak. In this paper, we propose a new method of estimating the transmission rate, t, using the moment conditions we derive from our stochastic network SIR model. The transmission rate is closely connected to the reproduction numbers, which are epidemiologic metrics used to measure the intensity of an infectious disease. The basic reproduction number, denoted by R0, is the number of new infections expected to result from one infected individual at the start of the epidemic, and within SIR models it is de ned by R0= 0= , where 0is the initial transmission rate, and is the recovery rate. For the current Covid-19, estimates of R0range between 2to 3.3Since the transmissibility of a disease will vary over time due to changes in immunity and/or mitigation policies, the e\u00a4ective reproduction number, which we denote by Ret, measures theR numbertperiods after the initial outbreak. The e\u00a4ective Rnumber is governed by the extent to which the susceptible population is shrinking and the e\u00a4ectiveness of mitigation policies (whether mandated or voluntary). In the single group SIR model we have Ret= (1\u0000ct) t= , wherectis the per capita number of infected cases at time t. Various methods are available in the epidemiological literature to estimate the reproduction numbers at the beginning and/or in real time during epidemics, but there is no uniform framework. 2The eight countries are Belgium, Germany, Finland, Great Britain, Italy, Luxembourg, The Netherlands, and Poland. 3A summary of published R0values is provided in Table 1 of D\u0092 Arienzo and Coniglio (2020). 5Estimation approaches, that are data-driven and involve simplifying assumptions, include the use of the number of susceptibles at endemic equilibrium, the average age at infection, the nal size equation, and calculation from the intrinsic growth rate of the number of infections (He\u00a4ernan, Smith, and Wahl, 2005). Estimation of reproduction numbers based on di\u00a4erent mathematical models are reviewed by Chowell and Nishiura (2008), Obadia, Haneef, and Bo\u00eblle (2012), and Nikbakht et al. (2019). More recent contributions, focusing on estimation of reproduction numbers for the Covid-19 pandemic include Atkeson, Kopecky, and Zha (2020), Baqaee et al. (2020), Fern\u00e1ndez-Villaverde and Jones (2020), Korolev (2020) and Toda (2020). In this paper we estimate the transmission rate using the moment conditions derived from our stochastic individual-based network SIR epidemic model. We do not use mortality data due to its unreliability,4but instead our method of moment estimation requires only data on per capita infected cases. Our estimation method is not only simple to apply, but also fairly robust to the under-reporting of infected cases. It has been widely acknowledged that the reported infected cases may su\u00a4er from considerable under-reporting, especially during the early stages of the epidemic. Li et al. (2020) estimate that only 14percent of all infections were documented in China prior to the January 23,2020 travel restrictions. This translates to a multiplication factor of 1=0:14\u00197:14, which is a quantity that measures the degree of under-reporting and will be elaborated in later sections of our paper. Jagodnik et al. (2020) estimate that the recorded cases were under-reported by a multiplication factor in the range of 3to16times in seven countries as of March 28,2020.5 In the US, the number of infected cases is likely to be 10times more than reported based on antibody tests from March through May, according to the study by Havers et al. (2020) led by the Centers for Disease Control and Prevention (CDC). More recently, Rahmandad, Lim, and Sterman (2020) estimate that the cumulative cases across 86countries through July 10,2020 are 10:5times the number of o\u00a2 cial reported cases, with 10th\u000090thpercentile range 3:35\u000023:81. Another source of measurement errors is reporting delays. Harris (2020) estimates that in New 4The recorded Covid death toll has undergone major revisions on several occasions. For example, the UK death toll was revised downwards by 5,377 on August 12, 2020 after a review concluded the daily death gure should only include deaths which had occurred within 28 days of a positive test. 5See Table 2 of Jagodnik et al. (2020). The seven countries considered are China, France, Italy, Spain, US, Germany and UK. 6York City the mean delay in reporting was 5days, with 15percent of cases reported after 10or more days, during June 21\u0096 August 1,2020. Many existing estimation methods of reproduction numbers do not allow for measurement errors and might not be robust to acknowledged under- reporting errors. For instance, the SUR estimates developed by Korolev (2020) may be biased downward if one neglects under-reporting of con rmed cases. Our study also contributes to a growing literature on quantitative epidemic policy analyses. A number of studies consider the e\u00a4ects of di\u00a4erent intervention strategies (such as isolating the elderly, closing schools and/or workplaces, and alternating work/school schedules) by hypo- thetically lowering the average number of contacts of some speci c age groups, and/or contact locations/schedules from normal (pre-Covid) levels using SIR or other compartmental models. (See Acemoglu et al. (2020), Akbarpour et al. (2020), Matrajt and Leung (2020), among others.) Chudik et al. (2020) simulate the trade-o\u00a4 between \u0087 attening the epidemic curves and lessening unemployment loss under di\u00a4erent degrees of mandatory and voluntary social distancing policies using a modi ed SIR model. Toda (2020) simulates the e\u00a4ects of di\u00a4erent mitigation policies on epidemic curves by reducing the transmission rate in the SIR model from its initial level. Atkeson et al. (2020) investigate the impact of earlier or later mitigation measures on the death toll. Our model can be used to investigate a number of di\u00a4erent mitigation policies either by lowering the number of contacts across age groups and/or by reducing the rate of infection upon contact. In the present paper we have focused on the timing of the lockdowns, comparing the spread of Covid-19 in UK and Germany in March 2020. But the model can be used in a variety of other contexts. 3 Basic concepts and the multigroup SIR model We consider a population of nindividuals that are subject to the spread of a disease with some initially infected individuals. We suppose that the susceptible population can be categorized into Lgroups of The grouping could be based on demographic factors (age and/or gender), or other observed characteristics such as contact locations and/or schedules, mode of transmission, 7genetic susceptibility, group-speci c vaccination coverage, as well as socioeconomic factors. See, for example, Hethcote (2000). Individual iin group`will be referred to as individual (i;`), with i= 1;2;:::;n`and`= 1;2;:::;L . It is assumed that n`is relatively large but remains xed over the course of the epidemic measured in days. Suppose that individual (i;`)becomes infected on day t=t\u0003 i`, and letxi`;tto take the value of unity for all t\u0015t\u0003 i`, and zero otherwise. In this way, we follow the convention that once an individual becomes infected, he/she is considered as infected thereafter, irrespective of whether that individual recovers or dies. Speci recovery or death of individual (i;`)at timetwill be represented by yi`;t, which will be equal to zero unless the individual is \"removed\" (recovered or dead). An individual (i;`) is considered to be \"active\" if he/she is infected and not yet recovered. We denote the active indicator by zi`;t;which is formally de ned by zi`;t= (1\u0000yi`;t)xi`;t: (2) zi`;ttakes the value of 0if individual (i;`)has not been infected, or has been infected but recov- ered/dead. It takes the value of 1if he/she is infected and not yet recovered. Any individual (i;`) who has not been infected is viewed \"susceptible\" and indicated by si`;t= 1, where si`;t= 1\u0000zi`;t\u0000yi`;t: (3) It then readily follows that the total (cumulative) number of those \"infected\" in group `at the end of day tis given by C`t=n`X i=1xi`;t; `= 1;2;:::;L; (4) where the summation is over all individuals in group `. The total number of \"recovered\" in group 8`in daytis (5) The total number of \"active\" cases (individuals who are infected and not yet removed) in group `in daytis I`t=n`X i=1zi`;t=n`X i=1xi`;t\u0000n`X `in daytis S`t=n`X i=1si`;t=n`\u0000I`t\u0000R`t. (7) Our model does not distinguish between recovery and death. Once an individual is removed (recovered or dead), following the SIR literature we assume that he/she cannot be infected again. Under this assumption, recovery and death have the same e\u00a4ects on the evolution of the epidemic, and accordingly in what follows we shall not distinguish between recovery and death and refer to their total as \"removed\".6 The classic multigroup SIR model in discretized form as above, `is the recovery rate which is assumed to be time-invariant and the same for all people in group `, and ``0is the transmission coe\u00a2 cient between S`tandI`0t. Note that individuals in group `0may transmit the contagion to individuals in group `, with the new infections in group `given byS`tPL `0=1 ``0I`0t.8 6Although it is also possible to calibrate our model using mortality data, we do not pursue this route as it is well known that it is di\u00a2 cult to correctly attribute deaths to Covid-19. 7See, for example, Guo, Li, and Shuai (2006) and Zhang et al. (2020b) and the references therein. 8For some of the recent contributions in the epidemiological literature on the multigroup SIR models and their stability conditions, see, for example, Hyman, Li, and Stanley (1999), Guo, Li, and Shuai (2006), Li, Shuai, and 94 An individual based stochastic epidemic model on a net- work We depart from the literature by explicitly modelling the individual indicators, xi`;tandyi`;t, (and hencezi`;t) and then simulate and aggregate up to match the theory predictions with realized outcomes. In this section, we rst describe the infection and recovery processes at individual level, then show how they lead to the moment conditions at group levels, and nally derive the relation between aggregated outcomes from our model and the multigroup SIR model. 4.1 Modelling the infection and recovery processes As an attempt to better integrate individual decisions to mitigate their health risk within the epi- demic model we propose to directly model xi`;tfor each individual (i;`), as compared to modelling the group aggregates S`t,R`t, andI`t. We follow the micro-econometric literature and model the infection process using the latent variable, x\u0003 i`;t+1;which determines whether individual (i;`)be- comes infected. Speci cally we begin with the following switching process individual (i;`): xi`;t+1=xi`;t+ (1\u0000xi`;t)I\u0000 x\u0003 i`;t+1>0\u0001 ; (11) whereI(A)is the indicator function that takes the value of unity if A>0, and zero otherwise. We suppose that x\u0003 i`;t+1is composed of two di\u00a4erent components. The rst component relates to the contact pattern of individual (i;`)with all other individuals in the active set, denoted by zj`0;t; both within (when `0=`) and outside of his/her group (when `06=`). The second component is an unobserved individual-speci c infection threshold variable, \u0018i`;t+1. Formally, we set x\u0003 i`;t+1= `LX `0=1n`0X j=1di`;j`0(t)zi`0;t\u0000\u0018i`;t+1; (12) where the rst component depends on pattern of contacts, di`;j`0(t), whether the contacted individ- uals are infectious, zj`0;t, exposure intensity parameter, denoted by `.D(t) =\u0002 di`;j`0(t)\u0003 is Wang (2010), Ji, Jiang, and Shi (2011), Ding, Qin, and Ding (2015) and Zhou, Yang, and Zhang (2017). 10the contact network matrix, such that di`;j`0(t) = 1 if individual (i;`)is in contact with individual \u0000 j;`0\u0001 at timet:zi`0;t= (1\u0000yi`0;t)xi`0;tis an infectious indicator, already de ned by (2), and takes the value of unity if individual (j;`0)is infected and not yet recovered, zero otherwise. The ex- posure intensity parameter, `, is group-speci c and depends on the average duration of contacts, whether the contacting individuals are wearing facemasks, and if they follow other recommended precautions. The multigroup structure of the rst component of (12) covers a wide range of observable characteristics, and can be extended to allow for di\u00a4erences in age, location, and medical pre- conditions. There are also many unobservable characteristics which lead to di\u00a4erent probabilities of infection even for individuals with the same contact patterns and exposure intensities. To allow for such latent factors, we have introduced the individual-speci c positive random variable (\u0018i`;t+1>0) which represents the individual\u0092 s degree of resilience to becoming infected and varies across (i;`)andt:Ceteris paribus , an individual with a low value of \u0018i`;t+1is more likely to become infected. \u0018i`;t+1is assumed to be independently distributed over i,`andt, and follows an exponential distribution with the cumulative distribution function given by Pr (\u0018i`;t+1<a) = 1\u0000exp\u0000 \u0000\u0016\u00001 `a\u0001 ;fora\u00150; (13) where\u0016`=E(\u0018i`;t+1). As we shall see, it is not possible to distinguish between \u0016`and `: To complete the speci cation of the infection process we also need to model yi`;t, namely the recovery indicator. We assume that recovery depends on the number of days since infection. Speci cally, the recovery process for individual iis de ned by yi`;t+1=yi`;t+zi`;t\u0010i`;t+1(t\u0003 i`); (14) wherezi`;t= (1\u0000yi`;t)xi`;t,\u0010i`;t+1(t\u0003 i`) = 1 if individual (i;`)recovers at time t+ 1, having been infected exactly at time t\u0003 i`and not before, and \u0010i`;t+1(t\u0003 i`) = 0;otherwise. The analysis of recovery simpli es considerably if we assume time to removal, denoted by T\u0003 i`;t=t\u0000t\u0003 i`;follows probability of recovery at time t+ 1having remained infected for t\u0000t\u0003 i`\u00001days. As is well known this is is the same across all individuals within a given group, and which most importantly does not depend on the number of days since infection.9Therefore, using (15) and (16) in (14), the recovery micro-moment condition simpli es to E(yi`;t+1jyi`;t;zi`;t) =yi`;t+ `zi`;t. (17) We assume that the elements of the n\u0002nnetwork matrix D(t) =\u0000 di`;j`0(t)\u0001 are independent draws with E\u0002 di`;j`0(t)\u0003 =p``0, namely, the probability of contacts is homogeneous within groups but di\u00a4ers across groups. Let d0 i(t)be theithrow of D(t). ztbe a column 9A more general speci cation that allows the recovery probability to depend on the number of days being infected is considered in Section S1 of the Online Supplement. 12vector consisting of zj`;t, forj= is clear that `and\u0016`are not separately identi ed. Without loss of generality, in what follows we set\u0016`= 1. Since in general individual contact patterns are not observed, we also need to deriveE(xi`;t+1jxi`;t;zt). To this end we rst note that individual (j;`0)is currently infected (namely if at time the/she is a member of the active set, It), otherwise zj`0;t= 0. In the latter case 1\u0000p``0+exp\u0000 \u0000 See also (6). 134.2 Moment conditions at group and aggregate levels Aggregating the micro infection moment conditions, (18), over ifor a given group `, we obtain E n`X i=1xi`;t+1jzt! =n`\u0000(n`\u0000C`t)LY `0=1\u0000 1\u0000p``0+p``0e\u0000 the micro recovery moment conditions, (17), we have E(R`;t+1jR`t;C`t) = (1\u0000 `)R`;t+ `C`t;for`= 1;2;:::;L: (20) In per capita terms we obtain the following 2Ldimensional system of moment wherec`t=C`t=n`andr`t=R`t=n`refer to per capita infected and recovered by group, re- spectively, and it= (i1t;i2t;:::;iLt)0withi`t=c`t\u0000r`t=I`t=n`. Given time series data on ct= (c1t;c2t;:::;cLt)0andrt= (r1t;r2t;:::;rLt)0, the above moment conditions can be used to estimate the structural parameters, `, `andp``0=p`0`. In relating the theory to the data one may need to further aggregate across groups to the population level if group-level data are unavailable or unreliable. It is interesting to note that the multigroup model does not lead to a model for the aggregates, Ct=PL `=1C`tandIt=PL `=1I`t, without strong restrictions. To see this, set p``0=\u0014k``0=n`0;wherek``0is the mean number of contacts per day between individuals in group `and`0;and\u0014is a constant. To preserve the symmetry of contact probabilities the mean contact numbers must satisfy the so-called reciprocity 14condition,n`k``0=n`0k`0`.10That is, the total number of contacts that people in group `have with people in group `0must be the same as the number of contacts that people in group `0have with people in group `. In practice n`is often quite large, with k``0relatively small (often less than 30). Then (1\u0000c`t) exp\" \u0000\u0014\u0000 1\u0000e\u0000 \u0014and `are not separably identi able, `)k``0. Note that 1\u0000e\u0000 since is small. Then we have ``0\u0019 `k``0, and (24) can be If we multiply both sides of (25) byw`and sum across `= example, Willem et al. (2020). 15It is now clear that the group moment condition for infected cases, (21), does not aggregate up to the moment conditions in terms of ctandit, unless ``0=n`0is the same across all `and`0. It is also straightforward to see that the group moment condition for recovery, (22), does not aggregate up either unless `= for all`. In the case of a single group, we have `= ,k``0=k, and ``0= if `= for all`, the recovery moment condition, (22), becomes E(rt+1jrt;ct) = (1\u0000 )rt+ ct: (28) Given aggregate data on ct,itandrt, one can estimate and using the moment conditions (27) and (28), respectively. We shall return to the identi cation and estimation problem once we have clari ed the relationship between our model and the classical SIR model. 4.3 Relation to the multigroup SIR model The multigroup SIR model given by (8)\u0096 (10) is a linearized-deterministic version of the above moment conditions. To see this, using the identity S`t=n`\u0000C`tands`t=S`t=n`, (25) can be rewritten as E(\u0001s`;t+1jit)t\u0000s`tLX `0=1 ``0i`0t+O\u0000 n\u00001\u0001 : (30) In comparison, dividing both sides of (8) in the multigroup SIR model gives \u0001s`;t+1=\u0000s`tLX `0=1 ``0i`0t: (31) 16To exactly match the deterministic expression of s`tgiven by (31) with the stochastic process given by (30), we can introduce either an additive or a multiplicative random error to the right-hand side of (31). To ensure that s`tis non-negative for all t, a multiplicative error with mean unity would be a more reasonable choice. Turning to the recovery process. The aggregate recovery governed by (20) matches with the deterministic recovery equation, (10), of the SIR model under a geometric recovery process. Finally, since I`t=n`\u0000R`t+S`t, the active cases of our model also match with the infected equation, (9), of the SIR model. 5 Basic and e\u00a4ective reproduction numbers In this section we consider the calibration of our model to a given basic reproduction number assuming no intervention, and derive the e\u00a4ective reproduction numbers in terms of mean contact patterns, exposure intensities, and the recovery rate. We also highlight the di\u00a2 culty in identifying the contact patterns from the exposure rates in single and multigroup contexts. 5.1 Basic reproduction number We calibrate the parameters of our model so that at the start of the disease outbreak (the initial state) the model yields the basic reproduction number, denoted by R0, formally de ned as \" the average number of secondary cases produced by one infected individual during the infected indi- vidual\u0092 s entire infectious period assuming a fully susceptible population \" (Del Valle, Hyman, and Chitnis, 2013). By construction, R0measures the ability of an infectious disease spreading in the absence of any interventions. Infection spreads if R0>1and abates ifR0<1. Suppose that in day 1, the equivalent of one individual becomes infected. To capture the di\u00a4erent contact and exposure intensities of the groups, we assume that a fraction w`=n`=nof each group `becomes infected. That is, in day 1,R`1= 0,I`1=C`1=w`for`= 1;2;:::;L exposition, suppose that `= ;for all`. Then the average infection duration is 1= . Assume further that the individual remains infected over the infectious period, 1= . According to the de nition of R0, is an exact multigroup expression for R0and it plays a critical role in identi cation and the calibration exercises to follow. To see how the expression in (33) relates to the well known expression R0= = , consider the case of a single group with p=k=(n\u00001)tk=nsincenis large. Then the expression in (33) reduces to R0=n\u0002 1\u0000\u0000 1\u0000p+pe\u0000 \u0001\u0003 =np(1\u0000e\u0000 )t k; (34) result follows by 1\u0000e\u0000 = +O( 2);and being small. Hence the model can be calibrated to any choice of R0and by setting the average number of contacts, k, and/or the exposure intensity parameter, . It is clear that andkare not separately identi ed\u0097 only their product is identi ed. In addition, we would obtain the classical result R0= in SIR models if we set =np(1\u0000e\u0000 )t k. Returning to the multigroup case, expression (34) continues to apply if the population is homogeneous in the sense that p``0=p, `= , for all`and`0. But in the more realistic case of group heterogeneity we can use (33) to calibrate `and/orp``0for given choices of R0and . Since we have assumed that n`is large and Lis xed, (33) can be further simpli ed with a linear approximation derived as follows. Let An;``0= (1\u0000p``0+p``0e\u0000 `)w`0, and use a similar argument 18as in can be written equivalently as R0=LX `=1w` `+O\u0000 n\u00001\u0001 ; (36) where `is transmission rate de ned by `=LX `0=1 `k``0: (37) Similar to the case of a single group, equation (35) implies that `andp``0are not separately identi ed; only their products are identi ed (or equivalently, ``0\u0019 `k``0are identi ed). To see this more formally, consider the simple case of two groups (L= 2). Then for su\u00a2 ciently large n, 2p22); (38) where the last line follows by the symmetry of contact probabilities: p``0=p`0`. It is clear from (38) that only 1p11,( 2)p12, and 2p22can 1;2;:::;L . 5.2 E\u00a4ective reproduction numbers and mitigation policies In reality, the average number of secondary cases will vary over time as a result of decline in the number of susceptible individuals (due to immunity or death) and/or changes in behavior (due to mitigation strategies such as social distancing, quarantine measures, travel restrictions and wearing of facemasks). The e\u00a4ective reproduction number, which we denote by Ret,11is the expected number of secondary cases produced by one infected individual in a population that includes both susceptible and non-susceptible individuals at time t:In a multigroup setting we represent \"one infected individual\" by the vector of population proportions, w= (w1;w2;:::;wL)0. The evolution ofRetis determined by the by ned by Ret=LX `=1E(C`;t+1\u0000C`tjIt=w): (39) In the absence of any interventions, using (19) we have Ret=LX `=1(n`\u0000C`t)2 41\u0000LY then fornsu\u00a2 `=1w` `s`t+O\u0000 n\u00001\u0001 ; (41) where `is already de ned by (37). In the case of a single group or when `= is homogeneous across groups, the above expression 11We use this notation in order to clearly distinguish the e\u00a4ective reproduction number from the number of removed cases, Rt. 20simpli es to Ret= \u0010PL `=1w`s`t\u0011 = st, which can be written equivalently as Ret= (1\u0000ct)R0: (42) In the absence of any interventions Retdeclines as ctrises, andRetfalls below 1whenct> (R0\u00001)=R0. The value (R0\u00001)=R0is often referred to as the herd immunity threshold. For the multigroup case, using (36) and (41), the condition for herd immunity is more complicated and is given by (for nsu\u00a2 `=1w` `c`tPL `=1w` `>R0\u00001 R0: This formula clearly shows that for herd immunity to apply, the group-speci c infection rate, c`t, must be su\u00a2 ciently large \u0096shielding one group requires higher infection rates in other groups with larger population weights. To see this, let us consider a simple example of two groups ( L= 2) with a homogeneous transmission rate across the two groups ( 1= 2= ). Suppose that policy makers want to shield Group 1, which may comprise elderly people, from infection. In the extreme case where all individuals in Group 1 are protected, namely, c1t= 0, then herd immunity requires c2t>(R0\u00001)=(R0w2), which is higher than the threshold value of (R0\u00001)=R0where the population groups are treated symmetrically. Social intervention might be necessary if the herd immunity threshold is too high and could lead to signi cant hospitalization and deaths. In such cases intervention becomes necessary to reduce the transmission rates `, thus introducing independent policy-induced reductions in the transmission rates. In the presence of social policy interventions the e\u00a4ective reproduction number for the multigroup can be written as `tk``0;t: Reductions in `tcan come about either by reducing the average number of contacts within and across groups, k``0;t, or by reducing the group-speci c exposure intensity parameter, `t, or both. Since only the product of `tandk``0;tis identi ed, in our simulations we x the contact patterns and calibrate the desired value of `tby setting the value of `tfor each`to achieve a desired Rnumber. Of course, one would obtain equivalent results if the average number of contacts is assumed to be time-varying and the exposure intensity parameter is assumed constant. In the case of a single group or when `t= tfor all`, we have Ret= (1\u0000ct) t ; (44) where (1\u0000ct)is the herding component. It is also worth bearing in mind that at the outset of epidemic outbreaks the value of ctis close to zero which ensures that Re0= 0= =R0. 6 Simulated properties of the model We are now in a position to examine the properties of the model by simulations. We rst present simulation results for a xed transmission rate, , (assuming no intervention) using the single and multigroup models. We then consider simulation outcomes under two scenarios with social interventions such that the transmission rate, t, is linearly declining and W-shaped, respectively. 6.1 Simulations with a xed transmission rate Although it is di\u00a2 cult to obtain an analytical solution to the individual based stochastic epidemic model, we can study its properties by simulations. We start with the baseline case of a single group (L= 1), with no interventions, so that the transmission rate is a constant. In light of the recent studies on the value of R0for Covid-19 we set R0= 3. A summary of published estimates ofR0is provided in Table 1 of D\u0092 Arienzo and Coniglio (2020). For the recovery rate, in view of 22the World Health Organization guidelines of two weeks self-isolation we set = 1=14.12It follows that = R0= 3=14:Recall that = kand, as has been shown in Section 5, andkare not separately identi ed. We set the average number of contacts to k= 10 based on the literature on social contacts in the pre-Covid period that we have reviewed in Section 2, and then set the exposure intensity parameter, , by = =k= R0=k. For each replication, the simulation begins with 1=1000 of the population randomly infected in day 1, that 1=i(b) from day 2onwards, the infection and recovery processes follow (11) and (14), respectively, with L= 1. After obtaining x(b) i;t,y(b) the population size to n= 10;000. We also tried larger population sizes but, as will be seen below, the interquartile range of the simulated infected and active cases is very tight when n= 10;000. Some simulation results for n= 50;000andn= 100;000are provided in Figure S.1 of the Online Supplement. The only remaining task is to determine the topology of the contact network which, in the case of a single group, can be denoted by D(b)(t) =\u0010 d(b) ij(t)\u0011 :Note that the contact network randomly changes every day (and also across replications). This feature captures the random nature of many encounters an individual has on a daily basis. We consider two widely used random networks: Erd \u00bdos-R\u00e9nyi and power law (also known as scale-free) random networks. In an Erd\u00bdos-R\u00e9nyi random graph (simply referred to as \"the\" random graph), each pair of the nodes (or individuals) are connected at random with a uniform probability p=k=(n\u00001)\u0019k=n;wherekis the mean degree of the network (or mean number of contacts per individual).14Note that in the limit of large n(withk xed), the Erd \u00bdos-R\u00e9nyi random network has a Poisson degree distribution, which may depart from real-world contact networks in which a small number of individuals (such 12Similar guidelines issued by U.S. and U.K. can be found at https://www.cdc.gov/coronavirus/2019-ncov/ if-you-are-sick/quarantine.html and https://www.nhs.uk/conditions/coronavirus-covid-19/ self-isolation-and-treatment/how-long-to-self-isolate/ , respectively. 13We nd that there will not be outbreaks in many replications if the simulation begins with less than 1=1000 of the population initially infected. 14The degree of a node in a network is the number of connections it has (or number of edges attached to it). 23as school-aged children, medical professionals, delivery drivers and sales workers) may have a relatively high number of daily contacts. In other words, the degree distribution of the contact networks may be heavy-tailed (right-skewed). The power law random network is a popular choice to model this phenomenon. In a (truncated) power law graph, the degree distribution follows the power-law distribution: px=Cx\u0000 ; x =kmin;kmin+ 1;:::;k max; (45) wherepxis the fraction of nodes in the graph with degree x,kmin(kmax) is the minimum (maximum) degree, >1is a constant known as the power law exponent, and Cis a normalization constant such thatPkmax kminpx= 1:We consider kmin= 5andkmax= 50 in the simulations. The value of is set so that the mean degree is equal to 10. We provide details on the generation of the Erd\u00bdos-R\u00e9nyi and power law networks in Section S2 of the Online Supplement. Figure 1 presents the simulation results using the power law contact network. It displays in fan chart style with the 10th,25th,50th,75thand90thpercentiles of the proportion of infected, c(b) t=C(b) t=n;and the proportion of active cases, i(b) t=I(b) t=n, over 1;000replications. The mean values are very close to the median and hence not shown. We see that the proportion of infected starts to increase rapidly around 40days since the outbreak, and then begins to level o\u00a4 about 90days after the start of the outbreak. The maximum proportion of infected averaged across replications, i.e., cmax=B\u00001PB b=1maxt\u0010 c(b) t\u0011 , eventually peaks at 93:8percent, which is markedly higher than the peak value of 2=3obtained for deterministic SIR models with the same basic reproduction number. The proportion of active cases is slightly right-skewed and reaches maximum, imax=B\u00001PB b=1maxt\u0010 i(b) t\u0011 = 0:298, about 59days since the outbreak. The simulation results using the Erd \u00bdos-R\u00e9nyi random network are very similar to those obtained using the power law network with the same mean degree. (See Figure S.3 of the Online Supplement.) Therefore, in what follows we will focus on the power law network. We now turn to the multigroup case. For illustrative purposes, we consider dividing the population into L= 3age groups: [0;15),[15;65)and65+ years old. We calibrate the model to 24Figure 1: Simulated number of infected and active cases using a single group model with R0= 3 Infected cases Active cases Notes: The simulation uses the power law network with mean contact number k= 10 and begins with 1=1000 of the population randomly infected in day 1. The exposure intensity parameter is set to = R0=k, withR0= 3 and recovery rate = 1=14. Population size is n= 10;000. Number of replications is 1;000: the contact matrix reported by Mossong et al. (2008) for Germany, which is (0:145;0:679;0:176)0.15Recall that ` andp``0=k``0=n`0are not separately identi ed.16To capture the fact that older people are more likely to be infected, we follow the study by Zhang et al. (2020a) who estimate that the odds ratios for a contact of age group 1and3to be infected relative to age group 2are0:34and1:47, respectively. Accordingly, we set = ( `p``0); As in the case of a single group, we set R0= 3and = 1=14. For each replication the simulation 15These data can be easily retrieved by the Social Contact Rates (SOCRATES) Data Tool at https://lwillem. shinyapps.io/socrates_rshiny/ . 16See Section S2 of the Online Supplement for the generation of networks with the multigroup structure. 25begins with 1=1000 of total population ( n= 10;000) randomly infected in day t= 1, and then fromt= 2onwards, the infection and recovery processes follow (11) for `= 1;2;3:We computec(b) `t=C(b) `t=n`andi(b) `t=I(b) `=1w`c(b) `tandi(b) t=PL `=1w`i(b) `t. replications is set to B= 1;000: Figure 2 displays the simulation results for the three groups separately. As before, the fan charts depict the 10thpercentile through the 90thpercentile of c(b) `tandi(b) `t; the mean and median values are quite close. Among the young people in Group 1, the proportion of infected peaks at 59:1percent, compared to the maximum proportion of infected equaling 95:8and91:9percents for Groups 2and3, respectively. For the proportion of new cases, Group 1peaks at 16:2percent, a level much lower than 32:2percent for Group 2and29:6percent for Group 3, respectively. It takes 64,55, and 57days, respectively, for the 3groups to reach their peak proportion of new cases. Of course, these outcomes depend on our speci cation of the contact matrix and the exposure intensity parameters. This exercise aims to demonstrate the simulations with the multigroup model, rather than produce results that are close to the real data. It is also of interest to compare the aggregates obtained using the multigroup model with those from the single group model. Figure 3 compares the median values of c(b) tandi(b) tover1;000 replications. What stands out is the similarity of the epidemic curves whether they are obtained by multigroup or the single group model.17This is not surprising because the simulations were performed with the same xed = R0. The heterogeneity in `andp``0a\u00a4ects the epidemic curves for each group, but do not seem to impact the aggregates. This is interesting and suggests that an aggregate analysis might be justi ed if the primary focus is on the spread of the infection across the population as a whole rather than on particular age/type groups. 17We also obtain similar results when we carry out simulations using 6and8groups instead of 3groups. 26Figure 2: Simulated number of infected and active cases using a multigroup model with R0= 3 Group 1: [0, 15) Group 2: [15, 65) Group 3: 65+ Infected cases Active cases Notes: We set 1=1000 of the population randomly infected in day 1. Recovery rate is = 1=14. The contact matrix is given by (46). Population size is n= 10;000, with population shares w= (0:145;0:679;0:176)0:Number of replications is 1;000: 6.2 Simulations with linearly declining and W-shaped transmission rates In reality, the transmission rate varies over time both due to voluntary and mandated social distancing and other mitigation measures, as well as changes in the share of susceptible population as the epidemic spreads. But at the early stage of the epidemic the main driver of the transmission rate is behavioral. Here we consider two scenarios\u0097 linearly declining tand W-shaped t\u0097 that are representative of transmission rates we observe as a result of di\u00a4erent mitigation policies. We focus on the case of a single group, but note that similar simulations can be conducted for the multigroup model. In the case of linearly declining t, we let tdecrease linearly from 0=R0 = 3=14at 27Figure 3: Median number of infected and active cases under single- and multi-group models with R0= 3 Infected cases Active cases tandi(b) tover 1=14. Population size is n= 10;000. In the case of a single group, the power law network with mean contact number k= 10 was used. In the case of the multigroup model, the contact matrix is given by (46) and population shares arew= (0:145;0:679;0:176)0. the rate of 0:0023 per day during the rst 80days since the outbreak and then remain constant thereafter. In the case of W-shaped t, we set tto fall linearly from 3=14at the daily rate of 0:0037 in the rst 7weeks, stay constant for another 2weeks, then rise linearly at the rate of 0:0038 during the 10th\u000012thweeks, fall linearly at the rate of 0:0031 during the 13th\u000018thweeks, and nally remain constant until the epidemic is over. We carry out simulations using the power law network assuming a single group. Since tandktare not separately identi ed, as have been shown in Section 5, in simulations we x k= 10 and set t= t=k:As before, we set = 1=14 and suppose that 1=1000 of population is randomly infected in day 1. Figure 4 presents the simulation results with linearly declining and W-shaped t, in comparison with the results without intervention (with a xed ), over 180days since the outbreak. The gure also displays the time pro le of t(scaled by 1= ) and the median of R(b) et= (1\u0000c(b) t) t= over 1;000replications. With linearly declining t, we nd that the maximum proportion of infected was brought down from 93:8percent under no intervention to 18:8percent; and the maximum proportion of active cases was signi cantly reduced from 29:8percent under no intervention to 4:64 percent. With W-shaped t, we obtain two peaks in the active cases \u0096this shows that our model 28Figure 4: Simulated number of infected and active cases using a single group model under linearly declining and W-shaped transmission rates (a) Without intervention R0= = Infected cases Active cases (b) Linearly declining transmission rates t Time pro le of t= andRet Infected cases Active cases (c) W-shaped transmission rates t Time pro le of t= andRet Infected cases Active cases Notes: We set 1=1000 of the population randomly infected in day 1and use the power law network with mean contact number k= 10. Recovery rate is = 1=14. The exposure intensity parameter is t= t= over1;000replications displayed together with t= in the rst column. 29Figure 5: Median number of infected and active cases using a single group model under linearly declining and W-shaped transmission rates Time pro le of t= Infected cases Active cases Notes: The simulation uses the power law network with mean contact number k= 10 and begins with 1=1000 of the population randomly infected in day 1. Recovery rate is = 1=14. The exposure intensity parameter is t= t=k. n= 10;000. Number of replications is 1;000. is able to produce results that mimic the rebound in Covid-19 cases many countries are currently experiencing. After 180days the proportion of infected cases accumulates to 9:35percent, a level much lower than that in the case of no intervention. As expected the di\u00a4erence between t= and Retis negligible at the beginning of the outbreak as ctis very small; t= becomes higher than Retasctgrows. To further compare the scenarios of linearly declining tand W-shaped t, we plot the median infected and active cases over 1;000replications in Figure 5. It is clear that the maximum infected and active cases are much higher with the linearly declining tthan with the W-shaped t. Even though there is a surge in tin the latter scenario, this comparison highlights the importance of lowering tsooner rather than later. 7 Estimation of transmission rates The previous section investigates the properties of the model assuming the transmission rates are given. We now turn to detailing how to estimate the transmission rate using data on infected cases. We rst derive the method of moments estimation of the transmission rate, present the nite sample properties of the estimators using Monte Carlo techniques, and then show that the estimates are robust to considerable under-reporting of infected cases. 307.1 Estimation without measurement errors Let us rst consider the case of a single group, and recall that the moment condition for this case is given by (27), which is replicated here for convenience E\u00121\u0000ct+1 1\u0000ctjit\u0013 =e\u0000 it+O\u0000 n\u00001\u0001 : (47) We can estimate the transmission rate, , using (47) by nonlinear least squares (NLS) given time series data onfct;itg. The recovery rate, , can be estimated using the recovery equation, (22): E(rt+1jrt;ct) = (1\u0000 )rt+ ct. We will discuss the estimation of in the next section, but note that in reality, rtis often not recorded in a timely manner and is estimated from the hospitalization data. In the absence of any interventions (voluntary or mandated), = R0, where as beforeR0is the basic reproduction number. Then it follows that R0can be estimated by^R0=^ = , where ^ is the NLS estimate of using (47). To examine the nite sample performance of ^ , we estimate using simulated data generated from the stochastic SIR model on a power law network with mean contact k= 10 and assuming 1=1000 of the population is randomly infected on day 1. The true value of the transmission rate is set to = 3=14, which corresponds to the case where R0= 3and = 1=14.18We consider population sizes n= the the number of replications toB= 1;000. To alleviate noise induced by zero and near zero observations at the start and the nal stages of the epidemic, estimation of is carried out over samples with i(b) t\u00150:01, for the bthreplication, b= 1;2;:::;B . Since the value of is quite small, we present the estimation results in terms of ^R0=^ = . Table 1 summarizes the bias and root mean square error (RMSE) of ^R0under di\u00a4erent population sizes, the estimate of in thebthsimulated sample. As can be seen from Table 1, although ^R0slightly underestimates R0, its bias and RMSE are quite small in all experiments. The RMSE declines as the population size nincreases, but 18For the rationale behind setting = 1=14, see Footnote 12. 31Table 1: Finite sample properties of the moment estimator of R0 Full Sub-samples Population Sample 38 Notes: The true value of R0is set to = , where = 3=14and = 1=14so thatR0= 3. We x and estimate using (47). Each sub-sample is about 1=3of the full time series sample size. The time series sample sizes averaged across replications are reported in the last row. Number of replications is B= 1;000. even withn= 5;000;R0can be estimated reasonably well. In the absence of any interventions we would expect to obtain the same estimate of R0irrespective of what sub-sample we consider. To illustrate the robustness of ^R0to the choice of the sub-sample, we estimated R0over three non-overlapping sub-samples, each around one third of the full sample, at the start, in the middle, and at the end of the epidemic. The results show that R0can be estimated fairly well over all of the three sub-samples. Similar moment conditions can also be used to estimate the parameters of the multigroup. If time series data on fc`t;i`tg, for`= 1;2;:::;L (Lis nite) are available, we can estimate the products, ``0, using the moment conditions (25), \u0000LX `0=1 ``0i`0t! +O\u0000 n\u00001\u0001 we have discussed in Section 5, ``0is identi able from (35) given andw= (w1;w2;:::;wL)0: Under social interventions the recovery equation holds (since is una\u00a4ected), but the moment condition for ct+1now depends on the time-varying transmission rate, t. For in the range of 1=14to1=21, it is reasonable to use 2or3weeks rolling windows when estimating t. Consider 32the case of a single group. For a window of size W, we have ^ t(W) =Argmin tX =t\u0000W+1\u00121\u0000c 1\u0000c \u00001\u0000e\u0000 i \u00001\u00132 : (48) To examine the nite sample properties of the rolling estimator, ^ t(W), we conduct 2-weekly and3-weekly rolling estimation using the simulated data with n= 10;000under xed, linearly declining and W-shaped transmission rates, respectively. We nd that the 2-weekly and 3-weekly rolling estimates are very close to each other. The bias and RMSE are reasonably small in all scenarios. The results are provided in Tables S.1 and S.2, and Figure S.4 of the Online Supplement. We will hereafter focus on the 3-weekly rolling estimates. 7.2 Estimation allowing for measurement errors It is widely recognized that in practice CtandRt(andIt=Ct\u0000Rt) are under-reported. The magnitude of under-reporting is measured by the multiplication factor (MF) in the literature (see, for example, Gibbons et al. (2014)). This multiple could change over time as the result of testing, but in any case it is certain that MF t>1. Denoting the observed values of ctanditby~ctand~{t, we have (we are assuming that rt=Rt=n=MFt~rt, where ~Rtis the observed value of Rt) ct=MFt~ctandit=ct\u0000rt=MFt~{t: Then the moment condition in terms of observed values ( ~ctand~{t) can be written as E(1\u0000MFt+1~ct+1j~{t;~ct) = (1\u0000MFt~ct)e\u0000 MFt~{t: (49) Suppose further that MF t+1is a martingale process distributed independently of ~ct+1, so that E(MFt+1) =MFt:In this case, it (1\u0000MFt~ct)e\u0000 MFt~{t: Now noting that ~{tMFtis likely to be quite small, we obtain E(1\u0000MFt~ct+1j~{t;~ct) average of MF tcan be estimated using rolling windows. However, in situations where ~ctand~{tare very small (as is the case for the current pandemic), the second term in the above moment condition will be close to zero and it might not be possible to identify MF t. Remark 1 Alternatively we could assume that MF titself is distributed independently of ~ct, but allow MF tto vary systematically with a measure of testing. It is expected that the data quality will improve as more testing is conducted. Given the current data availability, we leave the modelling of MFtas a function of testing to future research. Figure 6 depicts the median of the 3-weekly estimates of t(scaled by 1= ) over 1;000repli- cations with a MF of 1(no under-reporting) and MF of 10, for the scenarios of linearly declining tand W-shaped t, respectively. It is notable that the estimates are reasonably close to the assumed value even if infected cases are under-reported 10times. We have also considered MF = 20. The estimates are not displayed since they are so close to those under MF = 10 that the di\u00a4erences are hardly discernible. Also note that when tremains constant or rises, the estimates without measurement error (MF = 1) are closer to the assumed value than the estimates with measurement error; when tfalls, however, the estimates under MF = 10 tend to be closer to the assumed value. Let us close this section by addressing the concern about data smoothing. It is a common practice to take 1-week moving average (MA) of the recorded cases to mitigate daily \u0087 uctuation 34Figure 6: Rolling estimates of t= under linearly declining and W-shaped transmission rates using di\u00a4erent values of the multiplication factor (MF = 1;10) Linearly declining transmission rates t W-shaped transmission rates t Notes: Estimates refer to the median of 3-weekly rolling estimates of t= computed using (48) over 1;000replica- tions, where is set to 1=14. The data were simulated using a single group model with the power law network. The mean number of contacts is k= 10. The exposure intensity parameter is t= t=k. Population size is n= 10;000. due to reporting delays, weekend e\u00a4ects and other potential data anomalies. To investigate the e\u00a4ect of pre- ltering the data on the estimates of t, we apply a 1-week MA lter to the simulated data and compare the resulting estimates of twith the estimates obtained using un ltered data. We nd little di\u00a4erence in the estimates whether the data are ltered or not. (See Figure S.5 of the Online Supplement). But it is worth bearing in mind that ltering the data before estimation will introduce error serial correlation which could negatively a\u00a4ect the estimates. In practice it might be prudent to obtain estimates of tusing ltered and un ltered data. But since in our applications we obtain very similar results whether we use ltered or un ltered data, we only report the estimates based on un ltered observations. 8 Estimation of the recovery rate As noted earlier, with reliable data on the number of removed (recovered or dead), the recovery rate, , can be estimated using the moment condition given by (22). In reality, however, it is hard to accurately measure Rt. In the calibration exercise to be presented in the next section, we do not estimate because the data on recovery are either unavailable or problematic in the countries we considered. In the current section we demonstrate that the recovery rate can be estimated very 35precisely using simulated data. To simplify the exposition, we consider a single group ( L= 1) and suppose that the time to recovery follows a geometric distribution as in the standard SIR model. The same aggregate outcome follows in the multigroup case when the probability of recovery is the same across all groups. Under these conditions the aggregate moment condition for recovery, (22), can be written as \u0001Rt+1= It+un;t+1; (50) where \u0001Rt+1=Rt+1\u0000Rtandun;t+1is a martingale di\u00a4erence process with respect to ItandRt. (It=Ct\u0000Rt). Recall from (5) and (6) that Rt=Pn i=1yitandIt=Pn i=1zit, we note that un;t+1 is an aggregated error, namely, un;t+1=Pn i=1ui;t+1:Dividing both sides where \u0001rt+1=rt+1\u0000rt,rt=Rt=n,it=It=nand\u0016un;t+1=n\u00001Pn i=1ui;t+1. For large n and assuming that the individual di\u00a4erences in recovery are cross sectionally weakly correlated, we have \u0016ut+1=Op(n\u00001=2). It follows that can be consistently estimated from (51) by ordinary least squares (OLS) regression of \u0001rt+1onit. Note that Tis nite asn!1 . Due to the presence of Op\u0000 n\u00001=2\u0001 in (51), it is expected that as nincreases, the randomness will diminish and estimates of become increasingly precise. In the limit we would expect \u0001rt+1\u0000 it=Op(n\u00001=2). To examine the nite sample properties of the OLS estimator of , we simulate our model assuming a homogeneous recovery rate and compute the aggregate time series for B= 1;000 replications under a given population size, n. Denote the recovery and infection time series of the bthreplication by r(b) t+1andi(b) t, respectively, for b= 1;2;:::;B: For each replication, we obtain ^ (b)by regressing \u0001r(b) t+1oni(b) t, without an intercept. As before, we run these regressions using the observations with i(b) t\u00150:01, using the full sample as well as the three sub-samples (start, middle and end). The true value of in the experiment is set to 1=14. Table 2 reports the bias and RMSE of the OLS estimator of in (51). Note that even though the bias and RMSE in the table have been multiplied by 100, they are very small in magnitude. It is evident that we can estimate very precisely even with short time series samples. The RMSEs 36Table 2: Finite sample properties of the moment estimator of Full Sub-samples Population Sample 36 38 Notes: The true value of is set to 1=14. The estimating equation is given by (51). Each sub-sample is about 1=3of the full time series sample size. The time series sample sizes averaged across replications are reported in the last row. Number of replications is B= 1;000. obtained by using the sub-samples are slightly larger than those obtained using the full sample; but they are still quite small given that the sub-samples are based on fewer than 40observations. The RMSE declines as nincreases \u0096this con rms the theory that randomness will diminish with nat the rate of n\u00001=2. 9 Calibrating the model to the Covid-19 evidence for se- lected European countries We are now ready to calibrate our model to the realized Covid-19 data and perform counterfactual analyses. In view of the data quality and the current stage of the epidemic, we evaluate how our model matches with the recorded evidence in six European countries, namely, Austria, France, Germany, Italy, Spain and the United Kingdom. We rst estimate the transmission rate, t, on data from these countries, which we then use to calibrate and evaluate our stochastic network model. The Covid-19 data are sourced from the repository of the Center for Systems Science and Engineering (CSSE) at Johns Hopkins University,19and the population data (for year 2019) are 19Available at https://github.com/CSSEGISandData/COVID-19 . 37obtained from the World Bank database.20To estimate tfollowing (48), we need observations on per capita infected and active cases, ctandit. Using the recorded number of infected cases, Ct, and population data, ctis readily available. Since It=Ct\u0000Rt, we can obtain itif the number of removed (recovered) cases, Rt;is available. Unfortunately, the recovery data is either not reported or subject to severe measurement error/reporting issues in many countries. For all six countries we therefore estimate the number of removed (including recoveries and deaths) by Rt= (1\u0000 )Rt\u00001+ Ct\u00001, where the recovery rate is set to 1=14;and the process starts from R1= 0. We then compute Itby subtracting the estimated Rtfrom the recorded Ct.21 The Covid-19 outbreak in Europe began with Italy in early February 2020 with the recorded number of infections accelerating rapidly from February 21onward. A rapid rise in infections took place about one week later in Spain, France and Germany, followed by UK and Austria at the end of February. Accordingly, we rst compute 3-weekly rolling estimates of tusing (48) over the period from mid-March onwards for Italy and about one week later for the other ve countries, ending on October 15,2020 (the last data point available used in this study). These estimates are then substituted in (44) to obtain estimates of the e\u00a4ective reproduction number given by ^Ret= (1\u0000MFct)^ t= , where MF represents the extent of under-reporting of infected cases. As we shall see, MF di\u00a4ers across countries and is estimated to lie in the range of 3\u00009. The evolution of the 3-weekly rolling estimates of ^Retover the period March\u0096 October for the six countries are displayed in Figure 7.22The epidemic tends to expand (contract) if ^Retis above (below) unity, and to highlight this property in Figure 7 we also show the dates for which ^Ret falls below or rise above unity, as well as the start and end dates of the lockdowns. Among the six countries, Italy started national lockdown on March 9,2020, followed by Spain, Austria, and France about a week later, and Germany and UK two weeks later (on March 23, 20Available at https://data.worldbank.org/indicator/SP.POP.TOTL . 21Speci cally, among the six countries, the recorded data on recovery are unavailable for Spain and UK; they are of poor quality for France and Italy; and they are relatively close to our estimated recovery for Austria and Germany. We have also calibrated our model using the recorded recovery data for Austria and Germany as a robustness check and obtained similar results. 22In early stages of the epidemic where ctis small, estimates of ^Retand^ t= are very close, even if we set MF to10. See Figure S.6 in the Online Supplement where estimates of ^Ret;are compared to ^ t= , for the six countries. 38Figure 7: Rolling estimates of the e\u00a4ective reproduction numbers ( Ret) for selected European countries, with start and end dates of the respective lockdowns over the period March to October, 2020 Austria France Germany Italy Spain UK Notes: ^Ret= (1\u0000MFct)^ t= , where = 1=14,^ tis the 3-weekly rolling estimate of tcomputed using (48), and the value of MF for each country is given in Figure 8. The number of removed (recoveries + deaths) is estimated recursively using Rt= (1\u0000 )Rt\u00001+ Ct\u00001for all countries, with C1=R1= 0. To render the calibrations comparable across the six countries, is set to 3=14(givingR0= 3) during the rst week of the epidemic. Red (green) arrows indicate the start (end) dates of the respective lockdowns. Black arrows indicate the dates when ^Retcrosses one. 392020).23As can be seen from Figure 7, ^Retfell below one in mid to late April in all these countries except for the UK which took a bit longer before falling below unity in early May. On average it took 37days to bring ^Retdown below one from the start of lockdown, with Germany being the fastest ( 28days) and UK being the slowest ( 46days). By the end of May 2020,^Retwere brought down below 0:5in all six countries except for the UK where the lowest value of ^Ret(of about 0:54) occurred in early July. As lockdowns were eased, not surprisingly, the transmission rates started to rise, such that at the end of our sample (October 15,2020)^Retended up at 1:3or higher in all six countries with the exception of Spain.24This new surge in estimates of ^Rethas led Austria, France, Germany and UK to announce second lockdowns, e\u00a4ective from late October or from early November. Next we used the 3-weekly rolling estimates to calibrate the network SIR model to the Covid- 19 evidence in these six countries. To render the calibrations comparable across these countries, we start the simulations with set to 3=14(givingR0= 3) for the rst week of the epidemic, and then set tto the rolling estimates computed from the realized data. As shown in Section 6, it makes little di\u00a4erence to the aggregate outcomes whether we carry out the simulations using single or multigroup models. Since we are interested in comparing the calibrated outcomes with realized cases, we conduct simulations using the single group model in this exercise. As before, we x the average number of contacts to k= 10 and set the exposure intensity parameter to^ t=^ t=k; the population size in simulations is set to n= 10;000; the contact network is generated according to the power law speci cation with the number of contacts lying in the range of5to50. All simulations start with 1=1000 of population randomly infected in day 1and are replicatedB= 1;000times for each country. Figure 8 presents the realized and calibrated cases. To match the realized proportion of infected cases with the calibrated ones, we compute the multiplication factor, MF, as the ratio of cmaxbetween the calibrated and realized data for each country, and then plot the 7-day moving 23Lockdown dates across countries can be found in: https://en.wikipedia.org/wiki/COVID-19_pandemic_ lockdowns . 24The estimates of ^Retseem to be reasonably robust to the choice of the estimation window. Similar estimates are obtained if a 2-weekly window is used. See Figure S.7 of the Online Supplement. 40Figure 8: Realized and calibrated number of infected and active cases of Covid-19 for selected European countries (a) Austria ( MF= 4:82) Infected cases Daily new cases (b) France ( MF= 5:16) Infected cases Daily new cases (c) Germany ( MF= 8:26) Infected cases Daily new cases 41Figure 8: (Continued) Realized and calibrated number of infected and active cases of Covid-19 for selected European countries (d) Italy ( MF= 9:27) Infected cases Daily new cases (e) Spain ( MF= 2:60) Infected cases Daily new cases (f) UK ( MF= 8:87) Infected cases Daily new cases Notes: Realized series ( 7-day moving average) multiplied by the multiplication factor (MF) is displayed. MF is computed as the ratio of cmaxbetween the calibrated and realized data. The number of removed (recoveries + deaths) is estimated recursively using Rt= (1\u0000 )Rt\u00001+ Ct\u00001for all countries, with C1=R1= 0. We set 1=1000 of the population randomly infected in day 1and use a single group model with the power law network. The mean number of contacts is k= 10. The exposure intensity parameter is set to ^ t=^ t=k, where ^ tis the 3-weekly rolling 10;000. Number of replications 1;000: 42average of realized data multiplied by the computed MF. Figure 8 also shows the proportion of daily new cases, which are the rst di\u00a4erences of the proportion of infected cases after taking account of the under-reporting of infected cases. The calibrated data are displayed as fan charts with percentiles range from the 30thto the 70th. The estimates con rm signi cant evidence of under-reporting, with the estimated values of MF falling in the range of 3to9. These estimates are comparable to the degrees of under-reporting estimated by other approaches in recent studies, such as 7times in China (Li et al., 2020); 3to16times in ve European countries, China and US (Jagodnik et al., 2020); 10times in the US (Havers et al., 2020); and 10:5times across 86 countries (Rahmandad, Lim, and Sterman, 2020), just to name a few. Once we have taken account of under-reporting, the calibrated cases match with the recorded cases fairly well. It is interesting that our model is able to catch the \u0093second wave\u0094 of Covid-19 cases that start to show up in Europe from mid-August. 9.1 A Counterfactual Exercise Having shown that the outcomes of the calibrated model closely match the evidence, we now show how the model can be used for speci c counterfactual analysis of interest. Here we consider di\u00a4erent outcomes that could have resulted from di\u00a4erent timing of the lockdowns in Germany and the U.K.25In particular, we investigate the quantitative e\u00a4ect of bringing forward the lockdown in the UK on the infected cases, as compared to the e\u00a4ect of delaying the lockdown in Germany. To this end, we shift the estimated tvalues backward or forward for one or two weeks. We examine the counterfactual outcomes during the \u0093 rst wave\u0094of Covid-19 that levelled o\u00a4 in early July in both countries. As shown in Figure 9, if the German lockdown had been delayed by one week, the maximum proportion of infected cases would have increased from 2:5to5:8percent, and the maximum proportion of active cases would have risen from 0:7to1:6percent. In contrast, if the UK lockdown had been brought forward by one week, the model predicts that the maximum proportion of infected cases would have reduced from 6:2to2:6percent, and the maximum number 25For example, Neil Ferguson, once an advisor to the UK government, stated on June 10that \"Had we introduced lockdown measures a week earlier, we would have reduced the nal death toll by at least a half\". See https: //www.politico.com/news/2020/06/10/boris-johnson-britain-coronavirus-response-312668 . 43of active cases would have reduced from 1:3to0:5percent. These results suggest that the UK could have achieved a similarly low level of infected cases per capita as Germany if it had implemented social distancing sooner. The maximum proportion of infected (active cases) is estimated to rise further to 12:8(3:6) percent if the German lockdown was delayed by two weeks, and the maximum proportion of infected (active cases) is estimated to decrease further to 1:2(0:3) percent if the UK lockdown was brought forward by two weeks.26In summary, this counterfactual exercise shows that it is critical to take measures to lower the e\u00a4ective reproduction number as early as possible, if a policy maker aims to control the accumulative and active number of infected cases. 10 Concluding Remarks This paper has developed a stochastic network SIR model for empirical analyses of the Covid-19 pandemic across countries or regions. Moment conditions are derived for the number of infected and active cases for single as well as multigroup models. It is shown how these moment conditions can be used to identify the structural parameters and provide rolling estimates of the transmission rate at di\u00a4erent stages of the epidemic. In empirical applications to six European countries, the estimates are shown to be robust to the well-known under-reporting of infected cases. The rolling estimates of the transmission rate are then used to calibrate the proposed epidemic model. It is shown that the simulated outcomes are reasonably close to the reported cases, once the under- reporting of infected is addressed. It is estimated that the number of reported cases could be between 3to9times lower than the actual number of infected cases over the period from March to mid-October, 2020. The calibrated model is used for empirically-based counterfactual analyses. It is shown that the UK could have achieved an outcome similar to that experienced by Germany during the rst wave if she had started the lockdown just one week earlier. Almost symmetrically, Germany would have experienced much higher infection rates (similar to the UK\u0092 s experience) if she had started the lockdown one week later. 26See Figure S.8 of the Online Supplement. 44Figure 9: Counterfactual number of infected and active cases for Germany and UK under di\u00a4erent lockdown scenarios What if the German lockdown was delayed one week? Infected cases Active cases ^Ret What if the UK lockdown was brought forward one week? Infected cases Active cases ^Ret Notes: The simulation uses a single group model with power law network and begins with 1=1000 of the population randomly infected in day 1.n= 10;000.k= 10 . = 1=14.^ t=^ t=k, where ^ the 3-weekly rolling estimate computed using (48). The number of removed (recoveries + deaths) is estimated recursively using Rt= (1\u0000 )Rt\u00001+ Ct\u00001for both 1\u0000c(b) t\u0011 ^ t= over 1;000 replications is in the last column. References Acemoglu, D., V. Chernozhukov, I. Werning, and M. D. Whinston (2020). Optimal targeted lockdowns in a multi-group SIR model. NBER Working Paper No. 27102. Akbarpour, M., C. Cook, A. Marzuoli, S. Mongey, A. Nagaraj, M. Saccarola, P. Tebaldi, S. Vasserman, and H. Yang (2020). Socioeconomic network heterogeneity and pandemic policy response. University of Chicago, Becker Friedman Institute for Economics Working Paper No. 2020-75. Atkeson, A., K. A. Kopecky, and T. A. Zha (2020). Estimating and forecasting disease scenarios for COVID-19 with an SIR model. NBER Working Paper No. 27335. 45Baqaee, D., E. Farhi, M. Mina, and J. H. Stock (2020). Policies for a second wave. Brookings Papers on Economic Activity (forthcoming) . Beretta, E. and V. Capasso (1986). Global stability results for a multigroup SIR epidemic model. In T. G. Hallam, L. J. Gross, and A. Levin S (Eds.), Mathematical Ecology , pp. 317\u0096 340. World Scienti c. Bollob\u00e1s, B. (1980). A probabilistic proof of an asymptotic formula for the number of labelled regular graphs. European Journal of Combinatorics 1 (4), 311\u0096 316. Chowell, G. and H. Nishiura (2008). Quantifying the transmission potential of pandemic in\u0087 uenza. Physics of Life Reviews 5 (1), 50\u0096 77. Chudik, A., M. H. Pesaran, and A. Rebucci (2020). Voluntary and mandatory social distancing: Evidence on COVID-19 exposure rates from Chinese provinces and selected countries. NBER working paper No. 27039. D\u0092 Arienzo, M. and A. Coniglio (2020). Assessment of the SARS-CoV-2 basic reproduction number, R0, based on the early phase of COVID-19 outbreak in Italy. Biosafety and Health . Del Valle, S. Y., J. M. Hyman, and N. Chitnis (2013). Mathematical models of contact patterns between age groups for predicting the spread of infectious diseases. Mathematical Biosciences and Engineering 10 , 1475. Ding, D., W. Qin, and X. Ding (2015). Lyapunov functions and global stability for a discretized multigroup SIR epidemic model. Discrete & Continuous Dynamical Systems-B 20 (7), 1971. Fern\u00e1ndez-Villaverde, J. and C. I. Jones (2020). Estimating and simulating a SIRD model of COVID-19 for many countries, states, and cities. NBER working paper No. 27128. Gibbons, C. L., M.-J. J. Mangen, D. Plass, A. H. Havelaar, R. J. Brooke, P. Kramarz, K. L. Peterson, A. L. Stuurman, A. Cassini, E. M. F\u00e8vre, and M. E. Kretzschmar (2014). Measuring underreporting and under- ascertainment in infectious disease datasets: a comparison of methods. BMC Public Health 14 (1), 147. Guo, H., M. Y. Li, and Z. Shuai (2006). Global stability of the endemic equilibrium of multigroup SIR epidemic models. Canadian Applied Mathematics Quarterly 14 (3), 259\u0096 284. Harris, J. E. (2020). Overcoming reporting delays is critical to timely epidemic monitoring: The case of COVID-19 in New York City. Preprint medRxiv . Havers, F. P., C. Reed, T. Lim, J. M. Montgomery, J. D. Klena, A. J. Hall, A. M. Fry, D. L. Cannon, C.-F. Chiang, A. Gibbons, et al. (2020). Seroprevalence of antibodies to SARS-CoV-2 in 10 sites in the United States, March 23-May 12, 2020. JAMA Internal Medicine . He\u00a4ernan, J. M., R. J. Smith, and L. M. Wahl (2005). Perspectives on the basic reproductive ratio. Journal of the Royal Society Interface 2 (4), 281\u0096 293. Hethcote, H. W. (1978). An immunization model for a heterogeneous population. Theoretical Population Biol- ogy 14 (3), 338\u0096 349. Hethcote, H. W. (2000). The mathematics of infectious diseases. SIAM Review 42 (4), 599\u0096 653. Hoang, T., P. Coletti, A. Melegaro, G. Grijalva, J. W. Edmunds, P. Beutels, and N. Hens (2019). A systematic review of social contact surveys to inform transmission models of close-contact infections. Epi- demiology (Cambridge, Mass.) 30 (5), 723. Hyman, J. M., J. Li, and E. A. Stanley (1999). The di\u00a4erential infectivity and staged progression models for the transmission of HIV. Mathematical Biosciences 155 (2), 77\u0096 109. Jagodnik, K., F. Ray, F. M. Giorgi, and A. Lachmann (2020). Correcting under-reported COVID-19 case numbers: estimating the true scale of the pandemic. Preprint medRvix 14 . 46Jarvis, C. I., K. Van Zandvoort, A. Gimma, K. Prem, P. Klepac, G. J. Rubin, and W. J. Edmunds (2020). Quantifying the impact of physical distance measures on the transmission of COVID-19 in the UK. BMC Medicine 18 , 1\u0096 10. Ji, C., D. Jiang, and N. Shi (2011). Multigroup SIR epidemic model with stochastic perturbation. Physica A: Statistical Mechanics and its Applications 390 (10), 1747\u0096 1762. Kermack, W. and A. McKendrick (1927). A contribution to the mathematical theory of epidemics. Proceedings of the Royal Society of London. Series A. 115 (772), 700\u0096 721. Kiss, I. Z., J. C. Miller, and P. L. Simon (2017). Mathematics of epidemics on networks. Cham: Springer 598 . Korolev, I. (2020). Identi cation and estimation of the SEIRD epidemic model for COVID-19. Journal of Econo- metrics (forthcoming) . Lajmanovich, A. and J. A. Yorke (1976). A deterministic model for gonorrhea in a nonhomogeneous population. Mathematical Biosciences 28 (3-4), 221\u0096 236. Lee, C. and D. J. Wilkinson (2019). A review of stochastic block models and extensions for graph clustering. Applied Network Science 4 (1), 122. Leung, K., M. Jit, E. H. Lau, and J. T. Wu (2017). Social contact patterns relevant to the spread of respiratory infectious diseases in Hong Kong. Scienti c Reports 7 (1), 1\u0096 12. Li, M. Y., Z. Shuai, and C. Wang (2010). Global stability of multi-group epidemic models with distributed delays. Journal of Mathematical Analysis and Applications 361 (1), 38\u0096 47. Li, R., S. Pei, B. Chen, Y. Song, T. Zhang, W. Yang, and J. Shaman (2020). Substantial undocumented infection facilitates the rapid dissemination of novel coronavirus (SARS-CoV-2). Science 368 (6490), 489\u0096 493. Matrajt, L. and T. Leung (2020). Evaluating the e\u00a4ectiveness of social distancing interventions to delay or \u0087 atten the epidemic curve of coronavirus disease. Emerging Infectious Diseases 26 (8), 1740. Miller, J. C. and I. Z. Kiss (2014). Epidemic spread in networks: Existing methods and current challenges. Mathematical Modelling of Natural Phenomena 9 (2), 4\u0096 42. Mossong, J., N. Hens, M. Jit, P. Beutels, K. Auranen, R. Mikolajczyk, M. Massari, S. Salmaso, G. S. Tomba, J. Wallinga, et al. (2008). Social contacts and mixing patterns relevant to the spread of infectious diseases. PLoS Med 5 (3), e74. Nepomuceno, E., D. F. Resende, and M. J. Lacerda (2018). A survey of the individual-based model applied in biomedical and epidemiology. Journal of Biomedical Research and Reviews . Newman, M. (2018). Networks . Oxford University Press. Nikbakht, R., M. R. Baneshi, A. Bahrampour, and A. Hosseinnataj (2019). Comparison of methods to estimate basic reproduction number (R0) of in\u0087 uenza, using Canada 2009 and 2017-18 A (H1N1) data. Journal of Research in Medical Sciences 24 . Obadia, T., R. Haneef, and P.-Y. Bo\u00eblle (2012). The R0 package: A toolbox to estimate reproduction numbers for epidemic outbreaks. BMC Medical Informatics and Decision Making 12 (1), 1\u0096 9. Pastor-Satorras, R., C. Castellano, P. Van Mieghem, and A. Vespignani (2015). Epidemic processes in complex networks. Reviews of Modern Physics 87 (3), 925. Rahmandad, H., T. Y. Lim, and J. Sterman (2020). Estimating COVID-19 under-reporting across 86 nations: implications for projections and control. Available at SSRN 3635047. 47Rocha, L. E. and N. Masuda (2016). Individual-based approach to epidemic processes on arbitrary dynamic contact networks. Scienti c Reports 6 , 31456. Thieme, H. R. (1983). Global asymptotic stability in epidemic models. In H. W. Knobloch and K. Schmitt (Eds.), Equadi\u00a4 82 Proceedings , pp. 608\u0096 615. Springer. Thieme, H. R. (1985). Local stability in epidemic models for heterogeneous populations. In V. Capasso, E. Grosso, and S. L. Paveri-Fontana (Eds.), Mathematics in Biology and Medicine , pp. 185\u0096 189. Springer. Thieme, H. R. (2013). Mathematics in population biology , Volume 12 of Princeton Series in Theoretical and Computational Biology . Princeton University Press. Toda, A. A. (2020). Susceptible-infected-recovered (SIR) dynamics of COVID-19 and economic impact. Preprint arXiv: 2003.11221. Willem, L., T. Van Hoang, S. Funk, P. Coletti, P. Beutels, and N. Hens (2020). SOCRATES: An online tool lever- aging a social contact data sharing initiative to assess mitigation strategies for COVID-19. Preprint medRxiv . Willem, L., F. Verelst, J. Bilcke, N. Hens, and P. Beutels (2017). Lessons from a decade of individual-based models for infectious disease transmission: a systematic review (2006-2015). BMC infectious diseases 17 (1), 612. Zhang, J., P. Klepac, J. M. Read, A. Rosello, X. Wang, S. Lai, M. Li, Y. Song, Q. Wei, H. Jiang, et al. (2019). Patterns of human social contact and contact with animals in Shanghai, China. Scienti c Reports 9 (1), 1\u0096 11. Zhang, J., M. Litvinova, Y. Liang, Y. Wang, W. Wang, S. Zhao, Q. Wu, S. Merler, C. Viboud, A. Vespignani, et al. (2020a). Changes in contact patterns shape the dynamics of the COVID-19 outbreak in China. Science . Zhang, J., M. Litvinova, Y. Liang, Y. Wang, W. Wang, S. Zhao, Q. Wu, S. Merler, C. Viboud, A. Vespignani, et al. (2020b). Supplementary materials for \"Changes in contact patterns shape the dynamics of the COVID-19 outbreak in China\". Science . Zhou, J., Y. Yang, and T. Zhang (2017). Global stability of a discrete multigroup SIR model with nonlinear incidence rate. Mathematical Methods in the Applied Sciences 40 (14), 5370\u0096 5379. 48Online Supplement to \"Matching Theory and Evidence on Covid-19 using a Stochastic Network SIR Model\" M. Hashem Pesaran University of Southern California, USA, and Trinity College, Cambridge, UK Cynthia Fan Yang Florida State University November 10, 2020 This Online Supplement provides technical derivations and presents additional simulation re- sults. Section S1 generalizes the proposed stochastic network SIR model to allow for truncated geometric recovery. Section S2 discusses the edge probability and how the random networks were generated in our simulation exercises. Section S3 provides additional simulation results showing the robustness of the proposed model to the population size, n, and the network types. Section S4 reports additional Monte Carlo results of estimation of the transmission rate. Section S5 presents additional ndings of the calibration and counterfactual analyses. S1 Truncated Geometric Model of Recovery Here we consider a generalization of the recovery model used in the main paper and suppose that for all individuals in group `(`= 1;2;:::;L ) the time to recovery (or infection duration), denoted byT\u0003 i`;t=t\u0000t\u0003 i`, follows a truncated geometric number of days for an individual to recover and is assumed to be the same for all individuals in group `, `is the probability of recovery on each day if the geometric S1distribution is non-truncated (i.e., D`!1 ).A`is h`(s;D)(s= 1;2;:::;D), de ned as the probability of individuals in group `recovering at time sconditional on having remained infected for s\u00001days a nite D`and0< `<1,h`(s;D`)monotonically increases with s. Hence, by assuming a truncated geometric distribution for recovery time, we are able to allow for the possibility that the longer an individual is infected the more likely s/he will recover. It is also clear thath`(s;D`)! `asD`!1 , which establishes the familiar result for a non-truncated geometric distribution used in the main paper. Under the truncated geometric distribution we not simplify to the standard recovery process used in the SIR models, unless D`!1 . S2 Generating random networks This section describes how we generated random draws from Erd \u00bdos-R\u00e9nyi and power law networks in the case of single and multigroup random networks used in our simulations. First, in an Erd \u00bdos-R\u00e9nyi (ER) random graph each edge has a xed probability of being present or not independently of all other edges. Speci cally, we generate the ER random network with nnodes and a single group by considering all possible edges and including an edge between each distinct pair of nodes with probability p=k=(n\u00001). Second, we generate the power law random network in the case of a single group following the standard procedure in the literature:S1at each time t, we rst draw a degree sequence from the (truncated) power law distribution given by (45), and then generate a network with that degree sequence based on a con guration model.S2Speci cally, we draw a degree sequence ki(t) randomly and independently over ifori= 1;2;\u0001\u0001\u0001;n, (with replacement), such that ki(t)realizes with probability pki. Then we generate a con guration model with the degree sequence fki(t)g by the standard algorithm \u0096 rst assign each node with a number of stubs (half edges) that is equal to its degree, then match two stubs uniformly at random to form an edge and continue until all stubs are matched. Since the number of edges, denoted by m(t), in a graph satis es 2m(t) =P iki(t), the generated degrees must add to an even number to be able to construct a graph. If the generated degrees add to an even number, we simply throw them away and generate another sequence. Also notice that this algorithm may produce self-loops and multi-edges. This S1See, for example, Kiss et al. (2017), p. 20. S2A con guration model is a model of a random graph with a given degree sequence. The name \"con guration\" originates from Bollob\u00e1s (1980) meaning arrangements of edges in the model. S3is not a concern if nis su\u00a2 ciently large, since the density of such problematic links is of order O(n\u00001):S3In simulations, we discard self-loops and collapse multi-edges. The resulting graph is used as the power law contact network for time tand the same procedure is repeated in each t and over replications. It follows from the degree distribution given by (45) that the normalizing constant has the expressionC=\u0010Pkmax kminx\u0000 \u0011\u00001 , and then the average degree of power law graph is In simulations the value of the exponent, ;is solved from (S.4) such that k= 10. Given the degree sequence k(t) = [k1(t);k2(t);:::;kn(t)]0, the (conditional) edge probability between node the con guration model isS4 E[dij(t)jk(t)] =ki(t)kj(t) 2m(t)\u00001; which in the as E[dij(t)jk(t)] =ki(t)kj(t) 2m(t)=ki(t)kj(t)Pn r=1kr(t)=ki(t)kj(t) nk: Sinceki(t)andkj(t)are independent draws from the power law distribution with mean k, the (unconditional) edge probability is pij=E[dij(t)] =EfE[dij(t)jk(t)]g=k2 nk=k n; which is the same as the edge probability in the ER random network. Finally, the network with multigroup can be generated following the stochastic block model (SBM), which is a popular random graph model for blocks (groups, or communities) in networks.S5 Recall our assumption that the probability of contacts is homogeneous within groups but di\u00a4erent across groups. Node (or individual) iin group`is denoted by (i;`). At each time t, we draw a network in which the edge between each distinct pair of nodes, (i;`)and\u0000 j;`0\u0001 , exists with S3A proof can be found in Newman (2018), pp. 373\u0096 375. S4See, e.g., Newman (2018), p. 373. S5A recent review of stochastic block models is provided by Lee and Wilkinson (2019). S4probability p``0:That is, the edge probabilities depend on the groups which nodes belong to. We set the within group probability p``=k``=(n`\u00001)\u0019k``=n`, and the between group probability p``0=k``0=n`0. By construction we have p``0=p`0`under the reciprocity condition, n`k``0=n`0k`0`. Note that if p``0=pfor all groups `and`0, the SBM reduces to the ER random graph. If p``0are not all identical, the SBM generates ER random graphs within each group and random bipartite graphs between groups. Accordingly, the degree distribution of the generated network is a mixture of Poisson degree distributions. To create heavy-tailed degree distributions or other types of degree heterogeneity, one can generalize the SBM analogous to the con guration model or consider the degree-corrected SBM, but these generalizations are beyond the scope of the current paper.S6 S3 Simulated properties of the stochastic network SIR model First we consider how the simulated properties of the proposed model vary as we increase the population size, n. Speci cally, we carry out simulations with n= 10;000,50;000, and 100;000 assuming a xed transmission rate, where the parameters take the same values as set out in Section 6.1 of the paper, namely k= 10, = 1=14,R0= 3, = R0= 3=14, and = =k. For each replication the simulation is initialized with 1=1000 of the population randomly infected in day 1. The number of replications is set to B= 1;000;for all experiments. Figure S.1 displays the proportions of infected and active cases, as well as respective epidemic curves. As can be seen, the simulated values ofcmaxandimaxare hardly a\u00a4ected by the choice of nin the range of ( 10;000,100;1000). The time at which active cases peak is also almost the same across n. Although uncertainty in the simulation results decreases with larger n, the interquartile range with n= 10;000is quite tight. Therefore, without loss of generality and to save computational time we set n= 10;000in all experiments below and those reported in the main paper. S6See, for example, Newman (2018), Section 12.11.16, for a discussion. S5Figure S.1: Simulated number of infected and active cases using a single group model with R0= 3 under di\u00a4erent population 58 Notes: We set 1=1000 of the population randomly infected in day 1and use the power law network with mean contact number k= 10. The recovery rate is = 1=14. The exposure intensity parameter is = R0=k. Number of replications is 1;000: We next examine the e\u00a4ect of network topology on the simulation results. In particular, we consider two widely used random networks \u0096the Erd \u00bdos-R\u00e9nyi (ER) and the power law random networks. Figure S.2 illustrates the two networks with n= 50 nodes and the same average degree, k= 10 . It is assumed that the minimum and maximum degrees of the power law network is kmin= 5andkmax= 49 , respectively. The networks were generated following the algorithms described in Section S2 of this Online Supplement. Note that the ER random network has a binomial degree distribution, and it can be seen from the gure that most nodes have comparable degrees with the mean degree of 10, approximately. In contrast, the power law network has a heavy-tailed degree distribution, and there are many small-degree nodes as well as a few highly S6Figure S.2: Examples of power law and Erdos-Renyi random networks (Truncated) Power Law Network Erd \u00bdos-R\u00e9nyi Random Network Notes:n= 50:Mean degree is k= 10 in both networks. The degree distribution in the power law network follows px=Cx\u00002:43;forx= 5;6;:::; 49: connected nodes in the graph. Figure S.3 compares the simulation results obtained using the two random networks with the same average degree of 10. We setkmin= 5andkmax= 50 for the power law networks. The values of ,R0, and , and initialization of the simulation process are as given above. We plot the proportion of infected and active cases with uncertainty bands, and also the median values across replications for easy comparison. It is clear from Figure S.3 that the median epidemic curves obtained by the two di\u00a4erent random networks overlap. Although not shown, the mean simulation results are very close to the median values for both types of networks. We therefore focus on the power law network (viewed as more realistic) in our simulation and calibration exercises. S4 Estimation of the transmission rate Here we provide further evidence on the performance of the rolling estimators of the transmission rates. Table S.1 below reports the nite sample properties of the rolling estimates of R0in the case where it is xed at R0= 3and the population size is n= 10;000, which complements Table 1 of the paper. The simulated data were obtained under the same set-up as that for Table 1, and are based on a single group model with the power law network, and the parameter values S7Figure S.3: Simulated number of infected and active cases using a single group model with R0= 3 under di\u00a4erent network topologies Power Law Network Random Network Comparison of Medians Infected cases Active cases Notes: We set 1=1000 of the population randomly infected in day 1. Both networks have mean degrees k= 10. The recovery rate is = 1=14. The exposure intensity parameter is = R0=k. Population = 3=14. Table S.1 presents the bias and root mean square error (RMSE) of the rolling estimates, ^R0(W) =^ t(W)= , where the window size, W, is set to 2and 3weeks, respectively, and ^ t(W)is computed based on (48) of the main paper. The results refer to averages computed over the full sample ( 4th\u000015thweeks after the outbreak), as well as over the four non-overlapping 3-weekly sub-samples. As to be expected, the bias remains small and similar over di\u00a4erent sub-samples. The RMSE is smaller in the middle of the epidemic than at the beginning and end stages where itis very close to zero. Note that unlike Table 1 of the main paper, we do not discard observations with it<0:01in order to show that the transmission rate cannot be estimated very precisely at the early and late stages of the epidemic. Therefore the RMSEs in early and end sub-samples are S8Table S.1: Finite sample properties of the rolling estimates of R0, in the case where it is xed at R0= 3 Full sample 3-weekly sub-samples Weeks since the are computed using (48) of the main paper. The true value of R0is set to = , where = 3=14and = 1=14so 3. n= 10;000. Number of replications is 1;000: larger than those in Table 1 of the main paper. Nonetheless, the average RMSE of ^R0over the full period lies in the range 0:11\u00000:12, which is reasonably small compared to the true value of 3. In addition, the properties of the 2-weekly and 3-weekly rolling estimates are very close, with the 3-weekly rolling estimates having slightly smaller RMSE as compared to the 2-weekly estimates. We now turn to the performance of the rolling estimates under linearly declining tand W- shaped tscenarios. The simulations are described in Section 6.2 of the paper. Figure S.4 compares the2-weekly and 3-weekly rolling estimates of t= using the simulated data. The gure displays the median estimates based on 1;000replications, as well as the assumed value of t. It is readily seen that the 2-weekly and 3-weekly rolling estimates are very close. As tchanges over time, the rolling estimates catch up with the true values of twith a time lag, and as to be expected 2-weekly rolling estimates tend to catch up more quickly. When the assumed value falls (rises), ^ tslightly overestimates (underestimates) t, with negligible sampling errors when tis xed. The magnitude of the bias and RMSE in estimating t= are summarized in Table S.2, which complements the pictorial representation of the results in Figure S.4. Full sample comprises observations over 180days since the outbreak. We also divide the full sample into sub-samples in which tdeclines, stays constant, or rises, which only applies to the case of W-shaped t. We report the average bias and RMSE of ^ t= for the full sample and each sub-sample. Since there are two declining periods (weeks 1\u00007and13\u000018) in the case of W-shaped t, the bias and RMSE for the declining sub-sample refer to the values averaged over the two periods over which S9Figure S.4: Rolling estimates of t= under 2- and 3-weekly rolling windows Linearly declining transmission rates t W-shaped transmission rates t Notes: Median estimates over 1;000replications are shown in the gure. The rolling estimates are computed using (48) of the main paper. The data were simulated using a single group model with the power law network. The mean number of contacts is k= 10. The exposure intensity parameter is t= t=k. Population size is n= 10;000. tis falling. Similarly, results for the xed tsub-sample in the case of W-shaped trefer to the estimates averaged over the weeks 8\u00009and19\u000026. The average bias and RMSE over the full sample are found to be reasonably small, with the rolling estimates having positive (negative) bias when the true transmission rate is decreasing (increasing), which are in line with the estimates depicted in Figure S.4. The bias and RMSE are much smaller when the transmission rate is steady, compared to when the transmission rate is changing. The 2-weekly rolling estimates have smaller bias and RMSE as compared to the 3-weekly rolling estimates when tis declining. Over the full sample, the 2-weekly rolling estimates slightly outperform the 3-weekly estimates in both scenarios of varying transmission rates. Overall, both 2-weekly and 3-weekly rolling estimates are quite close and perform well. Finally, we show that the rolling estimates of tare robust to whether a moving average (MA) lter is applied to the data before estimation. In practice, a 1-week MA lter is often applied when displaying infected cases in order to smooth out data irregularities and to alleviate the in\u0087 uence of delayed reporting. It is therefore of interest to see whether the estimated tare robust to the application of an MA lter to the data. Figure S.5 presents the results. It can be seen that whether the data is ltered or not leads to very similar estimates of t, and the estimates are also reasonably close to the assumed value in both scenarios of linearly declining tand W-shaped t. S10Table S.2: Finite sample properties of the rolling estimates of t= , in the case of linearly declining and W-shaped transmission rates Full Sub-samples Sample Declining tFixed tRising t Linearly declining transmission rates t 2-weekly RMSE over the full sample ( 180days) and sub-samples in which the transmission rate declines, remains xed, or rises. The declining ( xed) sub-samples in the case of W-shaped transmission rates give averages over declining ( xed) periods. The rolling estimates are computed using (48) in the main paper. The data were simulated using a single group model with the power law network. The mean number of contacts is k= 10. The exposure intensity parameter is t= t=k. replications 1;000: Figure S.5: Comparison rolling estimates of t= using un ltered and one-week moving average ltered data Linearly declining transmission rates t W-shaped transmission rates t Notes: The median of 3-weekly rolling estimates over 1;000replications are shown in the gure. The estimates using ltered data are based on 1-week moving average ltered observations. The rolling estimates are computed using (48) of the main paper. The data were simulated using a single group model with the power law network. The mean number of contacts is k= 10. The exposure intensity parameter t= is n= 10;000. S11S5 Calibration and counterfactual analyses In this section, we provide additional results for the calibration and counterfactual exercises described in the paper. Figure S.6 shows that ^Ret= (1\u0000MFct)^ t= is almost the same as ^ t= since the proportion of infected is very small even after taking account of under-reporting. As infected cases have grown, small di\u00a4erences between ^ t= and ^Retstart to become visible towards the end of our sample period (mid-October). Figure S.7 shows that the 2-weekly and 3-weekly rolling estimates of the e\u00a4ective reproduction numbers using realized data, are very close to each other for all six countries under consideration. Therefore, our ndings would be similar if we adopt the 2-weekly rolling estimates of tin calibrating the model to the empirical evidence. To complement the counterfactuals presented in the main paper if the German (UK) lock- down were delayed (brought forward) one week, we further examine the potential outcomes if the lockdown were delayed or advanced two weeks. As shown in Figure S.8, if the German lockdown had been delayed one week, there would have been a whopping ve-fold increase in both infected and active cases. By contrast, if the UK lockdown had been implemented two weeks earlier, both infected and active cases could have been one- fth of the realized level. These results further highlight the importance of taking mitigation actions early in an epidemic outbreak. S12Figure S.6: Comparison of ^Retand ^ t= for selected European countries Austria France Germany Italy Spain UK Notes: ^ tis the 3-weekly rolling estimate of tcomputed using (48) of the main paper. ^Ret= (1\u0000MFct)^ t= , where = 1=14and the value of MF for each country is given in Figure 8 of the main paper. The number of removed (recoveries + deaths) is estimated recursively using Rt= (1\u0000 )Rt\u00001+ Ct\u00001for all countries, with C1=R1= 0. To render the calibrations comparable across the six countries, is set to 3=14(givingR0= 3) during the rst week of the epidemic. S13Figure S.7: Rolling estimates of the e\u00a4ective reproduction numbers ( Ret) under 2- and 3-weekly rolling windows for selected European countries Austria France Germany Italy Spain UK Notes: ^Ret= (1\u0000MFct)^ t= , where = 1=14and the value of MF for each country is given in Figure 8 of the main paper. The rolling estimates of tare computed using (48) of the main paper. The number of removed (recoveries + deaths) is estimated recursively using Rt= (1\u0000 )Rt\u00001+ Ct\u00001for all countries, with C1=R1= 0. To render the calibrations comparable across the six countries, is set to 3=14(givingR0= 3) during the rst week of the epidemic. S14Figure S.8: Counterfactual number of infected and active cases for Germany and UK under di\u00a4erent lockdown scenarios What if the German lockdown was delayed 2 weeks? Infected cases Active cases ^Ret What if the UK lockdown was brought forward 2 weeks? Infected cases Active cases ^Ret Notes: The simulation uses a single group model with power law network and begins with 1=1000 of the population randomly infected in day 1.n= 10;000.k= 10 . = 1=14.^ t=^ t=k, where ^ the 3-weekly rolling estimate computed using (48). The number of removed (recoveries + deaths) is estimated recursively using Rt= (1\u0000 )Rt\u00001+ Ct\u00001for both 1\u0000c(b) t\u0011 ^ t= over "}